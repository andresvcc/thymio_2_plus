/* Copyright 2018-2022 ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE - author Yves Piguet */
(function(){
var N,aa="function"==typeof Object.create?Object.create:function(a){function c(){}c.prototype=a;return new c},ba;if("function"==typeof Object.setPrototypeOf)ba=Object.setPrototypeOf;else{var ca;a:{var da={Qh:!0},ea={};try{ea.__proto__=da;ca=ea.Qh;break a}catch(a){}ca=!1}ba=ca?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null}
var ha=ba,ja="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};function ka(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");}var oa=ka(this);
function pa(a,c){if(c){var b=oa;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&ja(b,a,{configurable:!0,writable:!0,value:c})}}pa("Array.prototype.find",function(a){return a?a:function(c,b){a:{var d=this;d instanceof String&&(d=String(d));for(var e=d.length,f=0;f<e;f++){var g=d[f];if(c.call(b,g,f,d)){c=g;break a}}c=void 0}return c}});
pa("Array.prototype.fill",function(a){return a?a:function(c,b,d){var e=this.length||0;0>b&&(b=Math.max(0,e+b));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(b=Number(b||0);b<d;b++)this[b]=c;return this}});pa("Math.sign",function(a){return a?a:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}});pa("Math.log10",function(a){return a?a:function(c){return Math.log(c)/Math.LN10}});
var ra="function"==typeof Object.assign?Object.assign:function(a,c){for(var b=1;b<arguments.length;b++){var d=arguments[b];if(d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e])}return a};pa("Object.assign",function(a){return a||ra});pa("Math.trunc",function(a){return a?a:function(c){c=Number(c);if(isNaN(c)||Infinity===c||-Infinity===c||0===c)return c;var b=Math.floor(Math.abs(c));return 0>c?-b:b}});var sa,ta,ua;function va(a,c){this.name=a;this.xe=c}var wa=[];function xa(){var a=ya;if(a)for(var c=wa.length-1;0<=c;c--)wa[c]instanceof a&&wa.splice(c,1);else wa=[]}va.prototype.b=function(){throw"not implemented";};va.prototype.addEventListener=function(){throw"not implemented";};function ya(a,c,b){va.call(this,a,c);this.url=b}ya.prototype=Object.create(va.prototype);ya.prototype.constructor=ya;function za(a,c,b,d){var e=new XMLHttpRequest;e.timeout=5E3;b&&(e.addEventListener("timeout",function(){b(null)}),e.addEventListener("error",function(){b(null)}),e.addEventListener("load",function(){switch(e.status){case 200:b(e.responseText);break;default:b(null)}}));e.open(a,c,!0);e.send(d)}
function Aa(a,c){a=a||"";za("GET",a+"/nodes",function(b){null!==b&&(b=JSON.parse(b),0===b.length?Aa(a,c):(xa(),b.forEach(function(d){var e=new ya(d.name,d.aeslId,a+"/nodes/"+d.name,d.protocolVersion);za("GET",a+"/nodes/"+d.name,function(f){e.description=f?JSON.parse(f):""});wa.push(e)}),c&&c()))})}
function Ba(a,c){return"<!DOCTYPE aesl-source>\n<network>\n"+[].map(function(b){return"<event size='"+(b.size||0).toString(10)+"' name='"+b.name+"'/>\n"}).join("")+"<keywords flag='true'/>\n<node nodeId='"+(a.xe||1).toString(10)+"' name='"+a.name+"'><![CDATA["+c+"]]\x3e</node>\n</network>\n"}ya.prototype.b=function(a){a=Ba(this,a);za("PUT",this.url,void 0,a)};
ya.prototype.addEventListener=function(a,c){a=a.toString();var b=this.url+"/events";a&&(b+="/"+a);b=new EventSource(b);b.onmessage=function(d){c(d.data.split(" ").slice(1).map(function(e){return parseInt(e,10)}),a)};return b};function Ca(a){this.name=a.name;this.type=a.type;this.va=a.va||["b","a"];this.sh=a.sh||!1;this.sa=a.sa||null;this.fb=a.fb||null;this.df=a.df||null;this.ha=a.ha;this.Sf=a.Sf||null;this.Se=a.Se||null;this.validate=a.validate||null;this.Mb=a.Mb||{aseba:"e"===this.type?function(c){return{ie:"# onevent "+c.T.name+"\n"}}:function(c){return{ya:"# "+c.T.name+"\n"}}};this.J=a.J||function(c,b){c.text(b.T.name)};this.Je=a.Je||!1;this.fa=a.fa||null;this.Pa=a.Pa||null;this.jd=a.jd||null}var Da=[];
function Ea(a,c,b,d){var e=null;for(b=b||{K:0,Jh:1};;){var f=/`([^`]*)`/.exec(a);if(null==f)break;e=(new Function("$","i","slowdown","rgb","toFixed","return "+f[1]+";"))(c,b.K,b.Jh,function(g){g=[g[0],Math.max(.2+.8*g[1],g[2]/2),g[2]];var h=Math.max(g[0],Math.max(g[1],g[2]));return g.map(function(l){return.88*(1-h)+(.12+.88*h)*l})},function(g,h){return parseFloat(g.toFixed(void 0===h?2:h)).toString()});a=a.slice(0,f.index)+e+a.slice(f.index+f[0].length)}return d?e:a};function Fa(a){this.controls=a||[]}function Ga(a,c,b,d,e,f,g,h){this.top=a;this.left=c;this.bottom=b;this.right=d;this.l=e;this.i=f;this.b=g;this.u=h||null};function Ha(a,c,b){this.T=a;this.Gb=c;this.We=b;this.locked=this.disabled=!1;this.marks={};this.h=a.sa?a.sa():null;this.b=this.i=null}Ha.prototype.sb=function(a,c,b,d){a=new Ha(this.T,a,c);a.disabled=this.disabled;a.i=b;a.b=d;this.h&&(a.h=this.h.slice());return a};function Ia(a){a.i&&a.i()}function Ja(a){a.b&&a.b()}Ha.prototype.l=function(a,c){return this.disabled?{}:this.T.Mb[a]?this.T.Mb[a](this,c):Ka[a].b(this)};function La(a,c,b){Ha.call(this,Ma[a],c,b)}La.prototype=Object.create(Ha.prototype);La.prototype.constructor=La;var Ma={e:new Ca({name:"empty e",type:"e",J:function(a,c,b,d){var e=Na("!empty event");e&&e.J(a,c,b,d)}}),a:new Ca({name:"empty a",type:"a",J:function(a,c,b,d){var e=Na("!empty action");e&&e.J(a,c,b,d)}}),s:new Ca({name:"empty s",type:"s",J:function(a,c,b,d){var e=Na("!empty state")||Na("!empty event");e&&e.J(a,c,b,d)}})};La.prototype.l=function(){return{}};function Oa(){this.X=[];this.actions=[];this.error=null;this.locked=this.disabled=!1}N=Oa.prototype;N.sb=function(){for(var a=new Oa,c=0;c<this.X.length;c++)a.Yb(this.X[c]);for(c=0;c<this.actions.length;c++)a.Yb(this.actions[c]);return a};N.Tb=function(){return 0===this.X.length&&0===this.actions.length};function Pa(a){for(var c=0;c<a.X.length;c++)if("init"===a.X[c].T.name)return a.X[c];return null}
N.Yb=function(a,c,b,d,e){if(a){switch(a.T.type){case "e":case "s":if(a.Gb===this)c&&(this.X.splice(a.We.index,1),e?(a.i=b||null,a.b=d||null):a=a.sb(this,c,b||null,d||null),this.X.splice(c.index,0,a));else if(c){if(this.X[c.index]===a)return;e?(a.i=b||null,a.b=d||null):a=a.sb(this,c,b||null,d||null);this.X[c.index]=a}else e?(a.i=b||null,a.b=d||null):a=a.sb(this,{kd:!0,index:this.X.length},b||null,d||null),this.X.push(a);break;case "a":case "c":if(a.Gb===this)c&&(this.Gg(a.We),e?(a.i=b||null,a.b=d||
null):a=a.sb(this,c,b||null,d||null),(c.kd?this.X:this.actions).splice(c.index,0,a));else if(c){if((c.kd?this.X:this.actions)[c.index]===a)return;e?(a.i=b||null,a.b=d||null):a=a.sb(this,c,b||null,d||null);(c.kd?this.X:this.actions)[c.index]=a}else e?(a.i=b||null,a.b=d||null):a=a.sb(this,{kd:!1,index:this.actions.length},b||null,d||null),this.actions.push(a)}Qa(this)}};
N.Gg=function(a){a.kd?this.X[a.index]&&(this.X.splice(a.index,1),Qa(this)):this.actions[a.index]&&(this.actions.splice(a.index,1),Qa(this))};function Qa(a){a.X.forEach(function(c,b){c.Gb=this;c.We={kd:!0,index:b}},a);a.actions.forEach(function(c,b){c.Gb=this;c.We={kd:!1,index:b}},a)}
N.qf=function(a){function c(h,l){if(h.disabled)return l.disabled?0:1;if(l.disabled)return-1;h=h.T.name;l=l.T.name;return h>l?1:h<l?-1:0}function b(h,l){if(null===h.h&&null===l.h)return!0;if(null===h.h||null===l.h||h.h.length!==l.h.length)return!1;for(var k=0;k<h.h.length;k++)if(h.h[k]!==l.h[k])return!1;return!0}function d(h){for(var l=0;l<h.X.length;l++)if(!h.X[l].disabled)return!1;return!0}if(!(this.disabled||a.disabled||d(this)||d(a)||0===this.X.length||a.X.length!==this.X.length)){for(var e=this.X.slice(0,
1).concat(this.X.slice(1).sort(c)),f=a.X.slice(0,1).concat(a.X.slice(1).sort(c)),g=0;g<e.length&&!e[g].disabled&&!f[g].disabled;g++)if(e[g].T!==f[g].T||!b(e[g],f[g]))return;if(null==this.error||this.error.Wb)e=new Ra("Rules with same events"),Sa(e,a),this.error=e;if(null==a.error||a.error.Wb)e=new Ra("Rules with same events"),Sa(e,this),a.error=e}};function Ta(a){Oa.call(this);this.je=a||""}Ta.prototype=Object.create(Oa.prototype);N=Ta.prototype;N.constructor=Ta;N.sb=function(){return new Ta(this.je)};N.Tb=function(){return!1};N.Yb=function(){throw"internal";};N.Gg=function(){throw"internal";};N.qf=function(){};function Ua(){this.b=[];this.wb=this.Ee=this.ic=!1;this.l=!0;this.i=this.u=!1}function Va(a,c){a.b=c.slice()}Ua.prototype.toggle=function(a){var c=this.b.indexOf(a);0<=c?this.b.splice(c,1):this.b.push(a)};function Wa(){this.b={};this.language="en"}function Xa(a,c,b){a.b[c]||(a.b[c]={});a=a.b[c];for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}Wa.prototype.translate=function(a,c){return(c=this.b[c||this.language])&&c[a]||a};function Ya(){this.b={};this.ff={};this.i=null}Ya.prototype.add=function(a){for(var c in a)if(a.hasOwnProperty(c)){this.b[c]||(this.b[c]={});for(var b in a[c])if(a[c].hasOwnProperty(b)){this.b[c][b]||(this.b[c][b]={});for(var d in a[c][b])a[c][b].hasOwnProperty(d)&&(this.b[c][b][d]=a[c][b][d].slice())}}};function Za(a){a.ff={};a.i=null}Ya.prototype.get=function(a,c,b){return this.b[a]&&this.b[a][c]&&this.b[a][c][b]?this.b[a][c][b]:null};
function $a(a,c){var b="";c.forEach(function(d){function e(l,k){l=d.split(l);if(1<l.length){d=l[0];for(var r=1;r<l.length;r++)d+=(1==r%2?"<":"</")+k+">"+l[r];0==l.length%2&&(d+="</"+k+">")}}d=d.replace(/&\s/g,"&amp; ");var f="p";/^###/.test(d)?(d=d.slice(2),f="h4"):/^##/.test(d)?(d=d.slice(2),f="h3"):/^#/.test(d)&&(d=d.slice(1),f="h2");e(/\*\*|__/,"strong");for(e(/\*|_/,"em");;){var g=/!\[([^\]]*)\]\(([^)]*)\)/.exec(d);if(!g)break;var h=this.ff[g[2]]||(this.i?this.i(g[2]):g[2]);d=d.slice(0,g.index)+
'<img src="'+h+'" alt="'+g[1]+'">'+d.slice(g.index+g[0].length)}d=d.replace(/\[([^\]]*)\]\(([^)]*)\)/g,'<a href="$2">$1</a>');b="p"===f&&/^<img /.test(d)&&!/^.+<img/.test(d)?b+('<p class="md parimg">'+d+"</"+f+">\n"):b+("<"+f+' class="md">'+d+"</"+f+">\n")},a);return b}
Ya.prototype.bd=function(a,c,b,d){d=d&&d[a]?"<div style='padding: 2em; max-width: 60em; margin-left: auto; margin-right: auto;'>\n"+d[a]+"</div>\n":"<html>\n<style>\nbody {font-family: sans-serif;}\nimg {float: left; margin-right: 10px; margin-bottom: 20px;}\nh1, h2, hr {clear: left;}\np {margin-left: 120px}\np.parimg {margin-left: 0}\n</style>\n<body>\n<div style='padding: 2em; max-width: 60em; margin-left: auto; margin-right: auto;'>\nBUTTONS<hr>\nBLOCKS</div>\n</body>\n</html>\n";var e="";c.forEach(function(g){(g=
this.get(a,"buttons",g))&&(e+=$a(this,g))},this);var f="";b.forEach(function(g){(g=this.get(a,"blocks",g))&&(f+=$a(this,g))},this);return d.replace("BUTTONS",e).replace("BLOCKS",f)};function bb(a){this.filename=null;this.Qe=this.readOnly=!1;this.mode="b";this.ta=!1;this.Zb=cb;this.kh=!1;this.volume=null;this.j=[];this.Af=1;this.Vb=!1;this.Bg=!0;this.Bc=this.rc=!1;this.H=this.u=this.w=this.qa=null;this.xd=new db;this.code={};this.Bb="aseba";this.message=null;this.ec=eb;this.b=fb;this.kc=gb;this.i=hb;this.W=a||new Ua;this.l=null}var Ka={},ib=!0,eb=[],fb=!1,hb=!0,gb=[];function jb(){eb=kb("b").map(function(a){return a.name});gb=kb("a").map(function(a){return a.name})}
function lb(a){var c=mb.map(function(b){return b.name});switch(a){case "b":eb=c;break;case "a":gb=c}}N=bb.prototype;N.Xe=function(){this.W.b=[]};function nb(a,c){c?(c=a.xd,c.Ic=[],c.Hd=[]):a.yb();a.mode="b";a.ec=eb;a.b=fb;a.kc=gb;a.i=hb;a.filename=null;a.j=[];a.code={};a.Bg=!0;ob(a)}N.Tb=function(){for(var a=0;a<this.j.length;a++)if(!this.j[a].Tb())return!1;return!0};N.getError=function(){for(var a=0;a<this.j.length;a++)if(null!==this.j[a].error)return this.j[a].error;return null};
function pb(a){if("b"===a.mode?a.b:a.i)return!1;for(var c=0;c<a.j.length;c++)if(1<a.j[c].X.length||0<a.j[c].X.length&&"s"===a.j[c].X[0].T.type)return!1;return!0}N.yb=function(){this.xd.yb(qb(this,{filename:!0}),{Vb:this.Vb,rc:this.rc,Bc:this.Bc});this.code={};this.Bc=this.rc=this.Vb=!1};function rb(a){a.w&&a.w()}
N.ig=function(a){if(0<this.xd.Ic.length){var c=this.xd.ig(qb(this,{filename:!0}),{Vb:this.Vb,rc:this.rc,Bc:this.Bc});sb(this,c.state,a);this.Vb=c.marks.Vb;this.rc=c.marks.rc;this.Bc=c.marks.Bc;this.code={}}};N.Fg=function(a){if(0<this.xd.Hd.length){var c=this.xd.Fg(qb(this,{filename:!0}),{Vb:this.Vb,rc:this.rc,Bc:this.Bc});sb(this,c.state,a);this.Vb=c.marks.Vb;this.rc=c.marks.rc;this.Bc=c.marks.Bc;this.code={}}};
function tb(a,c){c!==a.mode&&(a.yb(),a.mode=c,a.j.forEach(function(b){b.X.forEach(function(d,e){b.X[e]=d});b.actions.forEach(function(d,e){b.actions[e]=d})}))}var cb="s";function ob(a){if(0!==a.j.length&&a.j[a.j.length-1].Tb())for(;1<a.j.length&&a.j[a.j.length-2].Tb();)a.j.splice(-2,1);else a.j.push(new Oa),ob(a)}
function qb(a,c){var b={};c&&!1===c.qd||(b.basicBlocks=a.ec,b.basicMultiEvent=a.b,ib&&(b.advanced="a"===a.mode,b.advancedBlocks=a.kc,b.advancedMultiEvent=a.i),b.disabledUI=a.W.b);c&&c.filename&&(b.filename=a.filename);if(c&&!1===c.td)return b;c=a.u?a.u():null;var d=null;null==c&&(d=a.j.map(function(e){function f(h){h&&g.push({name:h.T.name,disabled:h.disabled,locked:h.locked,param:h.T.Sf?h.T.Sf(h):h.h?h.h.slice():null})}var g=[];if(e instanceof Ta)return{comment:e.je,disabled:e.disabled,locked:e.locked};
e.X.forEach(function(h){f(h)});e.actions.forEach(function(h){f(h)});return{blocks:g,disabled:e.disabled,locked:e.locked}}));b.program=d;b.code=c;return b}function ub(a,c){return JSON.stringify(qb(a,c),null,"\t")}
function sb(a,c,b,d){var e=!1,f="vpl";try{if(c){!c.disabledUI||d&&d.Ai||Va(a.W,c.disabledUI);if(!d||!d.yi){var g=1==c.advanced;ib?(a.mode=g?"a":"b",a.ec=c.basicBlocks||eb,a.b=void 0!==c.basicMultiEvent?c.basicMultiEvent:fb,a.kc=c.advancedBlocks||gb,a.i=void 0!==c.advancedMultiEvent?c.advancedMultiEvent:hb):(a.mode="b",a.ec=g?c.advancedBlocks||gb:c.basicBlocks||eb,a.b=g?void 0!==c.advancedMultiEvent?c.advancedMultiEvent:hb:void 0!==c.basicMultiEvent?c.basicMultiEvent:fb)}if(!d||!d.gh)if(c.program?
a.j=c.program.map(function(l){if(l.hasOwnProperty("comment")){var k=new Ta(l.je);k.disabled=l.disabled||!1;k.locked=l.locked||!1;return k}var r=new Oa;l.blocks.forEach(function(u){var y=Na(u.name);if(y){var E=new Ha(y,null,null);E.disabled=u.disabled||!1;E.locked=u.locked||!1;y.Se?y.Se(E,u.param,function(){e&&b&&b("vpl")}):E.h=u.param;r.Yb(E,null,function(){a.yb()},function(){rb(a)},!0)}},this);r.disabled=l.disabled||!1;r.locked=l.locked||!1;return r},a):a.j=[],a.H){var h=c.code;a.H(void 0==c.code?
null:h);null!=h&&(f="src")}d&&d.zi||!c.hasOwnProperty("filename")||(a.filename=c.filename)}}catch(l){}ob(a);a.ta="src"===f;b&&b(f);e=!0}function vb(a,c,b,d){try{var e=JSON.parse(c);sb(a,e,b,d);var f=a.xd;f.Ic=[];f.Hd=[]}catch(g){}}bb.prototype.Cc=function(a){"string"!==typeof this.code[a]&&(this.code[a]=Ka[a].bd(this));return this.code[a]};function wb(a,c){var b=Ka[a];a=xb(b,c,!0);c=xb(b,c,!1);return 0<=a&&0<=c?{ie:a,end:c}:null}function yb(a,c){a.l=c}bb.prototype.log=function(a){this.l&&this.l(a)};function zb(a,c,b){this.language=a;this.i=c;this.l=b;this.marks=[]}function Ab(a,c,b){this.id=a;this.Sc=c;this.i=b;if(0>a||6399<a)throw"internal";this.v=String.fromCharCode(57344+a);this.b=-1}
function Bb(a,c){a.forEach(function(d){d.b=c.indexOf(d.v)});a.sort(function(d,e){return d.b-e.b});for(var b=0;b<a.length;b++)a[b].b-=b,c=c.replace(a[b].v,"");a.forEach(function(d){var e;if(d.i){for(;;){for(e=d.b;" "===c[e]||"\t"===c[e];e++);if("\n"===c[e])d.b=e+1;else break}if(" "===c[d.b-1]||"\t"===c[d.b-1]){for(e=d.b-1;" "===c[e]||"\t"===c[e];e--);"\n"===c[e]&&(d.b=e+1)}}else if(" "===c[d.b-1]||"\t"===c[d.b-1]){for(e=d.b-1;" "===c[e]||"\t"===c[e];e--);"\n"===c[e]&&(d.b=e+1)}});return c}
function Cb(a){return a.replace(/[\ue000-\uf8ff]/g,"")}function Db(a,c,b){var d=a.marks.length,e=new Ab(d,b,!0);a.marks.push(e);b=new Ab(d+1,b,!1);a.marks.push(b);return e.v+c+b.v}function xb(a,c,b){for(var d=0;d<a.marks.length;d++)if(a.marks[d].Sc===c&&a.marks[d].i===b)return a.marks[d].b;return-1}
function Eb(a,c,b){if(c.disabled||c.Tb())return{};c.error=null;for(var d=!1,e=!1,f=0;f<c.X.length;f++)if(!c.X[f].disabled){if("e"===c.X[f].T.type){if(d=!0,c.X[f].T.validate){var g=c.X[f].T.validate(c.X[f]);if(g&&(Fb(g,[f]),!g.Wb||!c.error)&&(c.error=g,!g.Wb))return{error:g}}}else"s"===c.X[f].T.type&&(e=!0);if(("e"===c.X[f].T.type||"s"===c.X[f].T.type)&&null===c.error)for(var h=f+1;h<c.X.length;h++)c.X[h].disabled||c.X[h].T!==c.X[f].T||(g=new Ra("Same block used multiple times",!0),Fb(g,[f,h]),c.error=
g)}g=!1;for(f=0;f<c.actions.length;f++)if(!c.actions[f].disabled&&"a"===c.actions[f].T.type){g=!0;break}if(!d&&!g)return c.error?{error:c.error}:{};if(!d&&!e)return g=new Ra("Missing event block"),Fb(g,[]),c.error=g,{error:g};if(!g)return g=new Ra("Missing action block"),g.b.push(0),c.error=g,{error:g};if(!c.error)for(f=0;f<c.actions.length;f++)if(!c.actions[f].disabled)for(h=f+1;h<c.actions.length;h++)c.actions[h].disabled||"a"!==c.actions[h].T.type||c.actions[h].T!==c.actions[f].T||(g=new Ra("Same block used multiple times",
!0),g.b.push(f),g.b.push(h),c.error=g);var l=[],k=[],r=[],u="",y=[],E="",x=[],n=!1,w="";c.X.forEach(function(m,p){var q=m.l(this.language,b);if(0===p&&q.da)q.cb&&(u=Db(this,q.cb,m),q.la&&(E+=q.la)),q.Lf&&(n=!0);else if(q.fh||q.cb)y.push(Db(this,q.fh||q.cb,m)),q.la&&(x=x.concat(q.la));q.ub&&(l=l.concat(q.ub));q.Cb&&(k=k.concat(q.Cb));q.tb&&(r=r.concat(q.tb));q.ya&&(w+=Db(this,q.ya,m))},a);for(f=0;f<c.actions.length;f++)d=c.actions[f].l(a.language,b),w+=d.ya?Db(a,d.ya,c.actions[f]):"",d.ub&&d.ub.forEach(function(m){0>
l.indexOf(m)&&l.push(m)}),d.Cb&&d.Cb.forEach(function(m){0>k.indexOf(m)&&k.push(m)}),d.tb&&d.tb.forEach(function(m){0>r.indexOf(m)&&r.push(m)});return 0<w.length?(f="e"===c.X[0].T.type?c.X[0].l(a.language,b):null,d=c.X.slice(1).filter(function(m){return"e"===m.T.type}).map(function(m){return m.l(this.language,b)},a),{Di:c.X[0]?c.X[0].T.name:"",ub:l,Cb:k,tb:r,da:f?f.da:"",zb:f?f.zb:"",eb:f?f.eb:"",Ud:d.map(function(m){return m.da||""}),Df:d.map(function(m){return m.zb||""}),Ef:d.map(function(m){return m.eb||
""}),la:E,Td:x,cb:u,Lf:n,cc:y.join(" "+a.i+" "),ya:(f&&f.ya||"")+w}):{}}function Gb(a){var c=Na("!init");return c&&c.Mb[a.language]?c.Mb[a.language](null):{}}function Hb(a,c){if(null!==c.volume){var b=Na("!volume");if(null!==b){var d=new Ha(b,null,null);d.h=[c.volume];if(a=b&&b.Mb[a.language])return"\n"+a(d).ya}}return""}zb.prototype.bd=function(){throw"internal";};zb.prototype.b=function(){throw"internal";};function Ib(){zb.call(this,"aseba","and","1 == 1")}Ib.prototype=Object.create(zb.prototype);Ib.prototype.constructor=Ib;
Ib.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(p){return Eb(this,p,a)},this),d={},e=[];b.forEach(function(p){p.da&&(d[p.da]={da:p.da,zb:p.zb,eb:p.eb,la:"",Va:""},0>e.indexOf(p.da)&&e.push(p.da));p.Ud&&p.Ud.forEach(function(q,A){d[q]={da:q,zb:p.Df[A],eb:p.Ef[A],la:"",Va:""};0>e.indexOf(q)&&e.push(q)})});var f=[],g=[],h=[],l=[],k=Gb(this);k&&(k.ub&&k.ub.forEach(function(p){0>f.indexOf(p)&&f.push(p)}),k.Cb&&k.Cb.forEach(function(p){0>g.indexOf(p)&&g.push(p)}),k.tb&&k.tb.forEach(function(p){0>
h.indexOf(p)&&h.push(p)}));b.forEach(function(p,q){p.ub&&p.ub.forEach(function(t){0>f.indexOf(t)&&f.push(t)});p.Cb&&p.Cb.forEach(function(t){0>g.indexOf(t)&&g.push(t)});p.tb&&p.tb.forEach(function(t){0>h.indexOf(t)&&h.push(t)});if(p.da&&(p.hb=l.indexOf(Cb(p.cb||p.da)),0>p.hb)){p.hb=l.length;l.push(Cb(p.cb||p.da));var A=d[p.da];p.la&&0>A.la.indexOf(p.la)&&(A.la+=p.la);A.Va+=p.cb?(p.Lf?"if "+p.cb+" then\n":"when "+p.cb+" do\n")+"eventCache["+p.hb+"] = 1\nend\n":"eventCache["+p.hb+"] = 1\n"}p.da||(p.ya=
Db(this,p.ya||"",a.j[q]))},this);var r="";if(c){var u=new Oa;k=new Ha(Na("init"),null,null);u.Yb(k,null,null,null);c.forEach(function(p){u.Yb(p,null,null,null)});k=Eb(this,u,a);var y=!0;k.ub.forEach(function(p){0>f.indexOf(p)&&(y=!1)});k.tb.forEach(function(p){0>h.indexOf(p)&&(y=!1)});y?r=k.ya:k.ki&&(r=k.ki)}var E=[],x="",n="",w=0;for(k=0;k<a.j.length;k++)0<=b[k].hb?(b[k].Td&&b[k].Td.forEach(function(p){0>E.indexOf(p)&&E.push(p)}),x+="if eventCache["+b[k].hb+"] != 0"+(b[k].cc?" and "+b[k].cc:"")+
" then\ntodo["+w+"] = 1\nend\n",n+="if todo["+w+"] != 0 then\n"+b[k].ya+"end\n",w++):b[k].cc&&(x+="when "+b[k].cc+" do\ntodo["+w+"] = 1\nend\n",n+="if todo["+w+"] != 0 then\n"+b[k].ya+"end\n",w++);b=0<f.length?"\n"+f.join("\n"):"";0<l.length&&(b+="var eventCache[] = ["+l.map(function(){return"0"}).join(", ")+"]\n");if(0<w){b+="var todo[] = [";for(k=0;k<w;k++)b+=0<k?", 0":"0";b+="]\n"}c?b+="\n"+r:(0<g.length&&(b+="\n"+g.join("\n")),x&&(b+=(0<b.length?"\n":"")+"timer.period[1] = 50\n"));for(k=0;k<e.length;k++)!/onevent/.test(d[e[k]].da)&&
(d[e[k]].eb||d[e[k]].la||d[e[k]].Va)&&(b+="\n"+(d[e[k]].da||"")+(d[e[k]].eb||"")+(d[e[k]].la||"")+(d[e[k]].Va||"")+(d[e[k]].zb||""));b+=Hb(this,a);0<h.length&&(b+="\n"+h.join("\n"));for(k=0;k<e.length;k++)/onevent/.test(d[e[k]].da)&&(d[e[k]].eb||d[e[k]].la||d[e[k]].Va)&&(b+="\n"+(d[e[k]].da||"")+(d[e[k]].eb||"")+(d[e[k]].la||"")+(d[e[k]].Va||"")+(d[e[k]].zb||""));if(x){b+="\nonevent timer1\n"+E.join("")+x+n;for(k=0;k<l.length;k++)b+="eventCache["+k+"] = 0\n";for(k=0;k<w;k++)b+="todo["+k+"] = 0\n"}"\n"===
b[0]&&(b=b.slice(1));var m=0;c=b.split("\n").map(function(p){return p.trim()}).map(function(p){function q(B){for(var L=Cb(p),T=0;T<B.length;T++)if(L.slice(0,B[T].length)===B[T]&&!/^\w/.test(L.slice(B[T].length)))return!0;return!1}if(0<p.length){var A=q(["else","elseif","end","onevent","sub"]),t=q("if else elseif for onevent sub when while".split(" "));A&&(m=Math.max(m-1,0));p="\t\t\t\t\t".slice(0,m)+p;t&&m++}return p});for(k=c.length-2;0<=k;k--)/^\s*#/.test(c[k])&&(b=c[k+1].replace(/^(\s*).*$/,"$1"),
c[k]=b+c[k].replace(/^\s*/,""));b=c.join("\n");for(k=0;k<a.j.length;k++)for(c=k+1;c<a.j.length;c++)a.j[k].qf(a.j[c]);return b=Bb(this.marks,b)};Ib.prototype.b=function(a){var c="# missing Aseba implementation for block "+a.T.name+"\n";switch(a.T.type){case "e":case "s":return{la:c,cb:"1 == 1"};case "a":return{ya:c};default:return{}}};Ka.aseba=new Ib;function Jb(){zb.call(this,"l2","&&","true")}Jb.prototype=Object.create(zb.prototype);Jb.prototype.constructor=Jb;
Jb.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(m){return Eb(this,m,a)},this),d={},e=[];b.forEach(function(m){m.da&&(d[m.da]={da:m.da,zb:m.zb,eb:m.eb,la:"",Va:""},0>e.indexOf(m.da)&&e.push(m.da));m.Ud&&m.Ud.forEach(function(p,q){d[p]={da:p,zb:m.Df[q],eb:m.Ef[q],la:"",Va:""};0>e.indexOf(p)&&e.push(p)})});var f=[],g=[],h=[],l=[],k=Gb(this);k&&(k.ub&&k.ub.forEach(function(m){0>f.indexOf(m)&&f.push(m)}),k.Cb&&k.Cb.forEach(function(m){0>g.indexOf(m)&&g.push(m)}),k.tb&&k.tb.forEach(function(m){0>
h.indexOf(m)&&h.push(m)}));b.forEach(function(m,p){m.ub&&m.ub.forEach(function(A){0>f.indexOf(A)&&f.push(A)});m.Cb&&m.Cb.forEach(function(A){0>g.indexOf(A)&&g.push(A)});m.tb&&m.tb.forEach(function(A){0>h.indexOf(A)&&h.push(A)});if(m.da&&(m.hb=l.indexOf(Cb(m.cb||m.da)),0>m.hb)){m.hb=l.length;l.push(Cb(m.cb||m.da));var q=d[m.da];m.la&&0>q.la.indexOf(m.la)&&(q.la+=m.la);q.Va+=m.cb?(m.Lf?"if":"when")+" ("+m.cb+") {\neventCache["+m.hb+"] = true;\n}\n":"eventCache["+m.hb+"] = true;\n"}m.da||(m.ya=Db(this,
m.ya||"",a.j[p]))},this);var r="";if(c){var u=new Oa;k=new Ha(Na("init"),null,null);u.Yb(k,null,null,null);c.forEach(function(m){u.Yb(m,null,null,null)});r=Eb(this,u,a).ya}var y=[],E="",x="",n=0;for(k=0;k<a.j.length;k++)0<=b[k].hb?(b[k].Td&&b[k].Td.forEach(function(m){0>y.indexOf(m)&&y.push(m)}),E+="if (eventCache["+b[k].hb+"]"+(b[k].cc?" && "+b[k].cc:"")+") {\ntodo["+n+"] = true;\n}\n",x+="if (todo["+n+"]) {\n"+b[k].ya+"}\n",n++):b[k].cc&&(E+="when ("+b[k].cc+") {\ntodo["+n+"] = true;\n}\n",x+="if (todo["+
n+"]) {\n"+b[k].ya+"}\n",n++);b=0<f.length?"\n"+f.join("\n"):"";0<l.length&&(b+="bool eventCache["+l.length+"] = false;\n");c?b+="\n"+r:(k="",0<g.length&&(k+="\n"+g.join("\n")),k&&(b+=(0<b.length?"\n":"")+k.slice(1)),E&&(b+=(0<b.length?"\n":"")+"timer.period[1] = 50;\n"));for(k=0;k<e.length;k++)!/onevent/.test(d[e[k]].da)&&(d[e[k]].eb||d[e[k]].la||d[e[k]].Va)&&(b+="\n"+(d[e[k]].da||"")+(d[e[k]].eb||"")+(d[e[k]].la||"")+(d[e[k]].Va||"")+(d[e[k]].zb||""));b+=Hb(this,a);0<h.length&&(b+="\n"+h.join("\n"));
for(k=0;k<e.length;k++)/onevent/.test(d[e[k]].da)&&(d[e[k]].eb||d[e[k]].la||d[e[k]].Va)&&(b+="\n"+(d[e[k]].da||"")+(d[e[k]].eb||"")+(d[e[k]].la||"")+(d[e[k]].Va||"")+(d[e[k]].zb||""));E&&(b+="\nonevent timer1 {\n",0<n&&(b+="bool todo["+n+"] = false;\n"),b+=y.join("")+E+x+"eventCache = false;\n}\n");"\n"===b[0]&&(b=b.slice(1));var w=0;c=b.split("\n").map(function(m){return m.trim()}).map(function(m){var p=Cb(m);if(0<p.length){var q="{"===p.slice(-1);"}"===p[0]&&(w=Math.max(w-1,0));m="\t\t\t\t\t".slice(0,
w)+m;q&&w++}return m});for(k=c.length-2;0<=k;k--)/^\s*#/.test(c[k])&&(b=c[k+1].replace(/^(\s*).*$/,"$1"),c[k]=b+c[k].replace(/^\s*/,""));b=c.join("\n");for(k=0;k<a.j.length;k++)for(c=k+1;c<a.j.length;c++)a.j[k].qf(a.j[c]);return b=Bb(this.marks,b)};Jb.prototype.b=function(a){var c="// missing L2 implementation for block "+a.T.name+"\n";switch(a.T.type){case "e":case "s":return{la:c,cb:"true"};case "a":return{ya:c};default:return{}}};Ka.l2=new Jb;function Kb(){zb.call(this,"js","&&","true")}Kb.prototype=Object.create(zb.prototype);Kb.prototype.constructor=Kb;
Kb.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(q){return Eb(this,q,a)},this),d={},e=[];b.forEach(function(q){q.da&&(d[q.da]={da:q.da,zb:q.zb,eb:q.eb,la:"",Va:""},0>e.indexOf(q.da)&&e.push(q.da));q.Ud&&q.Ud.forEach(function(A,t){d[A]={da:A,zb:q.Df[t],eb:q.Ef[t],la:"",Va:""};0>e.indexOf(A)&&e.push(A)})});var f=[],g=[],h=[],l=[],k=Gb(this);k&&(k.ub&&k.ub.forEach(function(q){0>f.indexOf(q)&&f.push(q)}),k.Cb&&k.Cb.forEach(function(q){0>g.indexOf(q)&&g.push(q)}),k.tb&&k.tb.forEach(function(q){0>
h.indexOf(q)&&h.push(q)}));var r=[],u=0;b.forEach(function(q,A){q.ub&&q.ub.forEach(function(L){0>f.indexOf(L)&&f.push(L)});q.Cb&&q.Cb.forEach(function(L){0>g.indexOf(L)&&g.push(L)});q.tb&&q.tb.forEach(function(L){0>h.indexOf(L)&&h.push(L)});var t=q.ya||"";q.cb&&(t="cond = "+q.cb+";\nif (cond && !cond0["+u+"]) {\n"+t+"}\ncond0["+u+"] = cond;\n",u++);if(q.da&&(q.hb=l.indexOf(Cb(q.cb||q.da)),0>q.hb)){q.hb=l.length;l.push(Cb(q.cb||q.da));var B=d[q.da];q.la&&0>B.la.indexOf(q.la)&&(B.la+=q.la);q.cb?(B.Va+=
"cond = "+q.cb+";\nif (cond && !cond0["+u+"]) {\neventCache["+q.hb+"] = true;\n}\ncond0["+u+"] = cond;\n",u++):B.Va+="eventCache["+q.hb+"] = true;\n"}q.da||(q.ya=Db(this,t,a.j[A]));Pa(a.j[A])&&r.push(A)},this);var y="";if(c){var E=new Oa;k=new Ha(Na("init"),null,null);E.Yb(k,null,null,null);c.forEach(function(q){E.Yb(q,null,null,null)});y=Eb(this,E,a).ya}var x=[],n="",w="",m=0;for(k=0;k<a.j.length;k++)0<=b[k].hb?(b[k].Td&&b[k].Td.forEach(function(q){0>x.indexOf(q)&&x.push(q)}),n+="if (eventCache["+
b[k].hb+"]"+(b[k].cc?" && "+b[k].cc:"")+") {\ntodo["+m+"] = true;\n}\n",w+="if (todo["+m+"]) {\n"+b[k].ya+"}\n",m++):b[k].cc&&(n+="cond = "+b[k].cc+";\nif (cond && !cond0["+u+"]) {\ntodo["+m+"] = true;\n}\ncond0["+u+"] = cond;\n",u++,w+="if (todo["+m+"]) {\n"+b[k].ya+"}\n",m++);0<u&&(f.unshift("var cond0;\nvar cond;\n"),g.unshift("cond0 = [];\n"));b=0<f.length?"\n"+f.join("\n"):"";0<l.length&&(b+="var eventCache = [];\n");0<m&&(b+="var todo = [];\n");c?b+="\n"+y:(k="",0<g.length&&(k+="\n"+g.join("\n")),
n&&(k+="this.setTimer(1, 0.1, true);\n"),k&&(b+=(0<b.length?"\n":"")+'this.addEventListener("init", function (name, param) {\n'+k.slice(1)+"});\n"));if(0<h.length)throw"internal error, unsupported sub/onevent in js";for(k=0;k<e.length;k++)if(d[e[k]].eb||d[e[k]].la||d[e[k]].Va)b+="\n"+(d[e[k]].da||"")+(d[e[k]].eb||"")+(d[e[k]].la||"")+(d[e[k]].Va||"")+(d[e[k]].zb||"");if(n){b+='\nthis.addEventListener("timer1", function (name, param) {\n'+x.join("")+n+w;for(k=0;k<l.length;k++)b+="eventCache["+k+"] = false;\n";
for(k=0;k<m;k++)b+="todo["+k+"] = false;\n"}0<b.trim().length&&(b+="});");"\n"===b[0]&&(b=b.slice(1));var p=0;c=b.split("\n").map(function(q){return q.trim()}).map(function(q){var A=Cb(q);if(0<A.length){var t="{"===A.slice(-1);"}"===A[0]&&(p=Math.max(p-1,0));q="\t\t\t\t\t".slice(0,p)+q;t&&p++}return q});for(k=c.length-2;0<=k;k--)/^\s*#/.test(c[k])&&(b=c[k+1].replace(/^(\s*).*$/,"$1"),c[k]=b+c[k].replace(/^\s*/,""));b=c.join("\n");for(k=0;k<a.j.length;k++)for(c=k+1;c<a.j.length;c++)a.j[k].qf(a.j[c]);
return b=Bb(this.marks,b)};Kb.prototype.b=function(a){var c="// missing JavaScript implementation for block "+a.T.name+"\n";switch(a.T.type){case "e":case "s":return{la:c,cb:"true"};case "a":return{ya:c};default:return{}}};Ka.js=new Kb;function Lb(){zb.call(this,"python","and","True")}Lb.prototype=Object.create(zb.prototype);Lb.prototype.constructor=Lb;
Lb.prototype.bd=function(a,c){this.marks=[];var b=a.j.map(function(q){return Eb(this,q,a)},this),d={},e=[];b.forEach(function(q){q.da&&(d[q.da]={da:q.da,zb:q.zb,eb:q.eb,la:"",Va:""},0>e.indexOf(q.da)&&e.push(q.da));q.Ud&&q.Ud.forEach(function(A,t){d[A]={da:A,zb:q.Df[t],eb:q.Ef[t],la:"",Va:""};0>e.indexOf(A)&&e.push(A)})});var f=[],g=[],h=[],l=[],k=0,r=Gb(this);r&&(r.ub&&r.ub.forEach(function(q){0>f.indexOf(q)&&f.push(q)}),r.Cb&&r.Cb.forEach(function(q){0>g.indexOf(q)&&g.push(q)}),r.tb&&r.tb.forEach(function(q){0>
h.indexOf(q)&&h.push(q)}));b.forEach(function(q,A){q.ub&&q.ub.forEach(function(B){0>f.indexOf(B)&&f.push(B)});q.Cb&&q.Cb.forEach(function(B){0>g.indexOf(B)&&g.push(B)});q.tb&&q.tb.forEach(function(B){0>h.indexOf(B)&&h.push(B)});if(q.da&&(q.hb=l.indexOf(Cb(q.cb||q.da)),0>q.hb)){q.hb=l.length;l.push(Cb(q.cb||q.da));var t=d[q.da];q.la&&0>t.la.indexOf(q.la)&&(t.la+=q.la);q.cb?(t.Va+="cond = "+q.cb+"\nif cond and not cond0["+k+"]:\neventCache["+q.hb+"] = True\n<\ncond0["+k+"] = cond\n",k++):t.Va+="eventCache["+
q.hb+"] = True\n"}q.da||(q.ya=Db(this,q.ya||"",a.j[A]))},this);if(c){var u=new Oa,y=new Ha(Na("init"),null,null);u.Yb(y,null,null,null);c.forEach(function(q){u.Yb(q,null,null,null)});y=Eb(this,u,a);y.ub.forEach(function(){});y.tb.forEach(function(){})}0<k&&g.unshift("cond0 = "+k+" * [False]\n");var E=[],x="",n="",w=0;for(r=0;r<a.j.length;r++)0<=b[r].hb?(b[r].Td&&b[r].Td.forEach(function(q){0>E.indexOf(q)&&E.push(q)}),x+="if eventCache["+b[r].hb+"]"+(b[r].cc?" and "+b[r].cc:"")+":\ntodo["+w+"] = True\n<\n",
n+="if todo["+w+"]:\n"+b[r].ya+"<\n",w++):b[r].cc&&(x+="cond = "+b[r].cc+"\nif cond and not cond0["+r+"]:\ntodo["+w+"] = 1\n<\ncond0["+r+"] = cond\n",n+="if todo["+w+"]:\n"+b[r].ya+"<\n",w++);b=0<f.length?f.join("\n"):"";0<l.length&&(b+="eventCache = "+l.length+" * [False]\n");0<w&&(b+="todo = "+w+" * [False]\n");c?b+="\n"+y:(0<g.length&&(b+="\n"+g.join("\n")),x&&(b+=(0<b.length?"\n":"")+"timer_period[1] = 50\n"));for(r=0;r<e.length;r++)!/onevent/.test(d[e[r]].da)&&(d[e[r]].eb||d[e[r]].la||d[e[r]].Va)&&
(b+="\n"+(d[e[r]].da||"")+(d[e[r]].eb||"")+(d[e[r]].la||"")+(d[e[r]].Va||"")+(d[e[r]].zb||""));b+=Hb(this,a);0<h.length&&(b+="\n"+h.join("\n"));for(r=0;r<e.length;r++)/onevent/.test(d[e[r]].da)&&(d[e[r]].eb||d[e[r]].la||d[e[r]].Va)&&(b+="\n"+(d[e[r]].da||"")+(d[e[r]].eb||"")+(d[e[r]].la||"")+(d[e[r]].Va||"")+(d[e[r]].zb||""));if(x){b+="\n@onevent\ndef timer1():\n"+E.join("")+x+n;for(r=0;r<l.length;r++)b+="eventCache["+r+"] = False\n";for(r=0;r<w;r++)b+="todo["+r+"] = False\n";b+="<\n"}"\n"===b[0]&&
(b=b.slice(1));b=Cb(b);b=b.replace(/\n[ \t]+/g,"\n").replace(/\n<\n\n<\n/g,"\n<\n<\n");var m=0,p="";b.split("\n").map(function(q){return q.trim()}).forEach(function(q){var A=Cb(q);if(0<A.length){var t=":"===A.slice(-1);"<"===A&&(m=Math.max(m-1,0));"<"!==A&&(q="\t\t\t\t\t".slice(0,m)+q,t&&m++)}"<"!==A&&(p+=q+"\n")});b=p;for(r=0;r<a.j.length;r++)for(c=r+1;c<a.j.length;c++)a.j[r].qf(a.j[c]);return b=Bb(this.marks,b)};
Lb.prototype.b=function(a){var c="# missing Python implementation for block "+a.T.name+"\npass\n";switch(a.T.type){case "e":case "s":return{la:c,cb:"True"};case "a":return{ya:c};default:return{}}};Ka.python=new Lb;function Mb(){Ib.call(this)}Mb.prototype=Object.create(zb.prototype);Mb.prototype.constructor=Mb;Mb.prototype.bd=function(a,c){a=Ib.prototype.bd.call(this,a,c);c=new Nb(Ob);a=new Pb(c,a);a.S=Qb;a=a.compile();return Rb(a,!0)};Ka.asm=new Mb;function Sb(a){this.I=[];this.b=a||null}N=Sb.prototype;N.add=function(a,c){this.I.push(new Tb(a,c))};N.find=function(a){for(var c=0;c<this.I.length;c++)if(this.I[c].name===a)return this.I[c];return null};function Ub(a,c){a=a.find(c);return null!=a&&null!=a.b}function Vb(a,c){if(a.b){var b=a.find(c);c={cmd:c};b.w&&(c.selected=b.Oa());b.u&&(c.state=b.getState());a.b({type:"cmd",data:c})}}N.Cd=function(a,c){var b=this.find(a);b&&(b.Cd(c),Vb(this,a))};
N.pb=function(a,c){this.b&&this.b({type:"drop",data:{cmd:a}});(a=this.find(a))&&a.pb(c)};N.gb=function(a,c){a=this.find(a);return null!=a&&a.gb(c)};N.$=function(a){if(window.vplConfig&&window.vplConfig.ignoredCommands&&0<=window.vplConfig.ignoredCommands.indexOf(a))return!1;a=this.find(a);return null!=a&&a.$()};N.isEnabled=function(a){a=this.find(a);return null!=a&&a.isEnabled()};N.Oa=function(a){a=this.find(a);return null!=a&&a.Oa()};
N.getState=function(a){a=this.find(a);return null!=a?a.getState():null};function Tb(a,c){this.name=a;this.H=c.isEnabled||null;this.w=c.Oa||null;this.u=c.getState||null;this.b=c.action||null;this.i=c.pb||null;this.l=c.gb||null;this.ed=c.object||null;this.pd=c.pd||!1;this.S=c.$||null;this.lb=c.lb||null;this.yc=c.yc||null}N=Tb.prototype;N.Cd=function(a){this.isEnabled()&&this.b&&this.b(this.ed,a)};
function Wb(a,c){if(!a.u)return!1;var b=a.getState();if(c===b)return!0;for(var d=0;100>d;d++){a.Cd(void 0);var e=a.getState();if(e===c)return!0;if(e===b)break}return!1}N.pb=function(a){this.gb(a)&&this.i&&this.i(this.ed,a)};N.gb=function(a){return null!=this.l&&this.l(this.ed,a)};N.isEnabled=function(){return null==this.H||this.H(this.ed)};N.Oa=function(){return null!=this.w&&this.w(this.ed)};N.getState=function(){return null!=this.u?this.u(this.ed):null};N.$=function(){return null==this.S||this.S(this.ed)};function Xb(a){Yb||(jb(),Yb=!0);this.rb=a;this.ia=new Zb;this.i=new Wa;this.W=new Ua;var c=this;this.I=new Sb(function(b){c.log(b)});this.lc=null;this.Kc="vpl:close !space vpl:about vpl:help vpl:statement !space vpl:new vpl:save vpl:load vpl:upload vpl:nextProgram vpl:filename vpl:exportToHTML !space vpl:advanced !stretch vpl:readonly !stretch vpl:add-comment !stretch vpl:undo vpl:redo !stretch vpl:connected !stretch vpl:run vpl:stop !space vpl:slowdown vpl:debug vpl:robot !space vpl:flash !stretch vpl:sim vpl:text !stretch vpl:teacher-reset vpl:teacher-save vpl:teacher-setasnew vpl:teacher".split(" ");
this.zc="!!stretch vpl:message-error vpl:message-warning !!stretch vpl:duplicate vpl:disable vpl:lock vpl:trashcan".split(" ");this.Za="src:close !space src:new src:save !space src:language src:disass !stretch src:run src:stop !stretch src:sim src:vpl !space src:locked !stretch src:teacher-reset src:teacher".split(" ");this.Ha="sim:close !stretch sim:restart sim:pause !space sim:speedup sim:noise !stretch sim:pen sim:clear !space sim:map-kind sim:map sim:map-ground sim:map-obstacles sim:map-height !stretch sim:vpl sim:text !stretch sim:teacher-reset sim:teacher".split(" ");
this.Ka=["vpl"];this.zd={vpl:1,src:1,sim:1};this.wd=["ground","height","obstacles"];this.De=this.hg=this.Yf=this.Ue=this.Ie=this.ve=null;this.Vc=!1;this.aa={};this.username=null;this.j=new bb(this.W);yb(this.j,function(b){c.log(b)});this.Wc=!1;this.Eg=!0;this.Pb="";this.yd=!1;this.pa=null;this.ba=new $b(a,{ia:this.ia,dg:function(b){(c.pa=b)&&ac(c)}});this.ba.state={ni:new bc};this.S="";this.M=this.b=null;this.Ga=[];this.ma=-1;this.Sg=this.we=!1;this.u=null;this.ba.Za=function(){null!==c.u&&(c.u=null,
ac(c))};this.ba.Ha=function(){ac(c)};this.H=null;this.uc=[];this.Bf=this.Jb=null;this.l=new cc;dc(this.l);this.Da=null;this.R=new ec(this);fc(this.ba,function(b,d){c.W.i||(b=c.R,b.i===gc&&b.Ra===gc)||(b.i=gc,b.Ra=gc,ac(b.l));if(null!==c.Da){b=c.Da;var e=d.x;d=d.y;if(b.u&&e>=b.u.left&&e<b.u.right&&d>=b.u.top&&d<b.u.bottom){d=e-b.u.left;for(e=0;e<b.l.length&&d>b.l[e];e++);b=0===e?0===b.l.length||d<b.l[0]/2?0:1:e>=b.l.length?b.l.length:d<(b.l[e-1]+b.l[e])/2?e:e+1}else b=null;null==b?(c.Da.finish(!0),
c.Da=null):c.Da.b=c.Da.i=b}return!0})}var Yb=!1;function hc(a){ic(a.l,function(c){if(!a.W.l||0<=a.Ka.indexOf("src")||c.altKey||c.ctrlKey||c.metaKey)return!1;if(0<=a.Ka.indexOf("vpl")){a:{var b=a.I;for(var d=c.key,e=a.Kc.concat(a.zc),f=0;f<b.I.length;f++)if((!e||0<=e.indexOf(b.I[f].name))&&b.I[f].yc&&b.I[f].yc===d&&b.I[f].$()){b=b.I[f];break a}b=null}if(b)return b.Cd(c.altKey),!0}return!1});a.W.u&&jc(a.R)}
function kc(a,c){if(null!==a.Da){if(void 0!=c.Sc&&c.Sc===a.Da.Sc)return;a.Da.finish(!0)}a.Da=window.vplTextFieldInputEvents?new lc(a,c):new mc(a,c)}Xb.prototype.translate=function(a,c){return this.i.translate(a,c)};function nc(a,c){nb(a.j,c);c=a.R;c.i=gc;c.Ra=gc;a.W.i&&(a.R.Ra=oc,a.R.Ab=0)}function pc(a,c){a.Ie=c?new rc(c,a.W.l?{sd:function(){sc(a.l,function(){a.Ie.wc()})},rd:function(){tc(a.l)}}:null):null}
function uc(a,c,b){var d=new vc;d.width=/ipad/i.test(navigator.userAgent)?d.height=0:d.height=64;var e=wc(16,16),f=xc(function(g){(a.j.fe||yc)(a,"vpl:save",g,e,a.ia,["vpl","top","detached"],d,a.i,!0,!1,!1,null)},d.width,d.height,d,e,1);f='<img src="'+f.url+'" width='+f.width+" height="+f.height+">";f=c?new rc(c,{th:[{title:"\u21d3",di:'',Fa:function(){zc(c,"doc.html","text/html")}}],scroll:!0,sd:a.W.l?function(){sc(a.l,function(){a.Yf.wc()})}:null,rd:a.W.l?function(){tc(a.l)}:null}):null;b?a.hg=f:
a.Yf=f}
function Ac(a){if(a.w){var c=a.Kc.concat(a.zc).filter(function(r){return"!"!==r[0]&&this.I.$(r)},a),b="b"===a.j.mode?a.j.ec:a.j.kc;b.sort(function(r,u){r=mb.indexOf(Na(r));u=mb.indexOf(Na(u));return r<u?-1:r>u?1:0});Za(a.w);var d=wc(100,100),e=Bc(a,a.ia),f=Cc(a,a.Kc,["vpl","top"]),g=Cc(a,a.zc,["vpl","bottom"]);a.lc={disabled:!1,$:!0,nh:!1,isEnabled:!0,Oa:!1,state:null};var h=Dc(a,a.Kc,["vpl","top"],e.Hc,e.Og,f),l=Dc(a,a.zc,["vpl","bottom"],e.Nd,e.Ng,g),k=50/f["vpl:new"]?.width;a.Kc.forEach(function(r){var u=Ec(h,
r,f[r],d,k);u&&(r="vpl:cmd:"+r.replace(/:/g,"-"),this.w.ff[r]=u.url)},a);a.zc.forEach(function(r){var u=Ec(l,r,g[r],d,k);u&&(r="vpl:cmd:"+r.replace(/:/g,"-"),this.w.ff[r]=u.url)},a);a.lc=null;mb.forEach(function(r){try{var u=new Ha(r,null,null);u.h=r.fb?r.fb():u.h;var y="vpl:block:"+r.name.replace(/ /g,"-"),E=u.toDataURL(this.ia,d,1);this.w.ff[y]=E}catch(x){}},a);c=a.w.bd(a.i.language,c,b,a.aa);uc(a,c)}}
Xb.prototype.qb=function(a,c){function b(){0<=a.indexOf("vpl")&&Fc(d.ba);0<=a.indexOf("src")&&Fc(d.O.Ua);0<=a.indexOf("sim")&&Fc(d.b)}var d=this;c&&(c.ta||c.Qg)&&(this.j.ta=!0,this.O.ta=!0,Gc(this.O,!1));if(1===a.length&&c&&c.te&&1<this.Ka.length){if(0<=this.Ka.indexOf(a[0]))return;var e=this.Ka.slice();e[this.Ka[0]===c.te?1:0]=a[0];a=e}else c&&c.ye?0>this.Ka.indexOf(a[0])&&(a=this.Ka.concat(a)):1===a.length&&c&&c.Nf&&1<this.Ka.length&&0<=this.Ka.indexOf(a[0])?(this.Ka.splice(this.Ka.indexOf(a[0]),
1),a=this.Ka):1===a.length&&c&&c.toggle&&(0<=this.Ka.indexOf(a[0])?(this.Ka.splice(this.Ka.indexOf(a[0]),1),a=this.Ka):a=this.Ka.concat(a));this.Ka=a;null!=this.M&&this.b.wc();this.ba.wc();null!=this.O&&(document.getElementById("src-editor").style.display=0<=a.indexOf("src")?"block":"none",this.O.Ua.wc());0<=a.indexOf("vpl")&&this.ba.show();0<=a.indexOf("src")&&this.O.Ua.show();null!=this.M&&0<=a.indexOf("sim")&&this.b.show();Hc(this,window.innerWidth<window.innerHeight);for(e=0;e<a.length;e++)switch(a[e]){case "vpl":this.ba.qa=
function(){if(!d.j.ta){d.j.code={};ob(d.j);if(d.O){var f=d.O,g=d.j.Cc(d.j.Bb);if(f.Ld){var h=f.Pe(f.language,g);null!==h&&(Ic(f,h,!0),f.Gc.Ob.readOnly=!0,f.Ld=g)}else Ic(f,g)}d.log()}ac(d)};break;case "src":Gc(this.O,!(c&&(c.ta||c.Qg)));this.O.focus();this.O.resize(window.innerWidth,window.innerHeight);break;case "sim":this.b.qa=function(){Jc(d)}}c&&(c.Nf||c.ye)&&Kc(d);this.ba&&(this.ba.Db=b);this.O&&this.O.Ua&&(this.O.Ua.Db=b);this.b&&(this.b.Db=b);0<=a.indexOf("vpl")&&(this.ba.qa(),this.ba.Db?this.ba.Db():
Fc(this.ba));0<=a.indexOf("src")&&(Lc(this),this.O.Ua.Db?this.O.Ua.Db():Fc(this.O.Ua));0<=a.indexOf("sim")&&(this.start(!1),this.b.qa(),this.b.Db?this.b.Db():Fc(this.b))};Xb.prototype.setView=Xb.prototype.qb;
function Hc(a,c){for(var b=a.Ka.map(function(h){return this.zd[h]},a),d=b.reduce(function(h,l){return h+l},0),e=0,f=0;f<a.Ka.length;f++){var g=c?{Y:0,na:1,ca:e,oa:e+b[f]/d}:{Y:e,na:e+b[f]/d,ca:0,oa:1};e+=b[f]/d;switch(a.Ka[f]){case "vpl":Mc(a.ba,g);break;case "src":Mc(a.O.Ua,g);break;case "sim":Mc(a.b,g)}}}
function Kc(a){var c=a.ba.b.parentElement.getBoundingClientRect(),b=c.width;c=window.innerHeight-c.top;Hc(a,b<c);window.vplDisableResize&&(c=a.ba.b.getBoundingClientRect(),b=c.width,c=c.height);a.ba.resize(b,c);a.O&&a.O.resize(b,c);a.M&&a.b.resize(b,c);a.Ka.forEach(function(d){switch(d){case "vpl":ac(this);break;case "src":Fc(this.O.Ua);break;case "sim":this.M&&Jc(this)}},a);a.Ie&&Nc(a.Ie)}
function Pc(a,c){if(0<=a.ma){var b=null;c&&(b=Na("!stop and blink"));b||(b=Na("!stop"));c=a.j.Bb;(b=b&&b.Mb[c])&&a.Ga[a.ma].Qa.oc(b(null).ya,c)}}function Qc(a){return!a.j.ta&&a.Ga[a.ma].Qa.isEnabled(a.j.Bb)}function Rc(a,c){a.uc.push(c)}
Xb.prototype.log=function(a){if(null==a){Sc(this);a={type:"vpl-changed",data:{filename:this.j.filename,nrules:this.j.j.reduce(function(b,d){return 0<d.X.length+d.actions.length?b+1:b},0),nblocks:this.j.j.reduce(function(b,d){return b+d.X.length+d.actions.length},0),uploadedToServer:this.j.rc,error:this.Pb&&!this.yd?this.Pb:null,warning:this.Pb&&this.yd?this.Pb:null,"error-tr":this.Pb&&!this.yd?this.i.translate(this.Pb):null,"warning-tr":this.Pb&&this.yd?this.i.translate(this.Pb):null,robot:0<=this.ma?
this.Ga[this.ma].Qa.isConnected()&&this.Ga[this.ma].Qa.ue():null}};var c=JSON.stringify(a);if(c===this.Jb)return;this.Jb=c}this.uc.forEach(function(b){try{b(a)}catch(d){}})};function Tc(a){function c(e){function f(t){for(var B=0;B<m.length;B++)if(m[B].uri){var L=Uc(m[B].uri);if(a.Ib[L.ad].yg(t,L.id))return!0}return!1}var g=e.name;if("!"===g[0])return 0;var h=0;/^\w/.test(g)||(b+='Bad block name "'+g+'"\n',h++);var l=e.defaultParameters,k=e.typicalParameters,r=e.buttons,u=e.radiobuttons,y=e.sliders,E=e.rotating,x=e.diffwheelmotion,n=e.score,w=e.otherParameters?parseInt(e.otherParameters,10):0,m=e.draw;if(m){e=null;for(var p=0;p<m.length;p++)if(m[p].uri)if(null==e){e=Uc(m[p].uri).ad;
var q=a.Ib[e]}else{var A=Uc(m[p].uri);A.ad!==e?(b+='In block "'+g+'", multiple svg\n',h++):q.Pc(A.id)||(b+='In block "'+g+'", uri "'+m[p].uri+'" not found\n',h++)}}r&&r.forEach(function(t){q.Pc(t.id)?f(t.id)||(b+='In block "'+g+'", button id "'+t.id+'" not displayed\n',h++):(b+='In block "'+g+'", button id "'+t.id+'" not found\n',h++);void 0==t.val?(b+='In block "'+g+'", missing property "val"\n',h++):void 0==t.st?(b+='In block "'+g+'", missing property "st"\n',h++):t.val.length!==t.st.length&&(b+=
'In block "'+g+'", properties "val" and "st" have different lengths\n',h++)});u&&u.forEach(function(t){q.Pc(t.id)?f(t.id)?void 0==t.val?(b+='In block "'+g+'", missing property "val"\n',h++):t.val instanceof Array?(b+='In block "'+g+'", illegal array in property "val"\n',h++):void 0==t.st?(b+='In block "'+g+'", missing property "st"\n',h++):2!==t.st.length&&(b+='In block "'+g+'", property "st" must have length 2\n',h++):(b+='In block "'+g+'", radiobutton id "'+t.id+'" not displayed\n',h++):(b+='In block "'+
g+'", radiobutton id "'+t.id+'" not found\n',h++)});y&&y.forEach(function(t){q.Pc(t.id)?f(t.id)||(b+='In block "'+g+'", slider id "'+t.id+'" not displayed\n',h++):(b+='In block "'+g+'", slider id "'+t.id+'" not found\n',h++);q.Pc(t.thumbId)?f(t.thumbId)||(b+='In block "'+g+'", slider thumbId "'+t.thumbId+'" not displayed\n',h++):(b+='In block "'+g+'", slider thumbId "'+t.thumbId+'" not found\n',h++);void 0==t.min&&(b+='In block "'+g+'", slider min undefined\n',h++);void 0==t.max&&(b+='In block "'+
g+'", slider max undefined\n',h++);t.lowerPartId&&!q.Pc(t.lowerPartId)&&(b+='In block "'+g+'", slider lowerPartId "'+t.lowerPartId+'" not found\n',h++);if(t.snap&&(t=t.snap,t instanceof Array))for(var B=0;B<t.length;B++)"string"===typeof t[B]?/^`.+`$/.test(t[B])||(b+='In block "'+g+'", invalid slider snap expression\n',h++):"number"!==typeof t[B]&&(b+='In block "'+g+'", slider snap must be a number or a string\n',h++)});E&&E.forEach(function(t){var B=t.id,L=t.centerId;t=t.thumbId;q.Pc(B)?f(B)||(b+=
'In block "'+g+'", rotating id "'+B+'" not displayed\n',h++):(b+='In block "'+g+'", rotating id "'+B+'" not found\n',h++);q.Pc(L)||(b+='In block "'+g+'", rotating centerId "'+L+'" not found\n',h++);q.Pc(t)?f(t)||(b+='In block "'+g+'", rotating thumbId "'+t+'" not displayed\n',h++):(b+='In block "'+g+'", rotating thumbId "'+t+'" not found\n',h++);q.yg(t,B)||(b+='In block "'+g+'", rotating thumbId "'+t+'" not a descendent of id "'+B+'"\n',h++)});x&&(q.Pc(x.id)?f(x.id)||(b+='In block "'+g+'", diffwheelmotion id "'+
x.id+'" not displayed\n',h++):(b+='In block "'+g+'", diffwheelmotion id "'+x.id+'" not found\n',h++));n&&(q.Pc(n.id)?f(n.id)||(b+='In block "'+g+'", score id "'+n.id+'" not displayed\n',h++):(b+='In block "'+g+'", score id "'+n.id+'" not found\n',h++),"number"!==typeof n.numHeights||n.numHeights!==Math.round(n.numHeights)||0>=n.numHeights)&&(b+='In block "'+g+'", score numHeights must be a strictly positive integer\n',h++);(r||u||y||E||n||0<w)&&!l&&(b+='In block "'+g+'", missing defaultParameters\n',
h++);l&&(x=0,r&&(x+=r.length),u&&(x+=1),y&&(x+=y.length),E&&(x+=E.length),n&&(x+=2*Math.floor((l.length-x)/2)),x+=w,x!==l.length?(b+='In block "'+g+'", defaultParameters.length='+l.length+", needs "+x+" parameters\n",h++):k&&k.length!=x&&(b+='In block "'+g+'", typicalParameters.length='+k.length+", needs "+x+" parameters\n",h++));return h}var b="",d=0;a.blocks&&a.blocks.forEach(function(e){d+=c(e)});0<d&&(b+=d+" error"+(1<d?"s":"")+"\n");return b||null};function Vc(a){function c(b){b=b.j.filename||"program.vpl3";return".vpl3"===b.slice(-5)?b.slice(0,-5):b}a.I.add("vpl:close",{action:function(b){b.qb(["vpl"],{Nf:!0})},object:a,$:function(b){return 1<b.Ka.length&&0<=b.Ka.indexOf("vpl")},yc:"w"});a.I.add("vpl:about",{action:function(b){b.Ie.show()},object:a,$:function(b){return null!=b.Ie},yc:"i"});a.I.add("vpl:help",{action:function(b){b.Yf.show()},object:a,$:function(b){return null!=b.Yf},yc:"?"});a.I.add("vpl:statement",{action:function(b){b.hg.show()},
object:a,$:function(b){return null!=b.hg}});a.I.add("vpl:readonly",{isEnabled:function(){return!1},object:a,$:function(b){return b.j.readOnly||b.j.ta}});a.I.add("vpl:suspend",{action:function(b){b.Vc=!b.Vc;b.Vc?(Qc(b)&&(Pc(b,!0),b.j.Vb=!1),b.De.show()):b.De.wc()},Oa:function(b){return b.Vc},object:a,$:function(b){return b.j.Zb===cb&&null!=b.De}});a.I.add("vpl:new",{action:function(b){nc(b);b.ve&&Wc(b,b.ve);rb(b.j);ac(b)},isEnabled:function(b){return!b.j.ta&&!b.j.readOnly&&(null!=b.j.filename||!b.j.Tb())},
object:a,$:function(b){return!b.j.readOnly},yc:"n"});a.I.add("vpl:save",{action:function(b,d){d?(d=Xc(b,b.ia),zc(d,c(b)+".html","text/html")):(d=ub(b.j,{qd:!0,td:!0}),zc(d,b.j.filename||"program.vpl3","application/x-vpl3"))},isEnabled:function(b){return true},object:a,$:function(b){return!b.j.readOnly},yc:"s"});a.I.add("vpl:load",{action:function(b){b.Ue.show("Open program file",".aesl,.json,.vpl3,.vpl3ui,.zip",function(d){Yc(b,d);rb(b.j)})},isEnabled:function(b){return!b.j.ta&&!b.j.readOnly},
object:a,$:function(b){return!b.j.readOnly},yc:"o"});a.I.add("vpl:upload",{action:function(b){var d=ub(b.j,{qd:!1,td:!0});window.vplUpload(b.j.filename,d);b.j.rc=!0;b.Eg=!1},isEnabled:function(b){return!b.j.ta&&!b.j.readOnly&&!b.j.Tb()},Oa:function(b){return b.j.rc},getState:function(b){return b.j.Tb()?"empty":b.j.rc?"uploaded":b.Eg?"canUpload":"canUploadAgain"},object:a,$:function(b){return null!=window.vplUpload&&!b.j.readOnly}});a.I.add("vpl:nextProgram",{action:function(b){var d=ub(b.j,{qd:!1,
td:!0});d=window.vplNextProgram(b.j.filename,d);Wc(b,d);d=JSON.parse(d);b.j.filename=d.filename||"program.vpl3"},isEnabled:function(b){return null!=window.vplNextProgram(b.j.filename,null)},object:a,$:function(){return null!=window.vplNextProgram}});a.I.add("vpl:exportToHTML",{action:function(b,d){d?(d=Zc(b,b.ia),zc(d,"vpl-ui.html","text/html")):(d=Xc(b,b.ia),b=c(b)+".html",zc(d,b,"text/html"))},isEnabled:function(b){return!b.j.ta&&!b.j.Tb()},object:a,yc:"h"});a.I.add("vpl:text",{action:function(b){b.we?
b.qb(["src"],{ye:!0}):b.qb(["src"],{te:"vpl"})},isEnabled:function(b){return!b.j.ta},pb:function(b,d){if(d.data instanceof Ha&&d.data.Gb){if(d=wb(b.j.Bb,d.data))b.qb(["src"]),b.O.eg(d.ie,d.end)}else d.data instanceof Oa&&(d=wb(b.j.Bb,d.data))&&(b.qb(["src"]),b.O.eg(d.ie,d.end))},gb:function(b,d){return d.data instanceof Ha&&null!=d.data.Gb||d.data instanceof Oa},object:a,$:function(b){return b.O&&0>b.Ka.indexOf("src")}});a.I.add("vpl:text-toggle",{action:function(b){b.qb(["src"],{toggle:!0})},isEnabled:function(b){return!b.j.ta},
Oa:function(b){return 0<=b.Ka.indexOf("src")},object:a,lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:advanced",{action:function(b){tb(b.j,"b"===b.j.mode?"a":"b");Ac(b)},isEnabled:function(b){return!b.j.ta&&!b.j.readOnly},Oa:function(b){return"a"===b.j.mode},object:a,$:function(b){return ib&&!b.j.readOnly},lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:undo",{action:function(b){b.j.ig(function(){ac(b);rb(b.j)})},isEnabled:function(b){return!b.j.ta&&0<b.j.xd.Ic.length},object:a,$:function(b){return!b.j.readOnly},
yc:"z"});a.I.add("vpl:redo",{action:function(b){b.j.Fg(function(){ac(b);rb(b.j)})},isEnabled:function(b){return!b.j.ta&&0<b.j.xd.Hd.length},object:a,$:function(b){return!b.j.readOnly},yc:"y"});a.I.add("vpl:add-comment",{action:function(b){b.j.yb();var d=b.R.Ra===oc?b.R.Ab:null,e=b.j,f=new Ta("");null!=d&&d<e.j.length?e.j.splice(d,0,f):0!==e.j.length&&e.j[e.j.length-1].Tb()?(d=e.j.length-1,e.j.splice(d,0,f)):(d=e.j.length,e.j.push(f));ob(e);rb(b.j);$c(b,d);ac(b)},isEnabled:function(b){return!b.j.ta},
object:a,$:function(b){return!b.j.readOnly}});a.I.add("vpl:run",{action:function(b){var d=b.j.Cc(b.j.Bb);b.Ga[b.ma].Qa.oc(d,b.j.Bb);b.j.Vb=!0;b.j.Bg=!1},isEnabled:function(b){if(b.j.ta||!b.Ga[b.ma].Qa.isEnabled(b.j.Bb))return!1;b=b.j.getError();return null==b||b.Wb},Oa:function(b){return b.j.Vb},getState:function(b){if(b.j.Tb())return"empty";if(b.j.Vb)return"running";var d=b.j.getError();return d&&!d.Wb?"error":b.j.Bg?"canLoad":"canReload"},pb:function(b,d){d.data instanceof Ha?d.data.Gb?(d=Ka[b.j.Bb].bd(b.j,
[d.data]),b.Ga[b.ma].Qa.oc(d,b.j.Bb)):b.ba.Qb=ad(b.ba,d):d.data instanceof Oa&&(d=Ka[b.j.Bb].bd(b.j,d.data.actions),b.Ga[b.ma].Qa.oc(d,b.j.Bb))},gb:function(b,d){if(b=0<=b.ma&&b.Ga[b.ma].Qa.isEnabled(b.j.Bb)&&d.data instanceof Oa)a:{b=d.data;for(var e=0;e<b.X.length;e++)if("a"===b.X[e].T.type){b=!0;break a}for(e=0;e<b.actions.length;e++)if("a"===b.actions[e].T.type){b=!0;break a}b=!1}return b||d.data instanceof Ha&&null!=d.data.Gb&&"a"===d.data.T.type},object:a,$:function(b){return 0<=b.ma},lb:[{selected:!1},
{selected:!0},{state:"empty"},{state:"running"},{state:"error"},{state:"canLoad"},{state:"canReload"}],yc:"r"});a.I.add("vpl:stop",{action:function(b){Pc(b);b.j.Vb=!1},isEnabled:function(b){return Qc(b)},object:a,$:function(b){return 0<=b.ma},yc:"."});a.I.add("vpl:stop-abnormally",{action:function(b){Pc(b,!0);b.j.Vb=!1},isEnabled:function(b){return Qc(b)},object:a,$:function(b){return 0<=b.ma}});a.I.add("vpl:slowdown",{action:function(b){var d=[.1,.2,.5,1];b.j.Af=d[(d.indexOf(b.j.Af)+1)%d.length]},
Oa:function(b){return 1!==b.j.Af},getState:function(b){return b.j.Af},object:a,lb:[{selected:!0,state:.1},{selected:!0,state:.2},{selected:!0,state:.5},{selected:!1,state:1}],$:function(b){return 0<=b.ma}});a.I.add("vpl:debug",{action:function(){},Oa:function(){return!1},object:a,$:function(){return!1},lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:flash",{action:function(b){var d=b.j.Cc(b.j.Bb);b.Ga[b.ma].Qa.Tf(d,b.j.Bb);b.j.Bc=!0},isEnabled:function(b){if(b.j.ta||!b.Ga[b.ma].Qa.pf(b.j.Bb))return!1;
b=b.j.getError();return null==b||b.Wb},Oa:function(b){return b.j.Bc},object:a,$:function(b){return 0<=b.ma&&null!=b.Ga[b.ma].Qa.ug}});a.I.add("vpl:connected",{Oa:function(b){return!b.j.ta&&b.Ga[b.ma].Qa.isConnected()},getState:function(b){return b.Bf?"monitored":!1===b.Bf?"nonmonitored":""},object:a,$:function(b){return 0<=b.ma},lb:[{selected:!1},{selected:!0},{selected:!1,state:"monitored"},{selected:!0,state:"monitored"},{selected:!1,state:"nonmonitored"},{selected:!0,state:"nonmonitored"}]});a.I.add("vpl:robot",
{action:function(b){b.ma=(b.ma+1)%b.Ga.length},getState:function(b){return b.Ga[b.ma].name},object:a,$:function(b){return 1<b.Ga.length}});a.I.add("vpl:volume",{action:function(b){var d=[null,8,7,6,5,4,3,2,1,0];b.j.volume=d[(d.indexOf(b.j.volume)+1)%d.length]},Oa:function(b){return null!==b.j.volume},getState:function(b){return null===b.j.volume?"":b.j.volume.toString(10)},object:a,lb:[{selected:!1,state:""},{selected:!0,state:"8"},{selected:!0,state:"7"},{selected:!0,state:"6"},{selected:!0,state:"5"},
{selected:!0,state:"4"},{selected:!0,state:"3"},{selected:!0,state:"2"},{selected:!0,state:"1"},{selected:!0,state:"0"}]});a.I.add("vpl:sim",{action:function(b){b.we?b.qb(["sim"],{ye:!0}):b.qb(["sim"],{te:"vpl"})},isEnabled:function(b){return!b.j.ta},object:a,$:function(b){return 0<=b.ma&&null!=b.M&&0>b.Ka.indexOf("sim")}});a.I.add("vpl:duplicate",{isEnabled:function(b){return!b.j.ta},pb:function(b,d){var e=b.j.j.indexOf(d.data);0<=e&&(b.j.yb(),b.j.j.splice(e+1,0,d.data.sb()),rb(b.j),b.ba.qa&&b.ba.qa(),
b.log())},gb:function(b,d){return d.data instanceof Oa&&!d.data.Tb()},object:a,$:function(b){return!b.j.readOnly}});a.I.add("vpl:disable",{isEnabled:function(b){return!b.j.ta},pb:function(b,d){d.data instanceof Ha?(b.j.yb(),d.data.disabled=!d.data.disabled,rb(b.j),b.ba.qa&&b.ba.qa(),b.log()):d.data instanceof Oa&&(b.j.yb(),d=d.data,d.disabled=!d.disabled,d.disabled&&(d.error=null),b.ba.qa&&b.ba.qa(),b.log())},gb:function(b,d){return d.data instanceof Oa?!d.data.Tb():d.data instanceof Ha&&null!==d.data.Gb},
object:a,$:function(b){return!b.j.readOnly}});a.I.add("vpl:lock",{isEnabled:function(b){return!b.j.ta},pb:function(b,d){d.data instanceof Ha?(b.j.yb(),d.data.locked=!d.data.locked,rb(b.j),b.ba.qa&&b.ba.qa(),b.log()):d.data instanceof Oa&&(b.j.yb(),d.data.locked=!d.data.locked,b.ba.qa&&b.ba.qa(),b.log())},gb:function(b,d){return d.data instanceof Oa?!d.data.Tb():d.data instanceof Ha&&null!==d.data.Gb},object:a,$:function(b){return b.j.kh&&"t"===b.j.Zb&&!b.j.readOnly}});a.I.add("vpl:trashcan",{isEnabled:function(b){return!b.j.ta},
pb:function(b,d){d.data instanceof Ha?null!==d.data.Gb&&(b.j.yb(),d.data.Gb.Gg(d.data.We),rb(b.j),b.ba.qa&&b.ba.qa(),b.log()):d.data instanceof Oa&&(d=b.j.j.indexOf(d.data),0<=d&&(b.j.yb(),b.j.j.splice(d,1),rb(b.j),b.ba.qa&&b.ba.qa(),b.log()))},gb:function(b,d){return d.data instanceof Ha?null!==d.data.Gb&&!d.data.locked:d.data instanceof Oa&&(!d.data.Tb()||b.j.j.indexOf(d.data)+1<b.j.j.length)&&!d.data.locked},object:a,$:function(b){return!b.j.readOnly}});a.I.add("vpl:message-error",{isEnabled:function(){return!1},
getState:function(b){return b.Pb},object:a,$:function(b){return b.Pb&&!b.yd}});a.I.add("vpl:message-warning",{isEnabled:function(){return!1},getState:function(b){return b.Pb},object:a,$:function(b){return b.Pb&&b.yd}});a.I.add("vpl:message-empty",{isEnabled:function(){return!1},object:a,$:function(b){return!b.Pb}});a.I.add("vpl:filename",{action:function(b){b.j.Qe||kc(b,{mh:b.j.filename||"program.vpl3",Fc:".vpl3",display:function(){b.ba.qa&&b.ba.qa()},finish:function(d){null!==d&&(b.j.yb(),b.j.filename=
d);b.Da=null;b.ba.qa&&b.ba.qa()},Sc:b.j})},isEnabled:function(b){return!b.j.Qe},getState:function(b){return b.j.Qe?(b.j.filename||"program.vpl3")+(b.username?"\n"+b.username:""):b.j.filename||"program.vpl3"},object:a,$:function(b){return b.j.filename||b.username||!b.j.Qe?!0:!1}});a.I.add("vpl:teacher",{action:function(b){b.j.W.wb=!b.j.W.wb;"t"===b.j.Zb?b.j.W.ic=b.j.W.wb:b.j.W.Ee=b.j.W.wb;b.j.W.wb||(Ac(b),0>b.Kc.indexOf("vpl:teacher-setasnew")&&0>b.zc.indexOf("vpl:setasnew")&&b.I.Cd("vpl:teacher-setasnew"))},
isEnabled:function(b){return!b.j.ta&&!b.j.readOnly},Oa:function(b){return b.j.W.wb},object:a,pd:!0,$:function(b){return b.j.Zb!==cb&&!b.j.readOnly},lb:[{selected:!1},{selected:!0}]});a.I.add("vpl:teacher-reset",{action:function(b,d){d?(lb(b.j.mode),b.j.ec=eb,b.j.kc=gb):(jb(),nb(b.j),b.j.Xe())},isEnabled:function(b){return!b.j.ta},object:a,pd:!0,$:function(b){return b.j.Zb!==cb&&b.j.W.wb&&!b.j.readOnly}});a.I.add("vpl:teacher-save",{action:function(b){b=ub(b.j,{qd:!0,td:!1});zc(b,"ui.vpl3ui","application/x-vpl3-ui")},
isEnabled:function(b){return!b.j.ta},object:a,pd:!0,$:function(b){return b.j.Zb!==cb&&b.j.W.wb&&!b.j.readOnly}});a.I.add("vpl:teacher-setasnew",{action:function(b){var d=ub(b.j,{qd:!0,td:!1});b.ve=b.ve===d?null:d},Oa:function(b){return b.ve===ub(b.j,{qd:!0,td:!1})},object:a,pd:!0,$:function(b){return b.j.Zb!==cb&&b.j.W.wb&&!b.j.readOnly},lb:[{selected:!1},{selected:!0}]})};function bd(a){this.i=a;this.controls=[];this.b="";this.y=this.x=0}function cd(a,c,b,d,e){a.controls.push({J:c,Ea:d||null,id:e||"",hd:b,x:0,y:0});a.b+="X"}
function dd(a,c,b,d){a.x=c.x;a.y=c.y;for(var e=a.b.replace(/^[s ]+/,"").replace(/[s ]+$/,"").replace(/ +/g," ").replace(/s +/g,"s").replace(/ +s/g,"s").replace(/s+/g,"s"),f=0,g=0,h=0,l=0,k=0;k<e.length;k++)switch(e[k]){case "X":f+=ed(b[a.controls[l].id]);l++;break;case " ":case "_":g++;break;case "s":case "S":h++}d=d?ed(d):0;var r=0;if(f>=c.width)d=0;else for(;;){r=(c.width-(f+d*g))/h;if(r>=d||!(0<d))break;d/=2}l=0;f=c.x;for(k=0;k<e.length;k++)switch(e[k]){case "X":g=a.controls[l];g.x=f+b[g.id].offsetLeft();
f+=ed(b[g.id]);g.y=c.y+b[g.id].offsetTop();l++;break;case " ":case "_":f+=d;break;case "s":case "S":f+=r}}
function fd(a,c,b,d){gd(a.i,function(e){hd(c,e,a.x,a.y)});a.controls.forEach(function(e){id(this.i,e.x,e.y,b[e.id],function(f,g,h){var l=Math.min(g.width/(e.hd.na-e.hd.Y),g.height/(e.hd.oa-e.hd.ca));f.save();f.translate(-e.hd.Y,-e.hd.ca);1!==l&&(f.scale(l,l),g=g.sb(),g.width/=l,g.height/=l);e.J(f,g,h)&&jd(a.i,0,0,g.width,g.height,["button"],["button"]);f.restore()},{action:e.Ea.action||null,pb:e.Ea.pb||null,gb:e.Ea.gb||null,Ac:d?function(){d(e.id)}:null},e.id)},a)};function yc(a,c,b,d,e,f,g,h,l,k,r,u){function y(m,p,q){b.save();q&&(b.scale(-1,1),b.translate(-2*m-d.g,0));b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(m,p,d.g,d.g);b.fillStyle=l?n.U:n.ea;b.beginPath();b.moveTo(m+.1*d.g,p+.6*d.g);b.lineTo(m+.4*d.g,p+.6*d.g);b.lineTo(m+.25*d.g,p+.34*d.g);b.closePath();b.fill();b.beginPath();b.arc(m+.5*d.g,p+.83*d.g,.4*d.g,4.2,5.6);b.strokeStyle=b.fillStyle;b.lineWidth=.08*d.g;b.stroke();b.restore()}function E(m,p,q){var A=d.g;b.save();b.fillStyle=r?n.Ba:n.xa;b.fillRect(m,
p,A,A);b.translate(m+A/2,p+A/2);b.rotate(-q*Math.PI/2);b.translate(-m-A/2,-p-A/2);b.beginPath();b.moveTo(m+.3557*A,p+.25*A);b.lineTo(m+.3557*A,p+.75*A);b.lineTo(m+.7887*A,p+.5*A);b.closePath();b.strokeStyle=n.U;b.lineWidth=2*d.Ca;b.stroke();b.restore()}function x(){b.beginPath();b.moveTo(0,.5*d.g);b.lineTo(.5*d.g,.5*d.g);b.lineTo(.5*d.g,-.25*d.g);b.bezierCurveTo(.3*d.g,-.5*d.g,.02*d.g,-.5*d.g,0,-.5*d.g);b.lineTo(0,-.5*d.g);b.bezierCurveTo(-.02*d.g,-.5*d.g,-.3*d.g,-.5*d.g,-.5*d.g,-.25*d.g);b.lineTo(-.5*
d.g,.5*d.g);b.closePath();b.fillStyle=l?n.U:n.ea;b.fill()}var n={xa:"navy",Ba:"#37f",Bd:"#06f",U:"white",ea:"#777",Oc:"#44a",rg:"#ddf",re:"#99a",hf:"#a00",lg:"#d10",jf:"#d00",mg:"#f50",se:"#c66",sg:"#800"};n={xa:"white",Ba:"#ddd",Bd:"white",U:"#333",ea:"#999",Oc:"#ddd",rg:"#555",re:"#666",hf:"#fcc",lg:"#fcc",jf:"#faa",mg:"#faa",se:"#866",sg:"#faa"};var w={"vpl:close":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,.5*d.g,d.g);b.beginPath();b.moveTo(.1*d.g,.1*d.g);b.lineTo(.4*d.g,.4*d.g);b.moveTo(.1*
d.g,.4*d.g);b.lineTo(.4*d.g,.1*d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke()},"vpl:about":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(.7*d.g).toString(10)+"px times";b.fillStyle=l?n.U:n.ea;b.fillText("i",.5*d.g,.5*d.g)},"vpl:help":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(.7*d.g).toString(10)+"px times";b.fillStyle=
l?n.U:n.ea;b.fillText("?",.5*d.g,.5*d.g)},"vpl:statement":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;b.fillStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.strokeRect(.25*d.g,.2*d.g,.5*d.g,.6*d.g);b.beginPath();b.arc(.33*d.g,.4*d.g,.03*d.g,0,2*Math.PI);b.arc(.33*d.g,.6*d.g,.03*d.g,0,2*Math.PI);b.fill();for(var m=0;5>m;m++)b.beginPath(),b.moveTo(.4*d.g,d.g*(.32+.1*m)),b.lineTo(.7*d.g,d.g*(.32+.1*m)),b.stroke(),b.lineWidth=.01*d.g,b.setLineDash([.02*d.g,.02*d.g])},"vpl:readonly":function(){var m=
d.g;b.save();b.fillStyle=n.re;b.strokeStyle=n.re;b.lineWidth=d.Ca;b.translate(.5*m,.7*m);b.save();b.rotate(.6);b.beginPath();b.moveTo(-.015/.22*m,.07*m);b.lineTo(0,.22*m);b.lineTo(.015/.22*m,.07*m);b.fill();b.beginPath();b.moveTo(-.1*m,-.4*m);b.lineTo(-.1*m,0);b.lineTo(0,.22*m);b.lineTo(.1*m,0);b.lineTo(.1*m,-.4*m);b.restore();b.moveTo(-.2*m,-.4*m);b.lineTo(.4*m,.2*m);b.stroke();b.restore()},"vpl:new":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*
d.g);b.lineTo(.25*d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke()},"vpl:save":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*
d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.5*d.g);b.lineTo(.8*d.g,.8*d.g);b.moveTo(.7*d.g,.7*d.g);b.lineTo(.8*d.g,.8*d.g);b.lineTo(.9*d.g,.7*d.g);b.stroke()},"vpl:exportToHTML":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.2*d.g);b.lineTo(.8*d.g,.5*d.g);b.moveTo(.7*d.g,.4*d.g);b.lineTo(.8*d.g,.5*d.g);b.lineTo(.9*
d.g,.4*d.g);b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(.3*d.g).toString(10)+"px sans-serif";b.fillStyle=l?n.U:n.ea;b.fillText("HTML",.5*d.g,.7*d.g);b.stroke()},"vpl:load":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.strokeStyle=
l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.55*d.g);b.lineTo(.8*d.g,.85*d.g);b.moveTo(.7*d.g,.65*d.g);b.lineTo(.8*d.g,.55*d.g);b.lineTo(.9*d.g,.65*d.g);b.stroke()},"vpl:upload":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.25*d.g);b.lineTo(.25*d.g,.75*d.g);b.lineTo(.67*d.g,.75*d.g);b.lineTo(.67*d.g,.32*d.g);b.lineTo(.6*d.g,.25*d.g);b.closePath();b.moveTo(.6*d.g,.25*d.g);b.lineTo(.6*d.g,.32*d.g);b.lineTo(.67*
d.g,.32*d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();var m=.15;if("uploaded"===u||"canUploadAgain"===u)b.beginPath(),b.moveTo(.7*d.g,.1*d.g),b.lineTo(.7*d.g,.35*d.g),b.lineTo(.9*d.g,.35*d.g),b.lineTo(.9*d.g,.16*d.g),b.lineTo(.84*d.g,.1*d.g),b.closePath(),b.fillStyle=n.re,b.fill(),m=.4;b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,d.g*(m/1.5+.35));b.lineTo(.8*d.g,d.g*m);b.moveTo(.7*d.g,d.g*(m+.1));b.lineTo(.8*d.g,d.g*m);b.lineTo(.9*d.g,d.g*(m+.1));b.stroke();b.fillStyle=l?k||r?n.U:
n.Oc:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:nextProgram":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;b.fillStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.strokeRect(.25*d.g,.2*d.g,.5*d.g,.6*d.g);b.beginPath();b.arc(.33*d.g,.4*d.g,.03*d.g,0,2*Math.PI);b.arc(.33*d.g,.6*d.g,.03*d.g,0,2*Math.PI);b.fill();for(var m=0;5>m;m++)b.beginPath(),b.moveTo(.4*d.g,d.g*(.32+.1*m)),b.lineTo(.7*d.g,d.g*(.32+.1*m)),b.stroke(),b.lineWidth=.01*d.g,b.setLineDash([.02*d.g,.02*
d.g]);b.moveTo(.8*d.g,.8*d.g);b.lineTo(.9*d.g,.7*d.g);b.lineTo(.8*d.g,.6*d.g)},"vpl:text":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);for(var m=.2;.6>m;m+=.1)b.moveTo(.3*d.g,d.g*(.2+m)),b.lineTo(.7*d.g,d.g*(.2+m));b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;
b.stroke()},"vpl:text-toggle":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.28*d.g,.2*d.g);b.lineTo(.28*d.g,.7*d.g);b.lineTo(.7*d.g,.7*d.g);b.lineTo(.7*d.g,.27*d.g);b.lineTo(.63*d.g,.2*d.g);b.closePath();b.moveTo(.63*d.g,.2*d.g);b.lineTo(.63*d.g,.27*d.g);b.lineTo(.7*d.g,.27*d.g);for(var m=.1;.5>m;m+=.1)b.moveTo(.33*d.g,d.g*(.2+m)),b.lineTo(.63*d.g,d.g*(.2+m));b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*
d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:advanced":function(){b.fillStyle=r&&l?n.Ba:k?n.Bd:n.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?n.U:n.ea;for(var m=0;4>m;m++)for(var p=0;5>p;p++)b.fillRect(.1*d.g*(1+m)+(2>m?0:.43*d.g),.1*d.g*(2+p),.07*d.g,.07*d.g);b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:undo":function(){y(0,0,!1)},"vpl:redo":function(){y(0,0,!0)},"vpl:add-comment":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.2*d.g,.6*d.g);
b.lineTo(.8*d.g,.6*d.g);b.moveTo(.7*d.g,.35*d.g);b.lineTo(.9*d.g,.35*d.g);b.moveTo(.8*d.g,.25*d.g);b.lineTo(.8*d.g,.45*d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.strokeRect(.1*d.g,.5*d.g,.8*d.g,.2*d.g)},"vpl:run":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.3*d.g,.25*d.g);b.lineTo(.3*d.g,.75*d.g);b.lineTo(.8*d.g,.5*d.g);b.closePath();b.fillStyle=l?n.U:n.ea;b.fill();b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:stop":function(){b.fillStyle=
r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?n.U:n.ea;b.fillRect(.28*d.g,.28*d.g,.44*d.g,.44*d.g)},"vpl:debug":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.save();b.translate(.5*d.g,.42*d.g);b.scale(.0085*d.g,.012*d.g);b.beginPath();b.arc(0,0,20,0,2*Math.PI);b.moveTo(-13,-10);b.bezierCurveTo(0,-5,0,-5,13,-10);b.moveTo(0,-5);b.lineTo(0,20);b.moveTo(-18,-5);b.lineTo(-30,-10);b.moveTo(-18,2);b.lineTo(-32,6);b.moveTo(-15,10);b.lineTo(-26,
18);b.moveTo(18,-5);b.lineTo(30,-10);b.moveTo(18,2);b.lineTo(32,6);b.moveTo(15,10);b.lineTo(26,18);b.restore();b.stroke();b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:flash":function(){var m=d.g;b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,m,m);b.save();b.translate(.6*m,.4*m);b.scale(.4,.4);x();b.restore();b.save();b.textAlign="center";b.textBaseline="middle";b.translate(.25*m,.4*m);b.rotate(-Math.PI/2);b.font="bold "+Math.round(m/4).toString(10)+"px sans-serif";b.fillStyle=
l?n.U:n.ea;b.fillText("flash",0,0);b.restore();b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:connected":function(){function m(p,q){var A=.08*d.g;b.save();b.fillStyle=l?n.Ba:n.xa;b.fillRect(p-A,q-A,2*A,2*A);b.beginPath();b.moveTo(p-A,q-A);b.lineTo(p+A,q+A);b.moveTo(p+A,q-A);b.lineTo(p-A,q+A);b.stroke();b.restore()}l=!1;b.translate(0,.1*d.g);b.save();b.translate(.8*d.g,.2*d.g);b.scale(.35,.35);x();b.restore();b.fillStyle=l?n.U:n.ea;b.strokeStyle=l?n.U:n.ea;b.lineWidth=
1.5*d.Ca;u&&b.strokeRect(0,.05*d.g,.3*d.g,.3*d.g);b.strokeRect(.3*d.g,.55*d.g,.4*d.g,.3*d.g);b.lineWidth=d.Ca;b.beginPath();b.moveTo(.7*d.g,.7*d.g);b.bezierCurveTo(.9*d.g,.7*d.g,.9*d.g,.7*d.g,.85*d.g,.35*d.g);u&&(b.moveTo(.3*d.g,.7*d.g),b.bezierCurveTo(.1*d.g,.7*d.g,.1*d.g,.7*d.g,.15*d.g,.35*d.g));b.stroke();k||m(.86*d.g,.55*d.g);"nonmonitored"===u&&m(.14*d.g,.55*d.g)},"vpl:robot":function(){b.fillStyle=r?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);switch(u){case "thymio":b.save();b.translate(d.g/2,.35*d.g);
b.scale(.3,.3);b.rotate(.2);x();b.restore();break;case "thymio-tdm":b.save();b.translate(d.g/2,.35*d.g);b.scale(.3,.3);b.rotate(.2);x();b.restore();b.fillStyle=n.U;b.fillRect(.4*d.g,.65*d.g,.2*d.g,.2*d.g);break;case "sim":b.save(),b.translate(d.g/2,.35*d.g),b.scale(.3,.3),b.rotate(.2),x(),b.beginPath(),b.strokeStyle=n.U,b.lineWidth=d.Ca/.3,b.strokeRect(-d.g,-.8*d.g,2*d.g,1.6*d.g),b.restore()}b.beginPath();b.moveTo(.2*d.g,.75*d.g);b.lineTo(.5*d.g,.75*d.g);b.lineTo(.5*d.g,d.g*("sim"===u?.6:.3));b.strokeStyle=
n.U;b.lineWidth=d.Ca;b.stroke()},"vpl:sim":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.save();b.translate(d.g/2,.35*d.g);b.scale(.4,.4);b.rotate(.2);x();b.beginPath();b.arc(d.g,.5*d.g,1.4*d.g,-3.2,-3.8,!0);b.strokeStyle=r&&l?n.rg:n.re;b.lineWidth=.2*d.g;b.stroke();b.beginPath();b.arc(d.g,.5*d.g,.6*d.g,-3.3,-3.8,!0);b.stroke();b.restore()},"vpl:message-empty":function(){},"vpl:message-error":function(){if(u){b.fillStyle=g.color;b.font=kd(g);b.textAlign="center";b.textBaseline="middle";
var m=h.translate(u);b.fillText(m,g.width/2,g.height/2)}},"vpl:filename":function(){if(a.j.Qe){if(u){b.beginPath();var m=3*d.g;b.rect(0,0,m,d.g);b.clip();b.fillStyle=g.color;b.font=kd(g);b.textAlign="center";b.textBaseline="middle";var p=u.trim();p=p.split("\n").slice(0,2).map(function(T){T=T.slice(0,80);if(1<T.length&&b.measureText(T).width>m){for(;1<T.length&&b.measureText(T+"\u2026").width>m;)T=T.slice(0,-1);T+="\u2026"}return T});1<p.length?(b.fillText(p[0],g.width/2,.25*g.height),b.fillText(p[1],
g.width/2,.75*g.height)):b.fillText(p[0],g.width/2,g.height/2)}}else if(b.beginPath(),m=3*d.g,p=u,b.rect(0,0,g.width,g.height),b.clip(),b.fillStyle=g.color,b.font=kd(g),b.textBaseline="middle",null!=a.Da&&a.Da.Sc===a.j){p=b.measureText(a.Da.v.slice(0,a.Da.b));var q=p.fontBoundingBoxAscent||0,A=p.fontBoundingBoxDescent||0;if(0===q||0===A)A=q=g.fontSize/2;var t={top:g.height/2-q,bottom:g.height/2+A,left:2,right:2+b.measureText(a.Da.v).width},B=a.Da.v.split("").map(function(T,la){return b.measureText(a.Da.v.slice(0,
la+1)).width});ld(a.Da,t,B);B=Math.min(0,g.width-b.measureText("0").width/4-t.right);if(a.Da.i===a.Da.b)b.strokeStyle="black",b.beginPath(),b.moveTo(B+t.left+p.width,t.top),b.lineTo(B+t.left+p.width,t.bottom),b.stroke();else{B=0;var L=b.measureText(a.Da.v.slice(a.Da.b,a.Da.i));b.save();b.fillStyle="silver";b.fillRect(t.left+p.width-1,t.top,L.width,q+A);b.restore()}b.textAlign="left";b.fillText(a.Da.v,B,g.height/2)}else b.textAlign="center",b.fillText(p,g.width/2,g.height/2)},"vpl:duplicate":function(){b.fillStyle=
r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.strokeRect(.3*d.g,.3*d.g,.4*d.g,.15*d.g);b.strokeRect(.3*d.g,.55*d.g,.4*d.g,.15*d.g)},"vpl:disable":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.strokeRect(.3*d.g,.3*d.g,.4*d.g,.4*d.g);b.beginPath();b.moveTo(.2*d.g,.6*d.g);b.lineTo(.8*d.g,.4*d.g);b.stroke()},"vpl:lock":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;
b.fillStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.strokeRect(.3*d.g,.3*d.g,.4*d.g,.4*d.g);md(b,.5*d.g,.52*d.g,.04*d.g,n.U)},"vpl:trashcan":function(){b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.32*d.g,.8*d.g);b.lineTo(.68*d.g,.8*d.g);b.lineTo(.75*d.g,.2*d.g);b.closePath();b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke()},"vpl:teacher-reset":function(){b.fillStyle=r&&l?n.jf:n.hf;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*
d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);b.strokeStyle=l?n.U:n.se;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l?n.U:n.se;nd(b,.63*d.g,.7*d.g,.2*d.g)},"vpl:teacher-save":function(){b.fillStyle=r&&l?n.jf:n.hf;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.se;b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);
b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.5*d.g);b.lineTo(.8*d.g,.8*d.g);b.moveTo(.7*d.g,.7*d.g);b.lineTo(.8*d.g,.8*d.g);b.lineTo(.9*d.g,.7*d.g);b.stroke();b.fillStyle=l?n.U:n.se;nd(b,.46*d.g,.45*d.g,.2*d.g)},"vpl:teacher-setasnew":function(){b.fillStyle=r&&l?k?n.mg:n.jf:k&&l?n.lg:n.hf;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.se;b.beginPath();
b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.7*d.g);b.lineTo(.67*d.g,.7*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineTo(.6*d.g,.2*d.g);b.closePath();b.moveTo(.6*d.g,.2*d.g);b.lineTo(.6*d.g,.27*d.g);b.lineTo(.67*d.g,.27*d.g);b.lineWidth=d.Ca;b.stroke();b.lineWidth=1.5*d.Ca;b.beginPath();b.moveTo(.8*d.g,.5*d.g);b.lineTo(.5*d.g,.5*d.g);b.moveTo(.6*d.g,.4*d.g);b.lineTo(.5*d.g,.5*d.g);b.lineTo(.6*d.g,.6*d.g);b.stroke();b.fillStyle=l?k||r?n.U:n.sg:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"vpl:teacher":function(){b.fillStyle=
r&&l?k?n.mg:n.jf:k&&l?n.lg:n.hf;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?n.U:n.se;nd(b,.5*d.g,.4*d.g,.27*d.g);b.fillStyle=l?k||r?n.U:n.sg:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g)},"src:vpl":function(){b.save();b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.25*d.g,.2*d.g);b.lineTo(.25*d.g,.8*d.g);b.lineTo(.75*d.g,.8*d.g);b.lineTo(.75*d.g,.3*d.g);b.lineTo(.65*d.g,.2*d.g);b.closePath();b.moveTo(.65*d.g,.2*d.g);b.lineTo(.65*d.g,.3*d.g);b.lineTo(.75*d.g,.3*d.g);b.strokeStyle=
l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=r&&l?n.U:n.re;for(var m=.15;.6>m;m+=.15)b.fillRect(.3*d.g,d.g*(.2+m),.4*d.g,.1*d.g);b.restore()},"src:locked":function(){b.save();b.fillStyle=l?r?n.Ba:k?n.Bd:n.xa:n.xa;b.fillRect(0,0,d.g,d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.fillStyle=l?k?n.rg:n.re:n.ea;for(var m=.15;.6>m;m+=.15)b.fillRect(.15*d.g,d.g*m,.4*d.g,.1*d.g);md(b,.77*d.g,.36*d.g,.06*d.g,l?n.U:n.ea,!k);b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g);b.restore()},
"src:language":function(){var m=d.g;b.save();b.fillStyle=l?r?n.Ba:n.xa:n.xa;b.fillRect(0,0,m,m);b.beginPath();for(var p=0;3>p;p++)b.moveTo(.2*m,m*(.2+.1*p)),b.lineTo(.5*m,m*(.2+.1*p));b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();for(p=0;3>p;p++){var q=2*(p+.25)/3*Math.PI;od(b,.75*m,.3*m,.15*m,q-.3*Math.PI,q+.3*Math.PI,{Ad:!1,Xc:3*d.Ca,style:l?n.U:n.ea})}b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(m/3).toString(10)+"px sans-serif";b.fillStyle=l?n.U:n.ea;b.fillText({aseba:"Aa",
l2:"l2",asm:"asm",js:"js",python:"Py"}[u],.5*m,.7*m);b.restore()},"src:disass":function(){var m=d.g;b.save();b.fillStyle=l&&r?n.Ba:k?n.Bd:n.xa;b.fillRect(0,0,m,m);b.beginPath();b.moveTo(.2*m,.2*m);b.lineTo(.3*m,.2*m);for(var p=0;5>p;p++)b.moveTo(.4*m,m*(.2+.1*p)),b.lineTo(.45*m,m*(.2+.1*p)),b.moveTo(.55*m,m*(.2+.1*p)),b.lineTo(.65*m,m*(.2+.1*p));b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l&&(k||r)?n.U:n.Oc;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g);b.restore()},"src:run":function(){b.fillStyle=
r&&l?n.Ba:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();b.moveTo(.3*d.g,.25*d.g);b.lineTo(.3*d.g,.75*d.g);b.lineTo(.8*d.g,.5*d.g);b.closePath();b.fillStyle=l?n.U:n.ea;b.fill()},"sim:restart":function(){b.save();b.fillStyle=r?n.Ba:n.xa;b.fillRect(0,0,g.width,g.height);var m=d.g;b.lineWidth=.05*m;od(b,.5*m,.5*m,.25*m,1.56,0,{Ad:!1,Xc:.2*m,style:n.U});b.restore()},"sim:pause":function(){b.save();b.fillStyle=r?n.Ba:k?n.Bd:n.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?n.U:n.ea;b.fillRect(.28*d.g,.28*d.g,.15*
d.g,.44*d.g);k?(b.beginPath(),b.moveTo(.54*d.g,.28*d.g),b.lineTo(.62*d.g,.28*d.g),b.lineTo(.75*d.g,.5*d.g),b.lineTo(.62*d.g,.72*d.g),b.lineTo(.54*d.g,.72*d.g),b.fill()):b.fillRect(.57*d.g,.28*d.g,.15*d.g,.44*d.g);b.restore()},"sim:speedup":function(){b.save();b.fillStyle=r&&l?n.Ba:k?n.Bd:n.xa;b.fillRect(0,0,d.g,d.g);b.fillStyle=l?n.U:n.ea;b.beginPath();for(var m=0;2>m;m++)b.moveTo(d.g*(.3+.22*m),.25*d.g/2),b.lineTo(d.g*(.3+.22*m),.75*d.g/2),b.lineTo(d.g*(.5+.22*m),.5*d.g/2),b.closePath();b.fill();
b.textAlign="center";b.textBaseline="middle";b.font="bold "+Math.round(d.g/3).toString(10)+"px sans-serif";b.fillText(1<=u?"\u00d7"+u.toString(10):"\u00f7"+Math.round(1/u).toString(10),.5*d.g,.7*d.g);b.restore()},"sim:noise":function(){b.save();b.fillStyle=r&&l?n.Ba:k?n.Bd:n.xa;b.fillRect(0,0,d.g,d.g);b.beginPath();var m=[.58,1.48,.96,.39,1.36,.09,-.75,-1.58,-.32,-1.36,-1.39,-.94,-1.1,-1.04,-.1,.93,1.22,.6,.89,.61];b.moveTo(.1*d.g,(.4+.1*m[0])*d.g);for(var p=1;p<m.length;p++)b.lineTo((.1+.8/(m.length-
1)*p)*d.g,(.4+.1*m[p])*d.g);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*d.g,.8*d.g,.8*d.g,.1*d.g);b.restore()},"sim:pen":function(){var m=d.g;b.save();b.fillStyle=r&&l?n.Ba:k?n.Bd:n.xa;b.fillRect(0,0,m,m);b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*m,.8*m,.8*m,.1*m);b.translate(.5*m,m*(.4+(k?.13:0)));b.beginPath();b.moveTo(-.015/.22*m,.07*m);b.lineTo(0,.22*m);b.lineTo(.015/.22*m,.07*m);b.fillStyle=l?n.U:n.ea;b.fill();b.beginPath();b.moveTo(-.1*
m,-.22*m);b.lineTo(-.1*m,0);b.lineTo(0,.22*m);b.lineTo(.1*m,0);b.lineTo(.1*m,-.22*m);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.stroke();b.restore()},"sim:clear":function(){var m=d.g;b.save();b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,0,m,m);b.strokeStyle=l?n.U:n.ea;b.lineWidth=d.Ca;b.strokeRect(.15*m,.25*m,.7*m,.5*m);b.translate(.5*m,.4*m);b.rotate(.4);b.fillStyle=l?n.U:n.ea;b.fillRect(0,0,.3*m,.2*m);b.restore()},"sim:map-kind":function(){var m=d.g,p=d.Ca;b.save();b.fillStyle=r&&l?n.Ba:n.xa;b.fillRect(0,
0,d.g,d.g);b.lineWidth=p;b.strokeStyle=l?n.U:n.ea;b.fillStyle=l?n.U:n.ea;for(var q=["ground","height","obstacles"].indexOf(u),A=0;3>A;A++){var t=2*(A+.25)/3*Math.PI;A===q?b.fillRect(m*(.35+.25*Math.cos(t)),m*(.39+.25*Math.sin(t)),.3*m,.22*m):b.strokeRect(m*(.35+.25*Math.cos(t)),m*(.39+.25*Math.sin(t)),.3*m,.22*m);od(b,.5*m,.5*m,.36*m,t-.42*Math.PI,t-.22*Math.PI,{Ad:!1,Xc:3*p,style:n.U})}b.restore()},"sim:map":function(){var m=d.g;b.save();b.fillStyle=r&&l?n.Ba:k?n.Bd:n.xa;b.fillRect(0,0,d.g,d.g);
b.fillStyle=l?k||r?n.U:n.Oc:n.ea;b.fillRect(.1*m,.8*m,.8*m,.1*m);b.lineWidth=d.Ca;b.strokeStyle=l?n.U:n.ea;b.strokeRect(.15*m,.15*m,.7*m,.5*m);switch(u){case "ground":b.lineWidth=.08*m;b.beginPath();b.arc(.6*m,.4*m,.15*m,-.5*Math.PI,.5*Math.PI);b.lineTo(.4*m,.55*m);b.arc(.4*m,.4*m,.15*m,.5*Math.PI,1.5*Math.PI);b.closePath();b.stroke();break;case "height":b.beginPath();for(var p=0;.75>=p;p+=.25)for(var q=0;1>=q;q+=.1){var A=m*(.2+.5*q+.15*p),t=m*(.5-.3*p-.2*(.2*Math.cos(5*q+2*p-3)-(p-.9)*(p-.9)/3));
0===q?b.moveTo(A,t):b.lineTo(A,t)}b.stroke();break;case "obstacles":b.strokeRect(.2*m,.2*m,.6*m,.4*m),b.beginPath(),b.moveTo(.4*m,.2*m),b.lineTo(.4*m,.43*m),b.moveTo(.6*m,.6*m),b.lineTo(.6*m,.37*m),b.stroke()}b.restore()},"sim:map-ground":function(){u="ground";w["sim:map"]()},"sim:map-height":function(){u="height";w["sim:map"]()},"sim:map-obstacles":function(){u="obstacles";w["sim:map"]()},"sim-event:forward":function(){E(0,0,1)},"sim-event:backward":function(){E(0,0,3)},"sim-event:left":function(){E(0,
0,2)},"sim-event:right":function(){E(0,0,0)},"sim-event:center":function(){var m=d.g;b.save();b.fillStyle=r?n.Ba:n.xa;b.fillRect(0,0,m,m);b.beginPath();b.arc(.5*m,.5*m,.25*m,0,2*Math.PI);b.strokeStyle=n.U;b.lineWidth=2*d.Ca;b.stroke();b.restore()},"sim-event:clap":function(){var m=d.g;b.save();b.fillStyle=r?n.Ba:n.xa;b.fillRect(0,0,m,m);b.beginPath();b.strokeStyle=n.U;b.lineWidth=2*d.Ca;b.translate(.5*m,.5*m);b.rotate(.1);for(var p=0;9>p;p++)b.beginPath(),b.moveTo(.12*m,0),b.lineTo(.24*m,0),b.moveTo(.28*
m,0),b.lineTo(.36*m,0),b.stroke(),b.rotate(Math.PI/4.5);b.restore()},"sim-event:tap":function(){var m=d.g;b.save();b.fillStyle=r?n.Ba:n.xa;b.fillRect(0,0,m,m);b.beginPath();b.strokeStyle=n.U;b.lineWidth=2*d.Ca;b.translate(.6*m,.6*m);for(var p=1;3>=p;p++)b.beginPath(),b.arc(0,0,.15*m*p,.9*Math.PI,1.7*Math.PI),b.stroke();b.moveTo(.3*m,0);b.lineTo(0,0);b.lineTo(0,.3*m);b.stroke();b.restore()}};w["vpl:message-warning"]=w["vpl:message-error"];w["vpl:slowdown"]=w["sim:speedup"];w["src:close"]=w["vpl:close"];
w["src:new"]=w["vpl:new"];w["src:save"]=w["vpl:save"];w["src:load"]=w["vpl:load"];w["src:stop"]=w["vpl:stop"];w["src:connected"]=w["vpl:connected"];w["src:sim"]=w["vpl:sim"];w["src:teacher"]=w["vpl:teacher"];w["src:teacher-reset"]=w["vpl:teacher-reset"];w["sim:close"]=w["vpl:close"];w["sim:vpl"]=w["src:vpl"];w["sim:text"]=w["vpl:text"];w["sim:teacher"]=w["vpl:teacher"];w["sim:teacher-reset"]=w["vpl:teacher-reset"];(c=w[c])&&c();return!1}
function pd(a,c){switch(a){case "vpl:close":case "src:close":case "sim:close":return{Y:0,na:c.g/2,ca:0,oa:c.g};case "vpl:message-error":case "vpl:message-warning":case "vpl:message-empty":return{Y:0,na:5*c.g,ca:0,oa:c.g};case "vpl:filename":return{Y:0,na:3*c.g,ca:0,oa:c.g}}return{Y:0,na:c.g,ca:0,oa:c.g}};function qd(a,c){var b=0<=a.W.b.indexOf(c);return(a.lc?a.lc.$:a.I.$(c))&&(a.W.ic||!b)}
function rd(a,c,b,d,e,f){var g=0<=c.W.b.indexOf(b);if(qd(c,b)){var h=a.i,l=c.I.find(b),k=l.pd;cd(a,function(r,u,y){if(c.lc)e(c,b,r,h.A,h.ia,d,u,c.i,c.lc.isEnabled&&(k||!c.W.Ee),c.lc.Oa,c.lc.nh,c.lc.state);else{var E=c.I.isEnabled(b)&&(k||!c.W.Ee);!E&&c.W.i&&(E=c.I.gb(b,{data:sd(c.R)}));e(c,b,r,h.A,h.ia,d,u,c.i,E,c.I.Oa(b),y,c.I.getState(b))}return c.lc?c.lc.disabled:g},f,{action:c.W.ic&&!k?function(){c.W.toggle(b);return 1}:!Ub(c.I,b)||!k&&c.W.Ee?!c.W.i||c.W.ic&&!k&&c.W.Ee?null:function(){td(c.R,
l)}:function(r){c.I.Cd(b,r.ei)},pb:c.W.ic&&!k&&c.W.Ee?null:function(r,u){c.I.pb(b,u)},gb:c.W.ic&&!k&&c.W.Ee?null:function(r,u){return c.I.gb(b,u)}},b)}}function ud(a,c,b,d,e,f){a.controls=[];a.b="";for(var g=0;g<b.length;g++)switch(b[g]){case "!space":a.b+=" ";break;case "!!space":a.b+="_";break;case "!stretch":a.b+="s";break;case "!!stretch":a.b+="S";break;default:rd(a,c,b[g],d,e,f(b[g],a.i.A,c.I.find(b[g]).ed))}}
function vd(a,c){for(var b=0;b<c.length;b++)if("!"!==c[b][0]&&a.I.$(c[b]))return!0;return!1}function Cc(a,c,b,d,e){for(var f={},g=0;g<c.length;g++)if("!"!==c[g][0]){var h=a.pa&&a.I.gb(c[g],a.pa)?["possible-drop-target"]:[];h=wd(a.ia,{tag:"button",id:c[g].replace(/:/g,"-"),ga:d?b.concat(d(c[g])):b,mb:e?h.concat(e(c[g])):h});f[c[g]]=h}return f}function xd(a){var c=0,b;for(b in a)a.hasOwnProperty(b)&&(c=Math.max(c,a[b].ra()));return c};var yd={"vpl:then":function(a,c,b,d){c=Math.min(d.width,d.height);a.strokeStyle=b.Ig;a.lineWidth=.2*c;a.beginPath();a.moveTo(-.25*c,-.5*c);a.lineTo(.25*c,0);a.lineTo(-.25*c,.5*c);a.stroke()},"vpl:error":function(a,c,b,d){c=Math.min(d.width,d.height);a.fillStyle="white";a.strokeStyle=b.qg;a.lineWidth=.07*c;a.beginPath();a.arc(0,0,.5*c,0,2*Math.PI);a.fill();a.stroke();a.fillStyle=b.qg;a.font="bold "+Math.round(.75*c).toString()+"px sans-serif";a.textAlign="center";a.textBaseline="middle";a.fillText("?",
0,.05*c)},"vpl:warning":function(a,c,b,d){c=Math.min(d.width,d.height);a.fillStyle="white";a.strokeStyle=b.Ug;a.lineWidth=.07*c;a.beginPath();a.arc(0,0,.5*c,0,2*Math.PI);a.fill();a.stroke();a.fillStyle=b.Ug;a.font="bold "+Math.round(.75*c).toString()+"px sans-serif";a.textAlign="center";a.textBaseline="middle";a.fillText("!",0,.05*c)},"vpl:moreHigh":function(a,c,b,d){c=Math.min(d.width,d.height);a.beginPath();a.moveTo(-.2*c,.1*c);a.lineTo(0,-.1*c);a.lineTo(.2*c,.1*c);a.lineWidth=.1*c;a.strokeStyle=
"black";a.shadowColor="white";a.shadowBlur=.2*c;a.stroke()},"vpl:moreLow":function(a,c,b,d){c=Math.min(d.width,d.height);a.beginPath();a.moveTo(-.2*c,-.1*c);a.lineTo(0,.1*c);a.lineTo(.2*c,-.1*c);a.lineWidth=.1*c;a.strokeStyle="black";a.shadowColor="white";a.shadowBlur=.2*c;a.stroke()},"vpl:customize":function(a,c,b,d){c=Math.min(d.width,d.height)/2;a.fillStyle=b.Ig;nd(a,0,0,c)}};function bc(){this.b=new zd;this.i=new zd;this.i.S=!0;this.l=new zd}function Ad(a,c){return function(){a.u!==c&&(a.u=c,ac(a))}}function Bd(a){return function(c){a.u!==c&&(a.u=c,ac(a))}}var Cd={e:"event",s:"state",a:"action",c:"comment"};
function Dd(a,c,b,d,e,f,g,h){function l(x){return"a"===x||"c"===x}var k=a.j,r=Math.min(d.width,d.height),u=0!=c.A.m?r/c.A.m:1,y=Cd[b.T.type];y&&0>e.indexOf(y)&&e.push(y);var E=new Ed(b,d.width,d.height,f,g,function(x,n,w,m,p){var q=x.N;q.save();var A=x.A;x.A=wc(r,x.A.g*u);hd(d,q,n.x+w,n.y+m);var t=b.T,B=n.data,L=n.x+w,T=n.y+m;x.N.save();x.N.translate(L,T);t.J(x,B,d,p);x.N.restore();b.locked&&Fd(x,n.x+w,n.y+m,r,r,!0);(b.disabled||h.disabled)&&jd(x,n.x+w,n.y+m,r,r,e,e,!b.disabled&&!h.$h);b.marks.uf&&
Gd(x,n.x+w,n.y+m,d.width,d.height,e.concat("kbd-target"));b.marks.tf&&Gd(x,n.x+w,n.y+m,d.width,d.height,e.concat("kbd-selected"));null!=b.marks.Te&&null!==b.T.ha&&(p=b.T.ha.controls[b.marks.Te],Gd(x,n.x+w+d.width*p.left,n.y+m+d.height*p.top,d.width*(p.right-p.left),d.height*(p.bottom-p.top),e.concat("kbd-selected","param")));x.A=A;q.restore()},h&&h.bg||b.disabled||b.locked||b.Gb&&b.Gb.locked||!b.T.fa?h&&h.fa?{fa:h.fa}:null:{fa:b.T.fa,Pa:b.T.Pa},h&&h.ag?null:function(x,n){x.data.Gb&&(k.yb(),x.data.Gb.Yb(n.data,
x.data.We,function(){k.yb()},function(){rb(k)}),rb(k));c.qa&&c.qa()},h&&h.ag?null:function(x,n){return n.data instanceof Ha&&(l(x.data.T.type)===l(n.data.T.type)||"c"===n.data.T.type)&&x.data!==n.data});if(!(h&&h.bg||!b.T.fa)){if(k.aa||b.T.Je)E.S=function(x){return ad(c,x)};if(k.S||b.T.Je)E.aa=function(x){return ad(c,x)}}E.Za=!(h&&h.$f);E.l=!(h&&h.xf);E.Ac=Ad(a,b.T.name);f=Hd(c,b);a.W.i&&h&&h.ac&&(E.l=!1,E.b=h.ac.type!==gc?{fa:function(x,n,w,m,p,q,A){a.R.Ra!==h.ac.type||a.R.Ab!==h.ac.Dd||a.R.w!==
h.ac.Ed?(a.R.Ra=h.ac.type,a.R.Ab=h.ac.Dd,a.R.w=h.ac.Ed):Id(a.R,(A.x-p)/w,(A.y-q)/m);Fc(x);return 0},Pa:function(x,n,w,m,p,q,A,t){w=x.b.getBoundingClientRect();n=t.x-w.left;t=t.y-w.top;t=n>=E.x&&n<E.x+E.width&&t>=E.y&&t<E.y+E.height;a.R.Ra!==(t?h.ac.type:Jd)&&(a.R.Ra=t?h.ac.type:Jd,Fc(x))}}:{dd:function(){h.ac.click&&h.ac.click()}});Kd(c,E,f);return E}
function Ld(a,c,b,d,e,f,g,h){var l=new Ha(b,null,null);b.fb&&(l.h=b.fb());l.marks={tf:g||!1,Te:null,uf:!1};var k=a.j;g=0>("b"===k.mode?k.ec:k.kc).indexOf(b.name);a=Dd(a,c,l,d,["block","library"],e,f,{bg:!0,ag:!0,xf:k.ta||k.readOnly,disabled:g||k.readOnly,$h:g,fa:!a.W.wb||k.ta||k.readOnly?null:function(){var r="b"===k.mode?k.ec:k.kc;0<=r.indexOf(b.name)?r.splice(r.indexOf(b.name),1):r.push(b.name);return 1},ac:a.W.wb?null:h});b.fb&&(a.Ha=function(r){r=r.clone();r.data=new Ha(b,null,null);return r})}
function Md(a,c,b){var d=[],e=0;d=a.X.map(function(h,l){var k=a.error&&a.error.i&&(0===a.error.l.length||0<=a.error.l.indexOf(l))?a.error.Wb?b.Wd:b.Vd:b.Na;k.width=null==h?ed(1===d.length?b.If:b.Hf):ed(Nd(h,0===l,b));e+=ed(k);return b.Na.width});if(0===a.X.length||!c&&null!==a.X[a.X.length-1])b.Na.width=ed(0===a.X.length?b.If:b.Hf),d.push(b.Na.width),e+=ed(b.Na);c=ed(b.Xb);var f=[],g=0;f=a.actions.map(function(h,l){var k=a.error&&!a.error.i&&(0===a.error.b.length||0<=a.error.b.indexOf(l))?a.error.Wb?
b.Wd:b.Vd:b.Na;k.width=null==h?ed(1===f.length?b.Gf:b.Ff):ed(Nd(h,0===l,b));g+=ed(k);return ed(k)});if(0===a.actions.length||null!==a.actions[a.actions.length-1])b.Na.width=ed(0===a.actions.length?b.Gf:b.Ff),f.push(b.Na.width),g+=ed(b.Na);return{total:e+c+g,X:d,Pg:e,Ji:c,actions:f,li:g}}function Nd(a,c,b){switch(a.T.type){case "e":return c?b.Yc:b.Mc;case "a":return b.gd;case "s":return b.Xh;case "c":return b.Uh;default:throw"internal";}}
function Od(a,c){switch(a.verticalAlign){case "middle":return(c.height-a.ra())/2;case "bottom":return c.height-a.ra();case "top":return 0;default:return c.height-a.ra()-a.verticalAlign}}function $c(a,c){var b=a.ba,d=a.j.j[c];kc(a,{mh:d.je,display:function(){b.qa&&b.qa()},finish:function(e){null!==e&&(d.je=e);a.Da=null;b.qa&&b.qa()},Sc:d})}
function Pd(a,c,b,d,e,f,g,h,l,k){var r=b instanceof Ta,u=g,y=Md(b,e,k),E=a.j,x=r?a.Da&&a.Da.Sc===b?k.Hg:k.Ye:k.xb,n=0<b.X.length&&"e"===b.X[0].T.type?k.Yc:k.Mc,w=new Ed(b,x.width+x.paddingLeft+x.paddingRight,Qd(x),u-x.paddingLeft-k.Na.offsetLeft()-n.offsetLeft(),l-x.paddingTop-k.Na.offsetTop()-n.offsetTop(),function(A,t,B,L){var T=A.N;hd(x,T,t.x+B,t.y+L,!0);if(r){T.save();T.fillStyle=x.color;T.font=kd(x);T.textAlign="left";T.textBaseline="middle";if(a.Da&&a.Da.Sc===b){var la=T.measureText(a.Da.v.slice(0,
a.Da.b)),U=la.fontBoundingBoxAscent||0,H=la.fontBoundingBoxDescent||0;if(0===U||0===H)H=U=x.fontSize/2;var J={top:t.y+L+x.paddingTop+x.height/2-U,bottom:t.y+L+x.paddingTop+x.height/2+H,left:t.x+B+x.paddingLeft,right:t.x+B+x.paddingLeft+T.measureText(a.Da.v).width},R=a.Da.v.split("").map(function(G,O){return T.measureText(a.Da.v.slice(0,O+1)).width});ld(a.Da,J,R);a.Da.i===a.Da.b?(T.strokeStyle="black",T.beginPath(),T.moveTo(J.left+la.width,J.top),T.lineTo(J.left+la.width,J.bottom),T.stroke()):(R=T.measureText(a.Da.v.slice(a.Da.b,
a.Da.i)),T.save(),T.fillStyle="silver",T.fillRect(J.left+la.width-1,J.top,R.width,U+H),T.restore());T.fillText(a.Da.v,J.left,t.y+L+x.paddingTop+x.height/2)}else T.fillText(b.je,t.x+B+x.paddingLeft,t.y+L+x.paddingTop+x.height/2);T.restore();a.R.i===oc&&a.R.b===d&&Gd(A,t.x+B,t.y+L,t.width,t.height,["rule","comment","kbd-selected"]);a.R.Ra===oc&&a.R.Ab===d&&Gd(A,t.x+B,t.y+L,t.width,t.height,["rule","comment","kbd-target"])}else{hd(k.Xb,T,h-k.Xb.width-k.Xb.marginRight-k.Xb.paddingRight-k.Na.offsetLeft()-
k.gd.offsetLeft()+B,t.y+(Qd(x)-k.Xb.height)/2+L);Rd(A,"vpl:then",h-ed(k.Xb)/2-k.Na.offsetLeft()-k.gd.offsetLeft()+B,t.y+Qd(x)/2+L,k.Xb);b.locked&&Fd(A,t.x,t.y,t.width,t.height,!1,b.disabled?"#ddd":"");a.R.i===oc&&a.R.b===d&&Gd(A,t.x+B,t.y+L,t.width,t.height,["rule","kbd-selected"]);a.R.Ra===oc&&a.R.Ab===d&&Gd(A,t.x+B,t.y+L,t.width,t.height,["rule","kbd-target"]);var X=t.x+B+x.paddingLeft;0<f&&(X+=f-y.Pg);p.forEach(function(G,O){var Q=b.error&&b.error.i&&(0===b.error.l.length||0<=b.error.l.indexOf(O))?
b.error.Wb?k.Wd:k.Vd:k.Na;Q.width=null==G?ed(1===p.length?k.If:k.Hf):ed(Nd(G,0===O,k));hd(Q,T,X+Q.marginLeft,t.y+L+x.paddingTop+k.Na.marginTop,!0);X+=ed(Q)});X=t.x+B+x.paddingLeft+h-g;q.forEach(function(G,O){var Q=b.error&&!b.error.i&&(0===b.error.b.length||0<=b.error.b.indexOf(O))?b.error.Wb?k.Wd:k.Vd:k.Na;Q.width=null==G?ed(1===q.length?k.Gf:k.Ff):ed(Nd(G,0===O,k));hd(Q,T,X+Q.marginLeft,t.y+L+x.paddingTop+k.Na.marginTop,!0);X+=ed(Q)})}},r?{dd:function(){$c(a,d)}}:null,function(A,t){if(t.data instanceof
Oa){A=E.j.indexOf(A.data);var B=E.j.indexOf(t.data);0<=A&&0<=B&&(E.yb(),E.j.splice(B,1),E.j.splice(A,0,t.data),rb(E))}else t.data instanceof Ha&&(E.yb(),A.data.Yb(t.data,null,function(){E.yb()},function(){rb(E)}),rb(E));c.qa&&c.qa()},function(A,t){return t.data instanceof Oa?t.data!==A.data:!r&&t.data.Gb!==A.data&&("a"===E.mode||0===A.data.X.length||t.data instanceof Ha&&"a"===t.data.T.type)});b.disabled&&(w.u=function(A,t,B,L){jd(c,t.x+B,t.y+L,t.width,t.height,["rule"],["rule"])});if(a.j.ta||a.j.readOnly)w.l=
!1;a.W.i&&(w.l=!1,w.b={fa:function(A){a.R.Ra=oc;a.R.Ab=d;Fc(A);return 0},Pa:function(A,t,B,L,T,la,U,H){B=A.b.getBoundingClientRect();t=H.x-B.left;H=H.y-B.top;H=t>=w.x&&t<w.x+w.width&&H>=w.y&&H<w.y+w.height;a.R.Ra!==(H?oc:Jd)&&(a.R.Ra=H?oc:Jd,Fc(A))}});Kd(c,w);if(!r){var m,p=b.X;if(0===p.length||!e&&null!==p[p.length-1])p=p.concat(null);u=g;0<f&&(u+=f-y.Pg);p.forEach(function(A,t){var B=A?Nd(A,0===t,k):1===p.length?k.If:k.Hf,L=b.error&&b.error.i&&(0===b.error.l.length||0<=b.error.l.indexOf(t))?b.error.Wb?
k.Wd:k.Vd:k.Na,T=Od(B,L);A?(A.marks={tf:this.R.i===Sd&&this.R.b===d&&this.R.u===t,Te:this.R.i===Td&&this.R.b===d&&this.R.u===t?this.R.H:null,uf:this.R.Ra===Sd&&this.R.Ab===d&&this.R.w===t},L.width=ed(B),m=Dd(this,c,A,B,["block"],u,l+T,{bg:b.disabled||this.j.ta||this.j.readOnly,$f:b.disabled||this.j.ta||this.j.readOnly,xf:this.j.ta||this.j.readOnly,ac:{type:Sd,Dd:d,Ed:t}})):(A=new La("e",b,{kd:!0,index:t}),A.marks={tf:this.R.i===Sd&&this.R.b===d&&this.R.u===t,Te:null,uf:this.R.Ra===Sd&&this.R.Ab===
d&&this.R.w===t},L.width=ed(B),m=Dd(this,c,A,B,["block"],u,l+T,{ag:b.disabled||this.j.readOnly,$f:!0,xf:!0,ac:{type:Sd,Dd:d,Ed:t}}));w.pa.push(m);u+=ed(L)},a);var q=b.actions;if(0===q.length||null!==q[q.length-1])q=q.concat(null);u=h;q.forEach(function(A,t){var B=A?Nd(A,0==t,k):1===q.length?k.Gf:k.Ff,L=b.error&&!b.error.i&&(0===b.error.b.length||0<=b.error.b.indexOf(t))?b.error.Wb?k.Wd:k.Vd:k.Na,T=Od(B,L);A?(A.marks={tf:this.R.i===Ud&&this.R.b===d&&this.R.u===t,Te:this.R.i===Vd&&this.R.b===d&&this.R.u===
t?this.R.H:null,uf:this.R.Ra===Ud&&this.R.Ab===d&&this.R.w===t},L.width=ed(B),m=Dd(this,c,A,Nd(A,0===t,k),["block"],u,l+T,{bg:b.disabled||this.j.ta||this.j.readOnly,$f:b.disabled||this.j.ta||this.j.readOnly,xf:this.j.ta||this.j.readOnly,ac:{type:Ud,Dd:d,Ed:t}})):(A=new La("a",b,{kd:!1,index:t}),A.marks={tf:this.R.i===Ud&&this.R.b===d&&this.R.u===t,Te:null,uf:this.R.Ra===Ud&&this.R.Ab===d&&this.R.w===t},L.width=ed(B),m=Dd(this,c,A,B,["block"],u,l,{ag:E.readOnly,$f:!0,xf:!0,ac:{type:Ud,Dd:d,Ed:t}}));
w.pa.push(m);u+=ed(L)},a);gd(c,function(){if(null!==b.error){var A=b.error.Wb?k.Oh:k.Rf;Rd(c,b.error.Wb?"vpl:warning":"vpl:error",g-x.paddingLeft-x.marginLeft-k.Na.offsetLeft()-n.offsetLeft()-A.width/2-A.marginRight-A.paddingRight,l+.5*n.height,A)}})}}
function Wd(a,c,b,d,e,f){var g=f?e.Oh:e.Rf;gd(a,function(h){var l=Xd(a.ia,{tag:"conflict-line",ga:[f?"warning":"error"]}),k=c-e.xb.paddingLeft-e.xb.marginLeft-e.Na.offsetLeft()-e.Yc.offsetLeft()-g.width/2-g.marginRight-g.paddingRight,r=b+(e.Na.height+g.height)/2,u=d+(e.Na.height-g.height)/2;h.beginPath();h.moveTo(k,r);h.lineTo(k,u);l.stroke(h);h.beginPath();h.arc(k,r,l.lineWidth,0,Math.PI);l.stroke(h);h.beginPath();h.arc(k,u,l.lineWidth,-Math.PI,0);l.stroke(h)})}
function Bc(a,c){var b={};a=window.matchMedia&&window.matchMedia("(pointer: coarse)").matches?a.j.S:a.j.aa;b.D=wd(c,{tag:"view",ga:["vpl"]});b.Og=wd(c,{tag:"separator",ga:["vpl","top"]});b.Ng=wd(c,{tag:"separator",ga:["vpl","bottom"]});b.Hc=wd(c,{tag:"toolbar",ga:["vpl","top"]});b.Nd=wd(c,{tag:"toolbar",ga:["vpl","bottom"]});b.wa=wd(c,{tag:"vpl",id:"scrolling-vpl"});b.Yc=wd(c,{tag:"block",ga:["event","event-main"],mb:a?["small"]:[]});b.Mc=wd(c,{tag:"block",ga:["event","event-aux"],mb:a?["small"]:
[]});b.gd=wd(c,{tag:"block",ga:["action"],mb:a?["small"]:[]});b.Xh=wd(c,{tag:"block",ga:["state"],mb:a?["small"]:[]});b.Uh=wd(c,{tag:"block",ga:["comment"],mb:a?["small"]:[]});b.oi=wd(c,{tag:"block",ga:["event","empty"],mb:a?["small"]:[]});b.Ff=wd(c,{tag:"block",ga:["action","empty"],mb:a?["small"]:[]});b.If=wd(c,{tag:"block",ga:["event","empty"],mb:a?["only-child","small"]:["only-child"]});b.Hf=wd(c,{tag:"block",ga:["event","event-aux","empty"],mb:a?["small"]:[]});b.Gf=wd(c,{tag:"block",ga:["action",
"empty"],mb:a?["only-child","small"]:["only-child"]});b.Na=wd(c,{tag:"block-container"});b.Vd=wd(c,{tag:"block-container",ga:["error"]});b.Wd=wd(c,{tag:"block-container",ga:["warning"]});b.xb=wd(c,{tag:"rule",mb:a?["small"]:[]});b.Xb=wd(c,{tag:"widget",id:"widget-then",mb:a?["small"]:[]});b.Ye=wd(c,{tag:"rule",ga:["comment"],mb:a?["small"]:[]});b.Hg=wd(c,{tag:"rule",ga:["comment"],mb:a?["small","edited"]:["edited"]});b.kf=wd(c,{tag:"block",ga:["library","event"]});b.Ke=wd(c,{tag:"block",ga:["library",
"action"]});b.Yh=wd(c,{tag:"block",ga:["library","state"]});b.Vh=wd(c,{tag:"block",ga:["library","comment"]});b.$a=wd(c,{tag:"block-library",ga:["event"]});b.bb=wd(c,{tag:"block-library",ga:["action"]});b.Rf=wd(c,{tag:"widget",id:"widget-error",mb:a?["small"]:[]});b.Oh=wd(c,{tag:"widget",id:"widget-warning",mb:a?["small"]:[]});return b}
function Sc(a){var c=a.W,b=a.j,d=b.Cc(b.Bb);a.Pb="";a.yd=!1;if(!c.wb)for(c=0;c<b.j.length;c++)if(b.j[c].error)if(b.j[c].error.Wb)a.Pb||(a.Pb=b.j[c].error.w,a.yd=!0);else{a.Pb=b.j[c].error.w;a.yd=!1;break}b=""!==a.Pb&&!a.yd;if(!b)try{var e=a.Ga[a.ma].Qa.check(d,a.j.Bb,function(){ac(a)});e&&(a.Pb=e,b=!0)}catch(f){}}function Dc(a,c,b,d,e,f){var g=new bd(a.ba);ud(g,a,c,b,a.j.fe||yc,a.j.bf||pd);dd(g,d,f,e);return g}
function Yd(a,c,b){for(var d=0;d<mb.length;d++){var e=mb[d];if((c?"a"===e.type||"c"===e.type:"e"===e.type||"s"===e.type)&&0<=("b"===a.j.mode?a.j.ec:a.j.kc).indexOf(e.name)){if(0===b)return e;b--}}return null}
function ac(a){function c(v,C){switch(C.type){case "e":return v.kf;case "a":return v.Ke;case "s":return v.Yh;case "c":return v.Vh;default:throw"internal";}}var b=a.W,d=a.ba,e=a.j,f=Bc(a,d.ia);Zd(d);Sc(a);e.aa=d.A.m<d.A.ph;e.S=d.A.m<d.A.qh;var g=$d(d),h=d.state.ni,l=vd(a,a.zc),k=pb(e),r=0,u=0,y=0,E=0;e.j.forEach(function(v){v instanceof Ta?E++:y++;v=Md(v,k,f);r=Math.max(r,v.Pg);u=Math.max(u,v.li)});var x=0,n=0;mb.forEach(function(v){if(b.wb||0<=("b"===e.mode?e.ec:e.kc).indexOf(v.name))switch(v.type){case "e":case "s":x++;
break;case "a":case "c":n++}},a);a.R.pa=x;a.R.Ha=n;ae(d,function(v,C,F){if(a.I.gb("vpl:trashcan",C)){v=B-f.xb.offsetLeft()-f.Na.offsetLeft()-f.Yc.offsetLeft();var S=ed(f.xb);if(F<v||F>v+S)return a.I.pb("vpl:trashcan",C),!0}return!1});var w=Cc(a,a.Kc,["vpl","top"],null,function(v){switch(v){case "vpl:filename":if(null!=a.Da&&a.Da.Sc===a.j)return["edited"]}return[]}),m=xd(w),p=Cc(a,a.zc,["vpl","bottom"]),q=xd(p);f.D.Uc(g.width);f.D.Ec(g.height);f.D.setPosition(0,0);f.Hc.Uc(f.D.width);f.Hc.height=m;
f.Hc.setPosition(f.D.x,f.D.y);f.$a.Ec(f.D.height-f.Hc.ra());var A=Math.max(Math.floor(f.$a.height/f.kf.ra()),1);m=f.$a.scroll?1:Math.ceil(x/A);f.$a.width=m*ed(f.kf);f.$a.setPosition(f.D.x,f.D.y+f.Hc.ra());f.bb.Ec(f.D.height-f.Hc.ra());var t=f.bb.scroll?1:Math.ceil(n/A);f.bb.width=t*ed(f.Ke);f.bb.setPosition(f.D.x+f.D.width-ed(f.bb),f.D.y+f.Hc.ra());f.Nd.Uc(f.D.width-ed(f.$a)-ed(f.bb));f.Nd.height=q;f.Nd.setPosition(f.D.x+ed(f.$a),f.D.y+f.D.height-f.Nd.ra());f.wa.Uc(f.D.width-ed(f.$a)-ed(f.bb));f.wa.Ec(f.D.height-
f.Hc.ra()-(l?f.Nd.ra():0));f.wa.setPosition(f.D.x+ed(f.$a),f.D.y+f.Hc.ra());f.Na.width=f.Vd.width=f.Wd.width=ed(f.Yc);f.Na.height=f.Vd.height=f.Wd.height=f.Yc.ra();q=ed(f.Xb);A=r+u+q;var B=f.D.x+(f.D.width-A+ed(f.Rf))/2,L=B+r+q;f.xb.width=A;f.xb.height=f.Na.ra();f.Ye.width=A;f.Ye.height=f.Ye.fontSize;f.Hg.width=A;f.Hg.height=f.Ye.fontSize;var T=[];e.j.forEach(function(v,C){v=v instanceof Ta?f.Ye.ra():f.xb.ra();T.push(0===C?v:T[C-1]+v)});d.ob=[];gd(d,function(v){f.D.J(v)});var la=Dc(a,a.Kc,["vpl",
"top"],f.Hc,f.Og,w);fd(la,f.Hc,w,Bd(a));if(a.R.i===be&&!a.W.wb){q=ce(a.R);var U=null;for(A=0;A<la.controls.length;A++)if(la.controls[A].id===q.name){U=la.controls[A];break}var H=w[U.id];gd(d,function(){Gd(d,U.x,U.y,H.width,H.height,["button","top","kbd-selected"])})}if(0<l&&(l=Dc(a,a.zc,["vpl","bottom"],f.Nd,f.Ng,p),fd(l,f.Nd,p,Bd(a)),a.R.i===de&&!a.W.wb)){q=ce(a.R);U=null;for(A=0;A<l.controls.length;A++)if(l.controls[A].id===q.name){U=l.controls[A];break}H=p[U.id];gd(d,function(){Gd(d,U.x,U.y,H.width,
H.height,["button","bottom","kbd-selected"])})}var J=f.kf.ra(),R=f.Ke.ra(),X=0,G=0;if(f.$a.scroll){a.R.S=1;X=ed(f.kf);h.i.Ec(x*J);f.$a.width=X;f.$a.height=f.$a.height;h.i.resize(f.$a.x,f.$a.y,f.$a.width,f.$a.height);gd(d,function(v){f.$a.J(v)});h.i.ie(d);var O=0;mb.forEach(function(v){if(("e"===v.type||"s"===v.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.kc).indexOf(v.name))){var C=c(f,v),F=f.$a.x+C.offsetLeft(),S=f.$a.y+C.offsetTop()+O*J;Ld(this,d,v,C,F,S,a.R.i===ee&&a.R.b===O,{type:gc,Dd:0,Ed:0,click:function(){fe(a.R,
v)}});O++}},a);h.i.end();gd(d,function(){var v=wd(d.ia,{tag:"widget",id:"widget-moreHigh"}),C=wd(d.ia,{tag:"widget",id:"widget-moreLow"});ge(h.i)||Rd(d,"vpl:moreHigh",f.$a.x+f.$a.width/2,f.$a.y+v.ra()/2,v);he(h.i)||Rd(d,"vpl:moreLow",f.$a.x+f.$a.width/2,f.$a.y+f.$a.height-C.ra()/2,C)})}else{gd(d,function(v){f.$a.J(v)});X=m*J+ie(f.$a);var Q=Math.ceil(x/m);a.R.S=Q;O=0;mb.forEach(function(v){if(("e"===v.type||"s"===v.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.kc).indexOf(v.name))){var C=c(f,v),F=f.$a.x+C.offsetLeft()+
Math.floor(O/Q)*J,S=f.$a.y+C.offsetTop()+O%Q*J;Ld(a,d,v,C,F,S,a.R.i===ee&&a.R.b===O%Q&&a.R.u===Math.floor(O/Q),{type:gc,Dd:0,Ed:0,click:function(){fe(a.R,v)}});O++}},a)}f.bb.scroll?(a.R.aa=1,G=ed(f.Ke),h.l.Ec(n*R),f.bb.width=G,f.bb.height=f.bb.height,h.l.resize(f.bb.x,f.bb.y,f.bb.width,f.bb.height),gd(d,function(v){f.bb.J(v)}),h.l.ie(d),O=0,mb.forEach(function(v){if(("a"===v.type||"c"===v.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.kc).indexOf(v.name))){var C=c(f,v);Ld(this,d,v,C,f.bb.x+f.Ke.offsetLeft(),
f.bb.y+f.Ke.offsetTop()+O*R,a.R.i===je&&a.R.b===O,{type:gc,Dd:0,Ed:0,click:function(){fe(a.R,v)}});O++}},a),h.l.end(),gd(d,function(){var v=wd(d.ia,{tag:"widget",id:"widget-moreHigh"}),C=wd(d.ia,{tag:"widget",id:"widget-moreLow"});ge(h.l)||Rd(d,"vpl:moreHigh",f.bb.x+f.bb.width/2,f.bb.y+v.ra()/2,v);he(h.l)||Rd(d,"vpl:moreLow",f.bb.x+f.bb.width/2,f.bb.y+f.bb.height-C.ra()/2,C)})):(gd(d,function(v){f.bb.J(v)}),G=t*R+ie(f.bb),Q=Math.ceil(n/t),a.R.aa=Q,O=0,mb.forEach(function(v){if(("a"===v.type||"c"===
v.type)&&(b.wb||0<=("b"===e.mode?e.ec:e.kc).indexOf(v.name))){var C=c(f,v),F=f.bb.x+C.offsetLeft()+f.bb.width-(t-Math.floor(O/Q))*R,S=f.bb.y+C.offsetTop()+O%Q*R;Ld(a,d,v,C,F,S,a.R.i===je&&a.R.b===O%Q&&a.R.u===Math.floor(O/Q),{type:gc,Dd:0,Ed:0,click:function(){fe(a.R,v)}});O++}},a));if(b.wb){(function(){var v=f.Na.sb();v.width=ed(f.Yc);var C=f.Na.sb();C.width=ed(f.Mc);var F=f.Na.sb();F.width=ed(f.gd);var S=ed(v)+ed(C)+ed(f.Xb)+ed(F),K=f.xb.sb();K.width=S;var ma=f.D.x+(f.D.width-S)/2+(X-G)/2-d.A.vd/
2,na=ma+S-ed(F);S=f.wa.y+K.offsetTop()+v.offsetTop();var Z=!1;S=new Ed(a,K.width+K.paddingLeft+K.paddingRight,Qd(K),ma-K.paddingLeft-v.offsetLeft(),S-K.paddingTop-v.offsetTop(),function(ia,fa,M,I){var qa=ia.N;hd(K,qa,fa.x+M,fa.y+I,!0);hd(f.Xb,qa,na-f.Xb.width-f.Xb.marginRight-f.Xb.paddingRight-f.Na.offsetLeft()-f.gd.offsetLeft()+M,fa.y+(Qd(f.xb)-f.Xb.height)/2+I);Rd(ia,"vpl:then",na-ed(f.Xb)/2-f.Na.offsetLeft()-f.gd.offsetLeft()+M,fa.y+Qd(f.xb)/2+I,f.Xb);var ab=fa.x+M+K.paddingLeft;hd(v,qa,ab+v.marginLeft,
fa.y+I+K.paddingTop+v.marginTop,!0);hd(f.Yc,qa,ab+v.offsetLeft()+f.Yc.marginLeft,fa.y+I+K.paddingTop+v.offsetTop()+f.Yc.marginTop+Od(f.Yc,v),!0);ab+=ed(v);hd(C,qa,ab+C.marginLeft,fa.y+I+K.paddingTop+C.marginTop,!0);hd(f.Mc,qa,ab+v.offsetLeft()+f.Mc.marginLeft,fa.y+I+K.paddingTop+C.offsetTop()+f.Mc.marginTop+Od(f.Mc,C),!0);!("a"===a.j.mode?a.j.i:a.j.b)^Z&&jd(ia,ab+v.offsetLeft()+f.Mc.marginLeft,fa.y+I+K.paddingTop+C.offsetTop()+f.Mc.marginTop+Od(f.Mc,C),f.Mc.width,f.Mc.height,["block"],["block"],!1);
ab=fa.x+M+f.xb.paddingLeft+na-ma;hd(F,qa,ab+F.marginLeft,fa.y+I+K.paddingTop+F.marginTop,!0);hd(f.gd,qa,ab+F.offsetLeft()+f.gd.marginLeft,fa.y+I+K.paddingTop+F.offsetTop()+f.gd.marginTop+Od(f.gd,F),!0)},{fa:function(ia){Z=!0;Fc(ia);return 0},Pa:function(ia,fa,M,I,qa,ab,qc,Oc){M=ia.b.getBoundingClientRect();fa=Oc.x-M.left;Oc=Oc.y-M.top;Z=fa>=ab&&fa<ab+I&&Oc>=qc&&Oc<qc+qa;Fc(ia)},dd:function(ia){Z&&("a"===a.j.mode?a.j.i=!a.j.i:a.j.b=!a.j.b);Fc(ia)}},null,null);S.l=!1;Kd(d,S)})();var P=wd(d.ia,{tag:"widget",
id:"vpl-customize"});P.width=f.wa.width/2;P.height=(f.wa.height-f.xb.ra())/2;gd(d,function(){Rd(d,"vpl:customize",f.wa.x+f.wa.width/2,f.wa.y+(f.wa.height+f.xb.ra())/2,P)})}else if(e.message)gd(d,function(v){var C=e.message.split("\n"),F=Math.min(14,g.height/C.length);v.font=F+"px sans-serif";v.textAlign="start";v.textBaseline="top";var S=f.wa.x+F,K=f.wa.y+F;C.forEach(function(ma,na){v.fillText(ma,S,K+1.2*F*na)})});else{p=ed(f.xb)+f.wa.paddingLeft+f.wa.paddingRight+ed(f.Rf);h.b.Uc(p);h.b.Ec(T[T.length-
1]);switch(a.R.i){case oc:case Sd:case Ud:case Td:case Vd:ke(h.b,0<a.R.b?T[a.R.b-1]:0,T[a.R.b])}h.b.resize(f.wa.x,f.wa.y,f.wa.width,f.wa.height);gd(d,function(v){f.wa.J(v)});h.b.ie(d);B+=(X-G)/2-d.A.vd/2;L+=(X-G)/2-d.A.vd/2;p>f.wa.width&&(B+=(p-f.wa.width)/2+f.wa.paddingLeft+f.wa.marginLeft,L+=(p-f.wa.width)/2+f.wa.paddingLeft+f.wa.marginLeft);var V="";e.j.forEach(function(v,C){(0<C?T[C-1]:0)<f.wa.height+h.b.b&&T[C]>h.b.b&&Pd(this,d,v,C,k,d.A.jh?r:0,B,L,f.wa.y+(0<C?T[C-1]:0)+f.xb.offsetTop()+f.Na.offsetTop(),
f);if(null!==v.error&&""===V&&(V=v.error.w,null!==v.error.u))for(var F=C+1;F<e.j.length;F++)if(e.j[F]===v.error.u){Wd(d,B,f.wa.y+f.xb.ra()*C+f.xb.offsetTop()+f.Na.offsetTop(),f.wa.y+f.xb.ra()*F+f.xb.offsetTop()+f.Na.offsetTop(),f,v.error.Wb);break}},a);h.b.end();if(!ge(h.b)){var z=wd(d.ia,{tag:"widget",id:"widget-moreHigh"});p=new Ed(null,ed(z),z.ra(),f.wa.x+f.wa.width-ed(z),f.wa.y+z.ra()-z.ra(),function(v){Rd(v,"vpl:moreHigh",f.wa.x+f.wa.width-ed(z)/2,f.wa.y+z.ra()/2,z)},{dd:function(){var v=h.b,
C=-f.xb.ra();v.u+=0;v.b+=C;Fc(d)}},null,null,"scrollUp");Kd(d,p)}if(!he(h.b)){var D=wd(d.ia,{tag:"widget",id:"widget-moreLow"});p=new Ed(null,ed(D),D.ra(),f.wa.x+f.wa.width-ed(D),f.wa.y+f.wa.height-D.ra(),function(v){Rd(v,"vpl:moreLow",f.wa.x+f.wa.width-ed(D)/2,f.wa.y+f.wa.height-D.ra()/2,D)},{dd:function(){var v=h.b,C=f.xb.ra();v.u+=0;v.b+=C;Fc(d)}},null,null,"scrollDown");Kd(d,p)}e.ta&&gd(d,function(){jd(d,f.wa.x,f.wa.y,f.wa.width,f.wa.height,["vpl"],["vpl"])})}a.u&&gd(d,function(v){var C=wd(d.ia,
{tag:"hint"});v.fillStyle=C.color;v.font=kd(C);v.textAlign="start";v.textBaseline="middle";var F=a.i.translate(a.u);if(a.W.i){var S=a.i.translate(a.u+";nodrag");";nodrag"!==S.slice(-7)&&(F=S)}C.width=v.measureText(F).width;C.height=1.2*C.fontSize;hd(C,v,C.marginLeft,g.height-C.ra()+C.marginTop,!0);v.fillText(F,C.offsetLeft(),g.height-C.ra()+C.offsetTop()+C.height/2)});e.qa&&e.qa();Fc(d)};function le(){this.S={};this.i=[];this.Ha={px:1,cm:96/2.54,mm:96/25.4,"in":96,pc:16,pt:96/72};this.aa={rad:1,deg:Math.PI/180,grad:Math.PI/200,turn:2*Math.PI};this.b=null}le.prototype.H=function(){this.S={};this.i=[]};
function me(a,c,b){function d(){return c+" line "+r+" col "+u}function e(){for(;k<b.length;)if(" "===b[k]||"\t"===b[k])k++,u++;else if("\n"===b[k])k++,u=1,r++;else if("\r"===b[k])k++;else if("/*"===b.slice(k,k+2))for(k+=2,u+=2;k<b.length;)if("*/"===b.slice(k,k+2)){k+=2;u+=2;break}else k++,u++;else break}function f(){"\n"===b[k]?(u=1,r++):"\r"!==b[k]&&u++;k++}function g(){for(var w=0;k+w<b.length&&/[-_a-z0-9]/i.test(b[k+w]);)w++;k+=w;u+=w;return b.slice(k-w,k)}function h(){var w=new ne;if(!/[a-z_.#*:]/i.test(b[k]))throw"Syntax error "+
d();for(/[a-z_]/i.test(b[k])?w.tag=g():"*"===b[k]&&f();;)if("#"===b[k]){if(w.id)throw"Multiple ids in selector "+d();f();w.id=g()}else if("."===b[k])f(),w.ga.push(g());else if(":"===b[k])f(),w.mb.push(g());else break;return w}function l(){for(var w=0,m=!1;k+w<b.length&&(m||";"!==b[k+w]&&"}"!==b[k+w]);)"\n"===b[k]?(r++,u=1):"\r"!==b[k]?u++:'"'===b[k]&&(m=!m),w++;k+=w;return b.slice(k-w,k).trim()}a.S[c]=b;for(var k=0,r=1,u=1;k<b.length;){e();if(k>=b.length)break;for(var y=[];;){y.push(h());e();if(","!==
b[k])break;k++;u++;e()}if("{"!==b[k])throw"Syntax error "+d();k++;u++;for(var E={};;){for(;;){e();if(";"!==b[k])break;k++}if(k>=b.length)throw"Unclosed block "+d();if("}"===b[k]){k++;u++;break}else if(!/[-a-z_]/i.test(b[k]))throw"Syntax error "+d();var x=g();e();if(":"!==b[k])throw"Missing colon "+d();k++;u++;var n=l();E[x]=a.Za(x,n)}for(x=0;x<y.length;x++)a.i.push({fg:y[x],ud:E})}}le.prototype.Za=function(a,c){return c};
function oe(a,c){if(/^(max|min)\(.*\)$/.test(c))return a=c.slice(4,-1).split(",").map(function(e){return oe(this,e)},a),new pe(c.slice(0,3),a);c=/^(-?([0-9]+\.?|[0-9]*\.[0-9]+))([a-z]*|%)$/.exec(c);var b=1,d=qe;if(null==c)throw"Illegal length";if("%"===c[3])d=re;else if(a.Ha.hasOwnProperty(c[3]))b=a.Ha[c[3]];else if("vw"===c[3])d=se;else if("vh"===c[3])d=te;else if("vmin"===c[3])d=ue;else if("vmax"===c[3])d=ve;else if("ww"===c[3])d=we;else if("wh"===c[3])d=xe;else if("wmin"===c[3])d=ye;else if("wmax"===
c[3])d=ze;else if(0==parseFloat(c[1]))b=0;else throw"Unknown length unit";return new Ae(parseFloat(c[1])*b,d)}
var Be={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",
darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",
ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",
lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",
moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",
seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32",transparent:"rgba(0,0,0,0)"};function Ae(a,c){this.Z=a;this.type=c?c:qe}
var qe="abs",re="%",se="vw",te="vh",ue="vmin",ve="vmax",we="ww",xe="wh",ye="wmin",ze="wmax";
Ae.prototype.V=function(a){switch(this.type){case qe:return this.Z;case re:return this.Z*(a?a.w/100:1);case se:return this.Z*(a?a.i:1);case te:return this.Z*(a?a.b:1);case ue:return this.Z*(a?Math.min(a.i,a.b):1);case ve:return this.Z*(a?Math.max(a.i,a.b):1);case we:return this.Z*(a?a.u:1);case xe:return this.Z*(a?a.l:1);case ye:return this.Z*(a?Math.min(a.u,a.l):1);case ze:return this.Z*(a?Math.max(a.u,a.l):1);default:throw"internal";}};function pe(a,c){Ae.call(this,0);this.Fa=a;this.values=c}
pe.prototype=Object.create(Ae.prototype);pe.prototype.constructor=pe;pe.prototype.V=function(a){switch(this.Fa){case "max":return this.values.reduce(function(c,b){return Math.max(c,b.V(a))},-Infinity);case "min":return this.values.reduce(function(c,b){return Math.min(c,b.V(a))},Infinity);default:throw"internal";}};function Ce(a,c,b,d,e){this.w=a;this.i=c;this.b=b;this.u=d;this.l=e}function ne(){this.id=this.tag=null;this.ga=[];this.mb=[]}
function De(a,c){a=(a.id?"#"+a.id:a.tag||"")+(a.ga&&0<a.ga.length?"."+a.ga.join("."):"")+(a.mb&&0<a.mb.length?":"+a.mb.join("."):"")||"*";c&&(a+="/"+Math.round(c.w).toString(10)+","+Math.round(c.i).toString(10)+","+Math.round(c.b).toString(10)+","+Math.round(c.u).toString(10)+","+Math.round(c.l).toString(10));return a}
ne.prototype.match=function(a){if(a.tag&&this.tag&&a.tag!==this.tag||this.id&&this.id!==a.id)return!1;for(var c=0;c<this.ga.length;c++)if(void 0==a.ga||0>a.ga.indexOf(this.ga[c]))return!1;for(c=0;c<this.mb.length;c++)if(void 0==a.mb||0>a.mb.indexOf(this.mb[c]))return!1;return!0};function Zb(){le.call(this);this.l=[];this.u={};this.w={};this.pa="none hidden dotted dashed solid double".split(" ");this.rb=["normal","italic","oblique"];this.Jb=["normal","bold"]}Zb.prototype=Object.create(le.prototype);Zb.prototype.constructor=Zb;Zb.prototype.H=function(){le.prototype.H.call(this);this.u={};this.w={}};
Zb.prototype.defineProperties=function(){for(var a=0;a<this.i.length;a++){var c=new Ee,b=this.i[a].fg;Fe(c,this.i[a].ud,(null!=b.id?100:0)+10*(b.ga.length+b.mb.length)+(null!=b.tag?1:0));this.l.push({fg:this.i[a].fg,Eh:c})}};
Zb.prototype.Za=function(a,c){function b(y){try{oe(e,y)}catch(E){return!1}return!0}function d(y){return Be.hasOwnProperty(y)||/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(y)||/^rgba\([^()]*\)$/.test(y)}var e=this;c=c.replace(/\s+(?=[^()]*\))/g,"");switch(a){case "margin-left":case "margin-right":case "margin-top":case "margin-bottom":case "padding-left":case "padding-right":case "padding-top":case "padding-bottom":case "border-left-width":case "border-right-width":case "border-top-width":case "border-bottom-width":case "border-corner-length":case "line-width":case "width":case "height":case "min-width":case "min-height":case "max-width":case "max-height":case "font-size":return oe(this,c);
case "margin":case "padding":case "border-width":switch(a=c.replace(/ +/g," ").split(" ").map(function(y){return oe(e,y)}),a.length){case 1:return[a[0],a[0],a[0],a[0]];case 2:return[a[0],a[1],a[0],a[1]];case 3:return[a[0],a[1],a[2],a[1]];case 4:return a;default:throw"Wrong number of lengths";}case "border-style":case "border-left-style":case "border-right-style":case "border-top-style":case "border-bottom-style":case "line-style":if(!(0<=e.pa.indexOf(c)))throw"Unknown border style";return c;case "line-cap":if(!(0<=
["butt","round","square"].indexOf(c)))throw"Unknown line cap";return c;case "border-color":case "border-left-color":case "border-right-color":case "border-top-color":case "border-bottom-color":case "color":case "background-color":case "background":case "border-cut-background":if(!d(c))throw"Unknown border color";return c;case "border-left":case "border-right":case "border-top":case "border-bottom":case "border":case "line":var f=null,g=null,h=null;c.replace(/ +/g," ").split(" ").forEach(function(y){if(d(y))f=
y;else if(0<=e.pa.indexOf(y))g=y;else if(b(y))h=oe(e,y);else throw"Illegal border property";});return{color:f,style:null===g&&(f||h)?"solid":g,width:null===h&&(f||g)?new Ae(1):h};case "border-top-left-radius":case "border-top-right-radius":case "border-bottom-right-radius":case "border-bottom-left-radius":case "border-top-left-cut":case "border-top-right-cut":case "border-bottom-left-cut":case "border-bottom-right-cut":switch(a=c.replace(/ +/g," ").split(" ").map(function(y){return oe(e,y)}),a.length){case 1:return[a[0],
a[0]];case 2:return a;default:throw"Wrong number of radii";}case "border-radius":case "border-cut":switch(a=c.split("/").map(function(y){y=y.replace(/ +/g," ").split(" ").map(function(E){return"/"===E?"/":oe(e,E)});switch(y.length){case 1:return[y[0],y[0],y[0],y[0]];case 2:return[y[0],y[1],y[0],y[1]];case 3:return[y[0],y[1],y[2],y[1]];case 4:return y;default:throw"Wrong number of radii";}}),a.length){case 1:return a[0].concat(a[0]);case 2:return a[0].concat(a[1]);default:throw"Wrong number of radius dimensions";
}case "font":var l="",k="",r=null,u="";c.replace(/ +/g," ").split(" ").forEach(function(y){if(null===r)if(b(y))r=oe(e,y);else if(0<=e.rb.indexOf(y))l=y;else if(0<=e.Jb.indexOf(y))k=y;else throw"Unknown font style "+y;else{if(""!==u)throw"Unexpected font style after font-family";u=y}});return{fontFamily:u,fontSize:r,fontStyle:l,fontWeight:k};case "box-shadow":case "line-shadow":return c=c.split(",")[0],a=c.replace(/ +/g," ").split(" "),"inset"===a[0]&&(a=a.slice(1)),3<=a.length&&5>=a.length?{offset:[oe(this,
a[0]),oe(this,a[1])],color:a[a.length-1],Jf:4<=a.length?oe(this,a[2]):null,gg:5<=a.length?oe(this,a[3]):null}:{};case "overflow":if(0>["wrap","scroll"].indexOf(c))throw"Unknown overflow mode";return c;case "vertical-align":return 0<=["top","middle","bottom"].indexOf(c)?c:oe(this,c);default:return c}};
function Ge(a,c){for(var b=null,d=0;d<a.l.length;d++)if(a.l[d].fg.match(c)){if(b){var e=void 0;var f=a.l[d].Eh;b=b.sb();for(e in f.ud)f.ud.hasOwnProperty(e)&&(!b.hasOwnProperty(e)||f.b[e]>=b.b[e])&&(b.ud[e]=f.ud[e]);e=b}else e=a.l[d].Eh.sb();b=e}for(var g in b)b.hasOwnProperty(g)&&b[g]instanceof Ae&&(b[g]=b[g].V(a.b));return b}function wd(a,c){var b=De(c,a.b);if(a.u[b])return a.u[b];c=Ge(a,c);c=new vc(c,a.b);return a.u[b]=c}
function Xd(a,c){var b=De(c,a.b);if(a.w[b])return a.w[b];c=Ge(a,c);c=new He(c,a.b);return a.w[b]=c}function Ee(){this.ud={};this.b={}}function Fe(a,c,b,d){for(var e in c)c.hasOwnProperty(e)&&(a.ud[e]=c[e],a.b[e]=d&&d[e]||b)}Ee.prototype.sb=function(){var a=new Ee;Fe(a,this.ud,0,this.b);return a};
function vc(a,c){this.marginBottom=this.marginTop=this.marginRight=this.marginLeft=this.y=this.x=this.height=this.width=0;this.Hb=!0;this.Dc=!1;this.borderBottomWidth=this.borderTopWidth=this.borderRightWidth=this.borderLeftWidth=0;this.borderBottomStyle=this.borderTopStyle=this.borderRightStyle=this.borderLeftStyle="none";this.borderBottomColor=this.borderTopColor=this.borderRightColor=this.borderLeftColor="black";this.borderTopLeftRadius=[0,0];this.borderTopRightRadius=[0,0];this.borderBottomRightRadius=
[0,0];this.borderBottomLeftRadius=[0,0];this.lf=this.Me=this.nf=this.mf=!1;this.paddingBottom=this.paddingTop=this.paddingRight=this.paddingLeft=this.Eb=0;this.backgroundColor=this.gf="transparent";this.color="black";this.fontFamily="sans-serif";this.fontSize=10;this.fontWeight=this.fontStyle="";this.scroll=!1;this.verticalAlign="middle";this.hc=null;this.Ce=this.Id=0;this.shadowColor=null;this.ze={};a&&Ie(this,a.ud,c)}vc.prototype=Object.create(Ee.prototype);N=vc.prototype;N.constructor=vc;
function Ie(a,c,b){var d=-1,e=-1,f=-1,g=-1,h=1E9,l=1E9,k;for(k in c)switch(k){case "margin-left":a.marginLeft=c[k].V(b);break;case "margin-right":a.marginRight=c[k].V(b);break;case "margin-top":a.marginTop=c[k].V(b);break;case "margin-bottom":a.marginBottom=c[k].V(b);break;case "border-left-width":a.borderLeftWidth=c[k].V(b);a.Hb=!1;break;case "border-right-width":a.borderRightWidth=c[k].V(b);a.Hb=!1;break;case "border-top-width":a.borderTopWidth=c[k].V(b);a.Hb=!1;break;case "border-bottom-width":a.borderBottomWidth=
c[k].V(b);a.Hb=!1;break;case "border-corner-length":a.Eb=c[k].V(b);break;case "padding-left":a.paddingLeft=c[k].V(b);break;case "padding-right":a.paddingRight=c[k].V(b);break;case "padding-top":a.paddingTop=c[k].V(b);break;case "padding-bottom":a.paddingBottom=c[k].V(b);break;case "margin":a.marginTop=c[k][0].V(b);a.marginRight=c[k][1].V(b);a.marginBottom=c[k][2].V(b);a.marginLeft=c[k][3].V(b);break;case "border-width":a.borderTopWidth=c[k][0].V(b);"none"===a.borderTopStyle&&0<a.borderTopWidth&&(a.borderTopStyle=
null);a.borderRightWidth=c[k][1].V(b);"none"===a.borderRightStyle&&0<a.borderRightWidth&&(a.borderRightStyle=null);a.borderBottomWidth=c[k][2].V(b);"none"===a.borderBottomStyle&&0<a.borderBottomWidth&&(a.borderBottomStyle=null);a.borderLeftWidth=c[k][3].V(b);"none"===a.borderLeftStyle&&0<a.borderLeftWidth&&(a.borderLeftStyle=null);break;case "padding":a.paddingTop=c[k][0].V(b);a.paddingRight=c[k][1].V(b);a.paddingBottom=c[k][2].V(b);a.paddingLeft=c[k][3].V(b);break;case "border-style":a.borderLeftStyle=
c[k];a.borderRightStyle=c[k];a.borderTopStyle=c[k];a.borderBottomStyle=c[k];break;case "border-left-style":a.borderLeftStyle=c[k];a.Hb=!1;break;case "border-right-style":a.borderRightStyle=c[k];a.Hb=!1;break;case "border-top-style":a.borderTopStyle=c[k];a.Hb=!1;break;case "border-bottom-style":a.borderBottomStyle=c[k];a.Hb=!1;break;case "border-color":a.borderLeftColor=c[k];a.borderRightColor=c[k];a.borderTopColor=c[k];a.borderBottomColor=c[k];break;case "border-left-color":a.borderLeftColor=c[k];
a.Hb=!1;break;case "border-right-color":a.borderRightColor=c[k];a.Hb=!1;break;case "border-top-color":a.borderTopColor=c[k];a.Hb=!1;break;case "border-bottom-color":a.borderBottomColor=c[k];a.Hb=!1;break;case "border-left":null!==c[k].color&&(a.borderLeftColor=c[k].color);null!==c[k].style&&(a.borderLeftStyle=c[k].style);null!==c[k].width&&(a.borderLeftWidth=c[k].width.V(b));a.Hb=!1;break;case "border-right":null!==c[k].color&&(a.borderRightColor=c[k].color);null!==c[k].style&&(a.borderRightStyle=
c[k].style);null!==c[k].width&&(a.borderRightWidth=c[k].width.V(b));a.Hb=!1;break;case "border-top":null!==c[k].color&&(a.borderTopColor=c[k].color);null!==c[k].style&&(a.borderTopStyle=c[k].style);null!==c[k].width&&(a.borderTopWidth=c[k].width.V(b));a.Hb=!1;break;case "border-bottom":null!==c[k].color&&(a.borderBottomColor=c[k].color);null!==c[k].style&&(a.borderBottomStyle=c[k].style);null!==c[k].width&&(a.borderBottomWidth=c[k].width.V(b));a.Hb=!1;break;case "border":null!==c[k].color&&(a.borderLeftColor=
a.borderRightColor=a.borderTopColor=a.borderBottomColor=c[k].color);null!==c[k].style&&(a.borderLeftStyle=a.borderRightStyle=a.borderTopStyle=a.borderBottomStyle=c[k].style);null!==c[k].width&&(a.borderLeftWidth=a.borderRightWidth=a.borderTopWidth=a.borderBottomWidth=c[k].width.V(b));a.Hb=!0;break;case "border-top-left-radius":a.borderTopLeftRadius=c[k].map(function(r){return r.V(b)});a.Dc=!0;break;case "border-top-right-radius":a.borderTopRightRadius=c[k].map(function(r){return r.V(b)});a.Dc=!0;
break;case "border-bottom-right-radius":a.borderBottomRightRadius=c[k].map(function(r){return r.V(b)});a.Dc=!0;break;case "border-bottom-left-radius":a.borderBottomLeftRadius=c[k].map(function(r){return r.V(b)});a.Dc=!0;break;case "border-radius":a.borderTopLeftRadius=[c[k][0].V(b),c[k][4].V(b)];a.borderTopRightRadius=[c[k][1].V(b),c[k][5].V(b)];a.borderBottomRightRadius=[c[k][2].V(b),c[k][6].V(b)];a.borderBottomLeftRadius=[c[k][3].V(b),c[k][7].V(b)];a.Dc=!0;break;case "border-top-left-cut":a.borderTopLeftRadius=
c[k].map(function(r){return r.V(b)});a.mf=!0;a.Dc=!0;break;case "border-top-right-cut":a.borderTopRightRadius=c[k].map(function(r){return r.V(b)});a.nf=!0;a.Dc=!0;break;case "border-bottom-left-cut":a.Me=c[k].map(function(r){return r.V(b)});a.Me=!0;a.Dc=!0;break;case "border-bottom-right-cut":a.borderBottomRightRadius=c[k].map(function(r){return r.V(b)});a.lf=!0;a.Dc=!0;break;case "border-cut":a.borderTopLeftRadius=[c[k][0].V(b),c[k][4].V(b)];a.borderTopRightRadius=[c[k][1].V(b),c[k][5].V(b)];a.borderBottomRightRadius=
[c[k][2].V(b),c[k][6].V(b)];a.borderBottomLeftRadius=[c[k][3].V(b),c[k][7].V(b)];a.mf=!0;a.nf=!0;a.Me=!0;a.lf=!0;a.Dc=!0;break;case "backdrop-color":a.gf=c[k];break;case "background-color":case "background":a.backgroundColor=c[k];break;case "color":a.color=c[k];break;case "font":a.fontFamily=c[k].fontFamily;a.fontSize=c[k].fontSize.V(b);a.fontStyle=c[k].fontStyle;a.fontWeight=c[k].fontWeight;break;case "font-family":a.fontFamily=c[k];break;case "font-size":a.fontSize=c[k].V(b);break;case "font-style":a.fontStyle=
c[k];break;case "font-weight":a.fontWeight=c[k];break;case "overflow":a.scroll="scroll"===c[k];break;case "vertical-align":a.verticalAlign=c[k]instanceof Ae?c[k].V(b):c[k];break;case "box-shadow":null!==c[k].hc&&(a.hc=c[k].offset.map(function(r){return r?r.V(b):0}),a.Id=c[k].Jf?c[k].Jf.V(b):0,a.Ce=c[k].gg?c[k].gg.V(b):0,a.shadowColor=c[k].color);break;case "width":d=c[k].V(b);break;case "min-width":f=c[k].V(b);break;case "max-width":h=c[k].V(b);break;case "height":e=c[k].V(b);break;case "min-height":g=
c[k].V(b);break;case "max-height":l=c[k].V(b);break;default:c.hasOwnProperty(k)&&(a.ze[k]=c[k])}d=Math.max(Math.min(d,h),f);e=Math.max(Math.min(e,l),g);0<=d&&(a.width=d);0<=e&&(a.height=e)}N.setPosition=function(a,c){this.x=a+this.offsetLeft();this.y=c+this.offsetTop()};function ed(a){return a.width+ie(a)}N.ra=function(){return this.height+(this.marginTop+this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth+this.marginBottom)};
N.Uc=function(a){this.width=a-(this.marginLeft+this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth+this.marginRight)};N.Ec=function(a){this.height=a-(this.marginTop+this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth+this.marginBottom)};
N.sb=function(){var a=new vc;a.width=this.width;a.height=this.height;a.x=this.x;a.y=this.y;a.marginLeft=this.marginLeft;a.marginRight=this.marginRight;a.marginTop=this.marginTop;a.marginBottom=this.marginBottom;a.Hb=this.Hb;a.Dc=this.Dc;a.borderLeftWidth=this.borderLeftWidth;a.borderRightWidth=this.borderRightWidth;a.borderTopWidth=this.borderTopWidth;a.borderBottomWidth=this.borderBottomWidth;a.borderLeftStyle=this.borderLeftStyle;a.borderRightStyle=this.borderRightStyle;a.borderTopStyle=this.borderTopStyle;
a.borderBottomStyle=this.borderBottomStyle;a.borderLeftColor=this.borderLeftColor;a.borderRightColor=this.borderRightColor;a.borderTopColor=this.borderTopColor;a.borderBottomColor=this.borderBottomColor;a.borderTopLeftRadius=this.borderTopLeftRadius;a.borderTopRightRadius=this.borderTopRightRadius;a.borderBottomRightRadius=this.borderBottomRightRadius;a.borderBottomLeftRadius=this.borderBottomLeftRadius;a.mf=this.mf;a.nf=this.nf;a.Me=this.Me;a.lf=this.lf;a.Eb=this.Eb;a.paddingLeft=this.paddingLeft;
a.paddingRight=this.paddingRight;a.paddingTop=this.paddingTop;a.paddingBottom=this.paddingBottom;a.gf=this.gf;a.backgroundColor=this.backgroundColor;a.color=this.color;a.fontFamily=this.fontFamily;a.fontSize=this.fontSize;a.fontStyle=this.fontStyle;a.fontWeight=this.fontWeight;a.scroll=this.scroll;a.verticalAlign=this.verticalAlign;a.hc=this.hc;a.Id=this.Id;a.Ce=this.Ce;a.shadowColor=this.shadowColor;return a};N.offsetLeft=function(){return this.marginLeft+this.borderLeftWidth+this.paddingLeft};
function ie(a){return a.marginLeft+a.borderLeftWidth+a.paddingLeft+a.paddingRight+a.borderRightWidth+a.marginRight}N.offsetTop=function(){return this.marginTop+this.borderTopWidth+this.paddingTop};function Qd(a){return a.height+a.paddingTop+a.paddingBottom}function kd(a){return(a.fontStyle?a.fontStyle+" ":"")+(a.fontWeight?a.fontWeight+" ":"")+a.fontSize.toFixed(1)+"px "+a.fontFamily}
function He(a,c){this.margin=0;this.Oe=this.style=this.width=null;this.color="black";this.hc=null;this.Ce=this.Id=0;this.shadowColor=null;this.ze={};a&&Je(this,a.ud,c);null===this.width&&(this.width=null!==this.style&&"none"!==this.style?1:0);null===this.style&&(this.style=0<this.width?"solid":"none");null===this.Oe&&(this.Oe="butt")}He.prototype=Object.create(Ee.prototype);He.prototype.constructor=He;
function Je(a,c,b){for(var d in c)switch(d){case "margin":a.margin=c[d].V(b);break;case "line-width":a.width=c[d].V(b);break;case "line-style":a.style=c[d];break;case "line-cap":a.Oe=c[d];break;case "color":a.color=c[d];break;case "line":null!==c[d].color&&(a.color=c[d].color);null!==c[d].style&&(a.style=c[d].style);null!==c[d].width&&(a.width=c[d].width.V(b));break;case "line-shadow":null!==c[d].hc&&(a.hc=c[d].offset.map(function(e){return e?e.V(b):0}),a.Id=c[d].Jf?c[d].Jf.V(b):0,a.Ce=c[d].gg?c[d].gg.V(b):
0,a.shadowColor=c[d].color);break;default:c.hasOwnProperty(d)&&(a.ze[d]=c[d])}}He.prototype.sb=function(){var a=new He;a.margin=this.margin;a.width=this.width;a.style=this.style;a.Oe=this.Oe;a.color=this.color;a.hc=this.hc;a.Id=this.Id;a.Ce=this.Ce;a.shadowColor=this.shadowColor;return a};var Ke=!1;function Le(a,c,b,d){a.strokeStyle=b||"black";switch(d){case "dotted":a.setLineDash([2*c,3*c]);a.lineDashOffset=0;break;case "dashed":a.setLineDash([3*c,3*c]),a.lineDashOffset=0}a.lineWidth=c||0}
function hd(a,c,b,d,e){function f(){var k=Math.min(g.borderTopLeftRadius[0],h/2),r=Math.min(g.borderTopLeftRadius[1],l/2);c.moveTo(b,d+r);g.mf?c.lineTo(b+k,d):c.bezierCurveTo(b,d+r/2,b+k/2,d,b+k,d);k=Math.min(g.borderTopRightRadius[0],h/2);r=Math.min(g.borderTopRightRadius[1],l/2);c.lineTo(b+h-k,d);g.nf?c.lineTo(b+h,d+r):c.bezierCurveTo(b+h-k/2,d,b+h,d+r/2,b+h,d+r);k=Math.min(g.borderBottomRightRadius[0],h/2);r=Math.min(g.borderBottomRightRadius[1],l/2);c.lineTo(b+h,d+l-r);g.lf?c.lineTo(b+h-k,d+l):
c.bezierCurveTo(b+h,d+l-r/2,b+h-k/2,d+l,b+h-k,d+l);k=Math.min(g.borderBottomLeftRadius[0],h/2);r=Math.min(g.borderBottomLeftRadius[1],l/2);c.lineTo(b+k,d+l);g.Me?c.lineTo(b,d+l-r):c.bezierCurveTo(b+k/2,d+l,b,d+l-r/2,b,d+l-r);c.closePath()}e||(b-=a.paddingLeft,d-=a.paddingTop);var g=a,h=a.width+a.paddingLeft+a.paddingRight,l=a.height+a.paddingTop+a.paddingBottom;Ke&&(c.save(),c.strokeStyle="black",c.lineWidth=1,c.strokeRect(b,d,h,l),c.strokeRect(b+a.paddingLeft,d+a.paddingTop,a.width,a.height),c.strokeRect(b-
a.marginLeft,d-a.marginTop,h+a.marginLeft+a.marginRight,l+a.marginTop+a.marginBottom),c.restore());c.save();0<a.Eb&&(c.beginPath(),c.rect(b-a.Eb,d-a.Eb,2*a.Eb,2*a.Eb),c.rect(b+h-a.Eb,d-a.Eb,2*a.Eb,2*a.Eb),c.rect(b-a.Eb,d+l-a.Eb,2*a.Eb,2*a.Eb),c.rect(b+h-a.Eb,d+l-a.Eb,2*a.Eb,2*a.Eb),c.clip());"transparent"!==a.gf&&(c.fillStyle=a.gf,c.fillRect(b,d,h,l));c.beginPath();a.Dc?(c.beginPath(),f()):c.rect(b,d,h,l);c.save();a.hc&&(c.shadowOffsetX=a.hc[0],c.shadowOffsetY=a.hc[1],c.shadowColor=a.shadowColor,
c.shadowBlur=a.Id);a.backgroundColor?c.fillStyle=a.backgroundColor:a.hc&&(c.fillStyle="transparent");c.fill();c.restore();a.Hb?0<a.borderLeftWidth&&a.borderLeftColor&&"none"!==a.borderLeftStyle&&"hidden"!==a.borderLeftStyle&&(Le(c,a.borderLeftWidth,a.borderLeftColor,a.borderLeftStyle),"double"===a.borderLeftStyle&&(c.save(),c.translate(b+h/2,d+l/2),c.scale((h-3*a.borderLeftWidth)/h,(l-3*a.borderLeftWidth)/l),c.translate(-b-h/2,-d-l/2),f(),c.restore()),c.stroke()):(0<a.borderLeftWidth&&a.borderLeftColor&&
"none"!==a.borderLeftStyle&&"hidden"!==a.borderLeftStyle&&(Le(c,a.borderLeftWidth,a.borderLeftColor,a.borderLeftStyle),c.beginPath(),c.moveTo(b,d),c.lineTo(b,d+l),c.stroke()),0<a.borderRightWidth&&a.borderRightColor&&"none"!==a.borderRightStyle&&"hidden"!==a.borderRightStyle&&(Le(c,a.borderRightWidth,a.borderRightColor,a.borderRightStyle),c.beginPath(),c.moveTo(b+h,d),c.lineTo(b+h,d+l),c.stroke()),0<a.borderTopWidth&&a.borderTopColor&&"none"!==a.borderTopStyle&&"hidden"!==a.borderTopStyle&&(Le(c,
a.borderTopWidth,a.borderTopColor,a.borderTopStyle),c.beginPath(),c.moveTo(b,d),c.lineTo(b+h,d),c.stroke()),0<a.borderBottomWidth&&a.borderBottomColor&&"none"!==a.borderBottomStyle&&"hidden"!==a.borderBottomStyle&&(Le(c,a.borderBottomWidth,a.borderBottomColor,a.borderBottomStyle),c.beginPath(),c.moveTo(b,d+l),c.lineTo(b+h,d+l),c.stroke()));c.restore();Ke&&a.ze["-vpl-debug"]&&(c.save(),c.font="9px sans-serif",c.textAlign="start",c.textBaseline="top",c.fillStyle="black",c.fillText(a.ze["-vpl-debug"],
b,d),c.restore())}vc.prototype.J=function(a){hd(this,a,this.x,this.y)};He.prototype.stroke=function(a){a.save();this.hc&&(a.shadowOffsetX=this.hc[0],a.shadowOffsetY=this.hc[1],a.shadowColor=this.shadowColor,a.shadowBlur=this.Id);0<this.width&&this.color&&"none"!==this.style&&"hidden"!==this.style&&(Le(a,this.width,this.color,this.style),a.lineCap=this.Oe,a.stroke());a.restore()};function Ed(a,c,b,d,e,f,g,h,l,k){this.data=a;this.width=c;this.height=b;this.x=d;this.y=e;this.i=null;this.pa=[];this.H=f;this.u=null;this.l=this.Za=!0;this.Ha=null;this.b=g||null;this.pb=h||null;this.gb=l||null;this.pg=this.rb=!1;this.Ac=this.doScroll=null;this.id=k||"";this.w=this.qa=this.aa=this.S=null}Ed.prototype.clone=function(){var a=new Ed(this.data,this.width,this.height,this.x,this.y,this.H,this.b,this.pb,this.gb,this.id);a.u=this.u;return a};
Ed.prototype.J=function(a,c,b,d,e){var f=a.N,g=this.i&&void 0===c;g&&(f.save(),f.beginPath(),f.rect(this.i.x,this.i.y,this.i.sc,this.i.ld),f.clip(),c=this.i.Vg,b=this.i.Wg);d?this.u&&this.u(a,this,c||0,b||0,e):this.H&&this.H(a,this,c||0,b||0,e);g&&f.restore()};Ed.prototype.toDataURL=function(a,c,b){var d=document.createElement("canvas");c=c||1;d.width=c*this.width;d.height=c*this.height;c=new $b(d,{xh:c});c.A=a;this.J(c);this.J(c,0,0,!0);return d.toDataURL(b||"image/png")};
function Me(a){return a.i?{Kb:a.i.Vg,Lb:a.i.Wg}:{Kb:0,Lb:0}}
function $b(a,c){function b(f){function g(m){var p=e.b.getBoundingClientRect(),q=Me(m);m.w=m.b.fa?m.b.fa(e,m.data,m.width,m.height,p.left+m.x+q.Kb,p.top+m.y+q.Lb,h):0;return null!==m.w?(m.b.Pa&&m.b.Pa(e,m.data,m.w,m.width,m.height,p.left+m.x+q.Kb,p.top+m.y+q.Lb,h),e.qa&&e.qa(),e.Db?e.Db():Fc(e),Ne=m.b.Pa||m.b.dd?function(A,t){t?m.b.dd&&m.b.dd&&(m.b.dd(e,m.data,m.w,m.width,m.height,p.left+m.x+q.Kb,p.top+m.y+q.Lb,Oe(e,A)),e.qa&&e.qa(),e.Db?e.Db():Fc(e)):m.b.Pa&&(m.b.Pa(e,m.data,m.w,m.width,m.height,
p.left+m.x+q.Kb,p.top+m.y+q.Lb,Oe(e,A)),e.qa&&e.qa(),e.Db?e.Db():Fc(e))}:null,e.qa&&e.qa(),e.Db?e.Db():Fc(e),!m.l||null!=m.b&&null!=m.b.Pa):!1}if(e.S){for(var h=Oe(e,f),l=0;l<e.rb.length;l++)if(!e.rb[l](f,h))return;if(Pe(e,h)){var k=e.Qb;k.b&&g(k)}else if(e.Qb)e.w=-1,e.Qb=null,e.qa&&e.qa(),e.Db?e.Db():Fc(e);else{var r=Qe(e,h,!0);if(0<r.length){if(k=e.ob[r[0]],0<=e.w&&e.w!==r[0]&&(e.w=-1,e.Qb=null),e.uc=Date.now(),(!k.b||(f instanceof MouseEvent?k.S:k.aa)&&e.w!==r[0]||!g(k))&&k.l){var u=k.Ha?k.Ha(k):
k,y=null,E=Me(u),x=h.x-E.Kb,n=h.y-E.Lb,w=Ne;Ne=function(m,p,q){var A=Oe(e,m);e.dg&&e.dg(p?null:k);if(p){if((q?k.aa:k.S)&&10>Math.abs(A.x-E.Kb-x)+Math.abs(A.y-E.Lb-n))e.w=r[0],e.Qb=(q?k.aa:k.S)(k,q);else{if(k.b&&k.b.dd&&10>Math.abs(A.x-E.Kb-x)+Math.abs(A.y-E.Lb-n)){w(m,p,q);return}if(y&&y.pb&&(!y.gb||y.gb(y,u)))y.pb(y,u);else if(null==y||null==y.pb||y.gb&&!y.gb(y,u)){for(p=0;p<e.pa.length&&!e.pa[p].pb(y,u,A.x,A.y);p++);p>=e.pa.length&&e.Ha&&e.Ha()}else e.Ha&&e.Ha()}Fc(e);e.b.style.cursor="default"}else{q=
Qe(e,A,!1);y=null;m=!1;for(p=0;!m&&p<q.length;p++)y=e.ob[q[p]],m=y.pb&&(!y.gb||y.gb(y,u));m&&null!=y?(y.pg=!0,Fc(e),y.pg=!1):Fc(e);p=e.N;m&&!y.rb&&(q=Me(y),Gd(e,y.x+q.Kb,y.y+q.Lb,y.width,y.height,["drop-target"]));p.save();Re(e);e.transform&&(p.translate(e.width/2,e.height/2),CanvasRenderingContext2D.prototype.transform.apply(p,e.transform),p.translate(-e.width/2,-e.height/2));p.translate(e.l*e.Ja.Y,e.i*e.Ja.ca);p.globalAlpha=.5;u.J(e,A.x-x,A.y-n);u.pa.forEach(function(t){t.J(e,A.x-x,A.y-n);t.J(e,
A.x-x,A.y-n,!0)});u.J(e,A.x-x,A.y-n,!0);p.restore();e.b.style.cursor=m?"copy":"default"}}}}else 0<=e.w&&(e.w=-1,e.Qb=null,Fc(e))}}}var d=c&&c.xh||("devicePixelRatio"in window?window.devicePixelRatio:1);this.b=a;this.l=a.width/d;this.i=a.height/d;this.Ja=c&&c.Ja||{Y:0,na:1,ca:0,oa:1};this.width=this.l*(this.Ja.na-this.Ja.Y);this.height=this.i*(this.Ja.oa-this.Ja.ca);this.S=!0;this.rb=[];this.transform=this.Jb=null;this.N=this.b.getContext("2d");this.Za=this.state=null;this.dg=c&&c.dg||null;this.pa=
[];this.Ha=null;this.uc=0;this.w=-1;this.Qb=null;this.u={};this.clientData={};this.ia=c&&c.ia||new Zb;this.A=null;this.resize(this.width,this.height,c&&c.xh);this.aa={};var e=this;a.addEventListener("mousedown",b,!1);a.addEventListener("touchstart",function(f){var g=f.targetTouches;1===g.length&&(f.preventDefault(),b(g[0]),Se=g[0])},!1);a.addEventListener("wheel",function(f){function g(k){k.doScroll&&(f.preventDefault(),k.doScroll(0===f.deltaMode?f.deltaX:1===f.deltaMode?10*f.deltaX:30*f.deltaX,0===
f.deltaMode?f.deltaY:1===f.deltaMode?10*f.deltaY:30*f.deltaY))}if(e.S){var h=Oe(e,f);if(Pe(e,h))e.Qb&&g(e.Qb);else if(0>e.w){h=Qe(e,h,!0);for(var l=0;l<h.length;l++)if(null!=e.ob[h[l]].doScroll){g(e.ob[h[l]]);break}}}},!1);a.addEventListener("mousemove",function(f){if(e.S){for(var g=Qe(e,Oe(e,f),!0),h=0;h<g.length;h++)if(null!=e.ob[g[h]].Ac){f.preventDefault();e.ob[g[h]].Ac();return}e.Za&&e.Za()}},!1);this.ob=[];this.H=[];this.Db=this.qa=null}function fc(a,c){a.rb.push(c)}
function Mc(a,c){a.Ja=c||{Y:0,na:1,ca:0,oa:1};a.width=a.l*(a.Ja.na-a.Ja.Y);a.height=a.i*(a.Ja.oa-a.Ja.ca)}function ae(a,c){for(var b=0;b<a.pa.length;b++)if("delete"===a.pa[b].tag){a.pa[b].pb=c;return}a.pa.push({tag:"delete",pb:c})}$b.prototype.show=function(){this.S=!0};$b.prototype.wc=function(){this.S=!1};function Te(a,c){a.b.style.filter=c}function Ue(a,c){a.Jb=c&&c.slice();a.transform=a.Jb}
function Oe(a,c){c={x:c.clientX,y:c.clientY,ei:c.altKey};var b=[c.x,c.y];b=[b[0]-a.l*a.Ja.Y,b[1]-a.i*a.Ja.ca];var d=a.transform;if(d){var e=a.width/2;a=a.height/2;d=d.slice(0,4).concat(d[4]-e*d[0]-a*d[2]+e,d[5]-e*d[1]-a*d[3]+a);a=d[0]*d[3]-d[1]*d[2];b=[(d[3]*b[0]-d[2]*b[1]+d[2]*d[5]-d[3]*d[4])/a,(-d[1]*b[0]+d[0]*b[1]+d[1]*d[4]-d[0]*d[5])/a]}c.x=b[0];c.y=b[1];return c}function Ve(a){a.qa&&a.qa();a.Db?a.Db():Fc(a)}
function wc(a,c){return{m:a,ph:60,qh:120,jh:!1,ua:Math.max(1,Math.min(3,Math.round(a/40))),ng:Math.round(a/4).toString(10)+"px sans-serif",wi:"navy",xi:"#37f",vi:"#06f",g:c,Ca:Math.max(1,Math.min(3,c/30)),Zh:"bold 15px sans-serif",Kg:"navy",Jg:"#ccc",vd:5,qg:"#e44",Ug:"#f88",Ig:"#bbb"}}
function Zd(a,c){a.width=a.l*(a.Ja.na-a.Ja.Y);a.height=a.i*(a.Ja.oa-a.Ja.ca);a.N=a.b.getContext("2d");c=c||("devicePixelRatio"in window?window.devicePixelRatio:1);1!=c&&(a.N.resetTransform(),a.N.scale(c,c));a.ia.b=new Ce(a.width,a.width/100,a.height/100,a.l/100,a.i/100);c=wd(a.ia,{tag:"block"}).width;var b=wd(a.ia,{tag:"button"}).width;a.A=wc(c,b)}
$b.prototype.resize=function(a,c,b){var d=b||("devicePixelRatio"in window?window.devicePixelRatio:1);this.b.width=a*d;this.b.height=c*d;this.b.style.width=a+"px";this.b.style.height=c+"px";this.l=a;this.i=c;Zd(this,b)};function Hd(a,c){for(var b=0;b<a.ob.length;b++)if(a.ob[b].data===c)return b;return-1}
function Qe(a,c,b){var d=a.b.getBoundingClientRect(),e=c.x-d.left;c=c.y-d.top;d=[];for(var f=a.ob.length-1;0<=f;f--){var g=Me(a.ob[f]);if(g=(!b||a.ob[f].Za)&&e>=a.ob[f].x+g.Kb&&e<=a.ob[f].x+g.Kb+a.ob[f].width&&c>=a.ob[f].y+g.Lb&&c<=a.ob[f].y+g.Lb+a.ob[f].height)g=a.ob[f],g=!g.i||e>=g.i.x&&e<g.i.x+g.i.sc&&c>=g.i.y&&c<g.i.y+g.i.ld;g&&d.push(f)}return d}
function ad(a,c){var b=c.clone();a=$d(a);var d=Math.min(a.width,a.height)/1.5/b.width;b.width*=d;b.height*=d;b.x=(a.width-b.width)/2;b.y=(a.height-b.height)/2;b.S=null;b.aa=null;b.H=function(e,f){var g=e.N;g.save();g.translate(f.x,f.y);g.scale(d,d);g.translate(-f.x,-f.y);c.H(e,b,f.x-b.x,f.y-b.y,!0);g.restore()};c.u&&(b.u=function(e,f){var g=e.N;g.save();g.translate(f.x,f.y);g.scale(d,d);g.translate(-f.x,-f.y);c.u(e,b,f.x-b.x,f.y-b.y,!0);g.restore()});return b}
function Pe(a,c){if(null==a.Qb)return!1;var b=a.b.getBoundingClientRect(),d=c.x-b.left;c=c.y-b.top;return d>=a.Qb.x&&d<=a.Qb.x+a.Qb.width&&c>=a.Qb.y&&c<=a.Qb.y+a.Qb.height}function $d(a){return{width:a.width,height:a.height}}function Re(a){a.N.beginPath();a.N.rect(a.l*a.Ja.Y,a.i*a.Ja.ca,a.l*(a.Ja.na-a.Ja.Y),a.i*(a.Ja.oa-a.Ja.ca));a.N.clip()}
function We(a,c,b,d,e,f,g){f=f||0;g=g||0;if(0<a.H.length){var h=a.H[a.H.length-1];h.x>c&&(d-=h.x-c,c=h.x);h.x+h.sc<c+d&&(d=h.x+h.sc-c);h.y>b&&(e-=h.y-b,b=h.y);h.y+h.ld<b+e&&(e=h.y+h.ld-b);f+=h.Vg;g+=h.Wg}a.H.push({x:c,y:b,sc:d,ld:e,Vg:f,Wg:g})}function Kd(a,c,b){0<a.H.length&&(c.i=a.H[a.H.length-1]);0<=b?a.ob[b]=c:a.ob.push(c)}function gd(a,c){var b=new Ed(null,-1,-1,0,0,function(d,e,f,g){d=d.N;d.save();d.translate(e.x+f,e.y+g);c(d);d.restore()});Kd(a,b);return b}
function id(a,c,b,d,e,f,g){var h,l=new Ed(null,d.width,d.height,c,b,function(k,r,u,y){k=k.N;k.save();hd(d,k,r.x+u,r.y+y);k.translate(r.x+u,r.y+y);e(k,d,a.u.id===g&&a.u.Zd||r.pg);k.restore()},f&&(f.action||f.me||f.oe)?{fa:function(k,r,u,y,E,x,n){a.u={id:g,rect:{x:l.x,y:l.y,sc:u,ld:y},Zd:!0};h=n;f.me&&f.me(h);Fc(a);return 0},Pa:function(k,r,u,y,E,x,n,w){u=k.b.getBoundingClientRect();r=w.x-u.left;w=w.y-u.top;a.u.Zd=r>=a.u.rect.x&&r<a.u.rect.x+a.u.rect.sc&&w>=a.u.rect.y&&w<a.u.rect.y+a.u.rect.ld;Fc(k)},
dd:function(){f.action?a.u.Zd&&f.action(h):f.oe&&f.oe(h);a.u={};Fc(a)}}:null,f&&f.pb,f&&f.gb,g);l.Ac=f&&f.Ac||null;l.l=!1;l.rb=!0;Kd(a,l);return l}function Rd(a,c,b,d,e){hd(e,a.N,b-e.width/2,d-e.height/2);var f=a.aa[c];void 0!=f&&(a.N.save(),a.N.translate(b,d),f(a.N,c,a.A,e),a.N.restore())}
function Fc(a){a.S&&(a.N.clearRect(a.l*a.Ja.Y,a.i*a.Ja.ca,a.l*(a.Ja.na-a.Ja.Y),a.i*(a.Ja.oa-a.Ja.ca)),a.N.save(),a.transform&&(a.N.translate(a.width/2,a.height/2),CanvasRenderingContext2D.prototype.transform.apply(a.N,a.transform),a.N.translate(-a.width/2,-a.height/2)),a.N.translate(a.l*a.Ja.Y,a.i*a.Ja.ca),a.ob.forEach(function(c){c.J(this)},a),a.ob.forEach(function(c){c.J(this,void 0,void 0,!0)},a),a.Qb&&(a.N.save(),a.N.globalAlpha=.5,a.N.fillStyle="black",a.N.fillRect(a.l*a.Ja.Y,a.i*a.Ja.ca,a.l*
(a.Ja.na-a.Ja.Y),a.i*(a.Ja.oa-a.Ja.ca)),a.N.restore(),a.Qb.J(a),a.Qb.J(a,0,0,!0)),a.N.restore())};function zd(){this.w=this.H=1;this.i=this.l=this.y=this.x=0;this.S=!1;this.pa="";this.Ge=this.b=this.Fe=this.u=0;this.aa=null}N=zd.prototype;N.Uc=function(a){this.H=a;this.u=Math.max(0,Math.min(this.u,this.H-this.l))};N.Ec=function(a){this.w=a;this.b=Math.max(0,Math.min(this.b,this.w-this.i))};N.resize=function(a,c,b,d){this.x=a;this.y=c;this.l=b;this.i=d;this.u=Math.max(0,Math.min(this.u,this.H-this.l));this.b=Math.max(0,Math.min(this.b,this.w-this.i))};
N.ie=function(a){this.aa=a;var c=this,b=new Ed(null,this.l,this.i,this.x,this.y,null,this.H>this.l||this.w>this.i?{fa:function(d,e,f,g,h,l,k){c.Fe=k.x;c.Ge=k.y;return 0},Pa:function(d,e,f,g,h,l,k,r){d=Math.max(Math.min(r.x-c.Fe,c.u),c.u-c.H+c.l);c.u-=d;c.Fe+=d;r=Math.max(Math.min(r.y-c.Ge,c.b),c.b-c.w+c.i);c.b-=r;c.Ge+=r}}:null,null,null);b.l=!1;b.doScroll=function(d,e){c.u+=d;c.b+=e;a.qa()};Kd(a,b);this.pa&&gd(a,function(d){d.save();d.fillStyle=c.pa;d.fillRect(c.x,c.y,c.l,c.i);d.restore()});(this.H>
this.l||this.w>this.i)&&gd(a,function(d){d.save();if(c.H>c.l){var e=c.l/c.H;e=Math.max(e*c.l,Math.min(20,c.l));var f=c.l-e,g=c.u/(c.H-c.l);f*=g;d.fillStyle=a.A.Jg;d.fillRect(c.x,c.y+c.i+2,c.l,a.A.vd);d.fillStyle=a.A.Kg;d.fillRect(c.x+f,c.y+c.i+2,e,a.A.vd)}c.w>c.i&&(e=c.i/c.w,e=Math.max(e*c.i,Math.min(20,c.i)),f=c.i-e,g=c.b/(c.w-c.i),f*=g,d.save(),d.fillStyle=a.A.Jg,d.fillRect(c.S?c.x-2-a.A.vd:c.x+c.l+2,c.y,a.A.vd,c.i),d.fillStyle=a.A.Kg,d.fillRect(c.S?c.x-2-a.A.vd:c.x+c.l+2,c.y+f,a.A.vd,e));d.restore()});
We(a,this.x,this.y,this.l,this.i,-this.u,-this.b)};N.end=function(){this.aa.H.pop()};function ke(a,c,b){b-a.b>a.i&&(a.b=b-a.i);c<a.b&&(a.b=c)}function ge(a){return a.b<=.001*a.i}function he(a){return a.b>=a.w-1.001*a.i};function Gd(a,c,b,d,e,f){f=wd(a.ia,{tag:"overlay-rectangle",ga:f||[]});f.x=c;f.y=b;f.width=d;f.height=e;f.J(a.N)}
function jd(a,c,b,d,e,f,g,h){Gd(a,c,b,d,e,(f||[]).concat("disabled"));if(!h){a.N.save();f=Xd(a.ia,{tag:"crossout-line",ga:g||[]});a.N.beginPath();h=a.ia;g=/^(-?([0-9]+\.?|[0-9]*\.[0-9]+))([a-z]*)$/.exec(f.ze["line-angle"]||"0");if(null==g)throw"Illegal angle";if(h.aa.hasOwnProperty(g[3]))h=h.aa[g[3]];else if(0==parseFloat(g[1]))h=0;else throw"Unknown angle unit";g=parseFloat(g[1])*h;h=oe(a.ia,f.ze["line-overflow"]||"0").V(a.ia.b);if(Math.abs(g%Math.PI)<.25*Math.PI||Math.abs((Math.PI-g)%Math.PI)<.25*
Math.PI){h=(d/2+h)*Math.sign(Math.cos(g));var l=e/2*Math.sin(g)*Math.sqrt(2)}else l=(e/2+h)*Math.sign(Math.sin(g)),h=d/2*Math.cos(g)*Math.sqrt(2);a.N.moveTo(c+d/2-h,b+e/2-l);a.N.lineTo(c+d/2+h,b+e/2+l);f.stroke(a.N);a.N.restore()}}
function md(a,c,b,d,e,f){a.save();a.strokeStyle=e;a.fillStyle=e;a.lineWidth=d;a.fillRect(c-2.5*d,b-d,5*d,4*d);a.beginPath();a.moveTo(c-1.7*d,b);a.lineTo(c-1.7*d,b);f?(a.arc(c-3.4*d,b-2*d,1.7*d,0,Math.PI,!0),a.lineTo(c-5.1*d,b)):(a.arc(c,b-2*d,1.7*d,-Math.PI,0),a.lineTo(c+1.7*d,b));a.stroke();a.restore()}function Fd(a,c,b,d,e,f,g){var h=.03*a.A.m;md(a.N,c+d+(f?-5:5)*h,b+.15*e,h,g||"#333")}
function od(a,c,b,d,e,f,g){a.save();g&&(g.style&&(a.strokeStyle=g.style,a.fillStyle=g.style),void 0!==g.lineWidth&&(a.lineWidth=g.lineWidth),void 0!==g.alpha&&(a.globalAlpha=g.alpha));var h=g&&void 0!==g.Xc?g.Xc:5*a.lineWidth;a.beginPath();var l=e+(g&&g.Ad?h/d:0),k=f-(g&&g.Ad?0:h/d);a.arc(c,b,d,l,k);a.stroke();g&&g.Ad?(a.translate(c+d*Math.cos(e),b+d*Math.sin(e)),a.rotate((e+l)/2+Math.PI)):(a.translate(c+d*Math.cos(f),b+d*Math.sin(f)),a.rotate((f+k)/2));a.beginPath();a.moveTo(0,0);a.lineTo(h/2,1.2*
-h);a.lineTo(-h/2,1.2*-h);a.fill();a.restore()}$b.prototype.text=function(a,c){var b=this.N,d=this.A;b.save();b.fillStyle=c&&c.fillStyle||"white";b.font=d.ng;b.textAlign="center";b.textBaseline="middle";b.translate(.5*d.m+(c&&c.x||0),.5*d.m-(c&&c.y||0));c&&c.hi&&b.rotate(-c.hi);b.translate(-.5*d.m,-.5*d.m);b.fillText(a,.5*d.m,.5*d.m);b.restore()};
function Xe(a,c){var b=a.N,d=a.A;b.save();b.beginPath();b.rect(0,0,a.A.m,a.A.m);b.clip();c&&(c.scale||c.rotation)&&(c.cf&&b.translate(-c.cf[0],-c.cf[1]),b.translate(.5*d.m,.5*d.m),c.scale&&b.scale(c.scale,c.scale),c.rotation&&b.rotate(-c.rotation),b.translate(-.5*d.m,-.5*d.m));b.beginPath();b.moveTo(.5*d.m,d.m-d.ua);c&&"left"===c.zf||(b.lineTo(d.m-d.ua,d.m-d.ua),b.lineTo(d.m-d.ua,.25*d.m),b.bezierCurveTo(.8*d.m,d.ua,.52*d.m,d.ua,.5*d.m,d.ua));c&&"right"===c.zf||(b.lineTo(.5*d.m,d.ua),b.bezierCurveTo(.48*
d.m,d.ua,.2*d.m,d.ua,d.ua,.25*d.m),b.lineTo(d.ua,d.m-d.ua));b.closePath();if(c&&c.nc){a=[c.nc[0],Math.max(.2+.8*c.nc[1],c.nc[2]/2),c.nc[2]];var e=Math.max(a[0],Math.max(a[1],a[2]));b.fillStyle="rgb("+a.map(function(f){return Math.round(225*(1-e)+(30+225*e)*f)}).join(",")+")"}else b.fillStyle="white";b.fill();c&&c.nc&&(b.strokeStyle="white",b.lineWidth=d.ua,b.stroke());c&&c.Lc&&(b.fillStyle="black",b.fillRect(0,.6*d.m,.1*d.m,.35*d.m),b.fillRect(.9*d.m,.6*d.m,.1*d.m,.35*d.m));b.restore()}
function Ye(a,c){var b=(c-a)/2,d=c===a?Infinity:(c+a)/(2*b);return{kb:b,kg:d,x:Math.abs(d)>1E3*Math.abs(a+c)?0:d*(.01>b?b*b/2:1-Math.cos(b)),y:Math.abs(d)>1E3*Math.abs(a+c)?(a+c)/2:d*Math.sin(b)}}
function Ze(a,c,b,d,e){var f=a.N;a=a.A;d*=a.m;var g=e&&e.r||[-1,0,1],h=e&&e.color||"black";e=e&&void 0!==e.vf?e.vf:1;var l=Ye(c,b);f.save();f.translate(.5*a.m,.5*a.m);f.strokeStyle=h;f.lineWidth=a.ua*e;20<Math.abs(l.kg)?(f.beginPath(),g.forEach(function(k){f.moveTo(k*d,0);f.lineTo((l.x+k)*d,-l.y*d)}),f.stroke()):g.forEach(function(k){f.beginPath();var r=-l.kg*d;k=(l.kg+k)*d;var u=l.kb;0<k?f.arc(r,0,k,0,-u,0<u):0>k&&f.arc(r,0,-k,Math.PI,Math.PI-u,0<u);f.stroke()});f.restore();return l}
function $e(a,c,b,d,e,f,g){a=a.A;e*=a.m;f*=a.m;a=.21*a.m;b=g.x-b-c/2;c=d+c/2-g.y;e=Ye(e,f);return(b-e.x)*(b-e.x)+(c-e.y)*(c-e.y)<a*a}
function af(a){var c=a.N;a=a.A;c.save();c.translate(.5*a.m,.5*a.m);c.scale(.7,.7);c.translate(-.5*a.m,-.5*a.m);c.fillStyle="white";c.fillRect(a.ua,.45*a.m,a.m-2*a.ua,.35*a.m);c.fillStyle="black";c.beginPath();c.arc(.27*a.m,.72*a.m,.2*a.m,0,2*Math.PI);c.fill();c.fillStyle="white";c.beginPath();c.arc(.27*a.m,.72*a.m,.12*a.m,0,2*Math.PI);c.fill();c.beginPath();c.arc(.8*a.m,.8*a.m-a.ua,.1*a.m,0,2*Math.PI);c.fill();c.restore()}
function bf(a){var c=a.N;a=a.A;c.save();c.lineWidth=a.ua;c.strokeStyle="white";for(var b=1;3>=b;b++)c.beginPath(),c.arc(.185*a.m,.48*a.m,.05*a.m*b,.9*Math.PI,1.7*Math.PI),c.stroke();c.restore()}
$b.prototype.buttons=function(a,c,b){var d=this.N,e=this.A;a.forEach(function(f,g){d.save();d.translate(e.m*(.5+f.x),e.m*(.5-f.y));d.rotate(f.r||0);d.fillStyle=f.fillStyle?f.fillStyle:b&&b.tg&&c?b.tg[c[g]]:c&&!0===c[g]?"red":c&&1===c[g]?"#f66":c&&-1===c[g]?"#333":"white";d.strokeStyle=f.strokeStyle?f.strokeStyle:b&&b.Lg&&c?b.Lg[c[g]]:!c||1!==c[g]&&!0!==c[g]?c&&0>c[g]?"black":"#aaa":"#700";d.lineWidth=e.ua;d.lineJoin="round";var h=f.size||1;switch(f.C){case "r":d.fillRect(.08*-e.m*h,.08*-e.m*h,.16*
e.m*h,.16*e.m*h);d.strokeRect(.08*-e.m*h,.08*-e.m*h,.16*e.m*h,.16*e.m*h);break;case "t":d.beginPath();d.moveTo(0,-.122*e.m*h);d.lineTo(.106*e.m*h,.062*e.m*h);d.lineTo(-.106*e.m*h,.062*e.m*h);d.closePath();d.fill();d.stroke();break;case "c":d.beginPath(),d.arc(0,0,.112*e.m*h,0,2*Math.PI),d.fill(),d.stroke()}c&&b&&void 0!==b.ke&&b.ke===c[g]&&(d.strokeStyle="white",d.beginPath(),d.moveTo(.06*-e.m*h,.06*-e.m*h),d.lineTo(.06*e.m*h,.06*e.m*h),d.moveTo(.06*-e.m*h,.06*e.m*h),d.lineTo(.06*e.m*h,.06*-e.m*h),
d.stroke());d.restore()})};function cf(a,c,b,d,e,f,g,h,l){var k=a.N;a=a.A;k.save();k.strokeStyle="black";k.lineWidth=a.ua*l;l=c.length/2;for(var r=0;r<l;r++)0<c[2*r+1]&&(k.fillStyle=2===c[2*r+1]?"white":"black",k.beginPath(),k.arc(a.m*(b+(d-b)/l*(r+.5)),a.m*(e+(f-e)/g*(c[2*r]+.5)),a.m*h/2,0,2*Math.PI),k.fill(),k.stroke());k.restore()}
function df(a,c){var b=a.N,d=a.A,e=null===c?-.15*d.m:0;b.save();b.beginPath();b.moveTo(.4*d.m+e,.3*d.m);b.lineTo(.4*d.m+e,.7*d.m);b.lineTo(.7*d.m+e,.7*d.m);b.lineTo(.7*d.m+e,.37*d.m);b.lineTo(.63*d.m+e,.3*d.m);b.closePath();b.lineWidth=d.ua;b.strokeStyle="white";b.lineJoin="round";b.stroke();for(var f=.15;.31>f;f+=.06)b.beginPath(),b.arc(.65*d.m+e,.5*d.m,d.m*f,-.6,.6),b.stroke();null===c?(b.beginPath(),b.moveTo(.12*d.m,.6*d.m),b.lineTo(.88*d.m,.4*d.m),b.lineWidth=1.5*d.ua,b.stroke()):a.text(c.toString(10),
{x:-.3*d.m});b.restore()}function ef(a){var c=a.N;a=a.A;c.beginPath();c.arc(0,0,.4*a.m,0,2*Math.PI,!0);c.moveTo(0,0);c.lineTo(0,.4*-a.m);c.strokeStyle="#666";c.lineWidth=a.ua;c.stroke();c.beginPath();c.arc(0,.4*-a.m,.1*a.m,0,2*Math.PI);c.fillStyle="white";c.fill();c.strokeStyle="black";c.stroke()}
function ff(a,c,b){var d=a.N,e=a.A;b=b*Math.PI/12;d.save();d.translate(.5*e.m,.5*e.m);d.rotate(b);ef(a);d.fillRect(-.28*e.m,-.1*e.m,.56*e.m,.2*e.m);d.fillStyle="black";c?(d.beginPath(),d.arc(-.15*e.m,.03*e.m,.11*e.m,0,2*Math.PI),d.fill(),d.fillStyle="white",d.beginPath(),d.arc(-.15*e.m,.03*e.m,.07*e.m,0,2*Math.PI),d.fill(),d.beginPath(),d.arc(.15*e.m,.07*e.m,.06*e.m,0,2*Math.PI)):(d.fillRect(-.28*e.m,.1*e.m,.08*e.m,.04*e.m),d.fillRect(.2*e.m,.1*e.m,.08*e.m,.04*e.m),d.fillStyle="white",d.beginPath(),
d.arc(0,.06*e.m,.06*e.m,0,2*Math.PI));d.fill();d.restore()}function gf(a,c,b,d,e){c=d.x-c-a/2;b=b+a/2-d.y;a=(c*c+b*b)/(a*a/4);return 1>a&&.4<a&&(e||0<=b)}function hf(a,c,b,d,e){a=Math.round(12*Math.atan2(d.x-c-a/2,b+a/2-d.y)/Math.PI);return e?12===a?-12:a:Math.max(-6,Math.min(6,a))}
function jf(a,c,b,d,e,f,g,h,l){var k=l?0>=g?0:Math.max(Math.log(10*g)/Math.log(100),0):g/4;a.save();!h&&f&&f(g);a.beginPath();a.arc(c,b,d,0,2*Math.PI);a.fillStyle="white";a.fill();f=.9*d;g=l?.8*d:.6*d;var r=2*Math.PI*(h?.2:k),u=h?"#ddd":"red";l=(g-(l?.5*d:.6*d))/4;a.save();a.beginPath();a.arc(c,b,f,-Math.PI/2,3*Math.PI/2-.05);a.arc(c,b,g-4*l,3*Math.PI/2-.05,Math.PI,!0);a.arc(c+l,b,g-3*l,Math.PI,Math.PI/2,!0);a.arc(c+l,b-l,g-2*l,Math.PI/2,0,!0);a.arc(c,b-l,g-l,0,-Math.PI/2,!0);a.clip();a.fillStyle=
u;a.beginPath();a.arc(c,b,f,-Math.PI/2,-Math.PI/2+r);a.lineTo(c,b);a.fill();a.restore();a.beginPath();a.arc(c,b,d/2,0,2*Math.PI);a.fill();a.beginPath();a.arc(c,b,d,0,2*Math.PI);a.strokeStyle="black";a.lineWidth=e;a.stroke();a.beginPath();a.moveTo(c-.1*d*Math.sin(2*k*Math.PI),b+.1*d*Math.cos(2*k*Math.PI));a.lineTo(c+.9*d*Math.sin(2*k*Math.PI),b-.9*d*Math.cos(2*k*Math.PI));a.lineWidth=2*e;a.stroke();h&&od(a,c,b,1.25*d,.5*-Math.PI,.1*-Math.PI,{Ad:!0,Xc:5*e,style:"black"});a.restore()}
function kf(a,c,b,d){var e=a.N,f=a.A.m;jf(e,f/2+(b?-.05*f:.05*f),f/2+(b?.07*f:.03*f),.4*f,a.A.ua,function(g){e.textAlign="start";e.textBaseline="top";e.font=Math.round(f/6).toString(10)+"px sans-serif";e.fillStyle="white";e.fillText(g.toFixed(1>g?2:1),f/20,f/40)},c,b,d)}
function lf(a,c,b,d,e,f,g){a.save();g&&(g.style&&(a.strokeStyle=g.style,a.fillStyle=g.style),void 0!==g.lineWidth&&(a.lineWidth=g.lineWidth),void 0!==g.alpha&&(a.globalAlpha=g.alpha));a.beginPath();e/=2;a.moveTo(c,d+e);for(g=0;g<f;g++){var h=c+(b-c)*(.5+g)/f;a.lineTo(h,d+e);e=-e;a.lineTo(h,d+e)}a.lineTo(b,d+e);a.stroke();a.restore()}
function mf(a,c,b,d,e,f,g,h,l,k){var r=(d+e)/2,u=(e-d)/2;a.save();a.beginPath();a.arc(c,b,d,-g,-f);a.arc(c+r*Math.cos(f),b-r*Math.sin(f),u,-f-Math.PI,-f,!0);a.arc(c,b,e,-f,-g,!0);a.arc(c+r*Math.cos(g),b-r*Math.sin(g),u,-g,-g+Math.PI,!0);a.fillStyle=h;a.strokeStyle=l;a.lineWidth=k;a.fill();a.stroke();a.restore()}function nf(a,c,b,d){var e=a.A;mf(a.N,e.m/2,e.m/2,.3*e.m,.45*e.m,c,b,0>d?"white":2===d?"red":0<d?"#f70":"#ddd",0===d?"#bbb":"black",e.ua)}
function of(a,c){var b=a.N;b.save();nf(a,.65*Math.PI,.85*Math.PI,c[0]);nf(a,.15*Math.PI,.35*Math.PI,c[1]);nf(a,1.15*Math.PI,1.35*Math.PI,c[2]);nf(a,1.65*Math.PI,1.85*Math.PI,c[3]);b.restore()}function pf(a,c){var b=a.N;b.save();for(var d=0;8>d;d++)nf(a,Math.PI*(.46-.25*d),Math.PI*(.54-.25*d),d===c?1:-1);b.restore()}function qf(a,c,b,d,e,f){c=(f.x-d)/c-.5;b=.5-(f.y-e)/b;for(e=0;e<a.length;e++)if(Math.max(Math.abs(c-a[e].x),Math.abs(b-a[e].y))<.11*(a[e].size||1))return e;return null}
function rf(a,c,b,d,e,f){function g(k,r){h.beginPath();h.moveTo(l.m*(.1+.8*k),l.m*(.46-b));h.lineTo(l.m*(.1+.8*r),l.m*(.46-b));h.arc(l.m*(.1+.8*r),l.m*(.5-b),.04*l.m,-Math.PI/2,Math.PI/2);h.lineTo(l.m*(.1+.8*r),l.m*(.54-b));h.lineTo(l.m*(.1+.8*k),l.m*(.54-b));h.arc(l.m*(.1+.8*k),l.m*(.5-b),.04*l.m,Math.PI/2,-Math.PI/2)}var h=a.N,l=a.A;h.save();d&&(h.translate(.5*l.m,.5*l.m),h.rotate(-Math.PI/2),h.scale(1,-1),h.translate(-.5*l.m,-.5*l.m));h.lineWidth=l.ua;h.fillStyle="white";h.strokeStyle="black";
g(0,1);h.fill();h.stroke();h.fillStyle=e;switch(f||0){case 1:g(0,c);h.fill();h.stroke();break;case 2:g(c,1),h.fill(),h.stroke()}h.fillStyle=e;h.strokeStyle="black";h.lineWidth=l.ua;h.beginPath();h.arc(l.m*(.1+.8*c),l.m*(.5-b),.1*l.m,0,2*Math.PI);h.fill();h.stroke();h.restore()}function sf(a,c,b,d,e,f,g){b=(g.x-e)/b-.5;d=.5-(g.y-f)/d;return.1>Math.abs((c?b:d)-a)}function tf(a,c,b,d,e,f){c=(f.x-d)/c-.5;b=.5-(f.y-e)/b;return.5+(a?b:c)/.8}
function uf(a,c,b,d,e,f,g,h,l,k,r){a=Math.floor(((r.x-l)/g-a)/((c-a)/e));b=Math.floor((b-(r.y-k)/h)/((b-d)/f));return 0<=a&&a<e&&0<=b&&b<f?{index:a,tone:b}:null}function vf(a,c,b,d,e){var f=.4*a;a=e.x-b-.55*a;c=d+.53*c-e.y;return a*a+c*c<=f*f}function wf(a,c,b,d,e,f){a=(Math.PI-Math.atan2(f.x-b-.55*a,-(d+.53*c-f.y)))/(2*Math.PI);return e?Math.exp(a*Math.log(100))/10:4*a}function xf(a,c,b,d,e){b=e.x-b-a/2;c=c/2-(e.y-d);return Math.abs(Math.sqrt(b*b+c*c)-.375*a)<=.15*a?0<=c?0>b?0:1:0>b?2:3:null}
function yf(a,c,b,d,e){b=e.x-b-a/2;c=c/2-(e.y-d);return Math.abs(Math.sqrt(b*b+c*c)-.375*a)<=.15*a?(a=Math.atan2(b,c)+Math.PI/8,Math.floor((0>a?a+2*Math.PI:a)/(Math.PI/4))):null}function nd(a,c,b,d){if(0<d){a.beginPath();a.moveTo(c+d*Math.cos(.1),b+d*Math.sin(.2));for(var e=1;6>e;e++)a.lineTo(c+d*Math.cos(e*Math.PI/3+.2),b+d*Math.sin(e*Math.PI/3+.2));a.closePath();a.arc(c,b,.5*d,0,2*Math.PI,!0);a.fill()}};function Na(a){for(var c=0;c<mb.length;c++)if(mb[c].name===a)return mb[c];return null}function kb(a){var c=[];(mb||[]).forEach(function(b){"h"!==b.type&&0<=b.va.indexOf(a)&&c.push(b)});return c};function zf(a,c){var b=.1*(a.size||1);return new Ga(.5-a.y-b,.5+a.x-b,.5-a.y+b,.5+a.x+b,c,null,null)}function Af(a,c){return c[(c.indexOf(a)+1)%c.length]}function Bf(a,c){return a.map(function(b,d){return zf(b,function(e){e.h[d]=Af(e.h[d],c)})})}function Cf(a){return a.map(function(c,b){return zf(c,function(d){d.h[0]=b})})}
function Df(a,c,b,d,e,f,g,h){var l=Math.pow(10,Math.round(Math.log10(Math.abs(g-f)/h/10)));return new Ga(c,b,d,e,null,function(k){k.h[a]=l*Math.round(Math.min(g,k.h[a]+(g-f)/(h-1))/l)},function(k){k.h[a]=l*Math.round(Math.max(f,k.h[a]-(g-f)/(h-1))/l)})}
function Ef(a,c,b,d,e){var f=.5+.37*Math.cos(Math.PI*(.5-2*(a-.3)/c)),g=.5-.37*Math.sin(Math.PI*(.5-2*(a-.3)/c)),h=.5+.37*Math.cos(Math.PI*(.5-2*(a+.3)/c));a=.5-.37*Math.sin(Math.PI*(.5-2*(a+.3)/c));return new Ga(Math.min(g,a)-.1,Math.min(f,h)-.1,Math.max(g,a)+.1,Math.max(f,h)+.1,b,d,e)}function Ff(a){for(var c=[],b=[1,3,2,0],d=0;4>d;d++)c.push(Ef(d+.5,4,function(e){return function(f){f.h[b[e]]=Af(f.h[b[e]],a)}}(d),null,null));return c}
function Gf(){for(var a=[],c=0;8>c;c++)a.push(Ef(c,8,function(b){return function(d){d.h[0]=b}}(c),function(b){b.h[0]=(b.h[0]+1)%8},function(b){b.h[0]=(b.h[0]+7)%8}));return a}
var mb=[new Ca({name:"!stop",type:"h"}),new Ca({name:"!stop and blink",type:"h"}),new Ca({name:"!init",type:"h"}),new Ca({name:"!volume",type:"h"}),new Ca(function(){var a=[{C:"c",x:0,y:0,r:0},{C:"t",x:0,y:.3,r:0},{C:"t",x:0,y:-.3,r:Math.PI},{C:"t",x:.3,y:0,r:Math.PI/2},{C:"t",x:-.3,y:0,r:-Math.PI/2}];return{name:"button 1",type:"e",sa:function(){return[0]},ha:new Fa(Cf(a)),J:function(c,b){Xe(c);b=b.h[0];c.buttons(a,[0==b,1==b,2==b,3==b,4==b])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==
c&&(Ia(b),b.h[0]=c,Ja(b));return c}}}()),new Ca(function(){var a=[{C:"c",x:0,y:0,r:0},{C:"t",x:0,y:.3,r:0},{C:"t",x:0,y:-.3,r:Math.PI},{C:"t",x:.3,y:0,r:Math.PI/2},{C:"t",x:-.3,y:0,r:-Math.PI/2}];return{name:"button",va:["c"],type:"e",sa:function(){return[!1,!1,!1,!1,!1]},fb:function(){return[!1,!1,!0,!1,!0]},ha:new Fa(Bf(a,[!1,!0])),J:function(c,b){Xe(c);c.buttons(a,b.h)},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h[c]=!b.h[c],Ja(b));return c},validate:function(c){for(var b=
0;5>b;b++)if(c.h[b])return null;return new Ra("No button specified",!0)}}}()),new Ca(function(){var a=[{C:"r",x:0,y:.4,r:0,v:"2"},{C:"r",x:-.22,y:.35,r:-.45,v:"1"},{C:"r",x:.22,y:.35,r:.45,v:"3"},{C:"r",x:-.4,y:.22,r:-.8,v:"0"},{C:"r",x:.4,y:.22,r:.8,v:"4"},{C:"r",x:-.2,y:-.4,v:"5"},{C:"r",x:.2,y:-.4,v:"6"}];return{name:"horiz prox",va:["b"],type:"e",sa:function(){return[0,0,0,0,0,0,0]},fb:function(){return[0,1,-1,1,-1,0,0]},ha:new Fa(Bf(a,[0,1,-1])),J:function(c,b){Xe(c);c.buttons(a,b.h,{ke:-1})},
fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h[c]=(b.h[c]+2)%3-1,Ja(b));return c},validate:function(c){for(var b=0;7>b;b++)if(c.h[b])return null;return new Ra("No proximity sensor specified",!0)},jd:function(c,b){switch(b){case "a":return b=new Ha(Na("horiz prox adv"),null,null),b.h=c.h.concat(b.h.slice(7)),b;default:return c}}}}()),new Ca(function(){var a=[{C:"r",x:0,y:.4,r:0,v:"2"},{C:"r",x:-.22,y:.35,r:-.45,v:"1"},{C:"r",x:.22,y:.35,r:.45,v:"3"},{C:"r",x:-.4,y:.22,r:-.8,v:"0"},
{C:"r",x:.4,y:.22,r:.8,v:"4"},{C:"r",x:-.2,y:-.4,v:"5"},{C:"r",x:.2,y:-.4,v:"6"}];return{name:"horiz prox adv",va:["c"],type:"e",sa:function(){return[0,0,0,0,0,0,0,.1,.4]},fb:function(){return[0,1,2,1,2,3,3,.1,.4]},ha:new Fa(Bf(a,[0,1,2,3]).concat(Df(7,.6,-.05,.8,1.05,.25,.75,3),Df(8,.38,-.05,.58,1.05,.25,.75,3))),J:function(c,b){Xe(c);c.buttons(a,b.h,{tg:["white","red","#333","#888"],Lg:["#aaa","black","black","black"],ke:2});rf(c,b.h[8],.02,!1,"red",2);rf(c,b.h[7],-.2,!1,"black",1)},fa:function(c,
b,d,e,f,g,h){c=qf(a,d,e,f,g,h);return null!==c?(Ia(b),b.h[c]=(b.h[c]+1)%4,Ja(b),c):sf(.02,!1,d,e,f,g,h)?(Ia(b),8):sf(-.2,!1,d,e,f,g,h)?(Ia(b),7):null},Pa:function(c,b,d,e,f,g,h,l){7<=d&&(b.h[d]=Math.max(0,Math.min(1,tf(!1,e,f,g,h,l))),Ja(b))},validate:function(c){for(var b=0;7>b;b++)if(c.h[b])return null;return new Ra("No sensor specified",!0)},jd:function(c,b){switch(b){case "b":if(b=c.T.sa(),c.h[7]===b[7]&&c.h[8]===b[8])return b=new Ha(Na("horiz prox"),null,null),b.h=c.h.slice(0,7),b;default:return c}}}}()),
new Ca(function(){var a=[{C:"r",x:0,y:.4,r:0,v:"2"},{C:"r",x:-.22,y:.35,r:-.45,v:"1"},{C:"r",x:.22,y:.35,r:.45,v:"3"},{C:"r",x:-.4,y:.22,r:-.8,v:"0"},{C:"r",x:.4,y:.22,r:.8,v:"4"},{C:"r",x:-.2,y:-.4,v:"5"},{C:"r",x:.2,y:-.4,v:"6"}];return{name:"horiz prox 1",va:["a"],type:"e",sa:function(){return[0,0,0,0,0,0,0,.25]},fb:function(){return[0,1,-1,1,-1,0,0,.25]},ha:new Fa(Bf(a,[0,1,-1]).concat(Df(7,.4,-.05,.6,1.05,.25,.75,3))),J:function(c,b){Xe(c);c.buttons(a,b.h,{ke:-1});rf(c,b.h[7],-.1,!1,"black",
1)},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);return null!==c?(Ia(b),b.h[c]=(b.h[c]+2)%3-1,Ja(b),c):sf(-.1,!1,d,e,f,g,h)?(Ia(b),7):null},Pa:function(c,b,d,e,f,g,h,l){7<=d&&(b.h[d]=Math.max(.25,Math.min(.75,Math.round(4*tf(!1,e,f,g,h,l))/4)),Ja(b))},validate:function(c){for(var b=0;7>b;b++)if(c.h[b])return null;return new Ra("No sensor specified",!0)},jd:function(c,b){switch(b){case "b":if(b=c.T.sa(),c.h[7]===b[7])return b=new Ha(Na("horiz prox"),null,null),b.h=c.h.slice(0,7),b;default:return c}}}}()),
new Ca(function(){var a=[{C:"r",x:-.15,y:.35,v:"0"},{C:"r",x:.15,y:.35,v:"1"}];return{name:"ground",va:["b"],type:"e",sa:function(){return[0,0]},fb:function(){return[1,-1]},ha:new Fa(Bf(a,[0,1,-1])),J:function(c,b){Xe(c,{Lc:!0});c.buttons(a,b.h,{ke:-1})},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h[c]=(b.h[c]+2)%3-1,Ja(b));return c},validate:function(c){return c.h[0]||c.h[1]?null:new Ra("No ground sensor specified",!0)},jd:function(c,b){switch(b){case "a":return b=new Ha(Na("ground adv"),
null,null),b.h=c.h.concat(b.h.slice(2)),b;default:return c}}}}()),new Ca(function(){var a=[{C:"r",x:-.15,y:.35,v:"0"},{C:"r",x:.15,y:.35,v:"1"}];return{name:"ground adv",va:["c"],type:"e",sa:function(){return[0,0,.4,.6]},fb:function(){return[1,2,.4,.6]},ha:new Fa(Bf(a,[0,1,2,3]).concat(Df(2,.6,-.05,.8,1.05,.25,.75,3),Df(3,.38,-.05,.58,1.05,.25,.75,3))),J:function(c,b){Xe(c,{Lc:!0});c.buttons(a,b.h,{tg:["white","red","#333","#888"],Lg:["#aaa","black","black","black"],ke:2});rf(c,b.h[3],.02,!1,"red",
2);rf(c,b.h[2],-.2,!1,"black",1)},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);return null!==c?(Ia(b),b.h[c]=(b.h[c]+1)%4,Ja(b),c):sf(.02,!1,d,e,f,g,h)?(Ia(b),3):sf(-.2,!1,d,e,f,g,h)?(Ia(b),2):null},Pa:function(c,b,d,e,f,g,h,l){2<=d&&(b.h[d]=Math.max(0,Math.min(1,tf(!1,e,f,g,h,l))),Ja(b))},validate:function(c){return c.h[0]||c.h[1]?null:new Ra("No ground sensor specified",!0)},jd:function(c,b){switch(b){case "b":if(b=c.T.sa(),c.h[2]===b[2]&&c.h[3]===b[3])return b=new Ha(Na("ground"),null,null),b.h=
c.h.slice(0,2),b;default:return c}}}}()),new Ca(function(){var a=[{C:"r",x:-.15,y:.35,v:"0"},{C:"r",x:.15,y:.35,v:"1"}];return{name:"ground 1",va:["a"],type:"e",sa:function(){return[0,0,.5]},fb:function(){return[1,-1,.5]},ha:new Fa(Bf(a,[0,1,-1]).concat(Df(2,.4,-.05,.6,1.05,.25,.75,3))),J:function(c,b){Xe(c,{Lc:!0});c.buttons(a,b.h,{ke:-1});rf(c,b.h[2],0,!1,"black",1)},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);return null!==c?(Ia(b),b.h[c]=(b.h[c]+2)%3-1,Ja(b),c):sf(0,!1,d,e,f,g,h)?(Ia(b),2):null},
Pa:function(c,b,d,e,f,g,h,l){2<=d&&(b.h[d]=Math.max(.25,Math.min(.75,Math.round(4*tf(!1,e,f,g,h,l))/4)),Ja(b))},validate:function(c){return c.h[0]||c.h[1]?null:new Ra("No ground sensor specified",!0)},jd:function(c,b){switch(b){case "b":if(b=c.T.sa(),c.h[2]===b[2])return b=new Ha(Na("ground"),null,null),b.h=c.h.slice(0,2),b;default:return c}}}}()),new Ca({name:"tap",va:["b","a"],type:"e",J:function(a){a.N.translate(.05*a.A.m,0);af(a);bf(a)},jd:function(a,c){switch(c){case "a":return new Ha(Na("accelerometer"),
null,null);default:return a}}}),new Ca(function(){var a=[{C:"c",x:-.33,y:-.3,r:0},{C:"c",x:0,y:-.3,r:0},{C:"c",x:.33,y:-.3,r:0}];return{name:"accelerometer",va:["c"],type:"e",sa:function(){return[0,0]},ha:new Fa(Cf(a).concat(new Ga(.1,.1,.9,.9,null,function(c){c.h[1]=0===c.h[0]?0:1===c.h[0]?Math.min(c.h[1]+1,6):Math.max(c.h[1]-1,-6)},function(c){c.h[1]=0===c.h[0]?0:1===c.h[0]?Math.max(c.h[1]-1,-6):Math.min(c.h[1]+1,6)}))),J:function(c,b){var d=b.h[0];b=b.h[1];0===d?(c.N.save(),c.N.translate(.08*c.A.m,
-.2*c.A.m),af(c),bf(c),c.N.restore()):ff(c,2===d,2===d?-b:b);c.buttons(a,[0===d,1===d,2===d])},fa:function(c,b,d,e,f,g,h){if(0!==b.h[0]&&gf(d,f,g,h))return Ia(b),1;c=qf(a,d,e,f,g,h);return null!==c?(Ia(b),b.h[0]=c,Ja(b),2):null},Pa:function(c,b,d,e,f,g,h,l){1===d&&(c=hf(e,g,h,l),b.h[1]=2===b.h[0]?-c:c,Ja(b))},jd:function(c,b){switch(b){case "b":if(0===c.h[0])return new Ha(Na("tap"),null,null);default:return c}}}}()),new Ca({name:"roll",va:["a"],type:"e",sa:function(){return[0]},fb:function(){return[2]},
ha:new Fa([new Ga(.1,.1,.9,.9,null,function(a){a.h[0]=(a.h[0]+13)%24-12},function(a){a.h[0]=(a.h[0]+11)%24-12})]),J:function(a,c){ff(a,!1,c.h[0])},fa:function(a,c,b,d,e,f,g){return gf(b,e,f,g,!0)?(Ia(c),1):null},Pa:function(a,c,b,d,e,f,g,h){c.h[0]=hf(d,f,g,h,!0);Ja(c)}}),new Ca({name:"pitch",va:["a"],type:"e",sa:function(){return[0]},fb:function(){return[2]},ha:new Fa([new Ga(.1,.1,.9,.9,null,function(a){a.h[0]=(a.h[0]+13)%24-12},function(a){a.h[0]=(a.h[0]+11)%24-12})]),J:function(a,c){ff(a,!0,c.h[0])},
fa:function(a,c,b,d,e,f,g){return gf(b,e,f,g,!0)?(Ia(c),1):null},Pa:function(a,c,b,d,e,f,g,h){c.h[0]=hf(d,f,g,h,!0);Ja(c)}}),new Ca({name:"yaw",va:["a"],type:"e",sa:function(){return[0]},fb:function(){return[2]},ha:new Fa([new Ga(.1,.1,.9,.9,null,function(a){a.h[0]=(a.h[0]+13)%24-12},function(a){a.h[0]=(a.h[0]+11)%24-12})]),J:function(a,c){var b=a.N,d=a.A;c=c.h[0]*Math.PI/12;b.save();b.translate(.5*d.m,.5*d.m);b.rotate(c);ef(a);b.translate(-d.m/2,-d.m/2);Xe(a,{Lc:!0,scale:.45});b.restore()},fa:function(a,
c,b,d,e,f,g){return gf(b,e,f,g,!0)?(Ia(c),1):null},Pa:function(a,c,b,d,e,f,g,h){c.h[0]=hf(d,f,g,h,!0);Ja(c)}}),new Ca({name:"clap",type:"e",J:function(a){var c=a.N;a=a.A;c.save();c.beginPath();c.arc(.7*a.m,.6*a.m,.15*a.m,0,2*Math.PI);c.fillStyle="white";c.fill();c.beginPath();c.moveTo(.7*a.m,.6*a.m);c.lineTo(.8*a.m,.95*a.m);c.strokeStyle="white";c.lineWidth=.13*a.m;c.stroke();c.lineWidth=1.5*a.ua;c.translate(.3*a.m,.3*a.m);c.rotate(.1);for(var b=0;9>b;b++)c.beginPath(),c.moveTo(.07*a.m,0),c.lineTo(.14*
a.m,0),c.moveTo(.17*a.m,0),c.lineTo(.22*a.m,0),c.stroke(),c.rotate(Math.PI/4.5);c.restore()}}),new Ca({name:"init",va:["b","a"],type:"e",J:function(a){var c=a.N;a=a.A;var b=.4*a.m;c.save();c.fillStyle="black";c.strokeStyle="black";c.lineWidth=a.ua;c.beginPath();c.arc(.3*a.m,.5*a.m,.08*a.m,0,2*Math.PI);c.fill();c.beginPath();c.moveTo(.42*a.m,.5*a.m);c.lineTo(.7*a.m,.5*a.m);c.stroke();b*=.4;c.beginPath();c.moveTo(.8*a.m,.5*a.m);c.lineTo(.8*a.m-b*Math.sqrt(3)/2,.5*a.m+b/2);c.lineTo(.8*a.m-b*Math.sqrt(3)/
2,.5*a.m-b/2);c.fill();c.restore()},sh:!0}),new Ca({name:"timer",va:["a"],type:"e",J:function(a){kf(a,0,!0,!1)}}),new Ca(function(){var a=[{C:"c",x:.3,y:.2},{C:"c",x:.3,y:-.2}];return{name:"clock",va:[],type:"e",sa:function(){return[10]},ha:new Fa([zf(a[0],function(c){c.h[0]=10}),zf(a[1],function(c){c.h[0]=20})]),J:function(c,b){Xe(c);var d=c.A.m;lf(c.N,.1*d,.6*d,.3*d,.15*d,4,{style:10===b.h[0]?"black":"#222",lineWidth:c.A.ua});lf(c.N,.1*d,.6*d,.7*d,.15*d,8,{style:20===b.h[0]?"black":"#222",lineWidth:c.A.ua});
c.buttons(a,[10===b.h[0],20===b.h[0]])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h[0]=0===c?10:20,Ja(b));return c}}}()),new Ca(function(){var a=[{C:"t",x:-.25,y:0,r:-Math.PI/2},{C:"t",x:0,y:.25,r:0},{C:"t",x:0,y:-.25,r:Math.PI},{C:"t",x:.25,y:0,r:Math.PI/2},{C:"c",x:0,y:0,r:0}];return{name:"remote control arrows",va:[],type:"e",sa:function(){return[0]},ha:new Fa(Cf(a)),J:function(c,b){var d=c.N,e=c.A;d.save();d.fillStyle="#eee";d.fillRect(.1*e.m,e.ua,.8*e.m,e.m-2*e.ua);d.restore();
b=b.h[0];c.buttons(a,[0==b,1==b,2==b,3==b,4==b])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h[0]=c,Ja(b));return c}}}()),new Ca(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI}];return{name:"user event",va:["a"],type:"e",sa:function(){return[0]},ha:new Fa([new Ga(0,0,1,.4,null,function(c){c.h[0]=Math.min(9,c.h[0]+1)},function(c){c.h[0]=Math.max(0,c.h[0]-1)})]),J:function(c,b){c.text(b.h[0].toString(10),{x:-.3*c.A.m,fillStyle:"black"});c.buttons(a,[9>b.h[0]?
-2:0,0<b.h[0]?-2:0]);Xe(c,{scale:.45,cf:[-.15*c.A.m,-.1*c.A.m]});od(c.N,.75*c.A.m,.05*c.A.m,.375*c.A.m,2.2,2.8,{Ad:!0,style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua})},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);if(null!==c){Ia(b);switch(c){case 0:b.h[0]=Math.min(9,b.h[0]+1);break;case 1:b.h[0]=Math.max(0,b.h[0]-1)}Ja(b)}return c}}}()),new Ca({name:"state",va:["a"],type:"s",sa:function(){return[0,0,0,0]},fb:function(){return[1,0,0,-1]},ha:new Fa(Ff([0,1,-1])),J:function(a,c){Xe(a);of(a,c.h)},fa:function(a,
c,b,d,e,f,g){a=xf(b,d,e,f,g);null!==a&&(Ia(c),c.h[a]=(c.h[a]+2)%3-1,Ja(c));return a},jd:function(a,c){return"b"===c&&0===a.h[0]&&0===a.h[1]&&0===a.h[2]&&0===a.h[3]?null:a}}),new Ca({name:"state 8",va:["c"],type:"s",sa:function(){return[0]},ha:new Fa(Gf()),J:function(a,c){Xe(a);pf(a,c.h[0])},fa:function(a,c,b,d,e,f,g){a=yf(b,d,e,f,g);null!==a&&(Ia(c),c.h[0]=a,Ja(c));return a}}),new Ca(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI},{C:"t",x:.1,y:.3,r:0},{C:"t",x:.1,y:-.3,r:Math.PI},
{C:"c",x:.35,y:-.3,r:0}];return{name:"counter comparison",va:["a"],type:"s",sa:function(){return[0,0]},ha:new Fa([new Ga(0,0,1,.4,null,function(c){c.h[0]=Math.min(1,c.h[0]+1)},function(c){c.h[0]=Math.max(-1,c.h[0]-1)}),new Ga(0,.4,1,.8,null,function(c){c.h[1]=Math.min(255,c.h[1]+1)},function(c){c.h[1]=Math.max(0,c.h[1]-1)}),zf(a[4],function(c){c.h[1]=0})]),J:function(c,b){c.text(0===b.h[0]?"=":0<b.h[0]?"\u2265":"\u2264",{x:-.3*c.A.m,fillStyle:"black"});c.text(b.h[1].toString(10),{x:.1*c.A.m,fillStyle:"black"});
c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0,255>b.h[1]?-2:0,0<b.h[1]?-2:0,0!==b.h[1]?-2:0])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);if(null!==c){Ia(b);switch(c){case 0:b.h[0]=Math.min(1,b.h[0]+1);break;case 1:b.h[0]=Math.max(-1,b.h[0]-1);break;case 2:b.h[1]=Math.min(255,b.h[1]+1);break;case 3:b.h[1]=Math.max(0,b.h[1]-1);break;case 4:b.h[1]=0}Ja(b)}return c}}}()),new Ca({name:"color state",va:["c"],type:"s",sa:function(){return[0,0,0]},ha:new Fa([Df(0,.1,-.05,.3,1.05,0,1,2),Df(1,.4,-.05,.6,1.05,
0,1,2),Df(2,.7,-.05,.9,1.05,0,1,2)]),J:function(a,c){Xe(a,{nc:c.h});rf(a,c.h[0],.3,!1,"red");rf(a,c.h[1],0,!1,"#0c0");rf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return sf(.3,!1,b,d,e,f,g)?(Ia(c),0):sf(0,!1,b,d,e,f,g)?(Ia(c),1):sf(-.3,!1,b,d,e,f,g)?(Ia(c),2):null},Pa:function(a,c,b,d,e,f,g,h){c.h[b]=Math.max(0,Math.min(1,Math.round(tf(!1,d,e,f,g,h))));Ja(c)}}),new Ca(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,
v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"color 8 state",
va:["a"],type:"s",sa:function(){return[0]},ha:new Fa(Cf(a)),J:function(c,b){Xe(c,{nc:[b.h&1,(b.h&2)/2,(b.h&4)/4]});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h=[c],Ja(b));return c}}}()),new Ca({name:"motor state",va:["c"],type:"s",sa:function(){return[0,0]},ha:new Fa([Df(0,-.05,0,1.05,.2,-1,1,3),Df(1,-.05,.8,1.05,1,-1,1,3)]),J:function(a,c){var b=Ze(a,2.4*c.h[0],2.4*c.h[1],.19);Xe(a,{Lc:!0,scale:.45,rotation:b.kb,cf:[.19*b.x*a.A.m+
.13*a.A.m*Math.sin(b.kb),.19*b.y*a.A.m+.13*a.A.m*Math.cos(b.kb)]});a.N.save();a.N.globalAlpha=.2;Ze(a,2.4*c.h[0],2.4*c.h[1],.19);a.N.restore();rf(a,.5+.5*c.h[0],-.4,!0,0===c.h[0]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0");rf(a,.5+.5*c.h[1],.4,!0,0===c.h[1]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0")},fa:function(a,c,b,d,e,f,g){return sf(-.4,!0,b,d,e,f,g)?(Ia(c),0):sf(.4,!0,b,d,e,f,g)?(Ia(c),1):$e(a,b,e,f,.5*c.h[0],.5*c.h[1],g)?(Ia(c),2):null},Pa:function(a,c,
b,d,e,f,g,h){2>b?(a=tf(!0,d,e,f,g,h),c.h[b]=.25>a?-1:.75<a?1:0):(a=tf(!0,d,e,f,g,h),a=.25>a?-1:.75<a?1:0,c.h[0]=a,c.h[1]=a);Ja(c)}}),new Ca({name:"motor",type:"a",sa:function(){return[0,0]},fb:function(){return[.5,.2]},ha:new Fa([Df(0,-.05,0,1.05,.2,-1,1,11),Df(1,-.05,.8,1.05,1,-1,1,11)]),J:function(a,c){var b=Ze(a,2.4*c.h[0],2.4*c.h[1],.19);Xe(a,{Lc:!0,scale:.45,rotation:b.kb,cf:[.19*b.x*a.A.m+.13*a.A.m*Math.sin(b.kb),.19*b.y*a.A.m+.13*a.A.m*Math.cos(b.kb)]});a.N.save();a.N.globalAlpha=.2;Ze(a,2.4*
c.h[0],2.4*c.h[1],.19);a.N.restore();rf(a,.5+.5*c.h[0],-.4,!0,0===c.h[0]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0");rf(a,.5+.5*c.h[1],.4,!0,0===c.h[1]?"white":c.h[0]===c.h[1]?"#0c0":c.h[0]===-c.h[1]?"#f70":"#fd0")},fa:function(a,c,b,d,e,f,g){return sf(-.4,!0,b,d,e,f,g)?(Ia(c),0):sf(.4,!0,b,d,e,f,g)?(Ia(c),1):$e(a,b,e,f,.5*c.h[0],.5*c.h[1],g)?(Ia(c),2):null},Pa:function(a,c,b,d,e,f,g,h){2>b?(a=2*tf(!0,d,e,f,g,h)-1,d=c.h[1-b],.1>Math.abs(a)?a=0:.1>Math.abs(a-d)?a=d:.1>Math.abs(a+
d)&&(a=-d),c.h[b]=Math.max(-1,Math.min(1,a))):(a=2*tf(!0,d,e,f,g,h)-1,a=.1>Math.abs(a)?0:Math.max(-1,Math.min(1,a)),.05>Math.abs(c.h[0]-c.h[1])?(c.h[0]=a,c.h[1]=a):Math.abs(c.h[0])>Math.abs(c.h[1])?(c.h[1]*=a/c.h[0],c.h[0]=a):(c.h[0]*=a/c.h[1],c.h[1]=a));Ja(c)}}),new Ca(function(){var a=[{C:"c",x:0,y:0,r:0},{C:"t",x:0,y:.35,r:0},{C:"t",x:0,y:-.35,r:Math.PI},{C:"t",x:-.3,y:.32,r:-.4},{C:"t",x:.3,y:.32,r:.4},{C:"t",x:-.35,y:.05,r:-Math.PI/2},{C:"t",x:.35,y:.05,r:Math.PI/2}];return{name:"move",va:["c"],
type:"a",sa:function(){return[0]},J:function(c,b){Xe(c,{Lc:!0,scale:.45});c.buttons(a,[0===b.h[0]?1:-2,1===b.h[0]?1:-2,2===b.h[0]?1:-2,3===b.h[0]?1:-2,4===b.h[0]?1:-2,5===b.h[0]?1:-2,6===b.h[0]?1:-2])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h[0]=c,Ja(b));return c}}}()),new Ca({name:"nn obstacles",va:[],type:"a",sa:function(){return[0,0,0,0]},fb:function(){return[.3,.2,.1,.3]},ha:new Fa([new Ga(0,0,.25,1,null,function(a){a.h[0]=Math.min(1,a.h[0]+.1)},function(a){a.h[0]=Math.max(0,
a.h[0]-.1)},function(a,c){console.info(c)}),new Ga(.25,0,.5,1,null,function(a){a.h[1]=Math.min(1,a.h[1]+.1)},function(a){a.h[1]=Math.max(0,a.h[1]-.1)},function(a,c){console.info(c)}),new Ga(.5,0,.75,1,null,function(a){a.h[2]=Math.min(1,a.h[2]+.1)},function(a){a.h[2]=Math.max(0,a.h[2]-.1)},function(a,c){console.info(c)}),new Ga(.75,0,1,1,null,function(a){a.h[3]=Math.min(1,a.h[3]+.1)},function(a){a.h[3]=Math.max(0,a.h[3]-.1)},function(a,c){console.info(c)})]),J:function(a,c,b,d){b=d?.5:1;var e=a.N,
f=a.A;e.save();d&&e.scale(b,b);e.fillStyle="white";e.font=f.ng;e.textAlign="center";e.textBaseline="middle";e.translate(.5*f.m,.5*f.m);e.translate(-.5*f.m,-.5*f.m);d?(e.fillText("\u21d1",.25*f.m,.35*f.m),e.fillText(c.h[0].toFixed(1),.6*f.m,.35*f.m),e.fillText("\u21a7",.25*f.m,.81*f.m),e.fillText(c.h[1].toFixed(1),.6*f.m,.81*f.m),e.fillText("+",.25*f.m,1.27*f.m),e.fillText(c.h[2].toFixed(1),.6*f.m,1.27*f.m),e.fillText("\u2212",.25*f.m,1.69*f.m),e.fillText(c.h[3].toFixed(1),.6*f.m,1.69*f.m),e.translate(f.m,
0),rf(a,c.h[0],.15,!1,"white"),rf(a,c.h[1],-.3,!1,"white"),rf(a,c.h[2],-.75,!1,"white"),rf(a,c.h[3],-1.2,!1,"white")):(e.fillText("\u21d1",.25*f.m,.17*f.m),e.fillText(c.h[0].toFixed(1),.6*f.m,.17*f.m),e.fillText("\u21a7",.25*f.m,.4*f.m),e.fillText(c.h[1].toFixed(1),.6*f.m,.4*f.m),e.fillText("+",.25*f.m,.63*f.m),e.fillText(c.h[2].toFixed(1),.6*f.m,.63*f.m),e.fillText("\u2212",.25*f.m,.87*f.m),e.fillText(c.h[3].toFixed(1),.6*f.m,.87*f.m));e.restore()},Je:!0,fa:function(a,c,b,d,e,f,g){return sf(.35,
!1,b/2,d,e+b/2,f,g)?(Ia(c),0):sf(.12,!1,b/2,d,e+b/2,f,g)?(Ia(c),1):sf(-.12,!1,b/2,d,e+b/2,f,g)?(Ia(c),2):sf(-.35,!1,b/2,d,e+b/2,f,g)?(Ia(c),3):null},Pa:function(a,c,b,d,e,f,g,h){c.h[b]=Math.max(0,Math.min(1,Math.round(20*tf(!1,d/2,e,f+d/2,g,h))/20));Ja(c)}}),new Ca({name:"top color",va:["a"],type:"a",sa:function(){return[0,0,0]},ha:new Fa([Df(0,.1,-.05,.3,1.05,0,1,11),Df(1,.4,-.05,.6,1.05,0,1,11),Df(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Xe(a,{nc:c.h});rf(a,c.h[0],.3,!1,"red");rf(a,c.h[1],0,
!1,"#0c0");rf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return sf(.3,!1,b,d,e,f,g)?(Ia(c),0):sf(0,!1,b,d,e,f,g)?(Ia(c),1):sf(-.3,!1,b,d,e,f,g)?(Ia(c),2):null},Pa:function(a,c,b,d,e,f,g,h){c.h[b]=Math.max(0,Math.min(1,tf(!1,d,e,f,g,h)));Ja(c)}}),new Ca(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",
x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"top color 8",va:["b"],type:"a",sa:function(){return[0]},ha:new Fa(Cf(a)),J:function(c,b){Xe(c,{nc:[b.h&1,(b.h&2)/
2,(b.h&4)/4]});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h=[c],Ja(b));return c}}}()),new Ca({name:"bottom color",va:["a"],type:"a",sa:function(){return[0,0,0]},ha:new Fa([Df(0,.1,-.05,.3,1.05,0,1,11),Df(1,.4,-.05,.6,1.05,0,1,11),Df(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Xe(a,{Lc:!0,nc:c.h});rf(a,c.h[0],.3,!1,"red");rf(a,c.h[1],0,!1,"#0c0");rf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return sf(.3,!1,b,d,e,f,g)?(Ia(c),
0):sf(0,!1,b,d,e,f,g)?(Ia(c),1):sf(-.3,!1,b,d,e,f,g)?(Ia(c),2):null},Pa:function(a,c,b,d,e,f,g,h){c.h[b]=Math.max(0,Math.min(1,tf(!1,d,e,f,g,h)));Ja(c)}}),new Ca({name:"bottom-left color",va:["c"],type:"a",sa:function(){return[0,0,0]},ha:new Fa([Df(0,.1,-.05,.3,1.05,0,1,11),Df(1,.4,-.05,.6,1.05,0,1,11),Df(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Xe(a,{Lc:!0,nc:c.h,zf:"left"});rf(a,c.h[0],.3,!1,"red");rf(a,c.h[1],0,!1,"#0c0");rf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,f,g){return sf(.3,!1,
b,d,e,f,g)?(Ia(c),0):sf(0,!1,b,d,e,f,g)?(Ia(c),1):sf(-.3,!1,b,d,e,f,g)?(Ia(c),2):null},Pa:function(a,c,b,d,e,f,g,h){c.h[b]=Math.max(0,Math.min(1,tf(!1,d,e,f,g,h)));Ja(c)}}),new Ca({name:"bottom-right color",va:["c"],type:"a",sa:function(){return[0,0,0]},ha:new Fa([Df(0,.1,-.05,.3,1.05,0,1,11),Df(1,.4,-.05,.6,1.05,0,1,11),Df(2,.7,-.05,.9,1.05,0,1,11)]),J:function(a,c){Xe(a,{Lc:!0,nc:c.h,zf:"right"});rf(a,c.h[0],.3,!1,"red");rf(a,c.h[1],0,!1,"#0c0");rf(a,c.h[2],-.3,!1,"#08f")},fa:function(a,c,b,d,e,
f,g){return sf(.3,!1,b,d,e,f,g)?(Ia(c),0):sf(0,!1,b,d,e,f,g)?(Ia(c),1):sf(-.3,!1,b,d,e,f,g)?(Ia(c),2):null},Pa:function(a,c,b,d,e,f,g,h){c.h[b]=Math.max(0,Math.min(1,tf(!1,d,e,f,g,h)));Ja(c)}}),new Ca(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},
{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"bottom color 8",va:["b"],type:"a",sa:function(){return[0]},ha:new Fa(Cf(a)),J:function(c,b){Xe(c,{Lc:!0,nc:[b.h&1,(b.h&2)/2,(b.h&4)/4]});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},
fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h=[c],Ja(b));return c}}}()),new Ca(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,
size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"bottom-left color 8",va:["c"],type:"a",sa:function(){return[0]},ha:new Fa(Cf(a)),J:function(c,b){Xe(c,{Lc:!0,nc:[b.h&1,(b.h&2)/2,(b.h&4)/4],zf:"left"});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h=[c],Ja(b));
return c}}}()),new Ca(function(){var a=[{C:"r",x:-.15,y:.3,size:1.4,v:"black",fillStyle:"#666",strokeStyle:"white"},{C:"r",x:-.3,y:0,size:1.4,v:"red",fillStyle:"red",strokeStyle:"white"},{C:"r",x:0,y:0,size:1.4,v:"green",fillStyle:"#0c0",strokeStyle:"white"},{C:"r",x:.3,y:0,size:1.4,v:"yellow",fillStyle:"yellow",strokeStyle:"silver"},{C:"r",x:-.3,y:-.3,size:1.4,v:"blue",fillStyle:"blue",strokeStyle:"white"},{C:"r",x:0,y:-.3,size:1.4,v:"magenta",fillStyle:"magenta",strokeStyle:"white"},{C:"r",x:.3,
y:-.3,size:1.4,v:"cyan",fillStyle:"cyan",strokeStyle:"white"},{C:"r",x:.15,y:.3,size:1.4,v:"white",fillStyle:"white",strokeStyle:"silver"}];return{name:"bottom-right color 8",va:["c"],type:"a",sa:function(){return[0]},ha:new Fa(Cf(a)),J:function(c,b){Xe(c,{Lc:!0,nc:[b.h&1,(b.h&2)/2,(b.h&4)/4],zf:"right"});c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h=[c],Ja(b));return c}}}()),new Ca({name:"notes",type:"a",sa:function(){return[0,1,1,
1,2,1,0,1,2,1,4,2]},ha:new Fa(function(a,c,b,d,e,f){var g=[];for(b=0;b<e;b++)(function(h){g.push(new Ga(.1,a+h*(c-a)/e,.9,a+(h+1)*(c-a)/e,function(l){l.h[2*h+1]=Af(l.h[2*h+1],[0,1,2])},function(l){0===l.h[2*h+1]?(l.h[2*h]=0,l.h[2*h+1]=1):l.h[2*h]=Math.min(l.h[2*h]+1,f-1)},function(l){0===l.h[2*h+1]?(l.h[2*h]=0,l.h[2*h+1]=1):l.h[2*h]=Math.max(l.h[2*h]-1,0)},function(l,k,r){k=f-1-Math.floor(r*f*.9999);0===l.h[2*h+1]?(l.h[2*h]=k,l.h[2*h+1]=1):l.h[2*h]===k?l.h[2*h+1]=Af(l.h[2*h+1],[0,1,2]):l.h[2*h]=k}))})(b);
return g}(.1,.9,.9,.1,6,5)),J:function(a,c){c=c.h;var b=a.N,d=a.A;b.save();b.fillStyle="#eee";for(var e=0;5>e;e++)b.fillRect(.1*d.m,d.m*(.1+.16*e),.8*d.m,.16*d.m-d.ua);cf(a,c,.1,.9,.9,.1,5,.14,1);b.restore()},fa:function(a,c,b,d,e,f,g){return(a=uf(.1,.9,.9,.1,6,5,b,d,e,f,g))?(Ia(c),c.h[2*a.index]===a.tone?c.h[2*a.index+1]=(c.h[2*a.index+1]+1)%3:(c.h[2*a.index]=a.tone,c.h[2*a.index+1]=1),Ja(c),0):null}}),new Ca(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI}];return{name:"play",
va:["c"],type:"a",sa:function(){return[0]},ha:new Fa([new Ga(0,0,1,.4,null,function(c){c.h[0]=(c.h[0]+1)%100},function(c){c.h[0]=(c.h[0]+99)%100})]),J:function(c,b){df(c,b.h[0]);c.buttons(a,[-2,-2])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);if(null!==c){Ia(b);switch(c){case 0:b.h[0]=(b.h[0]+1)%100;break;case 1:b.h[0]=(b.h[0]+99)%100}Ja(b)}return c}}}()),new Ca({name:"play stop",va:["c"],type:"a",J:function(a){df(a,null)}}),new Ca({name:"set state",va:["a"],type:"a",sa:function(){return[0,0,0,
0]},fb:function(){return[0,1,-1,0]},ha:new Fa(Ff([0,1,-1])),J:function(a,c){Xe(a);of(a,c.h)},fa:function(a,c,b,d,e,f,g){a=xf(b,d,e,f,g);null!==a&&(Ia(c),c.h[a]=(c.h[a]+2)%3-1,Ja(c));return a}}),new Ca({name:"toggle state",va:["c"],type:"a",sa:function(){return[!1,!1,!1,!1]},fb:function(){return[!0,!1,!1,!1]},ha:new Fa(Ff([!1,!0])),J:function(a,c){Xe(a);of(a,c.h.map(function(b){return b?2:0}));od(a.N,a.A.m/2,a.A.m/2,.2*a.A.m,-1.4,1.4,{style:"black",lineWidth:a.A.ua,Xc:5*a.A.ua});od(a.N,a.A.m/2,a.A.m/
2,.2*a.A.m,Math.PI-1.4,Math.PI+1.4,{style:"black",lineWidth:a.A.ua,Xc:5*a.A.ua})},fa:function(a,c,b,d,e,f,g){a=xf(b,d,e,f,g);null!==a&&(Ia(c),c.h[a]=!c.h[a],Ja(c));return a}}),new Ca({name:"set state 8",va:["c"],type:"a",sa:function(){return[0]},ha:new Fa(Gf()),J:function(a,c){Xe(a);pf(a,c.h[0])},fa:function(a,c,b,d,e,f,g){a=yf(b,d,e,f,g);null!==a&&(Ia(c),c.h[0]=a,Ja(c));return a}}),new Ca(function(){var a=[{C:"c",x:-.2,y:0},{C:"c",x:.2,y:0}];return{name:"change state 8",va:["c"],type:"a",sa:function(){return[1]},
ha:new Fa([zf(a[0],function(c){c.h[0]=-1}),zf(a[1],function(c){c.h[0]=1})]),J:function(c,b){Xe(c);var d=c.N;d.save();for(var e=0;8>e;e++)nf(c,Math.PI*(.46-.25*e),Math.PI*(.54-.25*e),0);d.restore();od(c.N,c.A.m/2,c.A.m/2,.375*c.A.m,-.8,.8,{style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua});od(c.N,c.A.m/2,c.A.m/2,.375*c.A.m,Math.PI-.8,Math.PI+.8,{Ad:!0,style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua});c.buttons(a,[0>b.h[0],0<b.h[0]])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);null!==c&&(Ia(b),b.h[0]=0===c?
-1:1,Ja(b));return c}}}()),new Ca(function(){var a=[{C:"t",x:0,y:.3,r:0},{C:"t",x:0,y:-.3,r:Math.PI}];return{name:"set counter",va:["a"],type:"a",sa:function(){return[0]},ha:new Fa([new Ga(.1,.25,.9,.75,null,function(c){c.h[0]=Math.min(1,c.h[0]+1)},function(c){c.h[0]=Math.max(-1,c.h[0]-1)})]),J:function(c,b){c.text(0===b.h[0]?"= 0":0<b.h[0]?"+1":"\u22121");c.buttons(a,[1>b.h[0]?-2:0,-1<b.h[0]?-2:0])},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);if(null!==c){Ia(b);switch(c){case 0:b.h[0]=Math.min(1,
b.h[0]+1);break;case 1:b.h[0]=Math.max(-1,b.h[0]-1)}Ja(b)}return c}}}()),new Ca({name:"set timer",va:["a"],type:"a",sa:function(){return[1]},ha:new Fa([new Ga(.13,.14,.93,.96,null,function(a){a.h[0]=Math.min(a.h[0]+.1,4)},function(a){a.h[0]=Math.max(a.h[0]-.1,0)})]),J:function(a,c){kf(a,c.h[0],!1,!1)},fa:function(a,c,b,d,e,f,g){return vf(b,d,e,f,g)?(Ia(c),1):null},Pa:function(a,c,b,d,e,f,g,h){c.h[0]=wf(d,e,f,g,!1,h);Ja(c)}}),new Ca({name:"set timer log",va:["c"],type:"a",sa:function(){return[1]},
ha:new Fa([new Ga(.13,.14,.93,.96,null,function(a){a.h[0]=Math.round(100*Math.min(1.05*a.h[0],10))/100},function(a){a.h[0]=Math.round(100*Math.max(.95*a.h[0],.1))/100})]),J:function(a,c){kf(a,c.h[0],!1,!0)},fa:function(a,c,b,d,e,f,g){return vf(b,d,e,f,g)?(Ia(c),1):null},Pa:function(a,c,b,d,e,f,g,h){c.h[0]=wf(d,e,f,g,!0,h);Ja(c)}}),new Ca(function(){function a(b,d){if(b.h[1]){var e=new Image;e.src=b.h[1];e.addEventListener("load",function(){b.h[2]=e;d&&d()},!1)}}var c=[{C:"c",x:-.33,y:-.3,r:0}];return{name:"picture comment",
va:["a"],type:"c",sa:function(){return[!1,"",null]},Sf:function(b){return 2<=b.h.length?[!1,b.h[1]]:[!1,""]},Se:function(b,d,e){b.h=2<=d.length?[!1,d[1]]:[!1,""];a(b,e)},J:function(b,d){d.h[2]&&b.N.drawImage(d.h[2],0,0,240,240,0,0,b.A.m,b.A.m);b.buttons(c,[d.h[0]])},fa:function(b,d,e,f,g,h,l){e=qf(c,e,f,g,h,l);0===e&&(d.h[0]?sa&&(sa.pause&&sa.pause(),ta.getTracks().forEach(function(k){k.stop()}),sa=null):(Ia(d),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:320,height:240}}).then(function(k){ta=
k;sa=document.createElement("video");sa.srcObject=k;sa.addEventListener("loadedmetadata",function(){sa.play();var r=setInterval(function(){sa?(ua||(ua=document.createElement("canvas"),ua.width=240,ua.height=240),ua.getContext("2d").drawImage(sa,0,0,240,240,0,0,240,240),d.h[1]=ua.toDataURL("image/png"),a(d,function(){b.qa&&b.qa();Fc(b)})):clearInterval(r)},100)},!1)})),d.h[0]=!d.h[0],Ja(d));return e}}}()),new Ca(function(){var a=[{C:"t",x:-.3,y:.3,r:0},{C:"t",x:-.3,y:-.3,r:Math.PI}];return{name:"send user event",
va:["a"],type:"a",sa:function(){return[0]},ha:new Fa([new Ga(0,0,1,.4,null,function(c){c.h[0]=Math.min(9,c.h[0]+1)},function(c){c.h[0]=Math.max(0,c.h[0]-1)})]),J:function(c,b){c.text(b.h[0].toString(10),{x:-.3*c.A.m,fillStyle:"black"});c.buttons(a,[9>b.h[0]?-2:0,0<b.h[0]?-2:0]);Xe(c,{scale:.45,cf:[-.15*c.A.m,-.1*c.A.m]});od(c.N,.65*c.A.m,.05*c.A.m,.375*c.A.m,.5,1.1,{Ad:!0,style:"black",lineWidth:c.A.ua,Xc:5*c.A.ua})},fa:function(c,b,d,e,f,g,h){c=qf(a,d,e,f,g,h);if(null!==c){Ia(b);switch(c){case 0:b.h[0]=
Math.min(9,b.h[0]+1);break;case 1:b.h[0]=Math.max(0,b.h[0]-1)}Ja(b)}return c}}}())];function Hf(a,c){function b(f){return f instanceof Array?f.join(""):f}function d(f,g,h){return f.map(function(l){return Ea(l,g,h)})}var e=c||{};["aseba","l2","js","python"].forEach(function(f){a[f]&&(e[f]=function(g,h){var l=g?g.h:[],k={Jh:h?h.Af:1,K:0};g={};a[f].initVarDecl&&(g.ub=d(a[f].initVarDecl.map(b),l,k));a[f].initCodeDecl&&(g.tb=d(a[f].initCodeDecl.map(b),l,k));a[f].initCodeExec&&(g.Cb=d(a[f].initCodeExec.map(b),l,k));a[f].sectionBegin&&(g.da=Ea(b(a[f].sectionBegin),l,k));a[f].sectionEnd&&
(g.zb=Ea(b(a[f].sectionEnd),l,k));a[f].sectionPreamble&&(g.eb=Ea(b(a[f].sectionPreamble),l,k));a[f].clauseInit&&(g.la=Ea(b(a[f].clauseInit),l,k));if(a[f].clauseAnd){var r="";l.forEach(function(u,y){k.K=y;(u=Ea(b(a[f].clauseAnd),l,k))&&(r+=(0<r.length?" "+Ka[f].i+" ":"")+u)});g.cb=r||Ka[f].l}else a[f].clause&&(g.cb=Ea(b(a[f].clause),l,k));a[f].clauseAlwaysEval&&(g.Lf=a[f].clauseAlwaysEval);a[f].clauseAsCondition&&(g.fh=Ea(b(a[f].clauseAsCondition),l,k));g.ui=a[f].clauseOptional||!1;a[f].statement1?
g.ya=l.map(function(u,y){k.K=y;return Ea(b(a[f].statement1),l,k)}).join(""):a[f].statement&&(g.ya=Ea(b(a[f].statement),l,k));a[f].error&&(g.cb=Ea(b(a.error.error),l,k));return g})});return e};function If(a){this.S=new DOMParser;this.b=this.S.parseFromString(a,"text/xml");this.i=this.b.documentElement;this.D=(this.i.getAttribute("viewBox")||"0 0 1 1").split(" ").map(function(c){return parseFloat(c)});this.w={}}
var Jf={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",
darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",
ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",
lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",
moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",
seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function Kf(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])}function Lf(a){var c={};Kf(c,a);return c}
function Mf(a,c){c.split(";").forEach(function(b){b=b.trim().split(":").map(function(d){return d.trim()});2===b.length&&(a[b[0]]=b[1])})}
function Nf(a,c,b,d,e){a&&(a=a.replace(/\s*\(\s*/g,"(").replace(/\s*\)\s*/g,")").replace(/ +,/g,",").replace(/, +/g,",").replace(/ +/g,","),a.split(")").slice(0,-1).forEach(function(f){var g=f.split("(")[0];f=f.split("(")[1].split(",").map(function(l){return parseFloat(l)});switch(g){case "translate":c(f[0]||0,f[1]||0);break;case "rotate":g=(f[0]||0)*Math.PI/180;var h=f[1]||0;f=f[2]||0;0!==h||0!==f?(c(-h,-f),b(g),c(h,f)):b(g);break;case "scale":g=f[0]||1;d(g,f[1]||g);break;case "matrix":e(f[0],f[1],
f[2],f[3],f[4],f[5]);break;default:throw"transform not implemented: "+g;}}))}function Of(a,c){Nf(a,function(b,d){c.translate(b,d)},function(b){c.rotate(b)},function(b,d){c.scale(b,d)},function(b,d,e,f,g,h){c.wf(b,d,e,f,g,h)})}
If.prototype.J=function(a,c){function b(p,q,A){function t(){for(var v=0;v<p.childElementCount;v++)b(p.children[v],q,A)}function B(v,C){v=p.getAttribute(v);return null===v?C||0:parseFloat(v)}function L(v,C){v=u.apply(new Pf(v,C));y.push(v.x);E.push(v.y)}function T(v,C,F){if(null==v||""==v)return C;v=/^\s*(-?[0-9.]+)\s*([a-z%]*)\s*$/i.exec(v);C=parseFloat(v[1]);switch(v[2]||"px"){case "pt":return 25.4*C/72*3;case "pc":return 25.4*C/6*3;case "in":return 25.4*C*3;case "mm":return 3*C;case "cm":return 30*
C;case "em":return 18*C;case "ex":return 9*C;case "%":return C*F/100;default:return C}}function la(v){v=v.replace(/\.([0-9]+)(?=\.)/g,".$1 ").replace(/([.0-9])-/g,"$1 -").replace(/\s*([a-z])\s*/gi,";$1").replace(/\s*,\s*/g,",").replace(/\s+/g,",");var C=0,F=0,S=0,K=0,ma=0,na=0,Z=[],ia=[],fa=!0;a&&a.beginPath();v.slice(1).split(";").forEach(function(M){var I=M[0];M=1<M.length?M.slice(1).split(",").map(function(Oc){return parseFloat(Oc)}):[];switch(I){case "M":if(2<=M.length){C=M[0];F=M[1];ma=C;na=
F;a&&a.moveTo(C,F);L(C,F);fa&&1<Z.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(Z,ia,!1);fa=!0;Z=y.slice(-1);ia=E.slice(-1);for(I=2;I+1<M.length;I+=2)C=M[I],F=M[I+1],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-1]);S=C;K=F}break;case "m":if(2<=M.length)for(C+=M[0],F+=M[1],ma=C,na=F,a&&a.moveTo(C,F),L(C,F),fa&&1<Z.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(Z,ia,!1),fa=!0,Z=y.slice(-1),ia=E.slice(-1),I=2;I+1<M.length;I+=2)C+=M[I],F+=M[I+1],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-
1]);S=C;K=F;break;case "L":for(I=0;I+1<M.length;I+=2)C=M[I],F=M[I+1],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-1]);S=C;K=F;break;case "l":for(I=0;I+1<M.length;I+=2)C+=M[I],F+=M[I+1],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-1]);S=C;K=F;break;case "H":for(I=0;I<M.length;I++)C=M[I],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-1]);S=C;K=F;break;case "h":for(I=0;I<M.length;I++)C+=M[I],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-
1]);S=C;K=F;break;case "V":for(I=0;I<M.length;I++)F=M[I],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-1]);S=C;K=F;break;case "v":for(I=0;I<M.length;I++)F+=M[I],a&&a.lineTo(C,F),L(C,F),Z.push(y[y.length-1]),ia.push(E[E.length-1]);S=C;K=F;break;case "A":for(I=0;I+6<M.length;I+=7){var qa=M[I+5],ab=M[I+6],qc=d(M[I],M[I+1],M[I+2]*Math.PI/180,0!=M[I+3],0==M[I+4],C,F,qa,ab);C=qa;F=ab;L(qc.x,qc.y);L(C,F);fa=!1}S=C;K=F;break;case "a":for(I=0;I+6<M.length;I+=7)qa=C+M[I+5],ab=F+M[I+6],qc=
d(M[I],M[I+1],M[I+2]*Math.PI/180,0!=M[I+3],0==M[I+4],C,F,qa,ab),C=qa,F=ab,L(qc.x,qc.y),L(C,F),fa=!1;S=C;K=F;break;case "C":for(I=0;I+5<M.length;I+=6)a&&a.bezierCurveTo(M[I],M[I+1],M[I+2],M[I+3],M[I+4],M[I+5]),C=M[I+4],F=M[I+5],S=2*C-M[I+2],K=2*F-M[I+3],L(C,F),fa=!1;break;case "c":for(I=0;I+5<M.length;I+=6)a&&a.bezierCurveTo(C+M[I],F+M[I+1],C+M[I+2],F+M[I+3],C+M[I+4],F+M[I+5]),S=C+2*M[I+4]-M[I+2],K=F+2*M[I+5]-M[I+3],C+=M[I+4],F+=M[I+5],L(C,F),fa=!1;break;case "S":for(I=0;I+3<M.length;I+=4)a&&a.bezierCurveTo(S,
K,M[I],M[I+1],M[I+2],M[I+3]),C=M[I+2],F=M[I+3],S=2*C-M[I],K=2*F-M[I+1],L(C,F),fa=!1;break;case "s":for(I=0;I+3<M.length;I+=4)a&&a.bezierCurveTo(S,K,C+M[I],F+M[I+1],C+M[I+2],F+M[I+3]),S=C-M[I],K=F-M[I+1],C+=M[I+2],F+=M[I+3],L(C,F),fa=!1;break;case "Q":for(I=0;I+3<M.length;I+=4)a&&a.quadraticCurveTo(M[I],M[I+1],M[I+2],M[I+3]),C=M[I+2],F=M[I+3],S=2*C-M[I],K=2*F-M[I+1],L(C,F),fa=!1;break;case "q":for(I=0;I+3<M.length;I+=4)a&&a.quadraticCurveTo(C+M[I],F+M[I+1],C+M[I+2],F+M[I+3]),S=C+2*M[I+2]-M[I],K=F+
2*M[I+3]-M[I+1],C+=M[I+2],F+=M[I+3],L(C,F),fa=!1;break;case "T":for(I=0;I+1<M.length;I+=2)a&&a.quadraticCurveTo(S,K,M[I],M[I+1]),C=M[I],F=M[I+1],S=2*C-S,K=2*F-K,L(C,F),fa=!1;break;case "t":for(I=0;I+1<M.length;I+=2)a&&a.quadraticCurveTo(S,K,C+M[I],F+M[I+1]),C+=M[I],F+=M[I+1],S=2*C-S,K=2*F-K,L(C,F),fa=!1;break;case "Z":case "z":C=ma;F=na;a&&a.closePath();fa&&1<Z.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(Z,ia,!0);fa=!0;Z=[];ia=[];break;default:throw"unimplemented path command: "+I;}});fa&&1<Z.length&&c&&
c.Ea&&c.Ea.line&&c.Ea.line(Z,ia,!1)}function U(v){function C(na,Z){if(0<Z.length){na.splice(0,na.length);for(var ia=0;ia<Z.length&&1>ia;ia++){var fa=(Z[ia].getAttribute("offset")||"0").trim(),M=/%$/.test(fa)?parseFloat(fa.slice(0,-1))/100:parseFloat(fa),I=Z[ia].getAttribute("style");fa={};I&&Mf(fa,I);isNaN(M)||(I=Z[ia].getAttribute("stop-color")||fa["stop-color"]||"#000",Jf.hasOwnProperty(I)&&(I=Jf[I]),fa=(Z[ia].getAttribute("stop-opacity")||fa["stop-opacity"]||"1").trim(),fa=/%$/.test(fa)?parseFloat(fa.slice(0,
-1))/100:parseFloat(fa),1!==fa&&(/^#[0-9a-f]{3}$/i.test(I)?I="rgba("+I.slice(1).split("").map(function(qa){return 17*parseInt(qa,16)}).map(function(qa){return qa.toString(10)}).join(",")+","+fa.toFixed(2)+")":/^#[0-9a-f]{6}$/i.test(I)?I="rgba("+[I.slice(1,3),I.slice(3,5),I.slice(5)].map(function(qa){return parseInt(qa,16)}).map(function(qa){return qa.toString(10)}).join(",")+","+fa.toFixed(2)+")":/^rgb(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(I)?I=I.slice(0,-1).replace(/\s+/g,",")+","+fa.toFixed(2)+
")":/^hsl(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(I)&&(I=I.slice(0,-1).replace(/\s+/g,",")+","+fa.toFixed(2)+")")),na.push({offset:M,color:I}))}}}function F(na,Z){if(na.attributes["xlink:href"]){var ia=na.getAttribute("xlink:href");"#"===ia[0]&&(ia=l.b.getElementById(ia.slice(1)))&&(Z=F(ia,Z))}Z.Pd=na.attributes.x1?parseFloat(na.getAttribute("x1")):Z.Pd||0;Z.Rd=na.attributes.y1?parseFloat(na.getAttribute("y1")):Z.Rd||0;Z.Qd=na.attributes.x2?parseFloat(na.getAttribute("x2")):Z.Qd||0;Z.Sd=na.attributes.y2?
parseFloat(na.getAttribute("y2")):Z.Sd||0;Z.cd=na.attributes.gradientUnits?na.getAttribute("gradientUnits"):Z.cd||"objectBoundingBox";Z.mc=na.attributes.gradientTransform?na.getAttribute("gradientTransform"):Z.mc||"";Z.vb=Z.vb||[];C(Z.vb,na.getElementsByTagName("stop"));return Z}function S(na,Z){if(na.attributes["xlink:href"]){var ia=na.getAttribute("xlink:href");"#"===ia[0]&&(ia=l.b.getElementById(ia.slice(1)))&&(Z=S(ia,Z))}Z.Zc=na.attributes.cx?parseFloat(na.getAttribute("cx")):Z.Zc||0;Z.$c=na.attributes.cy?
parseFloat(na.getAttribute("cy")):Z.$c||0;Z.r=na.attributes.r?parseFloat(na.getAttribute("r")):Z.r||0;Z.cd=na.attributes.gradientUnits?na.getAttribute("gradientUnits"):Z.cd||"objectBoundingBox";Z.mc=na.attributes.gradientTransform?na.getAttribute("gradientTransform"):Z.mc||"";Z.vb=Z.vb||[];C(Z.vb,na.getElementsByTagName("stop"));return Z}var K=/^url\(#(.+)\)$/.exec(v);if(K&&K[1]&&(K=l.b.getElementById(K[1])))switch(K.tagName){case "linearGradient":v=F(K,{});if("objectBoundingBox"===v.cd)throw"objectBoundingBox not supported";
if(v.mc)throw K=new Qf,Of(v.mc,K),"gradientTransform not supported";var ma=a.createLinearGradient(v.Pd,v.Rd,v.Qd,v.Sd);for(K=0;K<v.vb.length;K++)ma.addColorStop(v.vb[K].offset,v.vb[K].color);return ma;case "radialGradient":v=S(K,{});if("objectBoundingBox"===v.cd)throw"objectBoundingBox not supported";v.mc&&(K=new Qf,Of(v.mc,K),ma=Rf(K,{x:v.Zc,y:v.$c}),K=v.r/Math.sqrt(Math.abs(K.b[0]*K.b[4])),v.Zc=ma.x,v.$c=ma.y,v.r=K);ma=a.createRadialGradient(v.Zc,v.$c,0,v.Zc,v.$c,v.r);for(K=0;K<v.vb.length;K++)ma.addColorStop(v.vb[K].offset,
v.vb[K].color);return ma}return v}function H(v,C,F,S,K,ma){0>=K||0>=ma?a.rect(v,C,F,S):(K=Math.min((K+ma)/2,Math.min(F,S)/2),a.moveTo(v+F-K,C),a.arc(v+F-K,C+K,K,1.5*Math.PI,2*Math.PI),a.lineTo(v+F,C+S-K),a.arc(v+F-K,C+S-K,K,0,.5*Math.PI),a.lineTo(v+K,C+S),a.arc(v+K,C+S-K,K,.5*Math.PI,Math.PI),a.lineTo(v,C+K),a.arc(v+K,C+K,K,Math.PI,1.5*Math.PI),a.closePath())}function J(){if(a){var v=(q||"")+";"+(A||""),C={};v&&Mf(C,v);"hidden"!==C.visibility&&(C.opacity&&(a.globalAlpha*=parseFloat(C.opacity)),C.fill&&
"none"===C.fill||(a.fillStyle="white"===C.fill||"#fff"===C.fill||"#ffffff"===C.fill?"white":U(C.fill)||"none",a.fill()),C.stroke&&"none"!==C.stroke&&(a.lineWidth=T(C["stroke-width"]||"1px",1,100),a.strokeStyle=C.stroke||"none",a.miterLimit=C["stroke-miterlimit"]||4,a.lineJoin=C["stroke-linejoin"]||"miter",a.lineCap=C["stroke-linecap"]||"butt",C["stroke-dasharray"]&&(a.setLineDash(C["stroke-dasharray"].split(" ").map(function(F){return parseFloat(F)})),a.lineDashOffset=C["stroke-dashoffset"]?parseFloat(C["stroke-dashoffset"]):
0),a.stroke()))}}function R(v,C,F){if(a){var S=(q||"")+";"+(A||""),K={};S&&Mf(K,S);"hidden"!==K.visibility&&(a.font=(K["font-size"]||"12px")+" "+(K["font-family"]||"helvetica"),K.fill&&"none"!==K.fill&&(a.fillStyle="white"===K.fill||"#fff"===K.fill||"#ffffff"===K.fill?"white":c&&c.fill||"silver",a.fillText(v,C,F)),K.stroke&&"none"!==K.stroke&&(a.strokeStyle=c&&c.stroke||"black",a.strokeText(v,C,F)))}}function X(v,C){v=Sf({x:v,y:C});a.save();a.strokeStyle="black";a.lineWidth=1;a.strokeRect(v.Y,v.ca,
v.na-v.Y,v.oa-v.ca);a.restore()}var G=p.getAttribute("id"),O=G&&c&&c.Xd&&c.Xd[G];G=G&&c&&c.Mf&&c.Mf[G];a&&a.save();u.save();O&&a&&f(p,O);G&&a&&g(p,G);(function(){var v=(c&&c.ih||"")+";"+(p.getAttribute("style")||""),C=p.getAttribute("class");C&&r.hasOwnProperty(C)&&(v=r[C]+";"+v);q=(q||"")+";"+v;(v=p.getAttribute("fill"))&&(q+=";fill:"+v);(v=p.getAttribute("stroke"))&&(q+=";stroke:"+v);(v=p.getAttribute("stroke-width"))&&(q+="stroke-width:"+v);(v=p.getAttribute("stroke-dasharray"))&&(q+=";stroke-dasharray:"+
v.split(",").join(" "));(v=p.getAttribute("stroke-dashoffset"))&&(q+=";stroke-dashoffset:"+v);if(c&&c.style)if((v=p.getAttribute("id"))&&c.style.hasOwnProperty(v))A=(A||"")+";"+c.style[v];else for(var F in c.style)c.style.hasOwnProperty(F)&&"!"===F[0]&&F.slice(1)!==v&&(A=(A||"")+";"+c.style[F])})();O=y.length;switch(p.tagName){case "svg":u.save();h(p.getAttribute("transform"));t();u.restore();break;case "g":u.save();h(p.getAttribute("transform"));t();u.restore();break;case "path":a&&a.save();u.save();
h(p.getAttribute("transform"));la(p.getAttribute("d")||"");J();a&&a.restore();u.restore();break;case "line":G=B("x1");var Q=B("y1"),P=B("x2"),V=B("y2");a&&a.save();u.save();h(p.getAttribute("transform"));a&&a.beginPath();a&&a.moveTo(G,Q);a&&a.lineTo(P,V);J();L(G,Q);L(P,V);c&&c.Ea&&c.Ea.line&&c.Ea.line([G,P],[Q,V],!1);a&&a.restore();u.restore();break;case "polygon":case "polyline":G=p.getAttribute("points").trim().replace(/\s+/g," ").split(" ").map(function(v){return parseFloat(v)});if(4<=G.length){a&&
a.save();u.save();h(p.getAttribute("transform"));a&&a.beginPath();a&&a.moveTo(G[0],G[1]);L(G[0],G[1]);for(Q=2;Q+1<G.length;Q+=2)a&&a.lineTo(G[Q],G[Q+1]),L(G[Q],G[Q+1]);"polygon"===p.tagName&&a.closePath();J();c&&c.Ea&&c.Ea.line&&c.Ea.line(y.slice(-G.length/2),E.slice(-G.length/2),"polygon"===p.tagName);a&&a.restore();u.restore()}break;case "circle":G=B("cx");Q=B("cy");P=B("r");a&&a.save();u.save();h(p.getAttribute("transform"));a&&a.beginPath();a&&a.arc(G,Q,P,0,2*Math.PI);J();L(G-P,Q-P);L(G-P,Q+P);
L(G+P,Q-P);L(G+P,Q+P);c&&c.Ea&&c.Ea.Kf&&(G=y.slice(-4),Q=E.slice(-4),P=(G[3]-G[0])*(G[3]-G[0])+(Q[3]-Q[0])*(Q[3]-Q[0]),V=(G[2]-G[1])*(G[2]-G[1])+(Q[2]-Q[1])*(Q[2]-Q[1]),.001>Math.abs(P-V)/(P+V)&&.001>((G[3]-G[0])*(G[2]-G[1])+(Q[3]-Q[0])*(Q[2]-Q[1]))/P&&c.Ea.Kf((G[0]+G[2])/2,(Q[0]+Q[2])/2,Math.sqrt(P/8)));a&&a.restore();u.restore();break;case "rect":G=B("x");Q=B("y");P=B("width");V=B("height");var z=B("rx"),D=B("ry",z);z=B("rx",D);a&&a.save();u.save();h(p.getAttribute("transform"));a&&(a.beginPath(),
0<z||0<D?H(G,Q,P,V,z,D):a.rect(G,Q,P,V));J();L(G,Q);L(G,Q+V);L(G+P,Q);L(G+P,Q+V);a&&a.restore();u.restore();break;case "text":G=B("x"),Q=B("y"),a&&a.save(),u.save(),h(p.getAttribute("transform")),R(p.textContent,G,Q),L(G,Q),a&&a.restore(),u.restore()}a&&a.restore();u.restore();a&&c&&c.hh&&X(y.slice(O),E.slice(O))}function d(p,q,A,t,B,L,T,la,U){if(0===p||0===q)return a&&a.lineTo(la,U),new Pf(la,U);var H=Math.cos(A),J=Math.sin(A),R=(H*L+J*T)/p;T=(-J*L+H*T)/q;L=(H*la+J*U)/p;la=(-J*la+H*U)/q;U=(L-R)/
2;H=(la-T)/2;J=U*U+H*H;J=Math.sqrt((1-J)/J);isNaN(J)?J=0:t===B&&(J=-J);t=(R+L)/2+J*H;U=(T+la)/2-J*U;R=Math.atan2((T-U)/p,(R-t)/q);T=Math.atan2((la-U)/p,(L-t)/q);a&&(a.rotate(A),a.scale(p,q),B?a.arc(t,U,1,R,T,!0):a.arc(t,U,1,R,T),a.scale(1/p,1/q),a.rotate(-A));L=new Qf;L.rotate(A);L.scale(p,q);p=B?R<T?(R+T)/2+Math.PI:(R+T)/2:R<T?(R+T)/2:(R+T)/2+Math.PI;return L.apply(new Pf(t+Math.cos(p),U+Math.sin(p)))}function e(p){switch(p.tagName){case "svg":case "defs":for(var q=0;q<p.childElementCount;q++)e(p.children[q]);
break;case "style":k+=p.textContent}}function f(p,q){if(q.kb&&0!=q.kb){var A=q.Fe,t=q.Ge;if(void 0==A||void 0==t)A=l.J(null,{element:p}),p=Sf(A),A=(p.Y+p.na)/2,t=(p.ca+p.oa)/2;a.translate(A+(q.Kb||0),t+(q.Lb||0));a.rotate(q.kb);a.translate(-A,-t)}else(q.Kb||q.Lb)&&a.translate(q.Kb,q.Lb)}function g(p,q){a.beginPath();a.rect(q.x,q.y,q.sc,q.ld);a.clip()}function h(p){Nf(p,function(q,A){a&&a.translate(q,A);u.translate(q,A)},function(q){a&&a.rotate(q);u.rotate(q)},function(q,A){a&&a.scale(q,A);u.scale(q,
A)},function(q,A,t,B,L,T){a&&a.transform(q,A,t,B,L,T);u.wf(q,A,t,B,L,T)})}var l=this,k="",r={},u=new Tf,y=[],E=[];e(this.i);(function(){k.split("}").forEach(function(p){var q=p.split("{");q[0].split(",").forEach(function(A){A=A.trim();/^\.[-a-z0-9]+/i.test(A)&&(A=A.slice(1),r[A]=r[A]?r[A]+";"+q[1]:q[1])})})})();var x=this.i;c&&c.pe?x=this.b.getElementById(c.pe):c&&c.element&&(x=c.element);if(x){c&&c.Wf&&c.Wf(a,this.D);if(a){for(var n=[],w=x.parentElement;null!=w;w=w.parentElement)n.push(w);for(w=
n.length-1;0<=w;w--){var m=n[w].getAttribute("id");(m=m&&c&&c.Xd&&c.Xd[m])&&f(n[w],m);m=n[w].getAttribute("transform");h(m)}}b(x)}return{x:y,y:E}};function Sf(a){if(0===a.x.length)return{Y:0,na:0,ca:0,oa:0};for(var c=a.x[0],b=a.x[0],d=a.y[0],e=a.y[0],f=1;f<a.x.length;f++)c=Math.min(c,a.x[f]),b=Math.max(b,a.x[f]),d=Math.min(d,a.y[f]),e=Math.max(e,a.y[f]);return{Y:c,na:b,ca:d,oa:e}}function Uf(a,c){if(a.w[c])return a.w[c];var b=a.J(null,{pe:c});b=Sf(b);return a.w[c]=b}
If.prototype.Zd=function(a,c,b){a=Uf(this,a);return c>=a.Y&&c<=a.na&&b>=a.ca&&b<=a.oa};If.prototype.Pc=function(a){return null!=this.b.getElementById(a)};If.prototype.yg=function(a,c){a=this.b.getElementById(a);c=this.b.getElementById(c);return null!=c&&null!=a&&c.contains(a)};function Vf(a){If.call(this,a);this.l={};this.H={};this.u={};Wf(this)}Vf.prototype=Object.create(If.prototype);Vf.prototype.constructor=Vf;
function Wf(a){function c(g){switch(g.tagName){case "svg":case "defs":for(var h=0;h<g.childElementCount;h++)c(g.children[h]);break;case "style":f+=g.textContent}}function b(g){return g?(g=g.replace(/\s*\(\s*/g,"(").replace(/\s*\)\s*/g,")").replace(/ +,/g,",").replace(/, +/g,",").replace(/ +/g,","),g.split(")").slice(0,-1).map(function(h){var l=h.split("(")[0];h=h.split("(")[1].split(",").map(function(r){return parseFloat(r)});switch(l){case "translate":return{jb:l,F:[h[0]||0,h[1]||0]};case "rotate":return{jb:l,
F:[(h[0]||0)*Math.PI/180,h[1]||0,h[2]||0]};case "scale":var k=h[0]||1;return{jb:l,F:[k,h[1]||k]};case "matrix":return{jb:l,F:h};default:throw"transform not implemented: "+l;}})):null}function d(g,h){function l(E){for(var x=[],n=0;n<g.childElementCount;n++){var w=d(g.children[n],E);w&&x.push(w)}return x}function k(E,x){E=g.getAttribute(E);return null===E?x||0:parseFloat(E)}function r(E){E=E.replace(/\.([0-9]+)(?=\.)/g,".$1 ").replace(/([.0-9])-/g,"$1 -").replace(/\s*([a-z])\s*/gi,";$1").replace(/\s*,\s*/g,
",").replace(/\s+/g,",");var x=[],n=0,w=0,m=0,p=0,q=0,A=0;E.slice(1).split(";").forEach(function(t){var B=t[0];t=1<t.length?t.slice(1).split(",").map(function(la){return parseFloat(la)}):[];switch(B){case "M":if(2<=t.length){n=t[0];w=t[1];q=n;A=w;x.push({jb:"M",F:[n,w]});for(B=2;B+1<t.length;B+=2)n=t[B],w=t[B+1],x.push({jb:"L",F:[n,w]});m=n;p=w}break;case "m":if(2<=t.length)for(n+=t[0],w+=t[1],q=n,A=w,x.push({jb:"M",F:[n,w]}),B=2;B+1<t.length;B+=2)n+=t[B],w+=t[B+1],x.push({jb:"L",F:[n,w]});m=n;p=
w;break;case "L":for(B=0;B+1<t.length;B+=2)n=t[B],w=t[B+1],x.push({jb:"L",F:[n,w]});m=n;p=w;break;case "l":for(B=0;B+1<t.length;B+=2)n+=t[B],w+=t[B+1],x.push({jb:"L",F:[n,w]});m=n;p=w;break;case "H":for(B=0;B<t.length;B++)n=t[B],x.push({jb:"L",F:[n,w]});m=n;p=w;break;case "h":for(B=0;B<t.length;B++)n+=t[B],x.push({jb:"L",F:[n,w]});m=n;p=w;break;case "V":for(B=0;B<t.length;B++)w=t[B],x.push({jb:"L",F:[n,w]});m=n;p=w;break;case "v":for(B=0;B<t.length;B++)w+=t[B],x.push({jb:"L",F:[n,w]});m=n;p=w;break;
case "A":for(B=0;B+6<t.length;B+=7){var L=t[B+5],T=t[B+6];x.push({jb:"A",F:[t[B],t[B+1],t[B+2]*Math.PI/180,0!=t[B+3]?1:0,0==t[B+4]?1:0,n,w,L,T]});n=L;w=T}m=n;p=w;break;case "a":for(B=0;B+6<t.length;B+=7)L=n+t[B+5],T=w+t[B+6],x.push({jb:"A",F:[t[B],t[B+1],t[B+2]*Math.PI/180,0!=t[B+3],0==t[B+4],n,w,L,T]}),n=L,w=T;m=n;p=w;break;case "C":for(B=0;B+5<t.length;B+=6)x.push({jb:"C",F:t.slice(B,B+6)}),n=t[B+4],w=t[B+5],m=2*n-t[B+2],p=2*w-t[B+3];break;case "c":for(B=0;B+5<t.length;B+=6)x.push({jb:"C",F:[n+
t[B],w+t[B+1],n+t[B+2],w+t[B+3],n+t[B+4],w+t[B+5]]}),m=n+2*t[B+4]-t[B+2],p=w+2*t[B+5]-t[B+3],n+=t[B+4],w+=t[B+5];break;case "S":for(B=0;B+3<t.length;B+=4)x.push({jb:"S",F:[m,p,t[B],t[B+1],t[B+2],t[B+3]]}),n=t[B+2],w=t[B+3],m=2*n-t[B],p=2*w-t[B+1];break;case "s":for(B=0;B+3<t.length;B+=4)x.push({jb:"S",F:[m,p,n+t[B],w+t[B+1],n+t[B+2],w+t[B+3]]}),m=n-t[B],p=w-t[B+1],n+=t[B+2],w+=t[B+3];break;case "Q":for(B=0;B+3<t.length;B+=4)x.push({jb:"Q",F:[t[B],t[B+1],t[B+2],t[B+3]]}),n=t[B+2],w=t[B+3],m=2*n-t[B],
p=2*w-t[B+1];break;case "q":for(B=0;B+3<t.length;B+=4)x.push({jb:"Q",F:[n+t[B],w+t[B+1],n+t[B+2],w+t[B+3]]}),m=n+2*t[B+2]-t[B],p=w+2*t[B+3]-t[B+1],n+=t[B+2],w+=t[B+3];break;case "T":for(B=0;B+1<t.length;B+=2)x.push({jb:"Q",F:[m,p,t[B],t[B+1]]}),n=t[B],w=t[B+1],m=2*n-m,p=2*w-p;break;case "t":for(B=0;B+1<t.length;B+=2)x.push({jb:"Q",F:[m,p,n+t[B],w+t[B+1]]}),n+=t[B],w+=t[B+1],m=2*n-m,p=2*w-p;break;case "Z":case "z":n=q;w=A;x.push({jb:"Z",F:[]});break;default:throw"unimplemented path command: "+B;}});
return x}var u=g.getAttribute("id"),y=function(){var E=g.getAttribute("style")||"",x=g.getAttribute("class");x&&e.u.hasOwnProperty(x)&&(E=e.u[x]+";"+E);x={};Mf(x,E);(E=g.getAttribute("fill"))&&(x.fill=E);(E=g.getAttribute("stroke"))&&(x.stroke=E);(E=g.getAttribute("stroke-width"))&&(x["stroke-width"]=E);(E=g.getAttribute("stroke-dasharray"))&&(x["stroke-dasharray"]=E.split(","));(E=g.getAttribute("stroke-dashoffset"))&&(x["stroke-dashoffset"]=E);(E=g.getAttribute("id"))&&(x.id=E);return x}();h={name:g.tagName,
id:u,style:y,parent:h};switch(g.tagName){case "svg":h.children=l(h);break;case "g":h.children=l(h);h.transform=b(g.getAttribute("transform"));break;case "path":h.path=r(g.getAttribute("d")||"");h.transform=b(g.getAttribute("transform"));break;case "line":h.Pd=k("x1");h.Rd=k("y1");h.Qd=k("x2");h.Sd=k("y2");h.transform=b(g.getAttribute("transform"));break;case "polygon":case "polyline":h.Rc=g.getAttribute("points").trim().replace(/\s+/g," ").split(" ").map(function(E){return parseFloat(E)});h.transform=
b(g.getAttribute("transform"));break;case "circle":h.x=k("cx");h.y=k("cy");h.r=k("r");h.transform=b(g.getAttribute("transform"));break;case "rect":h.x=k("x");h.y=k("y");h.width=k("width");h.height=k("height");u=k("rx");y=k("ry",u);u=k("rx",y);h.Fh=u;h.Gh=y;h.transform=b(g.getAttribute("transform"));break;case "text":h.x=k("x");h.y=k("y");h.text=g.textContent;h.transform=b(g.getAttribute("transform"));break;default:return null}return h}var e=a,f="";c(a.i);a.u=function(){var g={};f.split("}").forEach(function(h){var l=
h.split("{");l[0].split(",").forEach(function(k){k=k.trim();/^\.[-a-z0-9]+/i.test(k)&&(k=k.slice(1),g[k]=g[k]?g[k]+";"+l[1]:l[1])})});return g}();a.i&&(a.l=d(a.i,null))}function Xf(a,c){function b(e,f){if(e.id===f)return e;if(e.children)for(var g=0;g<e.children.length;g++){var h=b(e.children[g],f);if(h)return h}return null}if(a.H[c])return a.H[c];var d=b(a.l,c);d&&(a.H[c]=d);return d}
function Yf(a,c,b,d,e){a&&a.forEach(function(f){switch(f.jb){case "translate":c(f.F[0],f.F[1]);break;case "rotate":0!==f.F[1]||0!==f.F[2]?(c(-f.F[1],-f.F[2]),b(f.F[0]),c(f.F[1],f.F[2])):b(f.F[0]);break;case "scale":d(f.F[0],f.F[1]);break;case "matrix":e(f.F[0],f.F[1],f.F[2],f.F[3],f.F[4],f.F[5])}})}
Vf.prototype.J=function(a,c){function b(x,n,w){function m(){for(var G=0;G<x.children.length;G++)b(x.children[G],n,w)}function p(G,O){G=h.apply(new Pf(G,O));l.push(G.x);k.push(G.y)}function q(G,O,Q){if(null==G||""==G)return O;G=/^\s*(-?[0-9.]+)\s*([a-z%]*)\s*$/i.exec(G);O=parseFloat(G[1]);switch(G[2]||"px"){case "pt":return 25.4*O/72*3;case "pc":return 25.4*O/6*3;case "in":return 25.4*O*3;case "mm":return 3*O;case "cm":return 30*O;case "em":return 18*O;case "ex":return 9*O;case "%":return O*Q/100;
default:return O}}function A(G){var O=0,Q=0,P=[],V=[],z=!0;a&&a.beginPath();G.forEach(function(D){switch(D.jb){case "M":2<=D.F.length&&(O=D.F[0],Q=D.F[1],a&&a.moveTo(O,Q),p(O,Q),z&&1<P.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(P,V,!1),z=!0,P=l.slice(-1),V=k.slice(-1));break;case "L":O=D.F[0];Q=D.F[1];a&&a.lineTo(O,Q);p(O,Q);P.push(l[l.length-1]);V.push(k[k.length-1]);break;case "A":var v=D.F[5],C=D.F[6];var F=D.F[0];var S=D.F[1],K=D.F[2],ma=0!=D.F[3],na=0!=D.F[4],Z=D.F[5],ia=D.F[6],fa=D.F[7],M=D.F[8];
if(0===F||0===S)a&&a.lineTo(fa,M),F=new Pf(fa,M);else{var I=Math.cos(K),qa=Math.sin(K);D=(I*Z+qa*ia)/F;ia=(-qa*Z+I*ia)/S;Z=(I*fa+qa*M)/F;fa=(-qa*fa+I*M)/S;M=(Z-D)/2;I=(fa-ia)/2;qa=M*M+I*I;qa=Math.sqrt((1-qa)/qa);isNaN(qa)?qa=0:ma===na&&(qa=-qa);ma=(D+Z)/2+qa*I;M=(ia+fa)/2-qa*M;D=Math.atan2((ia-M)/F,(D-ma)/S);ia=Math.atan2((fa-M)/F,(Z-ma)/S);a&&(a.rotate(K),a.scale(F,S),na?a.arc(ma,M,1,D,ia,!0):a.arc(ma,M,1,D,ia),a.scale(1/F,1/S),a.rotate(-K));Z=new Qf;Z.rotate(K);Z.scale(F,S);F=na?D<ia?(D+ia)/2+Math.PI:
(D+ia)/2:D<ia?(D+ia)/2:(D+ia)/2+Math.PI;F=Z.apply(new Pf(ma+Math.cos(F),M+Math.sin(F)))}O=v;Q=C;p(F.x,F.y);p(O,Q);z=!1;break;case "C":a&&a.bezierCurveTo(D.F[0],D.F[1],D.F[2],D.F[3],D.F[4],D.F[5]);O=D.F[4];Q=D.F[5];p(O,Q);z=!1;break;case "S":a&&a.bezierCurveTo(D.F[0],D.F[1],D.F[2],D.F[3],D.F[4],D.F[5]);O=D.F[4];Q=D.F[5];p(O,Q);z=!1;break;case "Q":a&&a.quadraticCurveTo(D.F[0],D.F[1],D.F[2],D.F[3]);O=D.F[2];Q=D.F[3];p(O,Q);z=!1;break;case "Z":a&&a.closePath(),z&&1<P.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(P,
V,!0),z=!0,P=[],V=[]}});z&&1<P.length&&c&&c.Ea&&c.Ea.line&&c.Ea.line(P,V,!1)}function t(G){function O(D,v){if(0<v.length){D.splice(0,D.length);for(var C=0;C<v.length&&1>C;C++){var F=(v[C].getAttribute("offset")||"0").trim(),S=/%$/.test(F)?parseFloat(F.slice(0,-1))/100:parseFloat(F),K=v[C].getAttribute("style");F={};K&&Mf(F,K);isNaN(S)||(K=v[C].getAttribute("stop-color")||F["stop-color"]||"#000",Jf.hasOwnProperty(K)&&(K=Jf[K]),F=(v[C].getAttribute("stop-opacity")||F["stop-opacity"]||"1").trim(),F=
/%$/.test(F)?parseFloat(F.slice(0,-1))/100:parseFloat(F),1!==F&&(/^#[0-9a-f]{3}$/i.test(K)?K="rgba("+K.slice(1).split("").map(function(ma){return 17*parseInt(ma,16)}).map(function(ma){return ma.toString(10)}).join(",")+","+F.toFixed(2)+")":/^#[0-9a-f]{6}$/i.test(K)?K="rgba("+[K.slice(1,3),K.slice(3,5),K.slice(5)].map(function(ma){return parseInt(ma,16)}).map(function(ma){return ma.toString(10)}).join(",")+","+F.toFixed(2)+")":/^rgb(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(K)?K=K.slice(0,-1).replace(/\s+/g,
",")+","+F.toFixed(2)+")":/^hsl(\d+%?(,|\s+)\d+%?(,|\s+)\d+%?)$/i.test(K)&&(K=K.slice(0,-1).replace(/\s+/g,",")+","+F.toFixed(2)+")")),D.push({offset:S,color:K}))}}}function Q(D,v){if(D.attributes["xlink:href"]){var C=D.getAttribute("xlink:href");"#"===C[0]&&(C=g.b.getElementById(C.slice(1)))&&(v=Q(C,v))}v.Pd=D.attributes.x1?parseFloat(D.getAttribute("x1")):v.Pd||0;v.Rd=D.attributes.y1?parseFloat(D.getAttribute("y1")):v.Rd||0;v.Qd=D.attributes.x2?parseFloat(D.getAttribute("x2")):v.Qd||0;v.Sd=D.attributes.y2?
parseFloat(D.getAttribute("y2")):v.Sd||0;v.cd=D.attributes.gradientUnits?D.getAttribute("gradientUnits"):v.cd||"objectBoundingBox";v.mc=D.attributes.gradientTransform?D.getAttribute("gradientTransform"):v.mc||"";v.vb=v.vb||[];O(v.vb,D.getElementsByTagName("stop"));return v}function P(D,v){if(D.attributes["xlink:href"]){var C=D.getAttribute("xlink:href");"#"===C[0]&&(C=g.b.getElementById(C.slice(1)))&&(v=P(C,v))}v.Zc=D.attributes.cx?parseFloat(D.getAttribute("cx")):v.Zc||0;v.$c=D.attributes.cy?parseFloat(D.getAttribute("cy")):
v.$c||0;v.r=D.attributes.r?parseFloat(D.getAttribute("r")):v.r||0;v.cd=D.attributes.gradientUnits?D.getAttribute("gradientUnits"):v.cd||"objectBoundingBox";v.mc=D.attributes.gradientTransform?D.getAttribute("gradientTransform"):v.mc||"";v.vb=v.vb||[];O(v.vb,D.getElementsByTagName("stop"));return v}var V=/^url\(#(.+)\)$/.exec(G);if(V&&V[1]&&(V=g.b.getElementById(V[1])))switch(V.tagName){case "linearGradient":G=Q(V,{});if("objectBoundingBox"===G.cd)throw"objectBoundingBox not supported";if(G.mc)throw V=
new Qf,Of(G.mc,V),"gradientTransform not supported";var z=a.createLinearGradient(G.Pd,G.Rd,G.Qd,G.Sd);for(V=0;V<G.vb.length;V++)z.addColorStop(G.vb[V].offset,G.vb[V].color);return z;case "radialGradient":G=P(V,{});if("objectBoundingBox"===G.cd)throw"objectBoundingBox not supported";G.mc&&(V=new Qf,Of(G.mc,V),z=Rf(V,{x:G.Zc,y:G.$c}),V=G.r/Math.sqrt(Math.abs(V.b[0]*V.b[4])),G.Zc=z.x,G.$c=z.y,G.r=V);z=a.createRadialGradient(G.Zc,G.$c,0,G.Zc,G.$c,G.r);for(V=0;V<G.vb.length;V++)z.addColorStop(G.vb[V].offset,
G.vb[V].color);return z}return G}function B(G,O,Q,P,V,z){0>=V||0>=z?a.rect(G,O,Q,P):(V=Math.min((V+z)/2,Math.min(Q,P)/2),a.moveTo(G+Q-V,O),a.arc(G+Q-V,O+V,V,1.5*Math.PI,2*Math.PI),a.lineTo(G+Q,O+P-V),a.arc(G+Q-V,O+P-V,V,0,.5*Math.PI),a.lineTo(G+V,O+P),a.arc(G+V,O+P-V,V,.5*Math.PI,Math.PI),a.lineTo(G,O+V),a.arc(G+V,O+V,V,Math.PI,1.5*Math.PI),a.closePath())}function L(){if(a){var G={};n&&Kf(G,n);w&&Kf(G,w);"hidden"!==G.visibility&&(G.opacity&&(a.globalAlpha*=parseFloat(G.opacity)),G.fill&&"none"===
G.fill||(a.fillStyle="white"===G.fill||"#fff"===G.fill||"#ffffff"===G.fill?"white":t(G.fill)||"none",a.fill()),G.stroke&&"none"!==G.stroke&&(a.lineWidth=q(G["stroke-width"]||"1px",1,100),a.strokeStyle=G.stroke||"none",a.miterLimit=G["stroke-miterlimit"]||4,a.lineJoin=G["stroke-linejoin"]||"miter",a.lineCap=G["stroke-linecap"]||"butt",G["stroke-dasharray"]&&(a.setLineDash(G["stroke-dasharray"].split(" ").map(function(O){return parseFloat(O)})),a.lineDashOffset=G["stroke-dashoffset"]?parseFloat(G["stroke-dashoffset"]):
0),a.stroke()))}}function T(G,O,Q){if(a){var P={};n&&Kf(P,n);w&&Kf(P,w);"hidden"!==P.visibility&&(a.font=(P["font-size"]||"12px")+" "+(P["font-family"]||"helvetica"),P.fill&&"none"!==P.fill&&(a.fillStyle="white"===P.fill||"#fff"===P.fill||"#ffffff"===P.fill?"white":c&&c.fill||"silver",a.fillText(G,O,Q)),P.stroke&&"none"!==P.stroke&&(a.strokeStyle=c&&c.stroke||"black",a.strokeText(G,O,Q)))}}function la(G,O){G=Sf({x:G,y:O});a.save();a.strokeStyle="black";a.lineWidth=1;a.strokeRect(G.Y,G.ca,G.na-G.Y,
G.oa-G.ca);a.restore()}var U=x.id&&c&&c.Xd&&c.Xd[x.id],H=x.id&&c&&c.Mf&&c.Mf[x.id];a&&a.save();h.save();U&&a&&d(x,U);H&&a&&e(H);n=Lf(n);w=Lf(w);(function(){x.style&&Kf(n,x.style);c&&c.ih&&Mf(n,c.ih);x.id&&c&&c.style&&c.style.hasOwnProperty(x.id)&&Mf(w,c.style[x.id]);for(var G in c.style)c.style.hasOwnProperty(G)&&"!"===G[0]&&G.slice(1)!==x.id&&Mf(w,c.style[G])})();U=l.length;switch(x.name){case "svg":h.save();f(x.transform);m();h.restore();break;case "g":h.save();f(x.transform);m();h.restore();break;
case "path":a&&a.save();h.save();f(x.transform);A(x.path);L();a&&a.restore();h.restore();break;case "line":a&&a.save();h.save();f(x.transform);a&&a.beginPath();a&&a.moveTo(x.Pd,x.Rd);a&&a.lineTo(x.Qd,x.Sd);L();p(x.Pd,x.Rd);p(x.Qd,x.Sd);c&&c.Ea&&c.Ea.line&&c.Ea.line([x.Pd,x.Qd],[x.Rd,x.Sd],!1);a&&a.restore();h.restore();break;case "polygon":case "polyline":if(4<=x.Rc.length){a&&a.save();h.save();f(x.transform);a&&a.beginPath();a&&a.moveTo(x.Rc[0],x.Rc[1]);p(x.Rc[0],x.Rc[1]);for(H=2;H+1<x.Rc.length;H+=
2)a&&a.lineTo(x.Rc[H],x.Rc[H+1]),p(x.Rc[H],x.Rc[H+1]);"polygon"===x.name&&a&&a.closePath();L();c&&c.Ea&&c.Ea.line&&c.Ea.line(l.slice(-x.Rc.length/2),k.slice(-x.Rc.length/2),"polygon"===x.name);a&&a.restore();h.restore()}break;case "circle":a&&a.save();h.save();f(x.transform);a&&a.beginPath();a&&a.arc(x.x,x.y,x.r,0,2*Math.PI);L();p(x.x-x.r,x.y-x.r);p(x.x-x.r,x.y+x.r);p(x.x+x.r,x.y-x.r);p(x.x+x.r,x.y+x.r);if(c&&c.Ea&&c.Ea.Kf){H=l.slice(-4);var J=k.slice(-4),R=(H[3]-H[0])*(H[3]-H[0])+(J[3]-J[0])*(J[3]-
J[0]),X=(H[2]-H[1])*(H[2]-H[1])+(J[2]-J[1])*(J[2]-J[1]);.001>Math.abs(R-X)/(R+X)&&.001>((H[3]-H[0])*(H[2]-H[1])+(J[3]-J[0])*(J[2]-J[1]))/R&&c.Ea.Kf((H[0]+H[2])/2,(J[0]+J[2])/2,Math.sqrt(R/8))}a&&a.restore();h.restore();break;case "rect":a&&a.save();h.save();f(x.transform);a&&(a.beginPath(),0<x.Fh||0<x.Gh?B(x.x,x.y,x.width,x.height,x.Fh,x.Gh):a.rect(x.x,x.y,x.width,x.height));L();p(x.x,x.y);p(x.x,x.y+x.height);p(x.x+x.width,x.y);p(x.x+x.width,x.y+x.height);a&&a.restore();h.restore();break;case "text":a&&
a.save(),h.save(),f(x.transform),T(x.text,x.x,x.y),p(x.x,x.y),a&&a.restore(),h.restore()}a&&a.restore();h.restore();a&&c&&c.hh&&la(l.slice(U),k.slice(U))}function d(x,n){if(n.kb&&0!=n.kb){var w=n.Fe,m=n.Ge;if(void 0==w||void 0==m)w=g.J(null,{ed:x}),x=Sf(w),w=(x.Y+x.na)/2,m=(x.ca+x.oa)/2;a.translate(w+(n.Kb||0),m+(n.Lb||0));a.rotate(n.kb);a.translate(-w,-m)}else(n.Kb||n.Lb)&&a.translate(n.Kb,n.Lb)}function e(x){a.beginPath();a.rect(x.x,x.y,x.sc,x.ld);a.clip()}function f(x){Yf(x,function(n,w){a&&a.translate(n,
w);h.translate(n,w)},function(n){a&&a.rotate(n);h.rotate(n)},function(n,w){a&&a.scale(n,w);h.scale(n,w)},function(n,w,m,p,q,A){a&&a.transform(n,w,m,p,q,A);h.wf(n,w,m,p,q,A)})}var g=this,h=new Tf,l=[],k=[],r=this.l;c&&c.pe?r=Xf(this,c.pe):c&&c.ed&&(r=c.ed);if(r){c&&c.Wf&&c.Wf(a,this.D);if(a){for(var u=[],y=r.parentElement;null!=y;y=y.parentElement)u.push(y);for(y=u.length-1;0<=y;y--){var E=u[y].id;(E=E&&c&&c.Xd&&c.Xd[E])&&d(u[y],E);f(u[y].transform)}}b(r,{},{})}return{x:l,y:k}};
function Zf(a,c){if(a.id===c)return a;if(a.children)for(var b=0;b<a.children.length;b++){var d=Zf(a.children[b],c);if(d)return d}return null}Vf.prototype.Pc=function(a){return null!=Zf(this.l,a)};Vf.prototype.yg=function(a,c){var b=Zf(this.l,c);if(null==b)throw"Undefined SVG element id "+c;return null!=Zf(b,a)};function Qf(a){this.b=a||[1,0,0,0,1,0]}N=Qf.prototype;N.sb=function(){return new Qf(this.b)};N.apply=function(a){return new Pf(this.b[0]*a.x+this.b[1]*a.y+this.b[2],this.b[3]*a.x+this.b[4]*a.y+this.b[5])};function Rf(a,c){var b=a.b[0]*a.b[4]-a.b[3]*a.b[1];return new Pf((a.b[4]*c.x-a.b[1]*c.y+a.b[1]*a.b[5]-a.b[4]*a.b[2])/b,(-a.b[3]*c.x+a.b[0]*c.y+a.b[3]*a.b[2]-a.b[0]*a.b[5])/b)}
N.translate=function(a,c){this.b=[this.b[0],this.b[1],this.b[0]*a+this.b[1]*c+this.b[2],this.b[3],this.b[4],this.b[3]*a+this.b[4]*c+this.b[5]]};N.scale=function(a,c){this.b=[this.b[0]*a,this.b[1]*c,this.b[2],this.b[3]*a,this.b[4]*c,this.b[5]]};N.rotate=function(a){var c=Math.cos(a);a=Math.sin(a);this.b=[c*this.b[0]+a*this.b[1],-a*this.b[0]+c*this.b[1],this.b[2],c*this.b[3]+a*this.b[4],-a*this.b[3]+c*this.b[4],this.b[5]]};
N.wf=function(a,c,b,d,e,f){this.b=[a*this.b[0]+b*this.b[1],c*this.b[0]+d*this.b[1],a*this.b[2]+b*this.b[3],c*this.b[2]+d*this.b[3],a*this.b[4]+b*this.b[5]+e,c*this.b[4]+d*this.b[5]+f]};function Pf(a,c){this.x=a||0;this.y=c||0}function Tf(){this.stack=[new Qf]}N=Tf.prototype;N.apply=function(a){return this.stack[this.stack.length-1].apply(a)};N.save=function(){this.stack.push(this.stack[this.stack.length-1].sb())};N.restore=function(){if(2>this.stack.length)throw"restore doesn't match save";this.stack.pop()};
N.translate=function(a,c){this.stack[this.stack.length-1].translate(a,c)};N.scale=function(a,c){this.stack[this.stack.length-1].scale(a,c)};N.rotate=function(a){this.stack[this.stack.length-1].rotate(a)};N.wf=function(a,c,b,d,e,f){this.stack[this.stack.length-1].wf(a,c,b,d,e,f)};function $f(a){for(var c=0;c<a.draw.length;c++)if(a.draw[c].uri)return a.draw[c].uri;throw"URI not found";}function Uc(a){a=a.split("#");return{ad:a[0],id:a[1]}}function ag(a,c,b){a.N.save();b.Wf=function(d,e){this.clientData.Le=e;d.translate(-e[0],-e[1]);d.scale(this.A.m/(e[2]-e[0]),this.A.m/(e[3]-e[1]))}.bind(a);c.J(a.N,b);a.N.restore()}
function bg(a,c,b,d,e){return{x:(a.clientData.Le[2]-a.clientData.Le[0])/d*(c+a.clientData.Le[0]),y:(a.clientData.Le[3]-a.clientData.Le[1])/e*(b+a.clientData.Le[1])}}
function cg(a,c,b){var d={},e=(a.buttons?a.buttons.length:0)+(a.radiobuttons?1:0);if(void 0!=a.sliders){for(var f=0;f<a.sliders.length;f++){var g=a.sliders[f],h=Uf(c,g.id),l=Uf(c,g.thumbId),k=(l.Y+l.na)/2,r=(l.ca+l.oa)/2;h.na-h.Y<h.oa-h.ca?(h.Y=h.na=(h.Y+h.na)/2,k=h.Y):(h.ca=h.oa=(h.ca+h.oa)/2,r=h.ca);l=(b[e+f]-g.min)/(g.max-g.min);d[g.thumbId]={Kb:l*(h.na-h.Y)-(k-h.Y),Lb:l*(h.ca-h.oa)-(r-h.oa)}}e+=a.sliders.length}if(void 0!=a.rotating)for(f=0;f<a.rotating.length;f++)g=a.rotating[f],l=g.numSteps?
2*Math.PI/g.numSteps:1,h=Uf(c,g.centerId),d[g.id]={kb:b[e+f]*l,Fe:(h.Y+h.na)/2,Ge:(h.ca+h.oa)/2};return d}function dg(a,c,b){return Math.min(Math.max((b-a)/(c-a),0),1)}
function eg(a,c,b,d,e,f,g,h,l){e=bg(a,l.x-g,l.y-h,e,f);var k=a.clientData.Jd.min+(a.clientData.Jd.max-a.clientData.Jd.min)*dg(a.clientData.min,a.clientData.max,a.clientData.ef?e.y:e.x),r=a.clientData.Jd.min,u=a.clientData.Jd.max;(e=a.clientData.Jd.discrete)&&0<e.length?k=e.reduce(function(y,E){return Math.abs(k-E)<Math.abs(k-y)?E:y},e[0]):(a=a.clientData.Jd.snap)&&a.forEach(function(y,E){"string"===typeof y&&/^`.+`$/.test(y)&&(y=Ea(y,c.h,E,!0));Math.abs(k-y)<Math.abs(u-r)/10&&(k=y)});c.h[(d.buttons?
d.buttons.length:0)+(d.radiobuttons?1:0)+b]=Math.max(Math.min(r,u),Math.min(Math.max(r,u),k));Ja(c)}
function fg(a,c,b,d){if(0!==b.draw.length){var e=Uc($f(b)).ad,f=e?cg(b,c.Ib[e],d.h):{},g=null;if(b.diffwheelmotion&&b.diffwheelmotion.id){g=b.diffwheelmotion;var h=g.id,l=g.dx||0,k=g.dy||0,r=g.adjscale||1,u=g.color||"black",y=void 0===g.linewidth?1:g.linewidth;g=Uf(c.Ib[e],h);var E=(b.buttons?b.buttons.length:0)+(b.radiobuttons?1:0),x=2.4*d.h[E];E=2.4*d.h[E+1];var n=a.A.m;g=(.5+l)*(g.na-g.Y)*r/n;l=Ze(a,x,E,g,{color:u,vf:y});f[h]={Kb:-(l.x*g*n+k*n*Math.sin(l.kb)),Lb:-(l.y*g*n+k*n*Math.cos(l.kb)),kb:-l.kb};
g={bi:x,ci:E,ii:g,color:u,vf:y}}b.draw.forEach(function(w){if(w.uri){var m=Uc(w.uri),p=c.Ib[m.ad];m=m.id;for(var q={},A=b.buttons?b.buttons.length:0,t=b.radiobuttons?b.radiobuttons.length:0,B=b.styles?b.styles.length:0,L=0;L<A;L++){var T=b.buttons[L].val,la=b.buttons[L].st;T=T.indexOf(d.h[L]);0<=T&&(q[b.buttons[L].id]=la[T])}for(L=0;L<t;L++)T=b.radiobuttons[L].val,la=b.radiobuttons[L].st,q[b.radiobuttons[L].id]=la[d.h[A]===T?1:0];for(L=0;L<B;L++)q[(b.styles[L].complement?"!":"")+b.styles[L].id]=Ea(b.styles[L].st,
d.h);A=c.Ib[e];t=d.h;B={};if(void 0!=b.sliders)for(L=0;L<b.sliders.length;L++){la=b.sliders[L];T=Uf(A,la.id);var U=la.lowerPartId&&Uf(A,la.lowerPartId);if(U){var H=(t[L]-la.min)/(la.max-la.min),J=U.na-U.Y,R=U.oa-U.ca;B[la.lowerPartId]=T.na-T.Y<T.oa-T.ca?{x:U.Y-R,y:U.ca,sc:J+2*R,ld:R*H}:{x:U.Y,y:U.ca-R,sc:J*H,ld:R+2*J}}}ag(this,p,{pe:m,style:q,Xd:f,Mf:B,hh:!1})}w.js&&(w=new Function("ctx","$",w.js),this.N.save(),this.N.scale(this.A.m/1E3,this.A.m/1E3),this.N.beginPath(),w(this.N,d.h),this.N.restore())},
a);g&&Ze(a,g.bi,g.ci,g.ii,{color:g.color,vf:g.vf});b.score&&b.score.id&&(h=(b.buttons?b.buttons.length:0)+(b.radiobuttons?1:0)+(b.sliders?b.sliders.length:0),k=b.score,u=k.numHeights||5,g=Uf(c.Ib[e],k.id),y=c.Ib[e].D,cf(a,d.h.slice(h),(g.Y-y[0])/(y[2]-y[0]),(g.na-y[0])/(y[2]-y[0]),(g.oa-y[1])/(y[3]-y[1]),(g.ca-y[1])/(y[3]-y[1]),u,(g.oa-g.ca)/(y[3]-y[1])/u*(k.noteSize||1),void 0===k.linewidth?1:k.linewidth))}}
function gg(a,c,b){function d(e){for(var f=0;f<b.length;f++)if(b[f].name===e)return f;return-1}c.forEach(function(e){var f=e.name;if(!f)throw"Missing block name";var g=d(f),h=0<=g?b[g]:null,l=h?h.type:"?";if(e.type||!h)switch(e.type){case "event":l="e";break;case "action":l="a";break;case "state":l="s";break;case "comment":l="c";break;case "hidden":l="h";break;default:throw"Unknown block type "+e.type+" for block "+f;}var k=h?h.va:[];e.modes&&!h&&e.modes.forEach(function(H){switch(H){case "basic":k.push("b");
break;case "advanced":k.push("a");break;default:throw"Unknown block mode "+H;}});var r=h?h.validate:null,u=e.validation;u&&(r=function(H){for(var J=0;J<u.length;J++){var R=u[J].assert;if("string"===typeof R&&/^`.+`$/.test(R)?!Ea(R,H.h,void 0,!0):!R)return(H=u[J].warning)?new Ra(H,!0):new Ra(u[J].error||"Error")}});var y=h?h.J:function(H,J){fg(H,a,e,J)},E=h?h.fa:function(H,J,R,X,G,O,Q){a:{var P=Uc($f(e)).ad,V=0,z=e.buttons;if(z){var D;b:{var v=a.Ib[P],C=bg(H,Q.x-G,Q.y-O,R,X);for(D=0;D<z.length;D++)if(v.Zd(z[D].id,
C.x,C.y)){v=z[D].val.indexOf(J.h[D]);0<=v&&(Ia(J),J.h[D]=z[D].val[(v+1)%z[D].val.length],Ja(J));break b}D=null}if(null!==D){J=V+D;break a}V+=z.length}if(D=e.radiobuttons){b:{v=a.Ib[P];z=z||0;C=bg(H,Q.x-G,Q.y-O,R,X);for(var F=0;F<D.length;F++)if(v.Zd(D[F].id,C.x,C.y)){Ia(J);J.h[z]=D[F].val;Ja(J);D=0;break b}D=null}if(null!==D){J=V+D;break a}V++}if(D=z=e.pushbuttons){b:{D=a.Ib[P];v=bg(H,Q.x-G,Q.y-O,R,X);for(C=0;C<z.length;C++)if(D.Zd(z[C].id,v.x,v.y)){Ia(J);z=z[C].newParameters;"string"===typeof z&&
/^`.+`$/.test(z)&&(z=Ea(z,J.h,void 0,!0));J.h=z;Ja(J);z=!0;break b}z=null}D=null!==z}if(D)J=-1;else{if(z=e.sliders){b:{D=a.Ib[P];v=bg(H,Q.x-G,Q.y-O,R,X);for(C=0;C<z.length;C++){H.clientData.Jd=z[C];var S=Uf(D,H.clientData.Jd.id);H.clientData.ef=S.na-S.Y<S.oa-S.ca;H.clientData.min=H.clientData.ef?S.oa:S.Y;H.clientData.max=H.clientData.ef?S.ca:S.na;F=(S.Y+S.na)/2;S=(S.ca+S.oa)/2;var K=Uf(D,H.clientData.Jd.thumbId);if(Math.abs((H.clientData.ef?v.x:v.y)-(H.clientData.ef?F:S))<(H.clientData.ef?K.na-K.Y:
K.oa-K.ca)){Ia(J);D=C;break b}}D=null}if(null!==D){J=V+D;break a}V+=z.length}if(z=e.rotating){b:{D=a.Ib[P];v=J.h.slice(V,V+z.length);C=bg(H,Q.x-G,Q.y-O,R,X);for(F=0;F<z.length;F++){S=Uf(D,z[F].centerId);S={x:(S.Y+S.na)/2,y:(S.ca+S.oa)/2};var ma=z[F].numSteps?2*Math.PI/z[F].numSteps:1;K=S.x+(C.x-S.x)*Math.cos(v[F]*ma)+(C.y-S.y)*Math.sin(v[F]*ma);ma=S.y-(C.x-S.x)*Math.sin(v[F]*ma)+(C.y-S.y)*Math.cos(v[F]*ma);if(D.Zd(z[F].thumbId,K,ma)){H.clientData.Hi=z[F];H.clientData.bh=S;H.clientData.gi=Math.atan2(ma-
S.y,K-S.x);Ia(J);D=F;break b}}D=null}if(null!==D){J=V+D;break a}V+=z.length}if(e.score&&(v=a.Ib[P],H=(e.buttons?e.buttons.length:0)+(e.radiobuttons?1:0)+(e.sliders?e.sliders.length:0),P=J.h.slice(H).length/2,z=e.score.numHeights||5,D=Uf(v,e.score.id),v=v.D,(R=uf((D.Y-v[0])/(v[2]-v[0]),(D.na-v[0])/(v[2]-v[0]),(D.oa-v[1])/(v[3]-v[1]),(D.ca-v[1])/(v[3]-v[1]),P,z,R,X,G,O,Q))?(Ia(J),J.h[H+2*R.index]===R.tone?J.h[H+2*R.index+1]=(J.h[H+2*R.index+1]+1)%3:(J.h[H+2*R.index]=R.tone,J.h[H+2*R.index+1]=1),Ja(J),
D=0):D=null,null!==D)){J=V+D;break a}J=null}}return J},x=h?h.Pa:function(H,J,R,X,G,O,Q,P){var V=(e.buttons?e.buttons.length:0)+(e.radiobuttons?1:0),z=e.sliders?e.sliders.length:0;R>=V&&R<V+z?eg(H,J,R-V,e,X,G,O,Q,P):(V+=z,z=e.rotating?e.rotating.length:0,R>=V&&R<V+z&&(R-=V,X=bg(H,P.x-O,P.y-Q,X,G),J.h[(e.buttons?e.buttons.length:0)+(e.radiobuttons?1:0)+(e.sliders?e.sliders.length:0)+R]=Math.round(((Math.atan2(X.y-H.clientData.bh.y,X.x-H.clientData.bh.x)-H.clientData.gi+Math.PI)%(2*Math.PI)-Math.PI)/
(e.rotating[R].numSteps?2*Math.PI/e.rotating[R].numSteps:1)),Ja(J)))},n=Hf(e,h&&h.Mb),w=h&&h.ha||null;if((null==h||null==h.J)&&"h"!==l){var m=Uc($f(e)).ad,p=a.Ib[m],q=0;e.buttons&&(e.buttons.forEach(function(H,J){var R=Uf(p,H.id);R=new Ga((R.ca-p.D[1])/(p.D[3]-p.D[1]),(R.Y-p.D[0])/(p.D[2]-p.D[0]),(R.oa-p.D[1])/(p.D[3]-p.D[1]),(R.na-p.D[0])/(p.D[2]-p.D[0]),function(X){var G=H.val.indexOf(X.h[J]);0<=G&&(Ia(X),X.h[J]=H.val[(G+1)%H.val.length],Ja(X))},null,null);null==w&&(w=new Fa);w.controls.push(R)}),
q=e.buttons.length);var A=0;e.radiobuttons&&(e.radiobuttons.forEach(function(H){var J=Uf(p,H.id);J=new Ga((J.ca-p.D[1])/(p.D[3]-p.D[1]),(J.Y-p.D[0])/(p.D[2]-p.D[0]),(J.oa-p.D[1])/(p.D[3]-p.D[1]),(J.na-p.D[0])/(p.D[2]-p.D[0]),function(R){Ia(R);R.h[q]=H.val;Ja(R)},null,null);null==w&&(w=new Fa);w.controls.push(J)}),A=e.radiobuttons.length);var t=0;e.pushbuttons&&(e.pushbuttons.forEach(function(H){var J=Uf(p,H.id);J=new Ga((J.ca-p.D[1])/(p.D[3]-p.D[1]),(J.Y-p.D[0])/(p.D[2]-p.D[0]),(J.oa-p.D[1])/(p.D[3]-
p.D[1]),(J.na-p.D[0])/(p.D[2]-p.D[0]),function(R){Ia(R);var X=H.newParameters;"string"===typeof X&&/^`.+`$/.test(X)&&(X=Ea(X,R.h,void 0,!0));R.h=X;Ja(R)},null,null);null==w&&(w=new Fa);w.controls.push(J)}),t=e.pushbuttons.length);var B=0;e.sliders&&(e.sliders.forEach(function(H,J){var R=Uf(p,H.id),X=Uf(p,H.thumbId),G=Math.abs(X.na-X.Y);X=Math.abs(X.oa-X.ca);var O=H.min,Q=H.max,P=H.discrete;H=new Ga((R.ca-X/2-p.D[1])/(p.D[3]-p.D[1]),(R.Y-G/2-p.D[0])/(p.D[2]-p.D[0]),(R.oa+X/2-p.D[1])/(p.D[3]-p.D[1]),
(R.na+G/2-p.D[0])/(p.D[2]-p.D[0]),null,function(V){var z=V.h[q+A+t+J];P?(z=P.indexOf(z),z=0<=z&&z+1<P.length?P[z+1]:0<P.length?P[P.length-1]:Math.max(O,Q)):z=Math.min(Math.max(O,Q),z+Math.abs(Q-O)/10);V.h[q+A+t+J]=z},function(V){var z=V.h[q+A+t+J];P?(z=P.indexOf(z),z=0<=z&&0<z?P[z-1]:0<P.length?P[0]:Math.min(O,Q)):z=Math.max(Math.min(O,Q),z-Math.abs(Q-O)/10);V.h[q+A+t+J]=z});null==w&&(w=new Fa);w.controls.push(H)}),B=e.sliders.length);var L=0;e.rotating&&(e.rotating.forEach(function(H,J){var R=Uf(p,
H.id),X=Uf(p,H.centerId),G=(X.Y+X.na)/2;X=(X.ca+X.oa)/2;R=Math.max(Math.max(Math.abs(R.Y-G),Math.abs(R.na-G)),Math.max(Math.abs(R.ca-X),Math.abs(R.oa-X)));var O=H.numSteps,Q=-Math.floor(O/2);H=new Ga((X-R-p.D[1])/(p.D[3]-p.D[1]),(G-R-p.D[0])/(p.D[2]-p.D[0]),(X+R-p.D[1])/(p.D[3]-p.D[1]),(G+R-p.D[0])/(p.D[2]-p.D[0]),null,function(P){P.h[q+A+t+B+J]=(P.h[q+A+t+B+J]+O-Q+1)%O+Q},function(P){P.h[q+A+t+B+J]=(P.h[q+A+t+B+J]+O-Q-1)%O+Q});null==w&&(w=new Fa);w.controls.push(H)}),L=e.rotating.length);if(e.score){var T=
Uf(p,e.score.id),la=(e.defaultParameters.length-q-A-t-B-L)/2,U=e.score.numHeights||5;for(m=0;m<la;m++)(function(H){var J=q+A+t+B+L,R=new Ga((T.ca-p.D[1])/(p.D[3]-p.D[1]),(T.Y-p.D[0]+(T.na-T.Y)*H/la)/(p.D[2]-p.D[0]),(T.oa-p.D[1])/(p.D[3]-p.D[1]),(T.Y-p.D[0]+(T.na-T.Y)*(H+1)/la)/(p.D[2]-p.D[0]),function(X){X.h[J+2*H+1]=Af(X.h[J+2*H+1],[0,1,2])},function(X){0===X.h[J+2*H+1]?(X.h[J+2*H]=0,X.h[J+2*H+1]=1):X.h[J+2*H]=Math.min(X.h[J+2*H]+1,U-1)},function(X){0===X.h[J+2*H+1]?(X.h[J+2*H]=0,X.h[J+2*H+1]=1):
X.h[J+2*H]=Math.max(X.h[J+2*H]-1,0)},function(X,G,O){G=U-1-Math.floor(O*U*.9999);0===X.h[J+2*H+1]?(X.h[J+2*H]=G,X.h[J+2*H+1]=1):X.h[J+2*H]===G?X.h[J+2*H+1]=Af(X.h[J+2*H+1],[0,1,2]):X.h[J+2*H]=G});null==w&&(w=new Fa);w.controls.push(R)})(m)}}f={name:f,type:l,va:k,sa:h?h.sa:function(){return e.defaultParameters||[]},fb:h?h.fb:function(){return e.typicalParameters||e.defaultParameters||[]},df:h?h.df||null:e.typicalParamSet||null,ha:w,J:y,Je:h?h.Je||!1:e.alwaysZoom||!1,fa:E,Pa:x,Mb:n,validate:r};0<=g?
b[g]=new Ca(f):b.push(new Ca(f))})}
function hg(a){wc=function(b,d){return{m:b,ph:void 0===a.styles.minInteractiveBlockSize?60:a.styles.minInteractiveBlockSize,qh:void 0===a.styles.minTouchInteractiveBlockSize?120:a.styles.minTouchInteractiveBlockSize,jh:void 0===a.styles.eventRightAlign?!1:a.styles.eventRightAlign,ua:void 0===a.styles.blockLineWidth?Math.max(1,Math.min(3,b/40)):a.styles.blockLineWidth,ng:Math.round(b/4).toString(10)+"px sans-serif",g:d,Ca:void 0===a.styles.controlLineWidth?Math.max(1,Math.min(3,b/40)):a.styles.controlLineWidth,
Zh:"bold 15px sans-serif",qg:a.styles.errorColor||"#f88",Ug:a.styles.warningColor||"#f88",background:a.styles.background||"white",Ig:a.styles.ruleMarks||"#bbb",Kg:a.styles.scrollbarThumbColor||"navy",Jg:a.styles.scrollbarBackgroundColor||"#ccc",vd:a.styles.scrollbarWidth||5}};var c=[];gg(a,a.blocks||[],c);mb=c};function Ra(a,c){this.w=a;this.Wb=c||!1;this.i=!1;this.l=[];this.b=[];this.u=null}function Fb(a,c){a.i=!0;a.l=c}function Sa(a,c){a.i=!0;a.u=c};function db(){this.Ic=[];this.Hd=[]}function ig(a,c){this.state=a;this.marks=c||{}}function jg(a,c){function b(d){if(c){if(d.marks)for(var e in d.marks)d.marks.hasOwnProperty(e)&&c[e]&&(d.marks[e]=!1)}else d.marks={}}a.Ic.forEach(b);a.Hd.forEach(b)}db.prototype.yb=function(a,c){c&&jg(this,c);this.Ic.push(new ig(a,c));20<this.Ic.length&&(this.Ic=this.Ic.slice(-20));this.Hd=[]};db.prototype.ig=function(a,c){c&&jg(this,c);return 0<this.Ic.length?(this.Hd.push(new ig(a,c)),this.Ic.pop()):new ig(a,c)};
db.prototype.Fg=function(a,c){c&&jg(this,c);return 0<this.Hd.length?(this.Ic.push(new ig(a,c)),this.Hd.pop()):new ig(a,c)};Ha.prototype.toDataURL=function(a,c,b){function d(l){l&&(l[0]*=g,l[1]*=h)}var e=this;switch(this.T.type){case "e":var f=wd(a,{tag:"block",ga:["event","html"]});break;case "a":f=wd(a,{tag:"block",ga:["action","html"]});break;case "s":f=wd(a,{tag:"block",ga:["state","html"]});break;case "c":f=wd(a,{tag:"block",ga:["comment","html"]});break;default:throw"internal";}var g=c.m/f.width,h=c.m/f.height;f.width=c.m;f.height=c.m;d(f.borderBottomLeftRadius);d(f.borderBottomRightRadius);d(f.borderTopLeftRadius);
d(f.borderTopRightRadius);return(new Ed(this,ed(f),f.ra(),0,0,function(l,k,r,u,y){r=k.x+f.offsetLeft()+r;u=k.y+f.offsetTop()+u;hd(f,l.N,r,u);var E=e.T;k=k.data;var x=f;l.N.save();l.N.translate(r,u);E.J(l,k,x,y);l.N.restore()})).toDataURL(c,b||1)};function kg(a,c,b,d,e){a=a.toDataURL(c,b,d);b="<img width='"+b.m.toString(10)+"' height='"+b.m.toString(10)+"' src='"+a+"'>";return e?"<a href='"+a+"' download='"+e+"'>"+b+"</a>":b}
function lg(a,c,b,d,e){var f=wd(b,{tag:"widget",id:"widget-"+c.replace(/^.*:/g,"")}),g=ed(f),h=f.ra();return{url:(new Ed(null,g,h,0,0,function(l,k,r,u){l.aa=a.aa;Rd(l,c,g/2+r,h/2+u,f)})).toDataURL(d,e||1),width:g,height:h}}function mg(a,c,b,d,e,f){a=lg(a,c,b,d,e);c="<img width='"+a.width.toString(10)+"' height='"+a.height.toString(10)+"' src='"+a.url+"'>";return f?"<a href='"+a.url+"' download='"+f+"'>"+c+"</a>":c}
function xc(a,c,b,d,e,f){return{url:(new Ed(null,c,b,0,0,function(g){a(g.N,d,!1)})).toDataURL(e,f||1),width:c,height:b}}function Ec(a,c,b,d,e){for(var f=0;f<a.controls.length;f++){var g=a.controls[f];if(g.id===c)return xc(function(h,l,k){g.J(h,l,k)},g.hd.na-g.hd.Y,g.hd.oa-g.hd.ca,b,d,e)}return null}
function Xc(a,c){var b=wc(100,100),d=mg(a.ba,"vpl:then",c,b,5);return"<!DOCTYPE html>\n<html>\n"+(a.S?"<head>\n<style>\n"+a.S+"</style>\n</head>\n":"")+"<body>\n<table class='program'>\n"+a.j.j.map(function(e){return e instanceof Ta?"<tr class='rule-comment'>\n<td class='comment'>\n"+e.je+"\n</td>\n</tr>\n":e.Tb()?"":"<tr class='rule'>\n<td class='events'>\n<table class='events'>\n<tr class='events'>\n"+e.X.map(function(f,g){var h="block";switch(f.T.type){case "e":h=h+" event"+(0===g?" event-main":
" event-aux");break;case "s":h+=" state";break;case "c":h+=" comment"}return"<td class='"+h+"'>"+kg(f,c,b,5)+"</td>\n"}).join("")+"</tr>\n</table>\n</td>\n<td class='then'>"+d+"</td>\n<td class='actions'>\n<table class='actions'>\n<tr class='actions'>\n"+e.actions.map(function(f){var g="block";switch(f.T.type){case "a":g+=" action";break;case "c":g+=" comment"}return"<td class='"+g+"'>"+kg(f,c,b,5)+"</td>\n"}).join("")+"</tr>\n</table>\n</td>\n</tr>\n"}).join("")+"</table>\n</body>\n</html>\n"}
function Zc(a,c,b){function d(w,m){return m.controls.map(function(p){return(w.I.find(p.id).lb||[{}]).map(function(q){w.lc.Oa=!0===q.selected;w.lc.state=q.state||null;var A=!0===q.selected?"selected":!1===q.selected?"unselected":"";q.state&&(A+=(0<A.length?" ":"")+"="+q.state);q=p.id+(A?"-"+A.replace(/\s+/g,"-").replace("=",""):"")+".png";var t=Ec(m,p.id,h[p.id],e,f),B="<img width='"+t.width.toString(10)+"' height='"+t.height.toString(10)+"' src='"+t.url+"'>";return"<tr><td>"+(q?"<a href='"+t.url+
"' download='"+q+"'>"+B+"</a>":B)+"</td><td>"+p.id+"</td><td>"+A+"</td></tr>\n"}).join("")}).join("")}var e=wc(100,100),f=5,g=Bc(a,c);a.lc={disabled:!1,$:!0,nh:!1,isEnabled:!0,Oa:!1,state:null};var h=Cc(a,a.Kc,["vpl","top"]),l=Dc(a,a.Kc,["vpl","top"],g.Hc,g.Og,h);h=Object.assign(h,Cc(a,a.zc,["vpl","bottom"]));g=Dc(a,a.zc,["vpl","bottom"],g.Nd,g.Ng,h);a.Za.forEach(function(w){h[w]=wd(c,{tag:"button",id:w.replace(/:/g,"-"),ga:["src","top"]})},a);var k=null;null!=a.O&&(k=ng(a,a.Za,wd(c,{tag:"toolbar",
ga:["src","top"]}),wd(c,{tag:"separator",ga:["src","top"]}),h));a.Ha.forEach(function(w){h[w]=wd(c,{tag:"button",id:w.replace(/:/g,"-"),ga:["sim","top"]})},a);var r=a.M,u=null,y=[],E=null;if(null!=r){u=og(a,a.Ha,wd(c,{tag:"toolbar",ga:["sim","top"]}),wd(c,{tag:"separator",ga:["sim","top"]}),h);y="sim-event:forward sim-event:backward sim-event:left sim-event:right sim-event:center sim-event:clap sim-event:tap".split(" ");var x=wd(c,{tag:"button",ga:["sim","event"]});E=y.map(function(w){return xc(function(m,
p,q){(r.fe||yc)(w,m,e,c,["sim","event"],null,!0,!1,q)},x.width,x.height,x,e,f)})}var n=a.j;b=b?"<!DOCTYPE html>\n<html>\n"+(a.S?"<head>\n<style>\n"+a.S+"</style>\n</head>\n":"")+"<body>\n<table>\n"+function(){for(var w=0,m=0,p="";;){for(;w<mb.length&&("e"!==mb[w].type&&"s"!==mb[w].type||0>("b"===n.mode?n.ec:n.kc).indexOf(mb[w].name));)w++;var q="";if(w<mb.length){var A=new Ha(mb[w],null,null);mb[w].fb&&(A.h=mb[w].fb());q=kg(A,c,e,f,mb[w].name.replace(/ /g,"_")+".png");w++}for(;m<mb.length&&("a"!==
mb[m].type&&"c"!==mb[m].type||0>("b"===n.mode?n.ec:n.kc).indexOf(mb[m].name));)m++;A="";m<mb.length&&(A=new Ha(mb[m],null,null),mb[m].fb&&(A.h=mb[m].fb()),A=kg(A,c,e,f,mb[m].name.replace(/ /g,"_")+".png"),m++);if(q||A)p+="<tr>\n<td>"+q+"</td>\n<td>"+A+"</td>\n</tr>\n";else break}return p}()+"</table></html>":"<!DOCTYPE html>\n<html>\n"+(a.S?"<head>\n<style>\n"+a.S+"</style>\n</head>\n":"")+"<body>\n<table>\n"+mb.map(function(w){var m=null;switch(w.type){case "e":m="event";break;case "s":m="state";
break;case "a":m="action";break;case "c":m="comment";break;default:return""}var p=new Ha(w,null,null),q="<tr class='"+m+"'>\n<td>\n";w.df?w.df.forEach(function(A,t){p.h=A;q+=kg(p,c,e,f,w.name.replace(/ /g,"_")+"-"+t.toString(10)+".png")}):(p.h=w.fb?w.fb():p.h,q+=kg(p,c,e,f,w.name.replace(/ /g,"_")+".png"));return q+="</td>\n<td>"+w.name+"</td>\n</tr>\n"}).join("")+"</table>\n<table>\n"+Object.keys(a.ba.aa).map(function(w){return"<tr><td>"+mg(this.ba,w,c,e,f,w+".png")+"</td><td>"+w+"</td></tr>\n"},
a).join("")+"</table>\n<table>\n"+d(a,l)+d(a,g)+(null!=a.O?d(a,k):"")+(null!=r?d(a,u)+E.map(function(w,m){m=y[m];var p="<img width='"+w.width.toString(10)+"' height='"+w.height.toString(10)+"' src='"+w.url+"'>",q=m.replace(/ /g,"_")+".png";return"<tr><td><a href='"+(w.url+"' download='"+q+"'>"+p+"</a></td><td>")+m+"</td></tr>\n"}):"")+"</table>\n</body>\n</html>\n";a.lc=null;return b};function pg(a,c){c=(new DOMParser).parseFromString(c,"text/xml").getElementsByTagName("node");if(1>c.length)throw"empty";c=c[0].getElementsByTagName("program");if(1!==c.length)throw"program";var b="0"!==c[0].getAttribute("advanced_mode");c=c[0].getElementsByTagName("set");nb(a);a.mode=b?"a":"b";for(b=0;b<c.length;b++){var d=qg(c[b],function(){a.yb()},function(){rb(a)});a.j.push(d)}}
function qg(a,c,b){a=a.getElementsByTagName("block");for(var d=new Oa,e=0;e<a.length;e++){a:{var f=a[e];f.getAttribute("type");var g=f.getAttribute("name");var h=[];for(var l=[],k=0;1E3>k;k++){var r=f.getAttribute("value"+k);if(null===r)break;h.push(r);l.push(parseFloat(r))}for(k=0;k<Da.length;k++)if(g===Da[k].Sh&&(!Da[k].Ta||Ea(Da[k].Ta,Da[k].Lh?h:l,void 0,!0))){f=Da[k].Wh;if(void 0==f){h=null;break a}h=Da[k].parameters?Ea(Da[k].parameters,Da[k].Lh?h:l,void 0,!0):null;l=Na(f);k=new Ha(l,null,null);
l.Se?l.Se(k,h):k.h=h;h=k;break a}throw"unknown AESL block "+g;}h&&d.Yb(h,null,c,b,!0)}return d}function rg(a,c,b,d){d=d||"application/xml";var e;"function"===typeof window.Blob&&window.URL?e=window.URL.createObjectURL(new window.Blob([c],{type:d})):e="data:"+d+";base64,"+window.btoa(c);a.href=e;a.download=b||"untitled.xml"}
var zc=function(){var a=null;return function(c,b,d){null===a&&(a=document.createElement("a"),document.body.appendChild(a),a.style.display="none");d=d||"application/xml";if("function"===typeof window.Blob&&window.URL){var e=new window.Blob([c],{type:d});if(/ipad/i.test(navigator.userAgent)){var f=new FileReader;f.readAsDataURL(e);f.onloadend=function(){window.webkit.messageHandlers.blobReady.postMessage({data:f.result,filename:b})}}e=window.URL.createObjectURL(e)}else e="data:"+d+";base64,"+window.btoa(c);
/ipad/i.test(navigator.userAgent)?(a.href=e,a.download=b):rg(a,c,b,d);a.click();("string"!==typeof e||/ipad/i.test(navigator.userAgent))&&window.URL.revokeObjectURL(e)}}();function sg(){this.Ob=document.getElementById("editor");this.Ob.value="";this.b=this.Ob.parentElement;var a=window.innerWidth,c=window.getComputedStyle(this.Ob);this.Ob.style.width=a-10-parseInt(c.paddingLeft,10)-parseInt(c.paddingRight,10)+"px";this.Ob.style.border="0px";this.Ob.style.outline="none";this.Ob.style.resize="none";this.Ob.style.whiteSpace="pre";this.Ob.setAttribute("wrap","off");this.i=null}sg.prototype.eg=function(a,c){this.Ob.setSelectionRange(a,c)};
sg.prototype.resize=function(){var a=this.b.getBoundingClientRect().width,c=window.getComputedStyle(this.Ob);this.Ob.style.width=a-10-parseInt(c.paddingLeft,10)-parseInt(c.paddingRight,10)+"px"};function tg(a,c){a.Ob.value=c;window.getComputedStyle(a.Ob)};function ug(a,c,b){this.ta=c;this.language=b||"aseba";this.b="";this.nd=!0;this.Ld=this.Pe=this.Rg=null;this.Zb=!1;this.W=a.W||new Ua;this.Gc=new sg;this.Gc.Ob.readOnly=this.nd;this.Gc.i=function(f){window.vplBreakpointsFunction&&window.vplBreakpointsFunction(f)};var d=this;this.Ua=new $b(a.rb,{ia:a.ia});document.getElementById("editor").addEventListener("input",function(){Lc(a);vg(d)===a.j.ta&&(a.j.ta=!a.j.ta,ac(a))},!1);var e=document.getElementById("editor");e&&document.getElementById("editor").addEventListener("keydown",
function(f){if(9===f.keyCode){f.preventDefault();f.b=!0;f=e.value;var g=this.selectionStart;f=f.slice(0,g)+"\t"+f.slice(this.selectionEnd);tg(d.Gc,f);this.selectionStart=this.selectionEnd=g+1;return!1}return!0},!1)}function wg(a,c){a.Rg=c}N=ug.prototype;N.Xe=function(){this.W.b=[]};function Ic(a,c,b){null===c?tg(a.Gc,a.b):(a.b=c,tg(a.Gc,c));b||(a.Ld=null)}N.Cc=function(){return document.getElementById("editor").value.replace(/\s+$/,"")};function vg(a){return a.Cc()===a.b.trim()}
N.eg=function(a,c){this.Gc.eg(a,c)};function xg(a){var c=wd(a.Ua.ia,{tag:"button",ga:["src","top"]});c.height=a.Ua.A.g;a=wd(a.Ua.ia,{tag:"toolbar",ga:["src","top"]});a.height=c.ra();return{height:a.height,ra:a.ra()}}function ng(a,c,b,d,e){var f=new bd(a.O.Ua);ud(f,a,c,["src","top"],a.O.fe||yc,a.O.bf||pd);dd(f,b,e,d);return f}
function Lc(a){var c=a.O;c.Ua.ob=[];var b=c.Mg||a.Za,d=Cc(a,b,["src","top"]),e=xg(c).height,f=$d(c.Ua);Zd(c.Ua);var g=wd(c.Ua.ia,{tag:"view",ga:["src"]});wd(c.Ua.ia,{tag:"button",ga:["src","top"]});var h=wd(c.Ua.ia,{tag:"separator",ga:["src","top"]}),l=wd(c.Ua.ia,{tag:"toolbar",ga:["src","top"]});g.Uc(f.width);g.Ec(f.height);g.setPosition(0,0);l.Uc(g.width);l.height=e;l.setPosition(g.x,g.y);gd(c.Ua,function(k){g.J(k)});fd(ng(a,b,l,h,d),l,d);Fc(c.Ua)}
function Gc(a,c){(a.nd=c)&&tg(a.Gc,a.b);a.Gc.Ob.readOnly=c;Lc(window.vplApp)}
N.resize=function(a,c){this.Ua.resize(a,c);a=this.Ua.b.getBoundingClientRect();c=document.getElementById("src-editor");var b=$d(this.Ua);var d=wd(this.Ua.ia,{tag:"view",ga:["src"]});d.Uc(b.width);d.Ec(b.height);d.setPosition(0,0);var e=xg(this);b=d.x;var f=d.y+e.ra;var g=d.width;d=d.height-e.ra;c.style.left=a.left+a.width*this.Ua.Ja.Y+b+"px";c.style.width=g+"px";c.style.top=a.top+a.height*this.Ua.Ja.ca+f+"px";c.style.height=d+"px";this.Gc.resize();Lc(window.vplApp)};
N.focus=function(){document.getElementById("editor").focus();Fc(this.Ua)};function yg(a){a.I.add("src:close",{action:function(c){c.qb(["src"],{Nf:!0})},object:a,$:function(c){return 1<c.Ka.length&&0<=c.Ka.indexOf("src")}});a.I.add("src:new",{action:function(c){tg(c.O.Gc,"");Fc(c.O.Ua)},isEnabled:function(c){return!c.O.nd&&0<c.O.Cc().length},object:a});a.I.add("src:save",{action:function(c){var b=ub(c.j,{qd:!1,td:!0});zc(b,c.j.filename||"program.vpl3","application/x-vpl3")},isEnabled:function(c){return 0<c.O.Cc().length},object:a});a.I.add("src:vpl",{action:function(c){c.we?
c.qb(["vpl"],{ye:!0}):c.qb(["vpl"],{te:"src"})},isEnabled:function(c){return vg(c.O)},object:a,$:function(c){return!c.O.ta&&0>c.Ka.indexOf("vpl")}});a.I.add("src:locked",{action:function(c){Gc(c.O,!c.O.nd);Fc(c.O.Ua);c.O.nd&&(c.j.ta=!1,ac(c))},isEnabled:function(c){return null===c.O.Ld},Oa:function(c){return c.O.nd},object:a,$:function(c){return!c.O.ta},lb:[{selected:!1},{selected:!0}]});a.I.add("src:language",{action:function(c){var b=c.O.Rg();c.O.language=b.language;c.O.nd&&Ic(c.O,b.code)},isEnabled:function(c){return null===
c.O.Ld},getState:function(c){return c.O.language},object:a,$:function(c){return null!=c.O.Rg},lb:[{state:"aseba"},{state:"l2"},{state:"asm"},{state:"js"},{state:"python"}]});a.I.add("src:disass",{action:function(c){if(null!==c.O.Ld)Ic(c.O,c.O.Ld),c.O.Gc.Ob.readOnly=c.O.nd;else{var b=c.O.Cc(),d=c.O.Pe(c.O.language,b);null!==d&&(Ic(c.O,d,!0),c.O.Gc.Ob.readOnly=!0,c.O.Ld=b)}Lc(c)},isEnabled:function(c){return null!=c.O.Pe&&null!==c.O.Pe(c.O.language,"")},Oa:function(c){return null!==c.O.Ld},object:a,
$:function(c){return null!==c.O.Pe},lb:[{selected:!1},{selected:!0}]});a.I.add("src:run",{action:function(c){var b=c.O.Cc();c.Ga[c.ma].Qa.oc(b,c.O.language)},isEnabled:function(c){return c.Ga[c.ma].Qa.isEnabled(c.O.language)},object:a,$:function(c){return 0<=c.ma}});a.I.add("src:stop",{action:function(c){Pc(c)},isEnabled:function(c){return Qc(c)},object:a,$:function(c){return 0<=c.ma}});a.I.add("src:connected",{isEnabled:function(c){return!c.j.ta&&0<=c.ma&&c.Ga[c.ma].Qa.isConnected()},object:a,$:function(c){return 0<
c.Ga.length},lb:[{selected:!1},{selected:!0},{selected:!1,state:"monitored"},{selected:!0,state:"monitored"},{selected:!1,state:"nonmonitored"},{selected:!0,state:"nonmonitored"}]});a.I.add("src:sim",{action:function(c){c.we?c.qb(["sim"],{ye:!0}):c.qb(["sim"],{te:"src"})},object:a,$:function(c){return null!=c.Ga.find(function(b){return"sim"===b.name})&&null!=c.M&&0>c.Ka.indexOf("sim")}});a.I.add("src:teacher-reset",{action:function(c){c.O.Xe();Lc(c)},object:a,pd:!0,$:function(c){return c.O.Zb&&c.O.W.ic}});
a.I.add("src:teacher",{action:function(c){c.O.W.ic=!c.O.W.ic;Lc(c)},Oa:function(c){return c.O.W.ic},object:a,pd:!0,$:function(c){return c.O.Zb},lb:[{selected:!1},{selected:!0}]})};function zg(a){var c=["vpl:message-error","vpl:message-warning","vpl:filename"];return function(b,d,e,f,g,h,l,k,r,u,y,E){function x(m){if(void 0==m)return!0;for(var p=0;p<m.length;p++)switch(m[p]){case "pressed":if(!y||!r)return!1;break;case "unpressed":if(y&&r)return!1;break;case "selected":if(!u)return!1;break;case "unselected":if(u)return!1;break;case "disabled":if(r)return!1;break;case "enabled":if(!r)return!1;break;default:if("="===m[p][0]&&(E||"").toString()!==m[p].slice(1))return!1}return!0}
if(a.buttons)for(var n=0;n<a.buttons.length;n++)if(a.buttons[n].name===d&&x(a.buttons[n].state)){var w=a.buttons[n];w.draw.forEach(function(m){if(m.uri){var p=Uc(m.uri);e.save();m.alpha&&(e.globalAlpha=m.alpha);var q={};w.styles&&w.styles.forEach(function(A){q[(A.complement?"!":"")+A.id]=A.st});a.Ib[p.ad].J(e,{pe:p.id,style:q});m.debug&&(e.fillStyle="black",e.textAlign="center",e.textBaseline="middle",e.fillText(m.debug,l.width/2,l.height/2));e.restore()}m.js&&(p={pressed:y&&r,unpressed:!(y&&r),selected:u,
unselected:!u,disabled:!r,enabled:r,state:E},m=new Function("ctx","$",m.js),e.save(),e.scale(l.width/1E3,l.height/1E3),e.beginPath(),m(e,p),e.restore())});return}0<=c.indexOf(d)?yc(b,d,e,f,g,h,l,k,r,u,y,E):(e.fillStyle="brown",e.fillRect(0,0,l.width,l.height),e.fillStyle="white",e.textAlign="left",e.textBaseline="top",e.font=Math.round(l.height/6).toString(10)+"px sans-serif",e.fillText(d,.02*l.width,.02*l.height),e.fillText((y?"pr ":"")+(u?"sel ":"")+(r?"":"dis"),.02*l.width,.22*l.height),E&&e.fillText("="+
E,.02*l.width,.42*l.height))}}function Ag(a){return function(c,b){if(a.buttons)for(var d=0;d<a.buttons.length;d++){var e=a.buttons[d];if(e.name===c&&(void 0==e.state||0>e.state.indexOf("pressed")&&0>e.state.indexOf("selected")&&0>e.state.indexOf("disabled")))return c=Uc(e.draw[0].uri),Uf(a.Ib[c.ad],c.id)}return{Y:0,na:b.g,ca:0,oa:b.g}}}
function Bg(a){function c(d){for(var e=0;e<a.widgets.length;e++)if(a.widgets[e].name===d)return a.widgets[e];return null}if(void 0==a.widgets)return{};var b={};["vpl:then","vpl:error","vpl:warning","vpl:moreHigh","vpl:moreLow"].forEach(function(d){var e=c(d);if(e){var f=Uc(e.draw[0].uri),g=Uf(a.Ib[f.ad],f.id);b[d]=function(h,l,k,r){e.draw.forEach(function(u){if(u.uri){var y=Uc(u.uri);u.alpha&&(h.globalAlpha=u.alpha);h.save();var E=Math.min(r.width/(g.na-g.Y),r.height/(g.oa-g.ca));h.scale(E,E);h.translate(-(g.Y+
g.na)/2,-(g.ca+g.oa)/2);a.Ib[y.ad].J(h,{pe:y.id});h.restore();u.debug&&(h.fillStyle="black",h.textAlign="center",h.textBaseline="middle",h.fillText(u.debug,0,0))}u.js&&(u=new Function("ctx",u.js),h.save(),h.scale(r.width,r.height),h.beginPath(),u(h),h.restore())})}}});return b};function Cg(a){this.Za=a&&a.oc?a.oc:null;this.u=a&&a.check?a.check:null;this.S=a&&a.xc?a.xc:null;this.w=a&&a.close?a.close:null;this.aa=a&&a.isConnected?a.isConnected:null;this.i=a&&a.isEnabled?a.isEnabled:null;this.ug=a&&a.Tf?a.Tf:null;this.l=a&&a.pf?a.pf:null;this.H=a&&a.ue?a.ue:null;this.fd=a&&a.fd?a.fd:"aseba";this.languages=a&&a.languages?a.languages:[this.fd];this.state=a&&a.state?a.state:null;this.ja=a&&a.ja?a.ja:{};this.b=this.Ha=this.pa=null}N=Cg.prototype;
N.isConnected=function(){return null==this.aa||this.aa()};N.isEnabled=function(a){return null!=this.Za&&0<=this.languages.indexOf(a)&&(null==this.i||this.i(a))};N.ue=function(){return null!=this.H?this.H():null};N.xc=function(a){this.S&&this.S(a)};N.close=function(){this.w&&this.w()};N.check=function(a,c,b){if(null==this.u||a===this.pa&&c===this.Ha)return this.b;var d=this;this.u(c,a,function(e){d.pa=a;d.Ha=c;e!==d.b&&(d.b=e,b(e))});return this.b};N.oc=function(a,c){this.isEnabled(c)&&this.Za(c,a)};
N.pf=function(a){return null!=this.ug&&0<=this.languages.indexOf(a)&&(null==this.l||this.l(a))};N.Tf=function(a,c){this.pf(c)&&this.ug(c,a)};function rc(a,c){function b(g,h,l,k){var r=document.createElement("div");null!=h?r.innerHTML=h:(r.textContent=g,r.style.font="bold 30px sans-serif",r.style.textAlign="left",r.style.padding="5px",r.style.paddingLeft="10px");r.style.position="absolute";r.style.width="32px";r.style.height="32px";r.style.top="0";r.style.cursor="default";l?(r.style.right=f.toString(10)+"px",f+=40):(r.style.left=e.toString(10)+"px",e+=40);r.addEventListener("click",function(){k()},!1);d.u.push(r)}this.w=a;this.b=document.createElement("div");
this.b.style.width="100%";this.b.style.height="100%";this.b.style.position="fixed";this.b.style.top="0";this.b.style.left="0";this.b.style.zIndex="1000";this.b.style.backgroundColor="rgba(1,1,1,0.5)";this.b.style.display="none";this.i=document.createElement("div");this.i.style.width="80%";this.i.style.height="80%";this.i.style.position="fixed";this.i.style.top="50%";this.i.style.left="50%";this.i.style.backgroundColor="white";this.b.appendChild(this.i);document.body.appendChild(this.b);a=document.createElement("div");
a.style.width="100%";a.style.height="100%";c&&c.scroll&&(a.style.overflowY="scroll");this.i.appendChild(a);this.l=document.createElement("div");this.l.style.backgroundColor="white";this.l.style.width="100%";this.l.style.height="100%";a.appendChild(this.l);this.u=[];var d=this,e=0,f=30;c&&c.fi||b("\u00d7",null,!1,function(){d.wc()});c&&c.th&&c.th.forEach(function(g){b(g.title,g.di,!0,g.Fa)});this.sd=c&&c.sd||null;this.rd=c&&c.rd||null}
rc.prototype.show=function(){this.u.forEach(function(a){this.i.appendChild(a)},this);this.l.innerHTML=this.w;this.b.style.display="block";Nc(this);this.sd&&this.sd()};rc.prototype.wc=function(){this.b.style.display="none";this.rd&&this.rd()};function Nc(a){var c=a.i.getBoundingClientRect();a.i.style.marginLeft=-c.width/2+"px";a.i.style.marginTop=-c.height/2+"px"};function Dg(a,c,b){c=c.toLowerCase();switch(c){case "html":case "htm":if(b){c=/<img\s[^>]*src=['"](?!\w+:)([^'"]+)['"]/;for(var d=0;d<a.length;){var e=c.exec(a.slice(d));if(null==e)break;var f=e[1];d=d+e.index+e[0].indexOf(f);e=b(f);a=a.slice(0,d)+e+a.slice(d+f.length);d+=e.length}}return a;case "txt":return"<pre style='width: 100%; height: 100%; padding: 3em;'>"+a.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"</pre>";case "md":return c=new Ya,c.i=b||null,"<div style='width: 100%; height: 100%; padding: 3em;'>"+
$a(c,a.split("\n"))+"</div>";case "gif":case "jpg":case "jpeg":case "png":case "svg":return"<div style='display: table; height: 100%; width: 100%; overflow: hidden;'><div style='display: table-cell; vertical-align: middle; text-align: center;'><img src='data:"+(Eg[c]+";base64,"+btoa(a)+"' style='max-width:100%;max-height:100%;'></div></div>");default:return""}}
var Eg={gif:"image/gif",htm:"text/html",html:"text/html",jpeg:"image/jpeg",jpg:"image/jpeg",md:"text/markdown",png:"image/png",svg:"image/svg+xml",txt:"text/plain"};function Wc(a,c,b){try{vb(a.j,c,function(d){if(0>this.Ka.indexOf(d))if(1===this.Ka.length)this.qb([d]);else{var e=this.Ka.slice();e[0<=e.indexOf("vpl")?e.indexOf("vpl"):0<=e.indexOf("src")?e.indexOf("src"):0]=d;this.qb(e)}this.Eg=!0;Ac(this);0<=this.Ka.indexOf("vpl")&&this.ba.qa()},b)}catch(d){}}
function Yc(a,c){var b=/(\.[^.]*|)$/.exec(c.name)[0].slice(1).toLowerCase(),d=new window.FileReader;switch(b){case "aesl":case "vpl3":case "vpl3ui":case "json":return d.onload=function(e){e=e.target.result;var f=c.name,g=!1;"<"===e.trim()[0]?pg(a.j,e):(g="vpl3ui"===b,Wc(a,e,{gh:g}));g||(a.j.filename=f);a.ba.qa()},d.readAsText(c),!0;case "zip":return d.onload=function(e){e=e.target.result;var f=new Fg;f.load(atob(e.slice(e.indexOf(",")+1)),function(){function g(u,y,E){return function(x){var n=Gg(x),
w=Hg(f,x,function(){var m=Dg(y,Gg(u),g(u,y,E));uc(a,m,E)});return w?"data:"+Eg[n.toLowerCase()]+";base64,"+w:x}}nc(a,!0);a.ve&&Wc(a,a.ve);a.j.filename=null;Ac(a);a.hg=null;var h=Ig(f.u,Jg),l=Ig(f.u,Kg),k=Ig(f.u,Lg),r=Ig(f.u,Mg);0<l.length?Ng(f,l[0].filename,!1,function(u){/^[\s]*{/.test(u)?Wc(a,u):(pg(a.j,u),a.ba.qa());a.j.filename=l[0].filename;Ve(a.ba)}):0<h.length&&Ng(f,h[0].filename,!1,function(u){Wc(a,u);Ve(a.ba)});0<k.length&&Ng(f,k[0].filename,!0,function(u){u=atob(u);u=Dg(u,Gg(k[0].filename),
g(k[0].filename,u,!1));uc(a,u,!1)});0<r.length&&Ng(f,r[0].filename,!0,function(u){u=atob(u);u=Dg(u,Gg(r[0].filename),g(r[0].filename,u,!0));uc(a,u,!0);Ve(a.ba)});ac(a)})},d.readAsDataURL(c),!0}return!1}
function Og(a,c){var b=/^[^.]+\.(.*)$/.exec(c.name);b=b?b[1]:"";var d=new window.FileReader;switch(b.toLowerCase()){case "svg":case "png":case "jpg":case "gif":return a.M&&("obstacle"===a.M.Nc?(d.onload=function(e){Pg(a,e.target.result)},d.readAsText(c)):(d.onload=function(e){e=e.target.result;var f=new Image;f.addEventListener("load",function(){Qg(a,f)});f.src=e},d.readAsDataURL(c))),!0}return!1}
function Rg(a,c){var b=/^[^.]+\.(.*)$/.exec(c.name);b=b?b[1]:"";var d=new window.FileReader;switch(b.toLowerCase()){case "wav":a.M&&(d.onload=function(e){a.M.ka.setFile(c.name,e.target.result)},d.readAsArrayBuffer(c))}};function Sg(){return JSZip.apply(this,arguments)||this}Sg.prototype=aa(JSZip.prototype);Sg.prototype.constructor=Sg;if(ha)ha(Sg,JSZip);else for(var Tg in JSZip)if("prototype"!=Tg)if(Object.defineProperties){var Ug=Object.getOwnPropertyDescriptor(JSZip,Tg);Ug&&Object.defineProperty(Sg,Tg,Ug)}else Sg[Tg]=JSZip[Tg];Sg.prototype.forEach=function(a){for(var c in this.files)if(c.slice(0,this.root.length)===this.root){var b=c.slice(this.root.length);/^[^\/]+\/?$/.test(b)&&a(b,this.files[c])}};
Sg.prototype.getEntries=function(){var a=[];this.forEach(function(c,b){a.push(b)});return a};Sg.prototype.getCompleteFileList=function(){var a=[],c;for(c in this.files)this.files[c].dir||a.push(c);return a};function Fg(){this.i=null;this.H=[];this.b="";this.u=new Vg;this.w={};this.l={}}
Fg.prototype.load=function(a,c){var b=this;this.i=new Sg;this.H=[];this.b="";var d=this;this.i.loadAsync(a).then(function(){b.b="";var e=b.i.getEntries();1===e.length&&e[0].dir&&(b.b=e[0].name);b.H=b.i.getCompleteFileList().map(function(f){return f.slice(b.b.length)});(e=d.i.file(b.b+Wg))?e.async("string").then(function(f){Xg(d.u,f,d.H);c&&c(b)}):c&&c(b)})};
function Ng(a,c,b,d){void 0!=(b?a.l:a.w)[c]?d&&d((b?a.l:a.w)[c]):a.i.file(a.b+c).async(b?"uint8array":"string").then(function(e){if(b){for(var f="",g=0;g<e.length;g++)f+=String.fromCharCode(e[g]);e=btoa(f)}(b?a.l:a.w)[c]=e;d(e)})}function Hg(a,c,b){return void 0==a.l[c]?(Ng(a,c,!0,function(d){b&&b(d)}),null):a.l[c]}function Gg(a){return/(\.[^.]*|)$/.exec(a)[0].slice(1)}function Vg(){this.files=[]}
function Xg(a,c,b){a.files=[];c=c.split("\n").map(function(h){return h.trim()});for(var d=0;d<c.length;d++)if(":"===c[d].slice(-1)){var e=Yg;switch(c[d].slice(0,-1).trim().toLowerCase()){case "vpl3":e=Kg;break;case "ui":e=Jg;break;case "program":e=Zg;break;case "attention":e=$g;break;case "doc":e=Lg;break;case "statement":e=Mg}if(e!==Yg)for(var f=/([-_\/.\p{Letter}0-9]+)(\s+\([^)]*\))?$/u;d+1<c.length;d++){var g=c[d+1];if(""!=g){g=f.exec(g);if(null==g)break;g=g[1];0<=b.indexOf(g)&&a.files.push(new ah(g,
e))}}}}function Ig(a,c){return a.files.filter(function(b){return b.type===c})}function ah(a,c){this.filename=a;this.type=c}var Yg=0,Kg=1,Jg=2,Zg=3,$g=4,Lg=5,Mg=6,Wg="manifest.txt";function bh(a,c){var b=this;this.b=document.createElement("div");this.b.style.width="100%";this.b.style.height="100%";this.b.style.position="fixed";this.b.style.top="0";this.b.style.left="0";this.b.style.zIndex="1000";this.b.style.backgroundColor="rgba(1,1,1,0.5)";this.b.style.display="none";this.i=document.createElement("div");this.i.style.width="40em";this.i.style.position="fixed";this.i.style.top="50%";this.i.style.left="50%";this.i.style.backgroundColor="white";this.i.style.padding="2em";this.b.appendChild(this.i);
document.body.appendChild(this.b);var d=document.createElement("p");this.w=d;this.i.appendChild(d);d=document.createElement("table");d.style.width="100%";this.i.appendChild(d);var e=document.createElement("tr");d.appendChild(e);var f=document.createElement("td");e.appendChild(f);this.input=document.createElement("input");this.input.setAttribute("type","file");this.input.style.width="35em";f.appendChild(this.input);f=document.createElement("td");f.align="right";e.appendChild(f);e=document.createElement("input");
e.setAttribute("type","button");e.setAttribute("value",a.i.translate("OK"));e.addEventListener("click",function(){var g=b.input.files[0];g&&b.l(g);b.wc()},!1);f.appendChild(e);f.appendChild(document.createTextNode("\u00a0\u00a0"));e=document.createElement("input");e.setAttribute("type","button");e.setAttribute("value",a.i.translate("Cancel"));e.addEventListener("click",function(){b.wc()},!1);f.appendChild(e);f=document.createElement("div");f.style.position="absolute";f.style.width="32px";f.style.height=
"32px";f.style.top="0";f.style.left="0";f.textContent="\u00d7";f.style.font="bold 30px sans-serif";f.style.textAlign="left";f.style.padding="5px";f.style.paddingLeft="10px";f.addEventListener("click",function(){b.wc()},!1);d.appendChild(f);this.u=a.i;this.l=null;this.sd=c&&c.sd||null;this.rd=c&&c.rd||null}
bh.prototype.show=function(a,c,b){this.w.textContent=this.u.translate(a);this.input.setAttribute("accept",c);this.l=b;this.b.style.display="block";a=this.i.getBoundingClientRect();this.i.style.marginLeft=-a.width/2+"px";this.i.style.marginTop=-a.height/2+"px";this.sd&&this.sd()};bh.prototype.wc=function(){this.b.style.display="none";this.rd&&this.rd()};function ch(a,c,b){this.b=a;this.l=c;this.tc=null;this.i=!1;this.sessionId=b;var d=this;setInterval(function(){null!=d.tc&&2<=d.tc.readyState&&(!1!==d.b.Bf&&(d.b.Bf=!1,ac(d.b)),d.connect())},5E3)}function dh(a,c,b,d){a=a.b.I;if(a.$(c)&&Ub(a,c)&&a.isEnabled(c))if(void 0!==b){d=a.find(c);var e;if(e=d)d.w?b===d.Oa()?e=!0:(d.Cd(void 0),e=b===d.Oa()):e=!1;e&&Vb(a,c)}else void 0!==d?(b=a.find(c))&&Wb(b,d)&&Vb(a,c):a.Cd(c)}
ch.prototype.connect=function(){var a=this;this.tc=new WebSocket(this.l);this.tc.addEventListener("open",function(){a.b.Bf=!0;a.tc.send(JSON.stringify({sender:{type:"vpl",sessionid:a.sessionId,role:a.b.j.Zb?"teacher":"student"},type:"hello"}));window.addEventListener("unload",function(){a.tc.send(JSON.stringify({sender:{type:"vpl",sessionid:a.sessionId,role:a.b.j.Zb?"teacher":"student"},type:"bye"}))});ac(a.b)});this.tc.addEventListener("message",function(c){try{var b=JSON.parse(c.data);"defaultfile"!==
b.type||a.b.Wc||(b.type="file");window.vplListenToCom&&window.vplListenToCom(b);switch(b.type){case "cmd":dh(a,b.data.cmd,b.data.selected,b.data.state);Ve(a.b.ba);break;case "file":var d=b.data.content,e=b.data.base64||!1,f=/(\.[^.]*|)$/.exec(b.data.name||"")[0].slice(1).toLowerCase();switch(b.data.kind){case "vpl":e&&(d=btoa(d));/^[\s]*{/.test(d)?Wc(a.b,d,{gh:"vpl3ui"===f}):(pg(a.b.j,d),a.b.ba.qa());"vpl3ui"!==f&&(a.b.j.filename=b.data.name||null);Ve(a.b.ba);break;case "aseba":e&&(d=btoa(d));a.b.Ga[a.b.ma].Qa.oc(d,
"aseba");a.b.j.Vb=!1;break;case "about":pc(a.b,Dg(e?atob(d):d,f));break;case "help":uc(a.b,Dg(e?atob(d):d,f));break;case "settings":e&&(d=btoa(d));var g=JSON.parse(d);g.hasOwnProperty("volume")&&(a.b.j.volume=g.volume);break;case "statement":uc(a.b,Dg(e?atob(d):d,f),!0);Ve(a.b.ba);break;case "suspend":var h=a.b,l=Dg(e?atob(d):d,f),k=h.Vc;k&&h.De&&h.De.wc();h.De=l?new rc(l,{fi:!0}):null;l&&k&&h.De.show()}break;case "robot":var r=b.data.robot,u=b.data.url||null,y=b.data.url||null,E=b.data.uuid||null,
x=b.data.pass||null;c=null;switch(r){case "thymio":u&&(c=eh(a.b,{Th:u}),c.xc(c.fd));break;case "thymio-tdm":!y&&0<=a.b.ma&&a.b.Ga[a.b.ma].Qa.ja.sc&&(y=a.b.Ga[a.b.ma].Qa.ja.sc);y&&(c=fh(a.b,{sc:y,Nh:E,vh:x}),c.xc(c.fd));break;case "sim":c=gh(a.b,{}),c.xc(c.fd)}c&&(dh(a,"vpl:stop"),0<=this.ma&&this.Ga[this.ma].Qa.stop(),a.b.Ga=[{name:r,Qa:c}],a.b.ma=0,Ve(a.b.ba));break;default:Ve(a.b.ba)}}catch(n){console.info(n)}});this.i||(Rc(this.b,function(c){a.log(c)}),this.i=!0)};
ch.prototype.log=function(a){try{if("cmd"===a.type&&a.data&&0<=["vpl:run","vpl:save","vpl:upload"].indexOf(a.data.cmd)){var c=ub(this.b.j,{qd:!1,td:!0});this.tc.send(JSON.stringify({sender:{type:"vpl",sessionid:this.sessionId},type:"file",data:{name:this.b.j.filename,content:c},reason:a.data.cmd}))}this.tc.send(JSON.stringify({sender:{type:"vpl",sessionid:this.sessionId},type:"log",data:a||null}))}catch(b){}};function cc(){this.b=[]}function dc(a){function c(d){0<b.b.length&&b.b[b.b.length-1].Fa(d)&&d.preventDefault()}var b=a;window.addEventListener("keydown",function(d){c(d)});window.addEventListener("message",function(d){d.origin===window.origin&&c(d.data)},!1)}function ic(a,c,b){a.b.push({Fa:c,Tg:!0===b});hh(!0===b)}function sc(a,c){a.b.push({Fa:function(b){return"Escape"===b.key?(c(),!0):!1},Tg:!1});hh(!1)}function ih(a,c){var b=tc(a);ic(a,function(d){return b.Fa(d)||c(d)},b.Tg)}
function tc(a){hh(1<a.b.length&&a.b[a.b.length-2].Tg);return a.b.pop()}function hh(a){a?(null==jh&&(a=document.createElement("input"),a.setAttribute("style","width:0;height:0;position:absolute;left:-10pt;top:-10pt;"),jh=a,document.body.appendChild(a)),jh.focus()):null!=jh&&jh.blur()}var jh=null;function mc(a,c){this.w=a;this.v=c.mh||"";(this.Fc=c.Fc||"")&&this.Fc!==this.v.slice(-this.Fc.length)&&(this.Fc="");this.Sc=c.Sc;this.b=0;this.i=this.v.length-this.Fc.length;this.u=null;this.l=[];this.aa=c.display||function(){};this.H=c.finish||function(){};var b=this;ic(this.w.l,function(d){if(d.ctrlKey||d.metaKey)return!1;switch(d.key){case "Escape":b.finish(!1);break;case "Enter":b.finish(!0);break;case "ArrowLeft":b.i>b.b?(b.i=b.b,b.display()):0<b.b&&(b.b--,b.i=b.b,b.display());break;case "ArrowRight":b.i>
b.b?(b.b=b.i,b.display()):b.b<b.v.length-b.Fc.length&&(b.b++,b.i=b.b,b.display());break;case "Backspace":b.i>b.b?(b.v=b.v.slice(0,b.b)+b.v.slice(b.i),b.i=b.b,b.display()):0<b.b&&(b.v=b.v.slice(0,b.b-1)+b.v.slice(b.b),b.b--,b.i=b.b,b.display());break;case "Delete":b.i>b.b?(b.v=b.v.slice(0,b.b)+b.v.slice(b.i),b.i=b.b,b.display()):b.b<b.v.length-b.Fc.length&&(b.v=b.v.slice(0,b.b)+b.v.slice(b.b+1),b.display());break;default:/^\w{2,}$/.test(d.key)||(b.v=b.v.slice(0,b.b)+d.key+b.v.slice(b.i),b.b+=d.key.length,
b.i=b.b,b.display())}return!0},!0)}mc.prototype.display=function(){this.aa(this.v,this.b,this.i)};mc.prototype.finish=function(a){this.H(a?this.v:null);tc(this.w.l)};function ld(a,c,b){a.u=c;a.l=b};function lc(a,c){mc.call(this,a,c);tc(this.w.l);this.input=document.createElement("input");this.input.style.position="absolute";this.input.style.left="-1000px";this.input.style.top="-1000px";this.input.value=this.Fc?this.v.slice(0,-this.Fc.length):this.v;this.input.selectionStart=0;this.input.selectionEnd=this.input.value.length;var b=this;this.input.addEventListener("input",function(){b.v=b.input.value+b.Fc;b.b=b.input.selectionStart;b.i=b.input.selectionEnd;b.display()},!1);this.S=function(){b.b=
b.input.selectionStart;b.i=b.input.selectionEnd;b.display()};document.addEventListener("selectionchange",this.S,!1);this.input.addEventListener("change",function(){b.input&&b.finish(!0)},!1);document.body.appendChild(this.input);this.input.focus();ic(this.w.l,function(d){return"Escape"===d.key?(b.finish(!1),!0):!1})}lc.prototype=Object.create(mc.prototype);lc.prototype.constructor=lc;
lc.prototype.finish=function(a){this.H(a?this.input.value+this.Fc:null);document.removeEventListener("selectionchange",this.S,!1);a=this.input;this.input=null;document.body.removeChild(a);tc(this.w.l)};function ec(a){this.l=a;this.pa=0;this.S=1;this.Ha=0;this.aa=1;this.i=gc;this.H=this.u=this.b=0;this.Ra=gc;this.w=this.Ab=0}var gc="",be="tb1",de="tb2",Sd="bl",Ud="br",Td="blp",Vd="brp",oc="r",ee="ll",je="lr",Jd={Gi:gc,Mi:be,Li:de,pi:Sd,si:Ud,ri:Td,ti:Vd,Ii:oc,Ei:ee,Fi:je};function kh(a){switch(a.i){case oc:return a.l.j.j[a.b];case Sd:return a.l.j.j[a.b].X[a.u];case Ud:return a.l.j.j[a.b].actions[a.u];default:return null}}
function lh(a){switch(a.i){case Td:return a.l.j.j[a.b].X[a.u];case Vd:return a.l.j.j[a.b].actions[a.u];default:return null}}function mh(a){switch(a.i){case ee:return Yd(a.l,!1,a.b+a.S*a.u);case je:return Yd(a.l,!0,a.b+a.aa*a.u);default:return null}}function sd(a){switch(a.Ra){case oc:return a.l.j.j[a.Ab];case Sd:return a.l.j.j[a.Ab].X[a.w]||a.l.j.j[a.Ab];case Ud:return a.l.j.j[a.Ab].actions[a.w]||a.l.j.j[a.Ab];default:return null}}
function nh(a,c){if(c=c?a.l.zc:a.l.Kc){for(var b=0,d=0;d<c.length;d++)if(c[d]&&"!"!==c[d][0]&&qd(a.l,c[d])){var e=a.l.I.find(c[d]);(e.b||e.i)&&b++}return b}return 0}function ce(a){switch(a.i){case be:var c=a.l.Kc;break;case de:c=a.l.zc;break;default:return null}for(var b=a.b,d=0;d<c.length;d++)if(c[d]&&"!"!==c[d][0]&&qd(a.l,c[d])){var e=a.l.I.find(c[d]);if(e.b||e.i){if(0===b)return e;b--}}return null}
function fe(a,c){var b=sd(a),d=a.l;b instanceof Ha&&(a.Ra===Sd?"a"===c.type:"e"===c.type||"s"===c.type)&&(b=b.Gb,a.Ra=oc);b instanceof Oa&&!(b instanceof Ta)?(c=new Ha(c,null,null),b.Yb(c,null,function(){d.j.yb()},function(){rb(d.j)})):b instanceof Ha&&(c=new Ha(c,null,null),b.Gb.Yb(c,{kd:a.Ra===Sd,index:a.w},function(){d.j.yb()},function(){rb(d.j)}));ob(d.j)}function td(a,c){if(c.b)c.b(a.l,!1);else{var b=sd(a);(b&&c.l?c.l(a.l,{data:b}):c.i)&&c.i(a.l,{data:b})}}
function jc(a){ih(a.l.l,function(c){function b(){return a.l.j.j[a.b].X.length+(pb(a.l.j)?0:1)}function d(){return a.l.j.j[a.b].actions.length+1}function e(){var g=kh(a)||mh(a);g instanceof Ha?a.l.u=g.T.name:g instanceof Ca?a.l.u=g.name:a.l.u=null}if(a.l.W.wb)return!1;switch(c.key){case "Escape":switch(a.i){case Sd:case Ud:a.Ra==a.i&&a.Ab==a.b&&a.w==a.u?a.Ra=gc:a.i=oc;break;case Td:a.i=Sd;break;case Vd:a.i=Ud;break;default:a.i=gc,a.Ra=gc}e();ac(a.l);return!0;case "Enter":switch(a.i){case gc:a.i=oc;
a.b=0;a.Ra=oc;a.Ab=0;break;case oc:c=kh(a);c instanceof Ta?$c(a.l,a.b):(a.i=Sd,a.u=0);break;case Sd:case Ud:c=kh(a);c instanceof Ha&&c.T.ha&&(a.i=a.i===Sd?Td:Vd,a.H=0);break;case be:case de:c=ce(a),null!=c&&td(a,c)}e();ac(a.l);return!0;case " ":switch(a.i){case Sd:case Ud:a.Ra=a.i;a.Ab=a.b;a.w=a.u;break;case Td:case Vd:var f=lh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.l&&c.l(f));break;case oc:a.Ra=a.i;a.Ab=a.b;a.u=0;break;case ee:case je:c=mh(a),fe(a,c)}e();ac(a.l);return!0;case "Backspace":c=kh(a);
switch(a.i){case oc:case Sd:case Ud:if(a.l.I.gb("vpl:trashcan",{data:c})){a.l.I.pb("vpl:trashcan",{data:c});switch(a.i){case oc:a.b>=a.l.j.j.length&&a.b--;break;case Sd:0<a.u&&a.u+1>=b()&&a.u--;break;case Ud:0<a.u&&a.u+1>=d()&&a.u--}a.Ra=gc;e();ac(a.l)}}return!0;case "ArrowRight":switch(a.i){case oc:if(null===a.Ra||a.Ra===oc)a.Ra=oc,a.Ab=a.b;a.i=je;a.b=0;a.u=0;break;case ee:a.u<Math.floor(a.pa/a.S)-(a.b<a.pa%a.S?0:1)?a.u++:(a.i=oc,a.b=0);break;case je:a.u=Math.min(a.u+1,Math.floor(a.Ha/a.aa)-(a.b<
a.Ha%a.aa?0:1));break;case Sd:a.u+1>=b()?(a.i=Ud,a.u=0):a.u++;break;case Ud:a.u<d()-1?a.u++:a.i=oc;break;case Td:case Vd:f=lh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.i&&c.i(f));break;case be:a.b=Math.min(a.b+1,nh(a,!1)-1);break;case de:a.b=Math.min(a.b+1,nh(a,!0)-1)}e();ac(a.l);return!0;case "ArrowLeft":switch(a.i){case oc:if(null===a.Ra||a.Ra===oc)a.Ra=oc,a.Ab=a.b;a.i=ee;a.b=0;a.u=Math.ceil(a.pa/a.S)-1;break;case ee:a.u=Math.max(a.u-1,0);break;case je:0<a.u?a.u--:(a.i=oc,a.b=0);break;case Sd:0<
a.u?a.u--:a.i=oc;break;case Ud:0===a.u?(a.i=Sd,a.u=b()-1):a.u--;break;case Td:case Vd:f=lh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.b&&c.b(f));break;case be:a.b=Math.max(a.b-1,0);break;case de:a.b=Math.max(a.b-1,0)}e();ac(a.l);return!0;case "ArrowUp":switch(a.i){case oc:0===a.b?0<nh(a,!1)&&(a.i=be,a.b=0):a.b=Math.max(a.b-1,0);break;case Sd:case Ud:0===a.b?0<nh(a,!1)&&(a.i=be,a.b=0):(a.b=Math.max(a.b-1,0),a.u=Math.min(a.u,(a.i===Sd?b():d())-1));break;case ee:case je:a.b=Math.max(a.b-1,0);break;case Td:case Vd:f=
lh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.i&&c.i(f));break;case de:a.i=oc,a.b=Math.max(a.l.j.j.length-1,0)}e();ac(a.l);return!0;case "ArrowDown":switch(a.i){case oc:a.b>=a.l.j.j.length-1?0<nh(a,!0)&&(a.i=de,a.b=0):a.b=Math.min(a.b+1,a.l.j.j.length-1);break;case Sd:case Ud:a.b>=a.l.j.j.length-1?0<nh(a,!0)&&(a.i=de,a.b=0):(a.b=Math.min(a.b+1,a.l.j.j.length-1),a.l.j.j[a.b]instanceof Ta?a.i=oc:a.u=Math.min(a.u,(a.i===Sd?b():d())-1));break;case ee:a.b=Math.min(a.b+1,(a.u<Math.floor(a.pa/a.S)?a.S:a.pa%
a.S)-1);break;case je:a.b=Math.min(a.b+1,(a.u<Math.floor(a.Ha/a.aa)?a.aa:a.Ha%a.aa)-1);break;case Td:case Vd:f=lh(a);null!=f.T.ha&&(c=f.T.ha.controls[a.H],c.b&&c.b(f));break;case be:a.i=oc,a.b=0}e();ac(a.l);return!0;case "Tab":switch(a.i){case Td:case Vd:f=lh(a),null!=f.T.ha&&(f=f.T.ha.controls.length,a.H=(a.H+(c.shiftKey?f-1:1))%f)}e();ac(a.l);return!0}return!1})}
function Id(a,c,b){function d(h){return h.bottom-h.top>h.right-h.left?b<(h.top+h.bottom)/2:c>(h.left+h.right)/2}a=sd(a);if(a instanceof Ha){var e=a.T.ha;if(void 0!=e)for(var f=0;f<e.controls.length;f++){var g=e.controls[f];if(c>=g.left&&c<=g.right&&b>=g.top&&b<=g.bottom){g.u?g.u(a,(c-g.left)/(g.right-g.left),(b-g.top)/(g.bottom-g.top)):g.l?g.l(a):g.b&&!d(g)?g.b(a):g.i&&d(g)&&g.i(a);break}}}};var Ne=null;document.addEventListener("mousemove",function(a){null!==Ne&&(Ne(a,!1,!1),a.preventDefault())},!1);document.addEventListener("mouseup",function(a){null!==Ne&&(Ne(a,!0,!1),Ne=null,a.preventDefault())},!1);var Se=null;document.addEventListener("touchmove",function(a){null!==Ne&&(Se=a.targetTouches[0],Ne(Se,!1,!0),a.preventDefault());return!1},{capture:!1,passive:!1});document.addEventListener("touchend",function(a){null!==Ne&&(Ne(Se,!0,!0),Ne=null,a.preventDefault());return!1},!1);
function oh(a,c,b,d,e){var f=0<=a.indexOf("/")?a.replace(/\/[^/]*$/,"/"):"",g={},h=new XMLHttpRequest;h.addEventListener("load",function(){if(200===h.status){g[a]=h.responseText;var l=JSON.parse(h.responseText),k=b(l),r=k.length,u=!1;k.forEach(function(y){var E=new XMLHttpRequest;E.addEventListener("load",function(){200===E.status?(g[y]=E.responseText,r--,u||0!==r||d(l,g)):u||(u=!0,e("HTTP error "+E.status))});E.addEventListener("error",function(){u||(u=!0,e("XMLHttpRequest error for "+a))});E.open("GET",
f+y);E.send()})}else e("HTTP error "+h.status)});h.addEventListener("error",e);h.open("GET",a);h.send()}
function ph(a,c,b,d,e){function f(u){var y=document.getElementById(u);if(null==y)throw"Missing script element "+u;return y.textContent}try{var g=f(a),h=JSON.parse(g),l={};h.svgFilenames&&h.svgFilenames.forEach(function(u){g=f(u);l[u]=g});h.overlays&&h.overlays.forEach(function(u){g=f(u);l[u]=g});h.css&&h.css.forEach(function(u){g=f(u).trim();l[u]=g});if(h.doc)for(var k in h.doc)if(h.doc.hasOwnProperty(k))for(var r in h.doc[k])h.doc[k].hasOwnProperty(r)&&(g=f(h.doc[k][r]).trim(),l[h.doc[k][r]]=g);
d(h,l)}catch(u){e(u)}}function qh(a){var c=window.vplQueryOptions||"",b=/^[^?]*\?([^#]*)/.exec(document.location.href);b&&(c=c?b[1]+"&"+c:b[1]);if(c)for(c=c.split("&").map(function(d){return d.split("=").map(function(e){return decodeURIComponent(e)})}),b=0;b<c.length;b++)if(c[b][0]===a)return c[b][1];return""}
function rh(a){return(document.location.hash||"#").slice(1).split("&").map(function(c){return c.split("=").map(decodeURIComponent)}).reduce(function(c,b){c[b[0]]=b[1];return c},{})[a]||null}
function sh(a,c){void 0===window.vplTextFieldInputEvents&&(window.vplTextFieldInputEvents=0<=navigator.userAgent.indexOf("Android"));var b=[];a&&a.overlays&&a.overlays.forEach(function(U){try{var H=JSON.parse(a.ce[U])}catch(G){console.error(G.message)}for(var J in H)if(H.hasOwnProperty(J))switch(J){case "blocks":case "blockList":case "aeslImportRules":case "buttons":case "widgets":a[J]=a[J]?a[J].concat(H[J]):H[J];break;case "toolbars":for(var R in H[J])H[J].hasOwnProperty(R)&&(a[J]=a[J]||{},a[J][R]=
H[J][R]);break;case "i18n":for(R in H[J])if(H[J].hasOwnProperty(R)){a[J]=a[J]||{};a[J][R]=a[J][R]||{};for(var X in H[J][R])H[J][R].hasOwnProperty(X)&&(a[J][R][X]=H[J][R][X])}break;case "help":b.push(H[J])}});var d=document.getElementById("programCanvas"),e=qh("role"),f=qh("shortcuts"),g=new Xb(d);f&&(g.W.l="true"===f);g.W.u=0<=qh("accessibility").split("+").indexOf("kbd");g.W.i=0<=qh("accessibility").split("+").indexOf("nodrag");g.wd=void 0==window.vplSimMaps?"ground,height,obstacles":"merged"===
window.vplSimMaps?null:window.vplSimMaps.split(",");window.vplApp=g;g.username=qh("user")||window.vplUsername||g.username;hc(g);a&&Tc&&(g.j.message=Tc(a),g.j.message&&window.console.info(g.j.message));a&&a.css&&(g.ia.H(),a.css.forEach(function(U){me(g.ia,U,a.ce[U])}),g.ia.defineProperties());if(a&&a.i18n)for(var h in a.i18n)a.i18n.hasOwnProperty(h)&&Xa(g.i,h,a.i18n[h]);d=qh("uilanguage")||"en";g.i.language=d;g.Ue=new bh(g,g.W.l?{sd:function(){sc(g.l,function(){g.Ue.wc()})},rd:function(){tc(g.l)}}:
null);window.vplStorageSetFunction&&(g.j.w=function(){var U=ub(window.vplApp.j);window.vplStorageSetFunction("program.vpl3",U)});h=void 0==a||a["hardcoded-gui"]||"classic"===qh("appearance");g.Sg="local"===qh("storage");g.we="false"!==qh("multiview");var l=qh("language");Ke="true"===qh("cssdebug");var k=yc,r=pd,u=yd;if(a){if(h)null!==a.blocks&&0<a.blocks.length&&(a.blocks||[]).forEach(function(U){var H=Na(U.name);Hf(U,H.Mb);U.typicalParamSet&&(H.df=U.typicalParamSet)});else if(null!==a.buttons&&0<
a.buttons.length&&(k=zg(a),r=Ag(a)),null!==a.widgets&&0<a.widgets.length&&(u=Bg(a)),null!==a.blocks&&0<a.blocks.length)try{hg(a)}catch(U){window.console&&window.console.error(U)}if(a.blockList){var y=[];mb.forEach(function(U){"h"===U.type&&y.push(U)});a.blockList.forEach(function(U){y.push(Na(U))});mb=y}a.aeslImportRules&&0<a.aeslImportRules.length&&(Da=a.aeslImportRules.map(function(U){return{Sh:U.aeslName,Ta:U.condition||null,Wh:U.blockName,parameters:U.parameters||null,Lh:U.stringParam||!1}}));
a.miscSettings&&void 0!=a.miscSettings.advancedModeEnabled&&(ib=1==a.miscSettings.advancedModeEnabled);a.miscSettings&&void 0!=a.miscSettings.basicMultiEvent&&(fb=1==a.miscSettings.basicMultiEvent);a.miscSettings&&void 0!=a.miscSettings.advancedMultiEvent&&(hb=1==a.miscSettings.advancedMultiEvent);a.miscSettings&&a.miscSettings.viewRelativeSizes&&(d=a.miscSettings.viewRelativeSizes,g.zd={vpl:d.vpl||1,src:d.src||1,sim:d.sim||1})}d=qh("server");f=qh("session");var E="true"===qh("adv"),x="true"===qh("exp");
ib="true"===qh("advmode");var n=0,w=0,m="",p=qh("blur").trim()||"";/^\d+$/.test(p)&&(n=parseInt(p,10)/10);p=qh("grayscale")||"";/^\d+$/.test(p)&&(w=parseInt(p,10)/100);if(0<n||0<w)m="blur("+n.toFixed(1)+"px) grayscale("+w.toFixed(2)+")";n=1;w=0;p=!1;var q=null;p=qh("scale").trim()||"";/^\d+(\.\d*)?$/.test(p)&&(n=parseFloat(p));p=qh("rotation").trim()||"";/^-?\d+(\.\d*)?$/.test(p)&&(w=parseFloat(p)*Math.PI/180);p=qh("mirror").trim()||"";p="true"===p;if(1!==n||0!==w||p)q=[n*Math.cos(w)*(p?-1:1),n*Math.sin(w)*
(p?-1:1),-n*Math.sin(w),n*Math.cos(w),0,0];l||(l=0<=g.ma?g.Ga[g.ma].Qa.fd:"aseba");jb();nb(g.j,!0);g.j.Xe();n=qh("view");p=0===n.length?["vpl"]:n.split("+");w=qh("robot");if(0<=p.indexOf("sim")||"sim"===w)w="sim";w.replace(/[+;]/g,",").split(",").forEach(function(U){var H=null;switch(U){case "thymio":H=eh(g);H.xc(l);break;case "thymio-tdm":H=fh(g);H.xc(l);break;case "thymio-jws":H=th(g);H.xc(l);break;case "sim":H=gh(g,{dh:m,eh:q});H.xc(l);break;default:window.vplConnections&&window.vplConnections.hasOwnProperty(U)&&
(H=window.vplConnections[U](),H.xc(l))}H&&g.Ga.push({name:U,Qa:H})});g.ma=0<g.Ga.length?0:-1;if(!Ka[l])throw"Unsupported language "+l;Va(g.W,E?[]:["src:language"]);g.j.Bb=l;g.ba.aa=u;null!=g.b&&(g.b.aa=u);Vc(g);!h&&a&&a.toolbars&&(a.toolbars.vpl&&(g.Kc=a.toolbars.vpl),a.toolbars.vpl2&&(g.zc=a.toolbars.vpl2));g.j.fe=k;g.j.bf=r;ug&&document.getElementById("editor")&&(g.O=new ug(g,g.j.ta,l),Te(g.O.Ua,m),g.j.u=function(){return vg(g.O)?null:g.O.Cc()},g.j.H=function(U){Ic(g.O,U)},g.O.Ua.aa=u,yg(g),!h&&
a&&a.toolbars&&a.toolbars.editor&&(g.O.Mg=a.toolbars.editor),g.O.fe=k,g.O.bf=r,g.O.Zb="teacher"===e);null!=g.M&&(uh(g),!h&&a&&a.toolbars&&a.toolbars.simulator&&(g.M.Mg=a.toolbars.simulator),g.M.fe=k,g.M.bf=r);m&&Te(g.ba,m);Ue(g.ba,q);document.getElementsByTagName("body")[0].addEventListener("dragover",function(U){U.stopPropagation();U.preventDefault();U.dataTransfer.dropEffect="copy"},!1);document.getElementsByTagName("body")[0].addEventListener("drop",function(U){U.stopPropagation();U.preventDefault();
U=U.dataTransfer.files;1===U.length&&(U=U[0],Yc(g,U)||Og(g,U)||Rg(g,U))},!1);if(g.M){g.M.W=g.W;var A=new Image;A.addEventListener("load",function(){g.M.Of=A});A.src="data:image/svg+xml;base64,"+btoa('<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="297mm" height="210mm" viewBox="0 0 1052 744" version="1.1"><defs><linearGradient id="gradient" x1="-1000" y1="0" x2="-800" y2="0" gradientUnits="userSpaceOnUse"><stop style="stop-color:#000;stop-opacity:1;" offset="0" /><stop style="stop-color:#000;stop-opacity:0;" offset="1" /></linearGradient></defs><g transform="translate(0,-308)"><rect style="fill:url(#gradient);stroke:none" width="319" height="687" x="-1027" y="336" transform="scale(-1,1)" /><path style="fill:none;stroke:#000;stroke-width:30;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" d="M 114,592 C 102,417 750,306 778,532 806,757 674,675 559,622 444,568 259,567 278,664 296,762 726,730 778,808 829,887 725,955 616,936 507,917 144,1083 129,837 Z" /></g></svg>');
var t=new Image;t.addEventListener("load",function(){g.M.Pf=t});t.src="data:image/svg+xml;base64,"+btoa('<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" width="297mm" height="210mm" viewBox="0 0 1052 744" version="1.1"><defs><radialGradient id="gradient" cx="400" cy="650" fx="400" fy="650" r="230" gradientTransform="matrix(1.6,0,0,1.16,-113,-75)" gradientUnits="userSpaceOnUse"><stop style="stop-color:#000;stop-opacity:1;" offset="0" /><stop style="stop-color:#000;stop-opacity:0;" offset="1" /></radialGradient></defs><g transform="translate(0,-308)"><rect style="fill:url(#gradient);fill-opacity:1;stroke:none" width="939" height="650" x="54" y="357" /></g></svg>');
g.M.Qf='<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="297mm" height="210mm" viewBox="0 0 1052 744" version="1.1"><g transform="translate(0,-308)"><path style="fill:none;stroke:#000;stroke-width:6;stroke-linecap:butt;stroke-linejoin:miter" d="M 172,928 137,420 763,371 905,688 708,981 Z" /><path style="fill:none;stroke:#949494;stroke-width:6;stroke-linecap:butt;stroke-linejoin:miter" d="m 402,754 168,91 101,-142" /><circle style="fill:none;stroke:#000;stroke-width:6" cx="531" cy="550" r="59" /></g></svg>'}nc(g,
!0);if(window.vplStorageGetFunction)window.vplStorageGetFunction("program.vpl3",function(U,H){try{H=H||{},U&&(g.j.filename=H.filename||"program.vpl3",g.j.readOnly=1==H.readOnly,g.j.Qe=void 0!=H.fixedFilename?1==H.fixedFilename:1==H.readOnly,1==H.customizationMode&&(g.W.wb=!0,g.W.ic="teacher"===e),vb(g.j,U,function(){Ac(g);ac(g)}),1==H.setAsNew&&g.I.Cd("vpl:teacher-setasnew"),g.Wc=!0)}catch(J){}});else if(g.Sg)try{var B=window.localStorage.getItem("program.vpl3");B&&vb(g.j,B,function(){Ac(g);ac(g)})}catch(U){}"text"===
qh("view")?g.qb(["src"],{ta:!0}):(g.qb(["vpl"]),g.j.kh=x,g.j.Zb="teacher"===e?"t":"teacher1"===e?"custb":cb,ac(g),g.O&&(document.getElementById("editor").textContent=g.j.Cc(g.j.Bb)));var L=["aseba","l2","asm","js","python"];g.O&&0<=L.indexOf(l)&&wg(g.O,function(){l=L[(L.indexOf(l)+1)%L.length];g.j.Bb=l;var U=g.j.Cc(l);return{language:l,code:U}});if(E&&g.O){var T=new Nb(Ob);g.O.Pe=function(U,H){try{switch(U){case "aseba":var J=new Pb(T,H);J.S=Qb;var R=J.compile();return vh(H,R,J.qc);case "l2":return J=
new wh(T,H),J.S=xh,R=J.compile(),vh(H,R,J.qc);case "asm":return R=yh(new zh(T,H)),Rb(R);default:return null}}catch(X){return"; "+X}}}a&&a.fragments&&a.fragments["about.html"]&&pc(g,a.fragments["about.html"].replace(/UIROOT/g,c));a&&a.fragments&&a.fragments["help.html"]&&uc(g,a.fragments["help.html"].replace(/UIROOT/g,c));if(a&&a.help||0<b.length){g.w=new Ya;a&&a.help&&g.w.add(a.help);g.aa={};if(a&&a.doc)for(var la in a.doc)a.doc.hasOwnProperty(la)&&a.ce[a.doc[la]["doctemplate.html"]]&&(g.aa[la]=a.ce[a.doc[la]["doctemplate.html"]]);
b.forEach(function(U){g.w.add(U)});Ac(g)}a&&a.fragments&&a.fragments["vpl-export-html.css"]&&(g.S=a.fragments["vpl-export-html.css"]);Kc(g);Ve(g.ba);window.addEventListener("resize",function(){Kc(g)},!1);g.M&&(g.M.Zb="teacher"===e);if("text"===n)g.qb(["src"],{ta:!0});else{c=["vpl","src","sim"];if(1>p.length||3<p.length||""===n)n="vpl";else for(B=0;B<p.length;B++){if(0>!c.indexOf(p[B])){n="vpl";break}for(la=0;la<B;la++)if(p[B]===p[la]){n="vpl";break}}g.qb(p)}Kc(g);d&&(window.vplCommandServer=new ch(g,
d,f),window.vplCommandServer.connect(),window.vplSendToCom=function(U){window.vplCommandServer.tc.send(JSON.stringify({sender:{type:"vpl",sessionid:window.vplCommandServer.sessionId},type:"client",data:U||null}))})}
window.addEventListener("load",function(){if(Ah&&Ob){var a=new Ah;if(a.Od!==Ob.maxVarSize)throw"internal: vm var size mismatch";if(a.Ma.length!==Ob.variables.length)throw"internal: vm var count mismatch";for(var c=0;c<a.Ma.length;c++)if(a.Ma[c].name!==Ob.variables[c].name||a.Ma[c].Z.length!==Ob.variables[c].size)throw"internal: vm var mismatch";if(a.Qc.length!==Ob.localEvents.length)throw"internal: vm ev count mismatch";for(c=0;c<a.Qc.length;c++)if(a.Qc[c].name!==Ob.localEvents[c].name)throw"internal: vm var mismatch";
if(a.Ub.length!==Ob.nativeFunctions.length)throw"internal: vm nat fun count mismatch";for(c=0;c<a.Qc.length;c++)if(a.Ub[c].name!==Ob.nativeFunctions[c].name)throw"internal: vm nat fun mismatch";}a=qh("ui")||"ui.json";c=null!=document.getElementById(a);var b=window.vplUIRoot?window.vplUIRoot:c?".":0<=a.indexOf("/")?a.replace(/\/[^/]*$/,""):".";(c?ph:oh)(a,b,function(d){var e=(d.svgFilenames||[]).concat(d.overlays||[]).concat(d.css||[]);if(d.doc)for(var f in d.doc)if(d.doc.hasOwnProperty(f))for(var g in d.doc[f])d.doc[f].hasOwnProperty(g)&&
e.push(d.doc[f][g]);return e},function(d,e){d.ce={};d.Ib={};d.svgFilenames&&d.svgFilenames.forEach(function(h){d.ce[h]=e[h];d.Ib[h]=new Vf(e[h])});d.overlays&&d.overlays.forEach(function(h){d.ce[h]=e[h]});d.css&&d.css.forEach(function(h){d.ce[h]=e[h]});if(d.doc)for(var f in d.doc)if(d.doc.hasOwnProperty(f))for(var g in d.doc[f])d.doc[f].hasOwnProperty(g)&&(d.ce[d.doc[f][g]]=e[d.doc[f][g]]);sh(d,b)},function(d){window.console&&window.console.error(d);sh()})},!1);
window.vplIsProgramChanged=function(){return 0<window.vplApp.j.xd.Ic.length};window.vplGetProgramAsJSON=function(a){return ub(window.vplApp.j,a?{qd:!0,td:!1}:void 0)};window.vplGetUIAsJSON=function(){return ub(window.vplApp.j,{qd:!0,td:!1})};window.vplConvertToHTML=function(a,c){var b=window.vplApp;a=JSON.parse(a);sb(b.j,a);c=c?Zc(b,b.ia,!0):Xc(b,b.ia);b.j.ig();return c};window.vplConvertMDToHtml=function(a){return $a(new Ya,a.split("\n"))};
window.addEventListener("unload",function(){var a=ub(window.vplApp.j);try{window.vplStorageSetFunction?window.vplStorageSetFunction("program.vpl3",a):window.vplApp.Sg&&window.localStorage.setItem("program.vpl3",a)}catch(c){}},!1);function Bh(){this.de=1}Bh.prototype.reset=function(){};Bh.prototype.resetEventListeners=function(){};Bh.prototype.set=function(){};Bh.prototype.get=function(){return null};Bh.prototype.setClientState=function(){};Bh.prototype.getClientState=function(){return null};Bh.prototype.addEventListener=function(){};Bh.prototype.sendEvent=function(){};Bh.prototype.start=function(){this.sendEvent("init",null)};Bh.prototype.setTimer=function(){};Bh.prototype.getTimer=function(){return-1};
Bh.prototype.loadCode=function(){};Bh.prototype.shouldRunContinuously=function(){return!1};Bh.prototype.run=function(){};Bh.prototype.suspend=function(){};Bh.prototype.resume=function(){};function Ch(){this.de=1;this.Ha={Y:-Infinity,na:Infinity,ca:-Infinity,oa:Infinity};this.u=this.aa=0;this.r=70;this.b=[0,0];this.i=0;this.Xf=!1;this.files={};this.rb=120;this.uc=80;this.He=20;this.state={};this.S={};this.Za=null;this.zd={};this.l=[];this.pa={};this.Wc=!1;this.H=null;Ch.prototype.reset.call(this,0);Ch.prototype.resetEventListeners.call(this)}Ch.prototype=Object.create(Bh.prototype);Ch.prototype.constructor=Ch;Ch.prototype.setPositionLimits=function(a,c,b,d){this.Ha={Y:a,na:c,ca:b,oa:d}};
Ch.prototype.setFile=function(a,c){this.files[a]=c};
Ch.prototype.reset=function(a){this.u=this.aa=a;this.b=[0,0];this.i=0;this.state={"button.center":!1,"button.left":!1,"button.right":!1,"button.forward":!1,"button.backward":!1,"prox.ground.delta":[1,1],"prox.horizontal":[0,0,0,0,0,0,0],acc:[0,0,1],"motor.left":0,"motor.right":0,"leds.top":[0,0,0],"leds.bottom.left":[0,0,0],"leds.bottom.right":[0,0,0],"leds.circle":[0,0,0,0,0,0,0,0],sound:{}};this.Wc=!1;var c=this;this.S={"leds.circle":function(){c.Wc=!0},sound:function(b,d){function e(){if(!(g>=
d.f.length)){c.H||(c.H=new (window.AudioContext||window.webkitAudioContext));var h=c.H.createOscillator();h.type="sawtooth";h.frequency.value=d.f[g];var l=c.H.createGain();l.connect(c.H.destination);h.connect(l);h.start(0);var k=d.d[g]/50;l.gain.exponentialRampToValueAtTime(.01,c.H.currentTime+k);h.stop(c.H.currentTime+k);h.addEventListener("ended",e);g++}}if(d.hasOwnProperty("pcm")){if(b=c.files["P"+d.pcm+".wav"]){c.H||(c.H=new (window.AudioContext||window.webkitAudioContext));var f=c.H;f.decodeAudioData(b.slice(),
function(h){var l=f.createBufferSource();l.buffer=h;l.connect(f.destination);l.start(0)})}}else if(d.f){var g=0;e()}}};this.l=[];this.Vc=!1};Ch.prototype.resetEventListeners=function(){this.pa={}};Ch.prototype.enforcePositionLimits=function(){this.b=[Math.max(this.Ha.Y,Math.min(this.Ha.na,this.b[0])),Math.max(this.Ha.ca,Math.min(this.Ha.oa,this.b[1]))]};Ch.prototype.setPosition=function(a,c){this.b=a;this.i=c;this.enforcePositionLimits();this.Za&&this.Za.call(this)};
Ch.prototype.set=function(a,c){this.state[a]=c;this.S[a]&&this.S[a](a,c)};Ch.prototype.get=function(a){return this.state[a]};Ch.prototype.setClientState=function(a,c){this.zd[a]=c};Ch.prototype.getClientState=function(a){a=this.zd[a];a instanceof Array&&(a=a.slice());return a};Ch.prototype.addEventListener=function(a,c){this.pa[a]=c};Ch.prototype.sendEvent=function(a,c){this.pa[a]&&this.pa[a].call(this,a,c);for(var b in this.pa)if(0===b.indexOf(a+"."))this.pa[b](a,c)};
Ch.prototype.setTimer=function(a,c,b,d){this.l[a]={name:c,next:this.u-this.aa+b,wh:d?b:-1}};Ch.prototype.getTimer=function(a){return void 0===this.l[a]||0>this.l[a].next?-1:this.aa+this.l[a]-this.u};Ch.prototype.loadCode=function(a,c){if("js"!==a)throw"unsupported language "+a;(new Function(c)).call(this)};
Ch.prototype.shouldRunContinuously=function(){if(this.Vc)return!1;if(0!==this.get("motor.left")||0!==this.get("motor.right"))return!0;for(var a=0;a<this.l.length;a++)if(this.l[a]&&0<this.l[a].next)return!0;return!1};function Dh(a,c){return a.Xf?c*Math.sqrt(-2*Math.log(Math.random()))*Math.sin(2*Math.PI*Math.random()):0}
Ch.prototype.run=function(a,c){0===this.aa&&this.reset(a);1!==this.de&&(this.aa-=(this.de-1)*(a-this.u),this.u=this.de*(this.u-a)+a);for(var b=Math.max(.01,(a-this.u)/10),d=this.b;!this.Vc&&this.u<a;){b=Math.min(b,a-this.u);var e=(100*this.get("motor.left")+Dh(this,1))*b,f=(100*this.get("motor.right")+Dh(this,1))*b;if(0!==e||0!=f){if(1E-6>Math.abs(e-f)||Math.abs(e-f)<1E-4*(Math.abs(e)+Math.abs(f)))this.b=[this.b[0]+.5*(e+f)*Math.cos(this.i),this.b[1]+.5*(e+f)*Math.sin(this.i)];else{var g=(e+f)*this.r/
(e-f);e=(f-e)/(2*this.r);this.b=[this.b[0]+g*(Math.sin(this.i)-Math.sin(this.i+e)),this.b[1]-g*(Math.cos(this.i)-Math.cos(this.i+e))];this.i+=e}this.enforcePositionLimits();this.Za&&this.Za.call(this)}this.u+=b;for(g=0;g<this.l.length;g++)this.l[g]&&0<this.l[g].next&&this.u>=this.aa+this.l[g].next+Dh(this,.01)&&(this.l[g].next=0<=this.l[g].wh?this.l[g].next+this.l[g].wh:-1,this.sendEvent(this.l[g].name,null))}c&&c("l",d.concat(this.b))};Ch.prototype.suspend=function(){this.Vc=!0};
Ch.prototype.resume=function(a){this.Vc&&(this.aa+=a-this.u,this.u=a,this.Vc=!1)};var Eh="shift left;shift right;add;sub;mult;div;mod;bitor;bitxor;bitand;eq;ne;gt;ge;lt;le;or;and".split(";");function Fh(a,c){function b(k){return 32784<=k?k-65536:k}function d(k){return 2048<=k?k-4096:k}var e=[],f=a[0];if(0<a.length){if(1!==f%2||f>a.length)throw"Bad event table";e.push({jc:0,be:a.slice(0,1),Zf:-1,v:"dc "+a[0]})}for(var g=[],h=1;h<f;h+=2)g.push({id:a[h],jc:a[h+1]}),e.push({jc:h,be:a.slice(h,h+2),Zf:-1,v:"dc 0x"+a[h].toString(16)+", "+a[h+1]});for(h=f;h<a.length;h++){f={jc:h,be:a.slice(h,h+1),Zf:a[h]>>>12};if(!c)for(var l=0;l<g.length;l++)if(g[l].jc===h){f.id="onevent_"+g[l].id.toString(16);
break}l=a[h];switch(l>>>12){case 0:f.v="stop";break;case 1:f.v="push.s "+((l&4095)-(l&2048?4096:0));break;case 2:f.be=a.slice(h,h+2);f.v="push "+b(a[++h]);break;case 3:f.v="load "+(l&4095);break;case 4:f.v="store "+(l&4095);break;case 5:f.be=a.slice(h,h+2);f.v="load.ind "+(l&4095)+" size="+a[++h];break;case 6:f.be=a.slice(h,h+2);f.v="store.ind "+(l&4095)+" size="+a[++h];break;case 7:case 8:switch(l){case 28672:f.v="neg";break;case 28673:f.v="abs";break;case 28674:f.v="bitnot";break;case 28675:f.v=
"not ; not implemented";break;case 32768:f.v="sl";break;case 32769:f.v="asr";break;case 32770:f.v="add";break;case 32771:f.v="sub";break;case 32772:f.v="mult";break;case 32773:f.v="div";break;case 32774:f.v="mod";break;case 32775:f.v="bitor";break;case 32776:f.v="bitxor";break;case 32777:f.v="bitand";break;case 32778:f.v="eq";break;case 32779:f.v="ne";break;case 32780:f.v="gt";break;case 32781:f.v="ge";break;case 32782:f.v="lt";break;case 32783:f.v="le";break;case 32784:f.v="or";break;case 32785:f.v=
"and";break;default:throw"Unknown instruction "+l.toString(16);}break;case 9:f.v="jump "+(h+d(l&4095));break;case 10:f.be=a.slice(h,h+2);f.v=(l&256?l&512?"dont.":"do.":"")+"jump."+(l&256?"when":"if")+".not "+Eh[l&31]+" "+(h+b(a[h+1]));h++;break;case 11:f.v="emit id="+(l&4095)+" data="+b(a[h+1])+" count="+b(a[h+2]);h+=2;break;case 12:f.v="callnat "+(l&4095);break;case 13:f.v="callsub "+(l&4095);break;case 14:f.v="ret";break;default:throw"Unknown instruction "+l.toString(16);}e.push(f)}return e}
function Rb(a,c){var b=Fh(a).map(function(d){var e=d.jc.toString(10);e="    ".slice(e.length-1)+e;var f=d.be.map(function(g){g=g.toString(16);return"000".slice(g.length-1)+g}).join(" ");f+="     ".slice(f.length-4);return(d.id?d.id+":\n":"")+(c?"    ":e+"  "+f+"  ")+d.v+(d.jc===a[0]-2||0===d.Zf||14===d.Zf?"\n":"")}).join("\n");0===b.length&&(b="; empty");return b};function vh(a,c,b){function d(r){var u=e[r].jc.toString(10);u="    ".slice(u.length-1)+u;var y=e[r].be.map(function(E){E=E.toString(16);return"000".slice(E.length-1)+E}).join(" ");y+="     ".slice(y.length-4);f+=(e[r].id?e[r].id+":\n":"")+u+"  "+y+"  "+e[r].v+"\n";e.splice(r,1)}var e=Fh(c,!0);a=a.split("\n");b=b.slice().sort(function(r,u){return r.jc-u.jc});b=[new Gh(-1,-1,-1,0)].concat(b,new Gh(Infinity,Infinity,Infinity,c.length));var f="";for(c=0;c<a.length;c++){for(var g=!1,h=0;h<b.length-1;)if(b[h].line<=
c){for(var l=b[h].jc;l<b[h+1].jc;l++)for(var k=0;k<e.length;)e[k].jc===l?(!g&&0<c&&(f+="\n"),g=!0,d(k)):k++;b.splice(h,1)}else h++;g&&(f+="\n");f+=a[c]+"\n"}for(k=0;k<e.length;)d(k);return f};function Nb(a){this.name=a.name;this.b=a.maxVarSize;this.Ma=[];for(var c=this.Ya=0;c<a.variables.length;c++)this.Ma.push(new Hh(a.variables[c].name,a.variables[c].size,[1],this.Ya,Ih)),this.Ya+=a.variables[c].size;this.Ub=a.nativeFunctions.map(function(b,d){return{id:d,name:b.name,F:b.args}});this.Qc=a.localEvents.map(function(b){return{name:b.name}})}function Jh(a,c){for(var b=0;b<a.Ub.length;b++)if(a.Ub[b].name===c)return a.Ub[b];return null}
function Kh(a,c){for(var b=0;b<a.Ma.length;b++)if(a.Ma[b].name===c)return a.Ma[b];return null}function Lh(a,c){if("init"===c)return 65535;for(var b=0;b<a.Qc.length;b++)if(a.Qc[b].name===c)return 65534-b;throw"unknown local event "+c;}function Pb(a,c){this.rb=Mh;this.Xg=!1;this.Aa=a;this.i=c;this.w=c.length;this.K=0;this.line=1;this.Sa=0;this.G=[];this.o=0;this.b=[];this.$g=[];this.S=[];this.H={};this.ib=[];this.Ha=[];this.Jb=this.uc=this.Aa.b;this.zg=!1;this.Xa=0;this.He=[];this.qc=[]}
function Nh(a,c){for(var b=0;b<a.He.length;b++)if(a.He[b].name===c)return a.He[b];return null}function Hh(a,c,b,d,e){this.name=a;this.size=c;this.A=b;this.offset=d;this.resultType=e}Hh.prototype.Yd=function(a,c){return[12288|this.offset+(c||0)]};Hh.prototype.Vf=function(a,c){return[16384|this.offset+(c||0)]};Hh.prototype.sf=function(){return[20480|this.offset,this.size]};Hh.prototype.wg=function(){return[24576|this.offset,this.size]};
Pb.prototype.Ih=function(){for(;this.K<this.w;)if(" "===this.i[this.K]||"\t"===this.i[this.K])this.K++,this.Sa++;else if("\n"===this.i[this.K])this.K++,this.Sa=0,this.line++;else if("\r"===this.i[this.K])this.K++;else if("#*"===this.i.slice(this.K,this.K+2))for(this.K+=2,this.Sa+=2;this.K<this.w&&"*#"!==this.i.slice(this.K-2,this.K);)"\n"===this.i[this.K]?(this.Sa=0,this.line++):"\r"!==this.i[this.K]&&this.Sa++,this.K++;else if("#"===this.i[this.K])for(;this.K<this.w&&"\n"!==this.i[this.K];)this.K++,
this.Sa++;else break};function Oh(a,c){a.Ha.push(c.length-1)}function Ph(a,c,b){if(0===a.Ha.length)throw"internal";void 0===b&&(b=c.length);a=a.Ha.pop();c[a]=36864===c[a]?c[a]+(b-a&4095):b-a+1&65535}Pb.prototype.Wc=function(a,c,b,d,e){var f;a:{for(f=0;f<this.ib.length;f++)if(this.ib[f].name===a){f=!0;break a}for(f=0;f<this.Aa.Ma.length;f++)if(this.Aa.Ma[f].name===a){f=!0;break a}f=!1}if(f)throw'duplicate variable declaration "'+a+'"';this.ib.push(new Hh(a,c,b,d,e))};
function Qh(a,c){for(var b=a.ib.length-1;0<=b;b--)if(a.ib[b].name===c.name)return a.ib[b];for(b=0;b<a.Aa.Ma.length;b++)if(a.Aa.Ma[b].name===c.name)return a.Aa.Ma[b];throw"unknown variable "+c.name+" "+W(c.head);}function Rh(a,c){for(var b=0;b<a.S.length;b++)if(a.S[b].name===c)return a.S[b];return null}function Sh(a,c){a.Jb-=c;return a.Jb}Pb.prototype.Za=function(){return[]};var Th="== != <= >= |= ^= &= *= /= %= += -= <<= >>= ++ -- ( ) [ ] - ~ * / % + << >> & ^ | > < = , : abs and callsub call const do elseif else emit end for if in not onevent or return step sub then var when while".split(" ");
function Uh(a,c,b){this.ee=a;this.Md=c;this.Kd=b}function W(a){return"line "+a.Md.toString()+" col "+a.Kd.toString()}function Vh(a,c,b,d){Uh.call(this,a,c,b);this.n=d}Vh.prototype=Object.create(Uh.prototype);Vh.prototype.constructor=Vh;function Wh(a,c,b,d){Uh.call(this,a,c,b);this.n=d}Wh.prototype=Object.create(Vh.prototype);Wh.prototype.constructor=Wh;function Xh(a,c,b,d){Uh.call(this,a,c,b);this.name=d}Xh.prototype=Object.create(Uh.prototype);Xh.prototype.constructor=Xh;
function Yh(a,c,b,d){Uh.call(this,a,c,b);this.name=d}Yh.prototype=Object.create(Uh.prototype);Yh.prototype.constructor=Yh;
Pb.prototype.og=function(a){for(;;){a:{var c=(c=a)||Th;this.Ih();if(this.K>=this.w)var b=null;else{for(var d=0;d<c.length;d++)if(b=c[d].length,this.i.slice(this.K,this.K+b)===c[d]&&!/[a-zA-Z0-9_.]{2}/.test(this.i.slice(this.K+b-1,this.K+b+1))){c=new Yh(this.K,this.line,this.Sa,c[d]);this.K+=b;this.Sa+=b;b=c;break a}b=0;if("0x"===this.i.slice(this.K,this.K+2)){for(this.K+=2;this.K+b<this.w&&/[0-9a-fA-F]/.test(this.i[this.K+b]);)b++;if(0===b)throw"hexadecimal number syntax error";c=parseInt(this.i.slice(this.K,
this.K+b),16);c=new Vh(this.K,this.line,this.Sa,c);this.K+=b;this.Sa+=2+b}else if("0b"===this.i.slice(this.K,this.K+2)){for(this.K+=2;this.K+b<this.w&&/[01]/.test(this.i[this.K+b]);)b++;if(0===b)throw"binary number syntax error";c=parseInt(this.i.slice(this.K,this.K+b),2);c=new Vh(this.K,this.line,this.Sa,c);this.K+=b;this.Sa+=2+b}else if(/[0-9]/.test(this.i[this.K])){for(;this.K+b<this.w&&/[0-9]/.test(this.i[this.K+b]);)b++;if(this.Xg&&this.K+b<this.w&&"."===this.i[this.K+b]){for(b++;this.K+b<this.w&&
/[0-9]/.test(this.i[this.K+b]);b++);c=parseFloat(this.i.slice(this.K,this.K+b));c=new Wh(this.K,this.line,this.Sa,c)}else c=parseInt(this.i.slice(this.K,this.K+b),10),c=new Vh(this.K,this.line,this.Sa,c);this.K+=b;this.Sa+=b}else if(/[a-zA-Z_]/.test(this.i[this.K])){for(;this.K+b<this.w&&/[a-zA-Z0-9_.]/.test(this.i[this.K+b]);)b++;if(0===b)throw"name syntax error";c=new Xh(this.K,this.line,this.Sa,this.i.slice(this.K,this.K+b));this.K+=b;this.Sa+=b}else throw"syntax error line "+this.line.toString()+
" col "+this.Sa.toString();b=c}}if(null===b)break;this.G.push(b)}};function Gh(a,c,b,d){this.Kh=a;this.line=c;this.Sa=b;this.jc=d}function Zh(a,c,b){(c=c.head||c.children[0]&&c.children[0].head)&&a.qc.push(new Gh(c.ee,c.Md,c.Kd,void 0===b?a.Xa:b))}function $h(a){this.head=a;this.children=[];this.nb=0;this.resultType=ai;this.Nb=!0}function bi(a,c){for(var b=0;b<a.length;b++)a[b]=a[b].L(c)}$h.prototype.L=function(){return this};$h.prototype.Wa=function(a){this.children.forEach(function(c){c.Wa(a)})};
$h.prototype.w=function(a){this.Wa(a);for(var c=0;c<this.children.length;c++)this.children[c]=this.children[c].w(a);return this};function ci(a,c){$h.call(this,a);this.n=void 0===c?this.head.n:c;this.resultType=Ih}ci.prototype=Object.create($h.prototype);ci.prototype.constructor=ci;ci.prototype.Wa=function(){this.nb=1};function di(a){a&=65535;return 32768<=a?a-65536:a}function ei(a,c){ci.call(this,a,c);this.resultType=fi}ei.prototype=Object.create(ci.prototype);ei.prototype.constructor=ei;
function gi(a){$h.call(this,a);this.name=a.name;this.b=!1}gi.prototype=Object.create($h.prototype);gi.prototype.constructor=gi;gi.prototype.Wa=function(a){a.H.hasOwnProperty(this.name)?(this.nb=1,this.resultType=a.H[this.name].resultType):(a=Qh(a,this),this.nb=a.size,this.resultType=a.resultType)};gi.prototype.L=function(a){return a.H.hasOwnProperty(this.name)?a.H[this.name].resultType===fi?new ei(this.head,a.H[this.name].Z):new ci(this.head,a.H[this.name].Z):this};
function hi(a){var c=new gi(a.head);c.resultType=a.resultType;c.b=!0;return c}var ai="?",Ih="n",fi="fx";function ii(a,c,b,d){$h.call(this,a);this.type=c;this.resultType=b?b.resultType:ai;this.La=b;this.children=d||[]}ii.prototype=Object.create($h.prototype);ii.prototype.constructor=ii;
ii.prototype.Wa=function(a){$h.prototype.Wa.call(this,a);for(var c=1,b=0;b<this.children.length;b++)if(1===c)c=this.children[b].nb;else if(1!==this.children[b].nb&&this.children[b].nb!==c)throw"incompatible sizes "+W(this.head);this.nb=c;this.La&&this.La.za&&(this.resultType=this.La.za(a,this,this.children.map(function(d){return d.resultType})))};ii.prototype.L=function(a){this.children=this.children.map(function(c){return c.L(a)});return this.La&&this.La.L?this.La.L(this,a):this};
ii.prototype.w=function(a){var c=$h.prototype.w.call(this,a);if(c.type===ji&&c.La.priority===ki&&(c.children[1]instanceof li||c.children[1]instanceof gi&&1!==c.children[1].nb)){var b=c.children[0];if(!(b instanceof gi)||c.Nb)throw"bad array assignment "+W(c.head);for(var d=c.children[1],e=new mi(c.head),f=0;f<d.nb;f++){var g=b;1<d.nb&&(g=new ni(b.head,[new ci(b.head,f)]),g.resultType=b.resultType);if(d instanceof li)var h=d.children[f];else h=new ni(d.head,[new ci(b.head,f)]),h.resultType=d.resultType;
g=new ii(c.head,c.type,c.La,[g,h]);g.resultType=b.resultType;g.Nb=!1;g=g.L(a);e.children.push(g)}return e}return c};function ni(a,c){gi.call(this,a);this.children=c}ni.prototype=Object.create(gi.prototype);ni.prototype.constructor=ni;ni.prototype.Wa=function(a){$h.prototype.Wa.call(this,a);a=Qh(a,this);this.nb=1;this.resultType=a.resultType};function oi(a){for(var c=0;c<a.children.length;c++)if(!(a.children[c]instanceof ci))return!1;return!0}
function pi(a,c){for(var b=0,d=1,e=0;e<a.children.length;e++){if(!(a.children[e]instanceof ci))throw"internal";b+=d*a.children[e].n;d*=c.A[e]}return b}function li(a){$h.call(this,a);this.A=[]}li.prototype=Object.create($h.prototype);li.prototype.constructor=li;li.prototype.Wa=function(a){this.nb=this.children.length;this.children[0]&&(this.children.forEach(function(c){c.Wa(a)}),this.resultType=this.children[0].resultType)};
function qi(a,c){$h.call(this,a);this.type=c||ri;this.pa=!1;this.ab=[null]}qi.prototype=Object.create($h.prototype);N=qi.prototype;N.constructor=qi;N.Ag=function(){throw"internal";};N.yh=function(){};N.Ah=function(){throw"internal";};N.zh=function(){};N.Ae=function(){};function si(a,c){c.Jb=c.uc;Zh(c,a)}var ri=1;function ti(a,c){this.b=a;this.ya=c}ti.prototype.B=function(){return"internal"};function ui(a,c){qi.call(this,a,2);this.qe=c}ui.prototype=Object.create(qi.prototype);
ui.prototype.constructor=ui;ui.prototype.L=function(a){bi(this.children,a);return this};ui.prototype.Ag=function(){return this};function vi(a,c){qi.call(this,a,2);this.Mh=c}vi.prototype=Object.create(qi.prototype);vi.prototype.constructor=vi;vi.prototype.L=function(a){bi(this.children,a);return this};vi.prototype.Ag=function(){return this};function wi(a){qi.call(this,a)}wi.prototype=Object.create(qi.prototype);wi.prototype.constructor=wi;
function xi(a,c,b){qi.call(this,a);this.b=c;this.Z=b;this.resultType=b.resultType}xi.prototype=Object.create(qi.prototype);xi.prototype.constructor=xi;function yi(a,c,b,d,e){qi.call(this,a);this.S=c.name;this.resultType=b;this.b=d||null;this.size=-1;this.A=[];this.offset=-1;e&&this.children.push(e)}yi.prototype=Object.create(qi.prototype);yi.prototype.constructor=yi;yi.prototype.Wa=function(a){this.children[0]&&($h.prototype.Wa.call(this,a),this.resultType=this.children[0].children[1].resultType)};
yi.prototype.L=function(a){bi(this.children,a);return this};function zi(a){qi.call(this,a.head);this.children.push(a)}zi.prototype=Object.create(qi.prototype);zi.prototype.constructor=zi;zi.prototype.L=function(a){bi(this.children,a);return this};function mi(a){qi.call(this,a)}mi.prototype=Object.create(qi.prototype);mi.prototype.constructor=mi;mi.prototype.L=function(a){bi(this.children,a);return this};function Ai(a,c){qi.call(this,a,3);this.b=[c];this.i=[];this.l=[]}Ai.prototype=Object.create(qi.prototype);
N=Ai.prototype;N.constructor=Ai;N.Wa=function(a){this.b.forEach(function(c){c.Wa(a)});this.i.forEach(function(c){c.forEach(function(b){b.Wa(a)})})};N.L=function(a){bi(this.b,a);this.i.forEach(function(c){bi(c,a)});return this};N.Ah=function(a){if(this.i.length>=this.b.length)throw"multiple else "+W(a.head);a instanceof Bi&&this.b.push(a.Ta);this.i.push(this.children);this.l.push(a);this.children=[];this.ab.push(a.ab[0])};
N.Ae=function(a,c){this.i.push(this.children);this.children=[];this.l.push(c);for(a=0;a<this.b.length;)if(this.b[a]instanceof ci)if(0===this.b[a].n)this.b.splice(a,1),this.i.splice(a,1),this.l.splice(a,1);else{this.b.splice(a);this.i.splice(a+1);break}else a++};function Bi(a,c){qi.call(this,a,4);this.Ta=c}Bi.prototype=Object.create(qi.prototype);Bi.prototype.constructor=Bi;Bi.prototype.L=function(a){this.Ta=this.Ta.L(a);bi(this.children,a);return this};function Ci(a){qi.call(this,a,4)}
Ci.prototype=Object.create(qi.prototype);Ci.prototype.constructor=Ci;function Di(a,c){qi.call(this,a,3);this.Ta=c}Di.prototype=Object.create(qi.prototype);Di.prototype.constructor=Di;Di.prototype.Wa=function(a){$h.prototype.Wa.call(this,a);this.Ta.Wa(a)};Di.prototype.L=function(a){this.Ta=this.Ta.L(a);bi(this.children,a);return this};function Ei(a,c){qi.call(this,a,3);this.Ta=c;this.b=[]}Ei.prototype=Object.create(qi.prototype);Ei.prototype.constructor=Ei;
Ei.prototype.Wa=function(a){$h.prototype.Wa.call(this,a);this.Ta.Wa(a)};Ei.prototype.L=function(a){this.Ta=this.Ta.L(a);bi(this.children,a);return this};Ei.prototype.Ae=function(a,c){this.Ta instanceof ci&&(0===this.Ta.n&&(this.children=[]),this.Ta=null);this.b.push(c)};function Fi(a,c,b,d,e){qi.call(this,a,3);this.l=new gi(c);this.children.push(b);this.children.push(d);this.b=e||null;this.i=[]}Fi.prototype=Object.create(qi.prototype);Fi.prototype.constructor=Fi;
Fi.prototype.Wa=function(a){$h.prototype.Wa.call(this,a);this.b&&this.b.Wa(a)};Fi.prototype.L=function(a){this.b&&(this.b=this.b.L(a));bi(this.children,a);return this};Fi.prototype.Ae=function(a,c){this.i.push(c)};function Gi(a,c,b){qi.call(this,a);this.name=c;this.children=b}Gi.prototype=Object.create(qi.prototype);Gi.prototype.constructor=Gi;Gi.prototype.L=function(a){bi(this.children,a);return this};function Hi(a,c){qi.call(this,a);this.name=c}Hi.prototype=Object.create(qi.prototype);
Hi.prototype.constructor=Hi;function Ii(a,c,b){qi.call(this,a);this.qe=c;b&&this.children.push(b)}Ii.prototype=Object.create(qi.prototype);Ii.prototype.constructor=Ii;Ii.prototype.Wa=function(a){if(this.children[0]){$h.prototype.Wa.call(this,a);var c=this.children[0],b=Nh(a,this.qe);if((c instanceof gi?Qh(a,c).size:c.nb)!==b.size)throw'Incompatible data size in "emit" '+W(this.head);}};function Ji(a){qi.call(this,a,5)}Ji.prototype=Object.create(qi.prototype);Ji.prototype.constructor=Ji;
var ki=30,ji=1;function Y(a,c,b){this.name=a;this.type=c;this.priority=b&&b.priority||0;this.resultType=b&&b.resultType||(b&&b.za?ai:Ih);this.za=b&&b.za||null;this.L=b&&b.L||null;this.P=b&&b.P||[];this.B=b&&b.B||null}function Ki(a,c){for(var b=[],d=0;d<a.children.length;d++){if(!(a.children[d]instanceof ci))return a;b.push(a.children[d].n)}return new ci(a.head,di(c(b)))}
var Mh=[new Y("--",0,{priority:150}),new Y("++",0,{priority:150}),new Y("-",0,{priority:150,L:function(a){return Ki(a,function(c){return-c[0]})},P:[28672]}),new Y("~",0,{priority:150,L:function(a){return Ki(a,function(c){return~c[0]})},P:[28674]}),new Y("abs",0,{priority:150,L:function(a){return Ki(a,function(c){return Math.abs(c[0])})},P:[28673]}),new Y("not",0,{priority:150,resultType:"b",L:function(a){return Ki(a,function(c){return 0==c[0]?1:0})},P:[4096,32778]}),new Y("size",0,{priority:150,L:function(a,
c){var b=0<a.children[0].nb?a.children[0].nb:a.children[0]instanceof li?a.children[0].children.length:-1;if(0>b&&a.children[0]instanceof gi)for(var d=c.ib.length-1;0<=d;d--)if(c.ib[d].name===a.children[0].name){b=c.ib[d].size;break}return 0<b?new ci(a.head,b):a}}),new Y("--",2,{priority:150}),new Y("++",2,{priority:150}),new Y("+=",ji,{priority:ki}),new Y("-=",ji,{priority:ki}),new Y("*=",ji,{priority:ki}),new Y("/=",ji,{priority:ki}),new Y("%=",ji,{priority:ki}),new Y("<<=",ji,{priority:ki}),new Y(">>=",
ji,{priority:ki}),new Y("&=",ji,{priority:ki}),new Y("|=",ji,{priority:ki}),new Y("^=",ji,{priority:ki}),new Y("*",ji,{priority:140,L:function(a){return Ki(a,function(c){return c[0]*c[1]})},P:[32772]}),new Y("/",ji,{priority:140,L:function(a){return Ki(a,function(c){return Math.trunc(c[0]/c[1])})},P:[32773]}),new Y("%",ji,{priority:140,L:function(a){return Ki(a,function(c){return c[0]%c[1]})},P:[32774]}),new Y("+",ji,{priority:130,L:function(a){return Ki(a,function(c){return c[0]+c[1]})},P:[32770]}),
new Y("-",ji,{priority:130,L:function(a){return Ki(a,function(c){return c[0]-c[1]})},P:[32771]}),new Y("<<",ji,{priority:120,L:function(a){return Ki(a,function(c){return c[0]<<c[1]})},P:[32768]}),new Y(">>",ji,{priority:120,L:function(a){return Ki(a,function(c){return c[0]>>c[1]})},P:[32769]}),new Y("==",ji,{priority:80,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]===c[1]?1:0})},P:[32778]}),new Y("!=",ji,{priority:80,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]!==
c[1]?1:0})},P:[32779]}),new Y("<",ji,{priority:80,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]<c[1]?1:0})},P:[32782]}),new Y("<=",ji,{priority:80,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]<=c[1]?1:0})},P:[32783]}),new Y(">",ji,{priority:80,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]>c[1]?1:0})},P:[32780]}),new Y(">=",ji,{priority:80,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]>=c[1]?1:0})},P:[32781]}),new Y("&",ji,
{priority:110,L:function(a){return Ki(a,function(c){return c[0]&c[1]})},P:[32777]}),new Y("|",ji,{priority:90,L:function(a){return Ki(a,function(c){return c[0]|c[1]})},P:[32775]}),new Y("^",ji,{priority:100,L:function(a){return Ki(a,function(c){return c[0]^c[1]})},P:[32776]}),new Y("and",ji,{priority:60,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]&&c[1]?1:0})},P:[32785]}),new Y("or",ji,{priority:50,resultType:"b",L:function(a){return Ki(a,function(c){return c[0]||c[1]?1:0})},P:[32784]}),
new Y("=",ji,{priority:ki})];function Li(a,c,b){for(var d=0;d<a.rb.length;d++)if(a.rb[d].type===b&&a.rb[d].name===c)return a.rb[d];return null}function Mi(a,c,b){return a.G[a.o+c]instanceof b}function Ni(a,c,b){return a.G[a.o+c]instanceof Yh&&a.G[a.o+c].name===b}N=Pb.prototype;N.oh=function(a){return new ii(a,4,null)};
function Oi(a,c){c=c||10;if(Mi(a,0,Wh)){var b=new ei(a.G[a.o]);a.o++}else if(Mi(a,0,Vh))b=new ci(a.G[a.o]),a.o++;else if(Mi(a,0,Xh))Ni(a,1,"(")?(b=a.oh(a.G[a.o]),a.o++,Ni(a,1,")")?a.o+=2:b.children=Pi(a)):(b=new gi(a.G[a.o]),a.o++);else if(Ni(a,0,"(")){a.o++;b=Oi(a,20);if(!Ni(a,0,")"))throw"subexpression in expression "+W(a.G[a.o]);a.o++}else if(Ni(a,0,"[")){b=new li(a.G[a.o]);a.o++;var d=[];for(var e=0,f=0,g=0;;){d.push(Oi(a,25));0===g&&f++;g++;if(1<f&&g>e)throw"non-rectangular array "+W(a.G[a.o]);
g>e&&(e=g);if(Mi(a,0,Yh))if(a.o++,"]"===a.G[a.o-1].name)break;else if(","===a.G[a.o-1].name)continue;else if(";"===a.G[a.o-1].name){e=g;g=0;continue}throw"array "+W(a.G[a.o-1]);}for(g=0;g<e;g++)for(var h=0;h<f;h++)b.children.push(d[h*e+g])}else if(Mi(a,0,Yh)&&(d=Li(a,a.G[a.o].name,0)))b=new ii(a.G[a.o],0,d),a.o++,b.children.push(Oi(a,150)),d.za&&(b.resultType=d.za(a,b,[b.children[0].resultType]));else if(Mi(a,0,Yh)&&(d=Li(a,a.G[a.o].name,3)))b=new ii(a.G[a.o],3,d),a.o++;else{if(a.o<a.G.length)throw"unexpected token in expression "+
W(a.G[a.o]);throw"unexpected end of file";}for(;Mi(a,0,Yh);)if((d=Li(a,a.G[a.o].name,2))&&d.priority>=c)b=new ii(a.G[a.o],2,d,[b]),a.o++;else if((d=Li(a,a.G[a.o].name,ji))&&(c===ki?d.priority>=c:d.priority>c))b=new ii(a.G[a.o],ji,d,[b]),a.o++,b.children.push(Oi(a,d.priority)),d.za&&(b.resultType=d.za(a,b,b.children.map(function(l){return l.resultType})));else if("["===a.G[a.o].name){if(!(b instanceof gi))throw"unexpected indexing";d=b.resultType;e=Pi(a,!0);b=new ni(b.head,e);b.resultType=d}else break;
return b}function Pi(a,c){var b=[];if(!Ni(a,0,c?"[":"("))throw"left "+(c?"bracket":"parenthesis")+" expected";for(a.o++;;){var d=Oi(a,25);b.push(d);if(!Mi(a,0,Yh))throw"syntax error in arguments";if(Ni(a,0,c?"]":")")){a.o++;break}else if(Ni(a,0,","))a.o++;else throw"syntax error in arguments "+W(a.G[a.o]);}return b}
N.uh=function(){if(this.o>=this.G.length)throw"no more tokens";if(this.G[this.o]instanceof Yh){var a=this.G[this.o];switch(a.name){case "const":if(!Mi(this,1,Xh)||!Ni(this,2,"="))throw'syntax error for "const" '+W(a);var c=this.G[this.o+1];this.o+=3;var b=Oi(this);b=b.L(this);if(!(b instanceof ci))throw"non-constant expression in constant definition "+W(this.G[this.o]);return[new xi(a,c.name,b)];case "var":if(!Mi(this,1,Xh))throw'unexpected token after "var" '+W(a);c=this.G[this.o+1];this.o+=2;if(Mi(this,
0,Yh))switch(this.G[this.o].name){case "[":if(Ni(this,1,"]")){this.o+=2;if(!Ni(this,0,"="))throw"missing size or initial value in array declaration"+W(this.G[this.o-2]);b=new ii(this.G[this.o],ji,Li(this,"=",ji),[new gi(c)]);this.o++;b.children.push(Oi(this));b.resultType=b.children[1].resultType;b.Nb=!1;var d=new ii(new Yh(b.head.ee,b.head.Md,b.head.Kd,"size"),0,Li(this,"size",0),[b.children[1]]);return[new yi(a,c,b.resultType,[d],b)]}this.o++;d=Oi(this);if(!Ni(this,0,"]"))throw"array size syntax error"+
W(this.G[this.o]);this.o++;return Ni(this,0,"=")?(b=new ii(this.G[this.o],ji,Li(this,"=",ji),[new gi(c)]),this.o++,b.children.push(Oi(this)),b.resultType=b.children[1].resultType,b.Nb=!1,b=b.L(this),[new yi(a,c,b.resultType,[d],b)]):[new yi(a,c,ai,[d])];case "=":return b=new ii(this.G[this.o],ji,Li(this,"=",ji),[new gi(c)]),this.o++,b.children.push(Oi(this)),b.resultType=b.children[1].resultType,b.Nb=!1,b=b.L(this),[new yi(a,c,b.resultType,null,b)]}return[new yi(a,c,ai)];case "if":case "elseif":this.o++;
b=Oi(this);if(!Ni(this,0,"then"))throw'"then" expected after "if" statement '+W(this.G[this.o]);this.o++;return["if"===a.name?new Ai(a,b):new Bi(a,b)];case "when":this.o++;b=Oi(this);if(!Ni(this,0,"do"))throw'"do" expected after "when" statement '+W(this.G[this.o]);this.o++;return[new Di(a,b)];case "while":this.o++;b=Oi(this);if(!Ni(this,0,"do"))throw'"do" expected after "while" statement '+W(this.G[this.o]);this.o++;return[new Ei(a,b)];case "for":if(!Mi(this,1,Xh)||!Ni(this,2,"in"))throw'"for" syntax error '+
W(a);c=this.G[this.o+1];this.o+=3;b=Oi(this);if(!Ni(this,0,":"))throw'range expected in "for" statement '+W(this.G[this.o]);this.o++;d=Oi(this);var e=null;Ni(this,0,"step")&&(this.o++,e=Oi(this));if(!Ni(this,0,"do"))throw'"do" expected after "for" statement '+W(this.G[this.o]);this.o++;return[new Fi(a,c,b,d,e)];case "end":return this.o++,[new Ji(a)];case "call":if(!Mi(this,1,Xh))throw'"call" syntax error '+W(a);c=this.G[this.o+1];this.o+=2;return Ni(this,0,"(")?[new Gi(a,c.name,Pi(this))]:[new Gi(a,
c.name,[])];case "callsub":if(!Mi(this,1,Xh))throw'"callsub" syntax error '+W(a);c=this.G[this.o+1];this.o+=2;return[new Hi(a,c.name)];case "else":return this.o++,[new Ci(a)];case "emit":if(!Mi(this,1,Xh))throw'"emit" syntax error '+W(a);c=this.G[this.o+1];this.o+=2;b=Nh(this,c.name);if(null==b)throw"Unknown user event "+c.name+" "+W(a);return 0<b.size?(b=Oi(this),[new Ii(a,c.name,b)]):[new Ii(a,c.name)];case "onevent":if(!Mi(this,1,Xh))throw'unexpected token after "onevent" '+W(a);c=this.G[this.o+
1];this.o+=2;return[new ui(a,c.name)];case "return":return this.o++,[new wi(a)];case "sub":if(!Mi(this,1,Xh))throw'unexpected token after "sub" '+W(a);c=this.G[this.o+1];this.o+=2;return[new vi(a,c.name)]}}b=Oi(this);b instanceof ii&&(b.Nb=!1);b=b.L(this);return[new zi(b)]};N.Ch=function(){};N.Bh=function(){};
N.Cf=function(a){if(a instanceof xi){a.Z=a.Z.L(this);if(!(a.Z instanceof ci))throw"constant definition "+W(a.head);this.H[a.b]={Z:a.Z.n,resultType:a.Z.resultType}}else a instanceof yi&&(a.size=1,a.A=[],a.b&&(a.b=a.b.map(function(c){c=c.L(this);if(!(c instanceof ci)||0>=c.n)throw"array variable size "+W(a.head);a.size*=c.n;a.A.push(c.n);return c},this)),a.offset=this.Ya,a.children[0]&&(a.resultType=a.children[0].resultType),this.Ya+=a.size,this.Wc(a.S,a.size,a.A,a.offset,a.resultType))};N.Be=function(){};
N.Ia=function(){};N.getContext=function(){return null};N.ah=function(){this.Ya=this.Aa.Ya;for(var a=0;a<this.b.length;a++)this.Cf(this.b[a])};function Qi(a,c,b){switch(c.type){case 3:b.push(a.getContext());a.Ia(c.ab[0]);break;case 4:a.Ia(c.ab[0]);break;case 5:a.Ia(b.pop())}}
function Ri(a){function c(){if(1<f.length){var h=f[f.length-1].head;throw"unterminated "+h.name+" "+W(h);}b.l.push(f[0])}var b=a,d=[];a.ah();a.Be();d=[];a.b.forEach(function(h){Qi(this,h,d);h.Wa(this)},a);a.Be();d=[];for(var e=0;e<a.b.length;e++)Qi(a,a.b[e],d),a.b[e]=a.b[e].L(a);a.Be();d=[];for(e=0;e<a.b.length;e++)Qi(a,a.b[e],d),a.b[e]=a.b[e].w(a);a.l=[];var f=[new ui(null,"init")];a.Be();for(e=0;e<a.b.length;e++)switch(a.b[e].type){case ri:a.b[e].Ae(a,a.b[e]);f[f.length-1].children.push(a.b[e]);
break;case 2:a.Ia(a.b[e].ab[0]);c();f=[a.b[e].Ag()];break;case 3:a.Ia(a.b[e].ab[0]);a.b[e].yh(a);f.push(a.b[e]);break;case 4:a.Ia(a.b[e].ab[0]);f[f.length-1].Ah(a.b[e]);break;case 5:if(2>f.length)throw"unexpected end "+W(a.b[e].head);a.Ia(a.b[e].ab[0]);f[f.length-1].zh(a.b[e]);var g=f.pop();a.Ia(a.b[e].ab[a.b[e].ab.length-1]);g.Ae(a,a.b[e]);f[f.length-1].children.push(g);break;default:throw"not implemented "+a.b[e].type;}c()}N.Dh=function(){};N.lh=function(){return null};
$h.prototype.B=function(a){for(var c=[],b=a.Xa,d=0;d<this.children.length;d++)c=c.concat(this.children[d].B(a)),a.Xa=b+c.length;return c};function Si(a){return-2048<=a&&2048>a?[4096|a&4095]:[8192,a&65535]}ci.prototype.B=function(){return this.Nb?Si(this.n):[]};gi.prototype.B=function(a){return this.b?[]:a.H.hasOwnProperty(this.name)?Si(a.H[this.name].Z):Qh(a,this).Yd(a)};
ii.prototype.B=function(a){function c(h,l,k,r){function u(n,w){r===b.Dg&&(y=y.concat(n.Yd(a,w)));k&&(y=y.concat(n.Yd(a,w)));y=y.concat(l.B(a)).concat(a.Za(l.resultType,n.resultType),n.Vf(a,w));r===b.yf&&(y=y.concat(n.Yd(a,w)))}var y=[];if(h instanceof ni){var E=Qh(a,h);if(oi(h)){h=pi(h,E);if(h>=E.size)throw"index out of range";u(E,h)}else if(r!==b.jg||k){var x=Sh(a,1);y=y.concat(Ti(h,a)).concat(16384|x);r===b.Dg&&(y=y.concat(12288|x).concat(E.sf(a)));k&&(y=y.concat(12288|x).concat(E.sf(a)));y=y.concat(l.B(a)).concat(a.Za(l.resultType,
E.resultType),12288|x,E.wg(a));r===b.yf&&(y=y.concat(12288|x).concat(E.sf(a)))}else y=y.concat(l.B(a)).concat(a.Za(l.resultType,E.resultType)).concat(Ti(h,a),E.wg(a))}else if(h instanceof gi)E=Qh(a,h),u(E);else throw"bad assignment";return y}var b={jg:0,yf:1,Dg:2},d=this.head.name;switch(d){case "=":return c(this.children[0],this.children[1],!1,this.Nb?b.yf:b.jg);case "++":case "--":if(!(this.children[0]instanceof gi))throw"invalid operand "+W(this.head);var e=d[0],f=Li(a,e,ji);e=new ii(new Yh(this.head.ee,
this.head.Md,this.head.Kd,e),ji,f,[hi(this.children[0]),new ci(new Vh(this.head.ee,this.head.Md,this.head.Kd,1))]);f.za&&(d=Qh(a,this.children[0]),e.resultType=f.za(a,e,[d.resultType,Ih]));return c(this.children[0],e,!0,this.Nb?0===this.type?b.yf:b.Dg:b.jg);default:if(this.type===ji&&this.La.priority===ki){if(!(this.children[0]instanceof gi))throw"invalid operand "+W(this.head);e=d.slice(0,-1);f=Li(a,e,ji);e=new ii(new Yh(this.head.ee,this.head.Md,this.head.Kd,e),ji,f,[hi(this.children[0]),this.children[1]]);
f.za&&(d=Qh(a,this.children[0]),e.resultType=f.za(a,e,[d.resultType,this.children[1].resultType]));return c(this.children[0],e,!0,this.Nb?b.yf:b.jg)}if(this.La&&this.La.B)return this.La.B(this,a);switch(this.type){case 0:return $h.prototype.B.call(this,a).concat(this.La.P);case ji:return $h.prototype.B.call(this,a).concat(this.La.P);case 3:return this.La.P;case 4:f=a.lh(this);if(null!==f)return f;e=Rh(a,d);if(null!=e){if(e.Fd!==this.children.length)throw"wrong number of arguments";f=[];d=Sh(a,e.Fd+
(e.Ve||0));for(var g=0;g<this.children.length;g++)f=f.concat(this.children[g].B(a)),f=f.concat(16384|d+g);return f=f.concat(e.Mb(a,a.Aa,this.children.map(function(h){return h.resultType}),d))}throw"unknown function "+d+" "+W(this.head);default:throw"internal";}}};function Ui(a,c,b){return a instanceof ii&&2===a.children.length?a.children[0].B(c).concat(a.children[1].B(c)).concat([40960|(b?256:0)|a.La.P[0]&255,0]):a.B(c).concat(4096,40960|(b?256:0)|Eh.indexOf("ne"),0)}
function Ti(a,c){var b=Qh(c,a);if(a.children.length>b.A.length)throw"too many indices"+W(a.head);for(var d=[],e=1,f=0;f<a.children.length;f++)d=d.concat(a.children[f].B(c)),0<f&&(d=d.concat(4096|e,32772,32770)),e*=b.A[f];return d}ni.prototype.B=function(a){if(this.b)return[];var c=Qh(a,this);if(oi(this)){var b=pi(this,c);if(b>=c.size)throw"index out of range "+W(this.head);return c.Yd(a,b)}return Ti(this,a).concat(c.sf(a))};li.prototype.B=function(){throw"internal";};
qi.prototype.B=function(){throw"internal";};ui.prototype.B=function(a){var c=a.getContext();si(this,a);a.Ia(this.ab[0]);var b="init"===this.qe?a.$g:[];a.Xa+=b.length;b=b.concat($h.prototype.B.call(this,a),0);a.Ia(c);return b};vi.prototype.B=function(a){var c=a.getContext();si(this,a);a.Ia(this.ab[0]);var b=$h.prototype.B.call(this,a).concat(57344);a.Ia(c);return b};xi.prototype.B=function(a){si(this,a);return[]};
yi.prototype.B=function(a){si(this,a);return 0===this.children.length?[]:$h.prototype.B.call(this,a)};zi.prototype.B=function(a){si(this,a);return this.children[0].B(a)};mi.prototype.B=function(a,c){si(this,a);var b=[];this.children.forEach(function(d){b=b.concat(d.B(a,c))});return b};
Ai.prototype.B=function(a){var c=a.getContext();si(this,a);for(var b=a.Xa,d=[],e=0,f=0;f<this.b.length;f++)a.Xa=b+d.length,0<f&&Zh(a,this.l[f-1]),d=d.concat(Ui(this.b[f],a)),a.Xa=b+d.length,Oh(a,d),a.Ia(this.ab[f]),this.i[f].forEach(function(g){d=d.concat(g.B(a));a.Xa=b+d.length}),a.Ia(c),f+1<this.i.length?(d=d.concat(36864),Ph(a,d),Oh(a,d),e++):Ph(a,d);a.Xa=b+d.length;this.i.length>this.b.length&&(Zh(a,0<this.b.length?this.l[this.b.length-1]:this,a.Xa+d.length),a.Ia(this.ab[this.b.length]),this.i[this.b.length].forEach(function(g){d=
d.concat(g.B(a));a.Xa=b+d.length}));for(;0<e--;)Ph(a,d);a.Ia(c);return d};Di.prototype.B=function(a){var c=a.getContext();si(this,a);var b=a.Xa,d=Ui(this.Ta,a,!0);Oh(a,d);a.Ia(this.ab[0]);this.children.forEach(function(e){a.Xa=b+d.length;d=d.concat(e.B(a))});Ph(a,d);a.Ia(c);return d};
Ei.prototype.B=function(a){if(null==this.Ta&&0===this.children.length)return[];var c=a.getContext();si(this,a);var b=a.Xa,d=[];null!=this.Ta&&(d=Ui(this.Ta,a));Oh(a,d);a.Ia(this.ab[0]);this.children.forEach(function(e){a.Xa=b+d.length;d=d.concat(e.B(a))});a.Xa=b+d.length;Zh(a,this.b[0]);d=d.concat(36864|-d.length&4095);Ph(a,d);a.Ia(c);return d};
Fi.prototype.B=function(a){var c=a.getContext();si(this,a);var b=a.Xa,d=this.children[0].B(a),e=Qh(a,this.l);d=d.concat(e.Vf(a));var f=d.length;d=d.concat(e.Yd(a)).concat(this.children[1].B(a),40975,0);Oh(a,d);a.Ia(this.ab[0]);for(var g=2;g<this.children.length;g++)a.Xa=b+d.length,d=d.concat(this.children[g].B(a));a.Xa=b+d.length;Zh(a,this.i[0]);d=d.concat(e.Yd(a));d=this.b?d.concat(this.b.B(a)):d.concat(Si(1));d=d.concat(32770,e.Vf(a),36864|f-d.length-2&4095);Ph(a,d);a.Ia(c);return d};
Gi.prototype.B=function(a){si(this,a);var c=Jh(a.Aa,this.name);if(!c)throw'native function "'+this.name+'" not found';if(this.children.length!==c.F.length)throw'wrong number of arguments for native function "'+this.name+'"';for(var b=[],d=[],e=[],f=this.children.length-1;0<=f;f--){var g=this.children[f];if(0>c.F[f])if(void 0==d[-c.F[f]-1])d[-c.F[f]-1]=g.nb;else{if(d[-c.F[f]-1]!==g.nb)throw'argument size mismatch in native function "'+this.name+'"';}else 0===c.F[f]&&e.push(g.nb);if(g instanceof ni)b=
b.concat(Si(Qh(a,g).offset)).concat(Ti(g,a),32770);else if(g instanceof gi)b=b.concat(Si(Qh(a,g).offset));else{for(var h=Sh(a,g.nb),l=0;l<g.nb;l++)b=b.concat((g instanceof li?g.children[l]:g).B(a)),b=b.concat(16384|h+l);b=b.concat(Si(h))}}for(f=e.length-1;0<=f;f--)b=Si(e[f]).concat(b);for(f=d.length-1;0<=f;f--)void 0!==d[f]&&(b=Si(d[f]).concat(b));return b=b.concat(49152|c.id)};wi.prototype.B=function(a){si(this,a);return[(a.zg?14:0)<<12]};function Vi(a,c){ti.call(this,a,c)}Vi.prototype=Object.create(ti.prototype);
Vi.prototype.constructor=Vi;Vi.prototype.B=function(){var a=this.ya.name;if(void 0===this.b.zd[a])throw'unknown function "'+a+'" '+W(this.ya.head);return 53248|this.b.zd[a]};Hi.prototype.B=function(a){si(this,a);return[new Vi(a,this)]};
Ii.prototype.B=function(a){si(this,a);var c=Nh(a,this.qe);if(0===c.size)return[45056|c.id,0,0];var b=this.children[0],d=[];if(b instanceof gi)var e=Qh(a,b).offset;else{e=Sh(a,b.nb);for(var f=0;f<b.nb;f++)d=d.concat((b instanceof li?b.children[f]:b).B(a)),d=d.concat(16384|e+f)}return d=d.concat(45056|c.id,e,b.nb)};function Wi(a,c){c=c||0;for(var b=0;b<a.length;b++)a[b]instanceof ti&&(a[b]=a[b].B(c+b))}
Pb.prototype.B=function(){this.Ha=[];this.Be();this.qc=[];var a=this.l.map(function(f){this.Xa=0;this.Ia(f.ab[0]);this.zg=f instanceof vi;this.qc=[];return{he:f.B(this,!0),mapping:this.qc}},this);if(0<this.Ha.length)throw"internal";for(var c=0,b=0;b<this.l.length;b++)this.l[b]instanceof ui&&c++;this.zd={};var d=[],e=[1+2*c];this.qc=[];for(b=0;b<this.l.length;b++)this.qc=this.qc.concat(a[b].mapping.map(function(f){return new Gh(f.Kh,f.line,f.Sa,f.jc+1+2*c+d.length)})),this.l[b]instanceof ui?(e=e.concat(Lh(this.Aa,
this.l[b].qe),1+2*c+d.length),d=d.concat(a[b].he)):this.l[b]instanceof vi&&(this.zd[this.l[b].Mh]=1+2*c+d.length,d=d.concat(a[b].he));Wi(d,1+2*c);return e.concat(d)};Pb.prototype.compile=function(){this.og();this.Ch();this.o=0;for(this.b=[];this.o<this.G.length;)this.b=this.b.concat(this.uh());this.Bh();Ri(this);this.Dh();return this.B()};function Xi(a,c,b){void 0===b&&(b=1);return{name:a,Fd:b,Ve:1,rf:function(d){return null!=Jh(d,c)},Mb:function(d,e,f,g){d=Jh(e,c);e=[4097];for(f=0;f<b;f++)e=e.concat([4096|g+b-1-f]);return e=e.concat([4096|g+b,49152|d.id,12288|g+b])}}}var Qb=[Xi("min","math.min",2),Xi("max","math.max",2),Xi("clamp","math.clamp",3),Xi("muldiv","math.muldiv",3),Xi("atan2","math.atan2",2),Xi("sin","math.sin"),Xi("cos","math.cos"),Xi("sqrt","math.sqrt"),Xi("rand","math.rand",0)];function wh(a,c){Pb.call(this,a,c);this.Xg=!0;this.rb=Yi;this.Fb=100;this.Ph=[];this.Uf=[];this.Zg=[];this.labels=[[]];this.Yg=[];this.Sb=!1;this.label=null;this.aa=ai;this.pa=[]}wh.prototype=Object.create(Pb.prototype);wh.prototype.constructor=wh;var Zi="== != <= >= |= ^= &= *= /= %= += -= <<= >>= ++ -- ( ) [ ] - ~ ! * / % + << >> && || & ^ | > < = , ? : { } ; bool break case const continue default do else emit false fixed for goto if int onevent return size switch true void when while".split(" ");
function $i(a,c,b){return b[0]}function aj(a,c,b){for(a=0;a<b.length;a++)switch(b[a]){case ai:case fi:return b[a];case "v":throw"cannot use void result in expression";}return Ih}function bj(a,c,b){if(!(a instanceof li)&&a.resultType!==c&&a.resultType!==ai){if("v"===a.resultType)throw"cannot use void result "+W(a.head);if(c=cj(c))a=new ii(new Yh(a.head.ee,a.head.Md,a.head.Kd,c),0,Li(b,c,0),[a]),a=a.L(b)}return a}function dj(a,c){a.children[1]=bj(a.children[1],a.resultType,c);return a}
wh.prototype.Za=function(a,c){if(a===ai||c===ai)throw"internal";if("v"===a)throw"bad conversion from void";switch(a){case Ih:case "b":switch(c){case fi:return[4196,32772]}break;case fi:switch(c){case Ih:case "b":return[4196,32773]}}return[]};function ej(a,c,b){var d=[];a.forEach(function(e){d=e instanceof ei&&c===Ih?d.concat(Si(Math.trunc(e.n))):e instanceof ci&&e.resultType===Ih&&c===fi?d.concat(Si(e.n*b.Fb)):d.concat(e.B(b)).concat(b.Za(e.resultType,c))});return d}
function fj(a,c,b,d){var e=Sh(a,4);return(c instanceof $h?c.B(a):Si(c)).concat(16384|e).concat(b instanceof $h?b.B(a):Si(b),16384|e+1).concat(d instanceof $h?d.B(a):Si(d),[16384|e+2,4097,4096|e+2,4096|e+1,4096|e,4096|e+3,49152|Jh(a.Aa,"math.muldiv").id,12288|e+3])}
function gj(a,c,b,d){for(var e=!1,f=[],g=0;g<a.children.length;g++){if(a.children[g]instanceof ei)e=!0;else if(!(a.children[g]instanceof ci))return a;f.push(a.children[g].n)}b=(e&&d?d:b)(f);d=a.La.resultType;a.La.za&&(d=a.La.za(c,a,a.children.map(function(h){return h.resultType})));switch(d){case Ih:case "b":return new ci(a.head,di(b));case fi:return new ei(a.head,b);default:throw"internal";}}
var Yi=[new Y("--",0,{priority:150,za:$i}),new Y("++",0,{priority:150,za:$i}),new Y("-",0,{priority:150,za:$i,L:function(a,c){return gj(a,c,function(b){return-b[0]})},P:[28672]}),new Y("~",0,{priority:150,L:function(a,c){return gj(a,c,function(b){return~b[0]})},P:[28674]}),new Y("!",0,{priority:150,resultType:"b",L:function(a,c){return gj(a,c,function(b){return 0==b[0]?1:0})},P:[4096,32778]}),new Y("bool",0,{priority:150,resultType:"b",L:function(a,c){return gj(a,c,function(b){return 0!=b[0]?1:0})},
P:[],B:function(a,c){c=a.children[0].B(c);"b"!==a.children[0].resultType&&(c=c.concat(4096,32779));return c}}),new Y("fixed",0,{priority:150,resultType:fi,L:function(a,c){return gj(a,c,function(b){return b[0]})},P:[],B:function(a,c){var b=a.children[0].B(c);a.children[0].resultType!==fi&&(b=b.concat(4096|c.Fb,32772));return b}}),new Y("int",0,{priority:150,L:function(a,c){return gj(a,c,function(b){return b[0]})},P:[],B:function(a,c){var b=a.children[0].B(c);a.children[0].resultType===fi&&(b=b.concat(4096|
c.Fb,32773));return b}}),new Y("size",0,{priority:150,L:function(a,c){var b=0<a.children[0].nb?a.children[0].nb:a.children[0]instanceof li?a.children[0].children.length:-1;if(0>b&&a.children[0]instanceof gi)for(var d=c.ib.length-1;0<=d;d--)if(c.ib[d].name===a.children[0].name){b=c.ib[d].size;break}return 0<b?new ci(a.head,b):a}}),new Y("--",2,{priority:150,za:$i}),new Y("++",2,{priority:150,za:$i}),new Y("+=",ji,{priority:ki,za:$i,L:dj}),new Y("-=",ji,{priority:ki,za:$i}),new Y("*=",ji,{priority:ki,
za:$i}),new Y("/=",ji,{priority:ki,za:$i}),new Y("%=",ji,{priority:ki,za:$i}),new Y("<<=",ji,{priority:ki}),new Y(">>=",ji,{priority:ki}),new Y("&=",ji,{priority:ki}),new Y("|=",ji,{priority:ki}),new Y("^=",ji,{priority:ki}),new Y("*",ji,{priority:140,za:aj,P:[32772],L:function(a,c){return gj(a,c,function(b){return b[0]*b[1]})},B:function(a,c){var b=a.children[1].resultType===fi,d=[];a.children[0].resultType===fi&&b?d=d.concat(fj(c,a.children[0],a.children[1],c.Fb)):(a.children.forEach(function(e){d=
d.concat(e.B(c))}),d=d.concat(a.La.P));return d}}),new Y("/",ji,{priority:140,za:aj,P:[32773],L:function(a,c){return gj(a,c,function(b){if(0===b[1])throw"division by 0 "+W(a.head);return Math.trunc(b[0]/b[1])},function(b){if(0===b[1])throw"division by 0 "+W(a.head);return b[0]/b[1]})},B:function(a,c){var b=a.children[1].resultType===fi,d=[];a.children[0].resultType===fi?b?d=d.concat(fj(c,a.children[0],c.Fb,a.children[1])):(a.children.forEach(function(e){d=d.concat(e.B(c))}),d=d.concat(a.La.P)):b?
d=d.concat(fj(c,a.children[0],c.Fb*c.Fb,a.children[1])):(a.children.forEach(function(e){d=d.concat(e.B(c))}),d=d.concat(a.La.P));return d}}),new Y("%",ji,{priority:140,za:aj,L:function(a,c){return gj(a,c,function(b){if(0===b[1])throw"division by 0 "+W(a.head);return b[0]%b[1]})},P:[32774],B:function(a,c){return ej(a.children,a.resultType,c).concat(a.La.P)}}),new Y("+",ji,{priority:130,za:aj,L:function(a,c){return gj(a,c,function(b){return b[0]+b[1]})},P:[32770],B:function(a,c){return ej(a.children,
a.resultType,c).concat(a.La.P)}}),new Y("-",ji,{priority:130,za:aj,L:function(a,c){return gj(a,c,function(b){return b[0]-b[1]})},P:[32771],B:function(a,c){return ej(a.children,a.resultType,c).concat(a.La.P)}}),new Y("<<",ji,{priority:120,L:function(a,c){return gj(a,c,function(b){return b[0]<<b[1]})},P:[32768],B:function(a,c){return a.children[0].B(c).concat(ej(a.children.slice(1),Ih,c)).concat(a.La.P)}}),new Y(">>",ji,{priority:120,L:function(a,c){return gj(a,c,function(b){return b[0]>>b[1]})},P:[32769],
B:function(a,c){return a.children[0].B(c).concat(ej(a.children.slice(1),Ih,c)).concat(a.La.P)}}),new Y("==",ji,{priority:80,resultType:"b",L:function(a,c){return gj(a,c,function(b){return b[0]===b[1]?1:0})},P:[32778],B:function(a,c){var b=a.children.map(function(d){return d.resultType});return ej(a.children,aj(c,a,b),c).concat(a.La.P)}}),new Y("!=",ji,{priority:80,resultType:"b",L:function(a,c){return gj(a,c,function(b){return b[0]!==b[1]?1:0})},P:[32779],B:function(a,c){var b=a.children.map(function(d){return d.resultType});
return ej(a.children,aj(c,a,b),c).concat(a.La.P)}}),new Y("<",ji,{priority:80,resultType:"b",L:function(a,c){return gj(a,c,function(b){return b[0]<b[1]?1:0})},P:[32782],B:function(a,c){var b=a.children.map(function(d){return d.resultType});return ej(a.children,aj(c,a,b),c).concat(a.La.P)}}),new Y("<=",ji,{priority:80,resultType:"b",L:function(a,c){return gj(a,c,function(b){return b[0]<=b[1]?1:0})},P:[32783],B:function(a,c){var b=a.children.map(function(d){return d.resultType});return ej(a.children,
aj(c,a,b),c).concat(a.La.P)}}),new Y(">",ji,{priority:80,resultType:"b",L:function(a,c){return gj(a,c,function(b){return b[0]>b[1]?1:0})},P:[32780],B:function(a,c){var b=a.children.map(function(d){return d.resultType});return ej(a.children,aj(c,a,b),c).concat(a.La.P)}}),new Y(">=",ji,{priority:80,resultType:"b",L:function(a,c){return gj(a,c,function(b){return b[0]>=b[1]?1:0})},P:[32781],B:function(a,c){var b=a.children.map(function(d){return d.resultType});return ej(a.children,aj(c,a,b),c).concat(a.La.P)}}),
new Y("&",ji,{priority:110,L:function(a,c){return gj(a,c,function(b){return b[0]&b[1]})},P:[32777]}),new Y("|",ji,{priority:90,L:function(a,c){return gj(a,c,function(b){return b[0]|b[1]})},P:[32775]}),new Y("^",ji,{priority:100,L:function(a,c){return gj(a,c,function(b){return b[0]^b[1]})},P:[32776]}),new Y("&&",ji,{priority:60,za:$i,L:function(a,c){return gj(a,c,function(b){return b[0]&&b[1]?1:0})},P:[32785],B:function(a,c){var b=a.children[0].B(c).concat([16384|c.Tc,12288|c.Tc,4096,40960|Eh.indexOf("eq"),
4,12288|c.Tc,36864]);Oh(c,b);a=bj(a.children[1],a.children[0].resultType,c).L(c);b=b.concat(a.B(c));Ph(c,b);return b}}),new Y("||",ji,{priority:50,za:$i,L:function(a,c){return gj(a,c,function(b){return b[0]||b[1]?1:0})},P:[32784],B:function(a,c){var b=a.children[0].B(c).concat([16384|c.Tc,12288|c.Tc,4096,40960|Eh.indexOf("ne"),4,12288|c.Tc,36864]);Oh(c,b);a=bj(a.children[1],a.children[0].resultType,c).L(c);b=b.concat(a.B(c));Ph(c,b);return b}}),new Y("?",ji,{priority:40,za:function(a,c,b){return b[1]},
L:function(a){if(!(a.children[1]instanceof ii)||0==a.children[1].La||":"!==a.children[1].La.name)throw"missing else part in conditional expression "+W(a.head);return a.children[0]instanceof ci?a.children[1].children[a.children[0].n?0:1]:a},B:function(a,c){var b=Ui(a.children[0],c);Oh(c,b);b=b.concat(a.children[1].children[0].B(c)).concat(36864);Ph(c,b);Oh(c,b);b=b.concat(a.children[1].children[1].B(c));Ph(c,b);return b}}),new Y(":",ji,{priority:41,za:$i,L:function(a,c){a.children[1]=bj(a.children[1],
a.children[0].resultType,c);return a},B:function(a){throw"unexpected colon outside conditional expression "+W(a.head);}}),new Y("=",ji,{priority:ki,za:$i,L:dj}),new Y(",",ji,{priority:25,za:function(a,c){return c[1]},L:function(a){a.children[0].Nb=!1;return a}}),new Y("false",3,{resultType:"b",L:function(a,c){return gj(a,c,function(){return 0})},P:[4096]}),new Y("true",3,{resultType:"b",L:function(a,c){return gj(a,c,function(){return 1})},P:[4097]})];N=wh.prototype;
N.Ih=function(){for(;this.K<this.w;)if(" "===this.i[this.K]||"\t"===this.i[this.K])this.K++,this.Sa++;else if("\n"===this.i[this.K])this.K++,this.Sa=0,this.line++;else if("\r"===this.i[this.K])this.K++;else if("/*"===this.i.slice(this.K,this.K+2))for(this.K+=2,this.Sa+=2;this.K<this.w&&"*/"!==this.i.slice(this.K-2,this.K);)"\n"===this.i[this.K]?(this.Sa=0,this.line++):"\r"!==this.i[this.K]&&this.Sa++,this.K++;else if("//"===this.i.slice(this.K,this.K+2))for(;this.K<this.w&&"\n"!==this.i[this.K];)this.K++,
this.Sa++;else break};N.og=function(a){return Pb.prototype.og.call(this,a||Zi)};N.Ch=function(){this.G.forEach(function(a,c){a instanceof Yh&&("def"===a.name||0<=["int","bool","fixed","void"].indexOf(a.name))&&this.G[c+1]instanceof Xh&&this.G[c+2]instanceof Yh&&"("===this.G[c+2].name&&this.Ph.push(this.G[c+1].name)},this)};
function hj(a,c){switch(a.name){case "var":case "def":return c||Ih;case "void":return"v";case "int":return Ih;case "bool":return"b";case "fixed":return fi;default:throw"internal";}}function cj(a){switch(a){case Ih:return"int";case fi:return"fixed";case "b":return"bool";default:return""}}function ij(a){return Ni(a,0,"int")||Ni(a,0,"bool")||Ni(a,0,"fixed")}
N.uh=function(){function a(){var l=[];for(this.o++;;){d=this.G[this.o];this.o++;if(!Mi(this,0,Yh))throw"syntax error "+W(b);switch(this.G[this.o].name){case "[":if(Ni(this,1,"]")){this.o+=2;if(!Ni(this,0,"="))throw"missing size or initial value in array declaration"+W(this.G[this.o-2]);e=new ii(this.G[this.o],ji,Li(this,"=",ji),[new gi(d)]);this.o++;e.children.push(Oi(this,25));e.resultType=hj(b,e.children[1].resultType);e.children[1].Wa(this);e.Nb=!1;var k=new ii(new Yh(this.G[this.o].ee,this.G[this.o].Md,
this.G[this.o].Kd,"size"),0,Li(this,"size",0),[e.children[1]]);l.push(new yi(b,d,e.resultType,[k],e))}else k=Pi(this,!0),Ni(this,0,"=")?(e=new ii(this.G[this.o],ji,Li(this,"=",ji),[new gi(d)]),this.o++,e.children.push(Oi(this,25)),e.resultType=hj(b,e.children[1].resultType),e.Nb=!1,l.push(new yi(b,d,e.resultType,k,e))):l.push(new yi(b,d,hj(b),k));break;case "=":e=new ii(this.G[this.o],ji,Li(this,"=",ji),[new gi(d)]);this.o++;e.children.push(Oi(this,25));e.resultType=hj(b,e.children[1].resultType);
e.Nb=!1;e=e.L(this);l.push(new yi(b,d,e.resultType,null,e));break;default:l.push(new yi(b,d,hj(b)))}if(Ni(this,0,","))this.o++;else{if(Ni(this,0,";"))return this.o++,l;throw"missing semicolon "+W(this.G[this.o]);}}}function c(){var l=hj(b);d=this.G[this.o+1];this.o+=3;var k=[];if(!Ni(this,0,")"))for(;;){var r=Ih;ij(this)&&(r=hj(this.G[this.o]),this.o++);if(!Mi(this,0,Xh))throw"bad function definition argument "+W(this.G[this.o]);var u=this.G[this.o].name,y=[],E=!1;this.o++;Ni(this,0,"[")&&(E=!0,y=
Pi(this,!0));k.push({name:u,type:r,ai:y,size:1,A:[],od:E});if(Ni(this,0,","))this.o++;else if(Ni(this,0,")"))break;else throw"syntax error in function definition "+W(this.G[this.o]);}this.o++;if(!Ni(this,0,"{"))throw"block expected after function header "+W(this.G[this.o]);this.o++;return new jj(b,d.name,l,k)}if(this.o>=this.G.length)throw"no more tokens";var b=this.G[this.o];if(this.G[this.o]instanceof Yh)switch(b.name){case "const":if(!Mi(this,1,Xh)||!Ni(this,2,"="))throw'syntax error for "const" '+
W(b);var d=this.G[this.o+1];this.o+=3;var e=Oi(this,25);e=e.L(this);if(!(e instanceof ci))throw"non-constant expression in constant definition "+W(this.G[this.o]);if(!Ni(this,0,";"))throw"missing semicolon "+W(b);this.o++;return[new xi(b,d.name,e)];case "int":case "bool":case "fixed":if(!Mi(this,1,Xh))throw'unexpected token after "'+b.name+'" '+W(b);return Ni(this,2,"(")?[c.call(this)]:a.call(this);case "void":return[c.call(this)];case "if":this.o++;var f=Pi(this);if(1!==f.length)throw'bad condition in "if" statement '+
W(this.G[this.o]);var g=new Ai(b,f[0]);Ni(this,0,"{")?this.o++:g.pa=!0;return[g];case "when":this.o++;f=Pi(this);if(1!==f.length)throw'bad condition in "when" statement '+W(this.G[this.o]);if(!Ni(this,0,"{"))throw'block expected after "when" statement '+W(this.G[this.o]);this.o++;return[new Di(b,f[0])];case "switch":this.o++;f=Pi(this);if(1!==f.length)throw'bad expression in "switch" statement '+W(this.G[this.o]);if(!Ni(this,0,"{"))throw'block expected after "switch" statement '+W(this.G[this.o]);
this.o++;return[new kj(b,f[0])];case "case":this.o++;e=Oi(this);if(!Ni(this,0,":"))throw'missing colon after "case" '+W(this.G[this.o]);this.o++;return[new lj(b,e)];case "default":if(!Ni(this,1,":"))throw'missing colon after "default" '+W(this.G[this.o]);this.o+=2;return[new lj(b,null)];case "goto":if(!Mi(this,1,Xh))throw'missing label after "goto" '+W(this.G[this.o]);d=this.G[this.o+1];this.o+=2;return[new mj(b,d.name)];case "while":this.o++;f=Pi(this);if(1!==f.length)throw'bad condition in "while" statement '+
W(this.G[this.o]);if(Ni(this,0,";"))return this.o++,[new nj(b,f[0])];if(!Ni(this,0,"{"))throw'block expected after "while" statement '+W(this.G[this.o]);this.o++;return[new oj(b,f[0])];case "do":if(!Ni(this,1,"{"))throw'block expected after "do" statement '+W(this.G[this.o]);this.o+=2;return[new pj(b)];case "for":if(!Ni(this,1,"("))throw'"for" syntax error '+W(b);this.o+=2;d=null;var h=Ih;if(Ni(this,0,";"))e=null;else{if(Ni(this,0,"var")||ij(this)){if(!Mi(this,1,Xh))throw'bad variable declaration in "for" statement '+
W(this.G[this.o]);h=hj(this.G[this.o]);this.o++;d=this.G[this.o]}e=Oi(this);if(!Ni(this,0,";"))throw'semicolon expected in "for" statement '+W(this.G[this.o]);}this.o++;if(Ni(this,0,";"))g=null;else if(g=Oi(this),!Ni(this,0,";"))throw'semicolon expected in "for" statement '+W(this.G[this.o]);this.o++;if(Ni(this,0,")"))f=null;else if(f=Oi(this),!Ni(this,0,")"))throw'semicolon expected in "for" statement '+W(this.G[this.o]);this.o++;if(!Ni(this,0,"{"))throw'block expected after "for" statement '+W(this.G[this.o]);
this.o++;return[new qj(b,d,h,e,g,f)];case ";":return this.o++,[new rj(b)];case "{":return this.o++,[new sj(b)];case "}":this.o++;if(Ni(this,0,"else")){this.o++;if(Ni(this,0,"if")){this.o++;f=Pi(this);if(1>f.length)throw'empty condition in "if" statement '+W(this.G[this.o]);1<f.length&&(g=new mi(b),g.children=f.slice(0,-1).map(function(l){l instanceof ii&&(l.Nb=!1);return l}),f=f.slice(-1));if(!Ni(this,0,"{"))throw'block expected after "if" statement '+W(this.G[this.o]);this.o++;return[new Bi(b,f[0])]}if(!Ni(this,
0,"{"))throw'block expected after "else" statement '+W(this.G[this.o]);this.o++;return[new Ci(b)]}return[new Ji(b)];case "else":throw'unexpected "else" '+W(this.G[this.o]);case "onevent":if(!Mi(this,1,Xh))throw'unexpected token after "onevent" '+W(b);if(!Ni(this,2,"{"))throw'block expected after "onevent" statement '+W(this.G[this.o]);d=this.G[this.o+1];this.o+=3;return[new tj(b,d.name)];case "return":this.o++;Ni(this,0,";")?e=null:e=Oi(this);if(!Ni(this,0,";"))throw"missing semicolon "+W(b);this.o++;
return[new uj(b,e)];case "break":d=null;Mi(this,1,Xh)&&(d=this.G[this.o+1],this.o++);if(!Ni(this,1,";"))throw"missing semicolon "+W(b);this.o+=2;return[new vj(b,!1,d?d.name:null)];case "continue":d=null;Mi(this,1,Xh)&&(d=this.G[this.o+1],this.o++);if(!Ni(this,1,";"))throw"missing semicolon "+W(b);this.o+=2;return[new vj(b,!0,d?d.name:null)]}if(Mi(this,0,Xh)&&Ni(this,1,"(")&&(d=this.G[this.o],Jh(this.Aa,d.name)))return this.o++,[new Gi(b,d.name,Pi(this))];if(Mi(this,0,Xh)&&Ni(this,1,":"))return d=
this.G[this.o],this.o+=2,[new wj(b,d.name)];e=Oi(this);e.Nb=!1;if(!Ni(this,0,";"))throw"missing semicolon "+(this.o<this.G.length?W(this.G[this.o]):"eof");this.o++;e=e.L(this);return[new zi(e)]};
N.Cf=function(a){if(a instanceof jj){for(var c=0;c<a.F.length;c++)a.F[c].size=1,a.F[c].A=a.F[c].ai.map(function(b){b=b.L(this);if(!(b instanceof ci))throw"non-constant expression in argument dimension "+W(b.head);if(0>=b.n||Math.round(b.n)!==b.n)throw"bad value for argument dimension "+W(b.head);a.F[c].size*=b.n;return b.n},this),this.Wc(a.F[c].name,a.F[c].size,a.F[c].A,this.Ya,a.F[c].type,a.F[c].od),this.Ya+=a.F[c].od?1:a.F[c].size;a.ab[1]={ib:this.ib.slice(),labels:this.labels.slice()}}else a instanceof
qj?a.aa&&(this.Wc(a.aa.name,1,[1],this.Ya,a.Ha),this.Ya+=1,a.ab[1]={ib:this.ib.slice(),labels:this.labels.slice()}):Pb.prototype.Cf.call(this,a)};N.Be=function(){this.ib=this.Zg;this.labels=this.Yg};N.Ia=function(a){a&&(this.ib=a.ib,this.labels=a.labels)};N.getContext=function(){return{ib:this.ib,labels:this.labels.slice()}};function xj(a,c,b,d,e,f,g){Hh.call(this,a,c,b,d,e);this.Sb=f;this.od=g||!1}xj.prototype=Object.create(Hh.prototype);N=xj.prototype;N.constructor=xj;
N.Yd=function(a,c){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,20480|(c||0),a.Aa.b]:[12288|a.u,20480|this.offset+(c||0),a.Aa.b]:[12288|this.offset+(c||0)]};N.Vf=function(a,c){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,24576|(c||0),a.Aa.b]:[12288|a.u,24576|this.offset+(c||0),a.Aa.b]:[16384|this.offset+(c||0)]};N.sf=function(a){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,32770,20480,a.Aa.b]:[12288|a.u,32770,20480|this.offset,a.Aa.b]:[20480|this.offset,this.size]};
N.wg=function(a){return this.Sb?this.od?[12288|a.u,20480|this.offset,a.Aa.b,32770,24576,a.Aa.b]:[12288|a.u,32770,24576|this.offset,a.Aa.b]:[24576|this.offset,this.size]};wh.prototype.Wc=function(a,c,b,d,e,f){this.ib.push(new xj(a,c,b,d,e,this.Sb,f))};function yj(a){ii.call(this,a,4,null)}yj.prototype=Object.create(ii.prototype);yj.prototype.constructor=yj;N=wh.prototype;
N.oh=function(a){var c=new yj(a,this.Sb,this.Ya);c.La={za:function(b,d){var e;a:{for(e=0;e<b.Uf.length;e++)if(b.Uf[e].vg===a.name){e=b.Uf[e];break a}e=null}return e?e.resultType:(e=Rh(b,a.name))&&e.za?e.za(b,e,d):Ih}};return c};
N.ah=function(){this.Ya=this.Aa.Ya;this.Sb=!1;for(var a=[],c=0;c<this.b.length;c++){if(0<=[Ji,Bi,Ci].indexOf(this.b[c].constructor)){if(0===a.length)throw"unexpected end of block "+W(this.b[c].head);var b=a.pop();this.Ya=b.Ya;this.Sb=b.Sb;b.ji.ab[0]={ib:this.ib.slice(),labels:this.labels.slice()};this.ib.splice(b.mi);this.labels.pop();0===a.length&&(this.aa=ai)}0<=[Ai,Di,kj,oj,sj,qj,tj,jj,Bi,Ci].indexOf(this.b[c].constructor)&&(a.push({Ya:this.Ya,Sb:this.Sb,mi:this.ib.length,ji:this.b[c]}),this.labels.push([]),
this.b[c]instanceof jj&&(this.Sb=!0,this.aa=this.b[c].resultType,this.Ya=0));this.Cf(this.b[c]);if(this.b[c]instanceof wj){b=this.b[c].label;for(var d=this.labels.length-1,e=0;e<this.labels[d].length;e++)if(this.labels[d][e].label===b)throw'duplicate label "'+b+'"';this.labels[d].push({label:b})}}this.Zg=this.ib.slice();this.Yg=this.labels};
N.Bh=function(){for(var a=1;a<this.b.length;)this.b[a]instanceof nj&&this.b[a-1]instanceof Ji?this.b.splice(a-1,1):a++;this.b.forEach(function(c){c instanceof jj&&(this.Uf.push(c),this.aa=c.resultType)},this);for(a=0;a<this.b.length-1;a++)this.b[a]instanceof wj&&(this.b[a+1]instanceof oj?this.b[a+1].label=this.b[a].label:this.b[a+1]instanceof pj?this.b[a+1].label=this.b[a].label:this.b[a+1]instanceof qj?this.b[a+1].label=this.b[a].label:this.b[a+1]instanceof kj&&(this.b[a+1].label=this.b[a].label))};
N.Dh=function(){for(var a=0;a<this.b.length;a++)(this.b[a]instanceof tj||this.b[a]instanceof jj)&&this.l.push(this.b[a])};function zj(a,c){for(var b=a.length-1;0<=b;b--)for(var d=a[b].length-1;0<=d;d--)if(a[b][d].label===c)return a[b][d];return null}
N.B=function(){this.Ha=[];this.Be();this.qc=[];this.Tc=this.Jb=this.uc=this.Aa.b-2;this.u=this.Tc+1;this.$g=[];var a=this.l.map(function(h){this.Xa=0;this.Ia(h.ab[0]);this.zg=h instanceof vi||h instanceof jj;this.Sb=h instanceof jj;this.qc=[];h=h.B(this,!0);Wi(h);return{he:h,mapping:this.qc}},this);if(0<this.Ha.length)throw"internal";for(var c=0,b=0;b<this.l.length;b++)this.l[b]instanceof ui&&c++;var d=[],e={},f=[];this.qc=[];for(b=0;b<this.l.length;b++){var g=1+2*c+f.length;this.l[b]instanceof tj||
this.l[b]instanceof ui?(d.push({id:Lh(this.Aa,this.l[b].qe),offset:f.length}),f=f.concat(a[b].he)):this.l[b]instanceof vi?(e[this.l[b].Mh]=f.length,f=f.concat(a[b].he)):this.l[b]instanceof jj&&(e[this.l[b].vg]=f.length,f=f.concat(a[b].he));this.qc=this.qc.concat(a[b].mapping.map(function(h){return new Gh(h.Kh,h.line,h.Sa,h.jc+g)}))}a=[1+2*d.length];for(b=0;b<d.length;b++)a=a.concat(d[b].id,1+2*d.length+d[b].offset);for(b=0;b<f.length;b++)if("string"===typeof f[b]){if(void 0===e[f[b]])throw Aj(f[b]),
'unknown function "'+f[b]+'"';f[b]=53248|e[f[b]]+a.length}return a.concat(f)};
N.lh=function(a){for(var c=a.head.name,b=0;b<this.l.length;b++)if(this.l[b]instanceof jj&&this.l[b].vg===c){if(a.children.length!==this.l[b].F.length)throw"wrong number of arguments "+W(a.head);c=a.Nb?[c,12288|this.Tc]:[c];this.Sb?0<this.Ya&&(c=[12288|this.u,4096|this.Ya,32770,16384|this.u].concat(c,12288|this.u,4096|this.Ya,32771,16384|this.u)):c=[4096|this.Ya,16384|this.u].concat(c);for(var d=[],e=0;e<a.children.length;e++){if(this.l[b].F[e].size!==a.children[e].nb)throw"incompatible size "+W(a.children[e].head);
if(this.l[b].F[e].od){if(!(a.children[e]instanceof gi))throw"variable reference expected "+W(a.children[e].head);if(this.l[b].F[e].type!==a.children[e].resultType)throw"variable reference type mismatch "+W(a.children[e].head);}if(this.l[b].F[e].od){var f=Qh(this,a.children[e]);d=d.concat(f.Sb?f.od?[12288|this.u,20480|f.offset,this.Aa.b]:[12288|this.u,4096|f.offset,32770]:[4096|f.offset]).concat(this.Sb?[12288|this.u,24576|e+this.Ya,this.Aa.b]:16384|e+this.Ya)}else a.children[e]=bj(a.children[e],this.l[b].F[e].type,
this).L(this),d=d.concat(a.children[e].B(this)).concat(this.Za(a.children[e].resultType,this.l[b].F[e].type),this.Sb?[12288|this.u,24576|e+this.Ya,this.Aa.b]:16384|e+this.Ya)}return d.concat(c)}return null};function Bj(a){a=a.trim();if(""===a)return!1;var c=["#","//","/*"].map(function(b){b=a.indexOf(b);return 0>b?a.length:b}).sort(function(b,d){return b-d})[0];return c<a.length?"#"!==a[c]:/[;{]/.test(a)}ei.prototype.B=function(a){return Si(Math.round(this.n*a.Fb))};
function sj(a){qi.call(this,a,3)}sj.prototype=Object.create(qi.prototype);sj.prototype.constructor=sj;sj.prototype.L=function(a){bi(this.children,a);return this};sj.prototype.B=function(a){var c=a.getContext();si(this,a);a.Ia(this.ab[0]);var b=$h.prototype.B.call(this,a);a.Ia(c);return b};function rj(a){qi.call(this,a)}rj.prototype=Object.create(qi.prototype);rj.prototype.constructor=rj;rj.prototype.B=function(){return[]};function oj(a,c){Ei.call(this,a,c);this.label=null}oj.prototype=Object.create(Ei.prototype);
oj.prototype.constructor=oj;oj.prototype.B=function(a){if(null==this.Ta&&0===this.children.length)return[];var c=a.getContext();si(this,a);var b=[],d=a.Xa;a.pa.push({});null!=this.Ta&&(b=Ui(this.Ta,a));Oh(a,b);a.Ia(this.ab[0]);this.children.forEach(function(e){a.Xa=d+b.length;b=b.concat(e.B(a))});b=b.concat(36864|-b.length&4095);Ph(a,b);Cj(b,0,b.length,this.label);a.pa.pop();a.Ia(c);return b};function pj(a){qi.call(this,a,3);this.label=this.Ta=null}pj.prototype=Object.create(qi.prototype);
pj.prototype.constructor=pj;pj.prototype.zh=function(a){if(!(a instanceof nj))throw'unexpected closing statement for "do"';this.Ta=a.Ta};
pj.prototype.B=function(a){if(null==this.Ta&&0===this.children.length)return[];var c=a.getContext();si(this,a);var b=[],d=a.Xa;a.pa.push({});a.Ia(this.ab[0]);this.children.forEach(function(e){a.Xa=d+b.length;b=b.concat(e.B(a))});null!=this.Ta&&(b=b.concat(Ui(new ii(new Yh(this.Ta.head.ee,this.Ta.head.Md,this.Ta.head.Kd,"not"),0,Li(a,"!",0),[this.Ta]),a)),Oh(a,b),Ph(a,b,0));Cj(b,0,b.length,this.label);a.pa.pop();a.Ia(c);return b};function nj(a,c){qi.call(this,a,5);this.Ta=c}nj.prototype=Object.create(qi.prototype);
nj.prototype.constructor=nj;function qj(a,c,b,d,e,f){qi.call(this,a,3);d&&(d.Nb=!1);f&&(f.Nb=!1);this.aa=c;this.Ha=b;this.i=d;this.b=e;this.l=f;this.label=null;this.S=[]}qj.prototype=Object.create(qi.prototype);N=qj.prototype;N.constructor=qj;N.Wa=function(a){$h.prototype.Wa.call(this,a);this.i&&this.i.Wa(a);this.b&&this.b.Wa(a);this.l&&this.l.Wa(a)};N.L=function(a){this.i&&(this.i=this.i.L(a));this.b&&(this.b=this.b.L(a));this.l&&(this.l=this.l.L(a));bi(this.children,a);return this};
N.Ae=function(a,c){this.S.push(c)};
N.B=function(a){var c=a.getContext();si(this,a);a.Ia(this.ab[1]);var b=a.Xa,d=this.i?this.i.B(a):[];a.pa.push({});var e=d.length;this.b&&(d=d.concat(Ui(this.b,a)),Oh(a,d));a.Ia(this.ab[0]);for(var f=0;f<this.children.length;f++)a.Xa=b+d.length,d=d.concat(this.children[f].B(a));a.Ia(this.ab[1]);f=d.length;a.Xa=b+d.length;Zh(a,this.S[0]);this.l&&(d=d.concat(this.l.B(a)));d=d.concat(36864|e-d.length&4095);this.b&&Ph(a,d);Cj(d,f,d.length,this.label);a.pa.pop();a.Ia(c);return d};
function vj(a,c,b){qi.call(this,a);this.H=c;this.label=b}vj.prototype=Object.create(qi.prototype);vj.prototype.constructor=vj;function Dj(a,c){ti.call(this,a,c)}Dj.prototype=Object.create(ti.prototype);Dj.prototype.constructor=Dj;function Cj(a,c,b,d){for(var e=0;e<a.length;e++)if(a[e]instanceof Dj){var f=a[e].ya.label;if(null==f||f===d)a[e]=a[e].ya.H?36864|c-e&4095:36864|b-e&4095}}
function Aj(a){if(a instanceof Dj){var c=a.ya.label;if(null!=c)throw"unknown "+(a.ya.H?"continue":"break")+' label "'+c+'"'+W(a.ya.head);throw'unexpected "'+(a.ya.H?"continue":"break")+'" '+W(a.ya.head);}}vj.prototype.B=function(a){if(0===a.pa.length)throw(this.H?'"continue"':'"break"')+" outside loop "+W(this.head);si(this,a);return[new Dj(a,this)]};function kj(a,c){qi.call(this,a,3);this.u=c;this.label=null}kj.prototype=Object.create(qi.prototype);kj.prototype.constructor=kj;
kj.prototype.B=function(a){var c=a.Xa,b=this.u.B(a).concat(16384|a.Tc),d=a.getContext();a.Ia(this.ab[0]);var e=!(this.children[0]instanceof lj);e&&(b=b.concat(36864),Oh(a,b));a.pa.push({});for(var f=!1,g=0;g<this.children.length;)if(a.Xa=c+b.length,this.children[g]instanceof lj){for(var h=[],l=!1;g<this.children.length&&this.children[g]instanceof lj;){if(null!=this.children[g].u){var k=this.children[g].u.L(a);if(!(k instanceof ci))throw'non-constant expression in "case" '+W(this.children[g].head);
h.push(k.n)}else l=!0;g++}l?e&&(Ph(a,b),e=!1):(1===h.length?(f&&(b=b.concat(36869)),e&&Ph(a,b),b=b.concat(12288|a.Tc).concat(Si(h[0])).concat(40960|Eh.indexOf("eq"),0)):(f&&(b=b.concat(36864|4*h.length+1)),e&&Ph(a,b),h.forEach(function(r,u){b=b.concat(12288|a.Tc).concat(Si(r)).concat(40960|Eh.indexOf("ne"),4*(h.length-u)-1)}),b=b.concat(36864)),Oh(a,b),e=!0);f=!0}else b=b.concat(this.children[g].B(a)),f=!(this.children[g]instanceof vj)&&!(this.children[g]instanceof uj),g++;Cj(b,-1,b.length,this.label);
a.pa.pop();a.Ia(d);return b};function lj(a,c){qi.call(this,a);this.u=c}lj.prototype=Object.create(qi.prototype);lj.prototype.constructor=lj;lj.prototype.B=function(){throw(this.u?'"case"':'"default"')+" outside switch "+W(this.head);};function wj(a,c){qi.call(this,a);this.label=c}wj.prototype=Object.create(qi.prototype);wj.prototype.constructor=wj;wj.prototype.B=function(a){a.label=this.label;zj(a.labels,this.label).Rh=a.Xa;return[]};function mj(a,c){qi.call(this,a);this.label=c}mj.prototype=Object.create(qi.prototype);
mj.prototype.constructor=mj;function Ej(a,c,b){ti.call(this,a,c);this.labels=b}Ej.prototype=Object.create(ti.prototype);Ej.prototype.constructor=Ej;Ej.prototype.B=function(a){var c=zj(this.labels,this.ya.label);if(null===c)throw'unknown label "'+this.ya.label+'" '+W(this.ya.head);return 36864|c.Rh-a&4095};mj.prototype.B=function(a){return[new Ej(a,this,a.labels.slice())]};function tj(a,c){qi.call(this,a,3);this.qe=c}tj.prototype=Object.create(qi.prototype);tj.prototype.constructor=tj;
tj.prototype.L=function(a){bi(this.children,a);return this};tj.prototype.B=function(a,c){if(c){c=a.getContext();si(this,a);a.Ia(this.ab[0]);var b=$h.prototype.B.call(this,a).concat(0);a.Ia(c);return b}return[]};function jj(a,c,b,d){qi.call(this,a,3);this.vg=c;this.resultType=b;this.F=d}jj.prototype=Object.create(qi.prototype);jj.prototype.constructor=jj;jj.prototype.yh=function(a){a.aa=this.resultType};jj.prototype.L=function(a){bi(this.children,a);return this};
jj.prototype.B=function(a,c){if(c){c=a.getContext();si(this,a);a.Ia(this.ab[0]);var b=$h.prototype.B.call(this,a).concat(57344);a.Ia(c);return b}return[]};function uj(a,c){qi.call(this,a);c&&this.children.push(c)}uj.prototype=Object.create(qi.prototype);uj.prototype.constructor=uj;
uj.prototype.Ae=function(a){if(a.aa===ai)throw'"return" outside function definition '+W(this.head);if("v"===a.aa&&0<this.children.length)throw"unexpected return value in void function "+W(this.head);if("v"!==a.aa&&0===this.children.length)throw"missing return value in non-void function "+W(this.head);0<this.children.length&&(this.children[0]=bj(this.children[0],a.aa,a).L(a))};
uj.prototype.B=function(a){si(this,a);var c=[];0<this.children.length&&(c=this.children[0].B(a).concat(a.Za(this.children[0].resultType,a.aa)).concat(16384|a.Tc));return c.concat(57344)};var xh=[{name:"abs",Fd:1,za:function(a,c){return c[0]},rf:function(){return!0},Mb:function(a,c,b,d){return[12288|d,28673]}},{name:"atan2",Fd:2,Ve:1,za:function(){return fi},rf:function(a){return null!=Jh(a,"math.atan2")},Mb:function(a,c,b,d){return(b[0]===fi&&b[1]!==fi?[12288|d+1,4096|a.Fb,32772,16384|d+1]:b[0]!==fi&&b[1]===fi?[12288|d,4096|a.Fb,32772,16384|d]:[]).concat([4097,4096|d+1,4096|d,4096|d+2,49152|Jh(c,"math.atan2").id,12288|d+2,4096|Math.floor(32768/(a.Fb*Math.PI)),32773])}},{name:"cos",
Fd:1,Ve:1,za:function(){return fi},rf:function(a){return null!=Jh(a,"math.cos")},Mb:function(a,c,b,d){return[12288|d,4096|Math.round(32767/((b[0]===fi?a.Fb:1)*Math.PI)),32772,16384|d,4097,4096|d,4096|d+1,49152|Jh(c,"math.cos").id,12288|d+1,4096|Math.floor(32768/a.Fb),32773]}},Xi("rand","math.rand",0),{name:"random",Fd:0,Ve:1,za:function(){return fi},rf:function(a){return null!=Jh(a,"math.rand")},Mb:function(a,c,b,d){return[4097,4096|d,49152|Jh(c,"math.rand").id,12288|d,28673,4096|Math.floor(32768/
a.Fb),32773]}},{name:"stop",Fd:0,za:function(){return"v"},Mb:function(){return[0]}},{name:"sin",Fd:1,Ve:1,za:function(){return fi},rf:function(a){return null!=Jh(a,"math.sin")},Mb:function(a,c,b,d){return[12288|d,4096|Math.round(32767/((b[0]===fi?a.Fb:1)*Math.PI)),32772,16384|d,4097,4096|d,4096|d+1,49152|Jh(c,"math.sin").id,12288|d+1,4096|Math.floor(32768/a.Fb),32773]}},{name:"sqrt",Fd:1,Ve:6,za:function(){return fi},Mb:function(a,c,b,d){c=Si(b[0]===fi?a.Fb:a.Fb*a.Fb);return[4096|a.Fb,16384|d+1,4106,
16384|d+2,12288|d,16384|d+4].concat(c,[16384|d+5,12288|d+1,16384|d+6,4097,4096|d+6,4096|d+5,4096|d+4,4096|d+3,49152|Jh(a.Aa,"math.muldiv").id,12288|d+3,12288|d+1,32770,4098,32773,16384|d+1,12288|d+2,4097,32771,16384|d+2,12288|d+2,4096,40960|Eh.indexOf("le"),-(23+c.length)&65535,12288|d+1])}}];var Ob={name:"thymio-II",maxVarSize:620,variables:[{name:"_id",size:1},{name:"event.source",size:1},{name:"event.args",size:32},{name:"_fwversion",size:2},{name:"_productId",size:1},{name:"buttons._raw",size:5},{name:"button.backward",size:1},{name:"button.left",size:1},{name:"button.center",size:1},{name:"button.forward",size:1},{name:"button.right",size:1},{name:"buttons._mean",size:5},{name:"buttons._noise",size:5},{name:"prox.horizontal",size:7},{name:"prox.comm.rx._payloads",size:7},{name:"prox.comm.rx._intensities",
size:7},{name:"prox.comm.rx",size:1},{name:"prox.comm.tx",size:1},{name:"prox.ground.ambiant",size:2},{name:"prox.ground.reflected",size:2},{name:"prox.ground.delta",size:2},{name:"motor.left.target",size:1},{name:"motor.right.target",size:1},{name:"_vbat",size:2},{name:"_imot",size:2},{name:"motor.left.speed",size:1},{name:"motor.right.speed",size:1},{name:"motor.left.pwm",size:1},{name:"motor.right.pwm",size:1},{name:"_integrator",size:2},{name:"acc",size:3},{name:"leds.top",size:3},{name:"leds.bottom.left",
size:3},{name:"leds.bottom.right",size:3},{name:"leds.circle",size:8},{name:"temperature",size:1},{name:"rc5.address",size:1},{name:"rc5.command",size:1},{name:"mic.intensity",size:1},{name:"mic.threshold",size:1},{name:"mic._mean",size:1},{name:"timer.period",size:2},{name:"acc._tap",size:1},{name:"sd.present",size:1}],localEvents:[{name:"button.backward"},{name:"button.left"},{name:"button.center"},{name:"button.forward"},{name:"button.right"},{name:"buttons"},{name:"prox"},{name:"prox.comm"},{name:"tap"},
{name:"acc"},{name:"mic"},{name:"sound.finished"},{name:"temperature"},{name:"rc5"},{name:"motor"},{name:"timer0"},{name:"timer1"}],nativeFunctions:[{name:"_system_reboot",args:[]},{name:"_system_settings_read",args:[1,1]},{name:"_system_settings_write",args:[1,1]},{name:"_system_settings_flash",args:[]},{name:"math.copy",args:[-1,-1]},{name:"math.fill",args:[-1,1]},{name:"math.addscalar",args:[-1,-1,1]},{name:"math.add",args:[-1,-1,-1]},{name:"math.sub",args:[-1,-1,-1]},{name:"math.mul",args:[-1,
-1,-1]},{name:"math.div",args:[-1,-1,-1]},{name:"math.min",args:[-1,-1,-1]},{name:"math.max",args:[-1,-1,-1]},{name:"math.clamp",args:[-1,-1,-1,-1]},{name:"math.dot",args:[1,-1,-1,1]},{name:"math.stat",args:[-1,1,1,1]},{name:"math.argbounds",args:[-1,1,1]},{name:"math.sort",args:[-1]},{name:"math.muldiv",args:[-1,-1,-1,-1]},{name:"math.atan2",args:[-1,-1,-1]},{name:"math.sin",args:[-1,-1]},{name:"math.cos",args:[-1,-1]},{name:"math.rot2",args:[2,2,1]},{name:"math.sqrt",args:[-1,-1]},{name:"math.rand",
args:[-1]},{name:"_leds.set",args:[1,1]},{name:"sound.record",args:[1]},{name:"sound.play",args:[1]},{name:"sound.replay",args:[1]},{name:"sound.system",args:[1]},{name:"leds.circle",args:[1,1,1,1,1,1,1,1]},{name:"leds.top",args:[1,1,1]},{name:"leds.bottom.left",args:[1,1,1]},{name:"leds.bottom.right",args:[1,1,1]},{name:"sound.freq",args:[1,1]},{name:"leds.buttons",args:[1,1,1,1]},{name:"leds.prox.h",args:[1,1,1,1,1,1,1,1]},{name:"leds.prox.v",args:[1,1]},{name:"leds.rc",args:[1]},{name:"leds.sound",
args:[1]},{name:"leds.temperature",args:[1,1]},{name:"sound.wave",args:[142]},{name:"prox.comm.enable",args:[1]},{name:"sd.open",args:[1,1]},{name:"sd.write",args:[-1,1]},{name:"sd.read",args:[-1,1]},{name:"sd.seek",args:[1,1]},{name:"_rf.nodeid",args:[1]},{name:"_poweroff",args:[]}]};function zh(a,c){this.Aa=a;this.b=c}function Fj(a){var c={};a.Aa.Ma.forEach(function(b){c[b.name]=b.offset});c._userdata=a.Aa.Ya;c._topdata=a.Aa.b;c["_ev.init"]=65535;a.Aa.Qc.forEach(function(b,d){c["_ev."+b.name]=65534-d});a.Aa.Ub.forEach(function(b){c["_nf."+b.name]=b.id});return c}
function yh(a){for(var c=a.b.split("\n"),b=[],d=Fj(a),e=0;2>e;e++){b=[];var f=null;c.forEach(function(g,h){var l=/^\s*(;.*)?$/.exec(g);if(!l)if(l=/^\s*([\w_.]+:)\s*(;.*)?$/i.exec(g))f=l[1].slice(0,-1),d[f]=b.length;else if(l=/^\s*([\w_.]+:)?\s*([a-z0-9.]+)([-+a-z0-9\s._,=]*)(;.*)?$/i.exec(g)){if(l[1]&&(f=l[1].slice(0,-1),d[f]=b.length),g=l[2],l=l[3].trim(),g){var k=0<l.length?l.split(",").map(function(r){return r.trim().split(/\s+/)}):[];k=[].concat.apply([],k);l=Gj[g];if(void 0==l)throw'Unknown instruction "'+
g+'" (line '+(h+1).toString(10)+")";if(-1!==l.fc&&(l.fc||0)!=k.length)throw"Wrong number of arguments (line "+(h+1).toString(10)+")";void 0!==l.code?b=b.concat(l.code):l.$b&&(g=k.map(function(r){/^[a-z]+=/.test(r)&&(r=r.replace(/^[a-z]+=/,""));return/^(0x[0-9a-f]+|[0-9]+)$/i.test(r)?parseInt(r,0):r}),b=b.concat(l.$b(b.length,g,f,d,e,h+1)));f&&d[f]!==b.length&&(f=null)}}else throw"Syntax error (line "+(h+1).toString(10)+")";},a)}return b}
function Hj(a,c,b,d){function e(k){if(!b)return 0;if(/^(0x[0-9a-f]+|[0-9]+)$/i.test(k))return parseInt(k,0);if(!c.hasOwnProperty(k))throw'Unknown symbol "'+a+'" (line '+d.toString(10)+")";return c[k]}if("string"===typeof a){for(var f=0,g=!1,h=0;h<a.length;){var l=/^(\+|-|[._a-z0-9]+)/i.exec(a.slice(h));if(null==l)throw"Syntax error (line "+d.toString(10)+")";switch(l[0]){case "+":g=!1;break;case "-":g=!0;break;default:f+=g?-e(l[0]):e(l[0])}h+=l[0].length}return f}return a}
var Gj={dc:{fc:-1,$b:function(a,c,b,d,e,f){return c.map(function(g){g=Hj(g,d,1===e,f);return g&65535})}},equ:{fc:1,$b:function(a,c,b,d,e,f){if(!b)throw'No label for pseudo-instruction "equ" (line '+f.toString(10)+")";d&&(d[b]=Hj(c[0],d,1===e,f));return[]}},stop:{code:[0]},"push.s":{fc:1,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(2048<=a||2048<-a)throw"Small integer overflow (line "+f.toString(10)+")";return[4096|a&4095]}},push:{fc:1,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(32768<=a||
32768<-a)throw"Integer overflow (line "+f.toString(10)+")";return[8192,a&65535]}},load:{fc:1,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+f.toString(10)+")";return[12288|a&4095]}},store:{fc:1,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+f.toString(10)+")";return[16384|a&4095]}},"load.ind":{fc:2,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+
f.toString(10)+")";c=Hj(c[1],d,1===e,f);if(0>c||65536<=c)throw"Array size overflow (line "+f.toString(10)+")";return[20480|a&4095,c&65535]}},"store.ind":{fc:2,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Data address out of range (line "+f.toString(10)+")";c=Hj(c[1],d,1===e,f);if(0>c||65536<=c)throw"Array size overflow (line "+f.toString(10)+")";return[24576|a&4095,c&65535]}},neg:{code:[28672]},abs:{code:[28673]},bitnot:{code:[28674]},not:{$b:function(a,c,b,d,e,f){throw"Unary not not implemented in the VM (line "+
f.toString(10)+")";}},sl:{code:[32768]},asr:{code:[32769]},add:{code:[32770]},sub:{code:[32771]},mult:{code:[32772]},div:{code:[32773]},mod:{code:[32774]},bitor:{code:[32775]},bitxor:{code:[32776]},bitand:{code:[32777]},eq:{code:[32778]},ne:{code:[32779]},gt:{code:[32780]},ge:{code:[32781]},lt:{code:[32782]},le:{code:[32783]},or:{code:[32784]},and:{code:[32785]},jump:{fc:1,$b:function(a,c,b,d,e,f){c=Hj(c[0],d,1===e,f);if(2048<=c-a||2048<a-c)throw"Jump too far (line "+f.toString(10)+")";return[36864|
c-a&4095]}},"jump.if.not":{fc:2,$b:function(a,c,b,d,e,f){b=Gj[c[0]];if(void 0==b||void 0==b.code||1!==b.code.length||32768!==(b.code[0]&61440))throw'Unknown op "'+c[0]+'" for jump.if.not (line '+f.toString(10)+")";c=Hj(c[1],d,1===e,f);if(32768<=c-a||32768<a-c)throw"Jump too far (line "+f.toString(10)+")";return[40960|b.code[0]&255,c-a&65535]}},"do.jump.when.not":{fc:2,$b:function(a,c,b,d,e,f){b=Gj[c[0]];if(void 0==b||void 0==b.code||1!==b.code.length||32768!==(b.code[0]&61440))throw'Unknown op "'+
c[0]+'" for do.jump.when.not (line '+f.toString(10)+")";c=Hj(c[1],d,1===e,f);if(32768<=c-a||32768<a-c)throw"Jump too far (line "+f.toString(10)+")";return[41216|b.code[0]&255,c-a&65535]}},"do.jump.always":{fc:2,$b:function(a,c,b,d,e,f){b=Gj[c[0]];if(void 0==b||void 0==b.code||1!==b.code.length||32768!==(b.code[0]&61440))throw'Unknown op "'+c[0]+'" for do.jump.always (line '+f.toString(10)+")";c=Hj(c[1],d,1===e,f);if(32768<=c-a||32768<a-c)throw"Jump too far (line "+f.toString(10)+")";return[41728|
b.code[0]&255,c-a&65535]}},emit:{fc:3,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Event id out of range (line "+f.toString(10)+")";b=Hj(c[1],d,1===e,f);if(0>b||65536<=b)throw"Address out of range (line "+f.toString(10)+")";c=Hj(c[2],d,1===e,f);if(0>c||65536<=c)throw"Size out of range (line "+f.toString(10)+")";return[45056|a&4095,b&65535,c&65535]}},callnat:{fc:1,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Native call id out of range (line "+f.toString(10)+
")";return[49152|a&4095]}},callsub:{fc:1,$b:function(a,c,b,d,e,f){a=Hj(c[0],d,1===e,f);if(0>a||4096<=a)throw"Subroutine address out of range (line "+f.toString(10)+")";return[53248|a&4095]}},ret:{code:[57344]}};function Ij(a,c,b){this.id=a;this.u=c;if(b instanceof ArrayBuffer)this.i=b;else if(b){for(a=c=0;a<b.length;a++)c="string"===typeof b[a]?c+(1+b[a].length):c+2;c=new ArrayBuffer(c);for(var d=new DataView(c),e=a=0;a<b.length;a++)if("string"===typeof b[a]){d.setUint8(e++,b[a].length);for(var f=0;f<b[a].length;f++)d.setUint8(e++,b[a].charCodeAt(f))}else 32768>b[a]?d.setInt16(e,b[a],!0):d.setUint16(e,b[a],!0),e+=2;this.i=c}else this.i=new ArrayBuffer(0)}
function Jj(a){function c(g){for(var h=[],l=0,k=0;k<g.length;k++)if(g[k]){for(var r=b.getUint8(l),u="",y=0;y<r;y++)u+=String.fromCharCode(b.getUint8(l+1+y));h.push(u);l+=1+r}else h.push(b.getUint16(l,!0)),l+=2;return h}var b=new DataView(a.i);switch(a.id){case Kj:var d=c([!0,!1,!1,!1,!1,!1,!1,!1]);a.nodeName=d[0];a.Ne=d[2];a.$e=d[3];a.Od=d[4];break;case Lj:d=c([!1,!0]);a.Ya=d[0];a.S=d[1];break;case Mj:d=c([!0,!0]);break;case Nj:var e=[!0,!0,!1];d=c(e);a.functionName=d[0];a.w=d[2];for(var f=0;f<a.w;f++)e.push(!1),
e.push(!0);d=c(e);a.ja=[];for(f=0;f<a.w;f++)a.ja.push({size:d[3+2*f]-(d[3+2*f]&32768?65536:0),name:d[4+2*f]});break;case Oj:b.getUint16(0,!0);a.Jc=[];for(f=2;f<b.byteLength;f+=2)a.Jc.push(b.getUint16(f,!0));break;case Pj:a.b=b.getUint16(0,!0);f=b.getUint16(2,!0);a.flags={flags:f,Bi:0!==(f&1),Ki:0!==(f&2),Ci:0!==(f&4)};break;case Qj:a.b=b.getUint16(2,!0);a.result=b.getUint16(4,!0);break;case Rj:a.l=b.getUint16(0,!0);b.getUint16(2,!0);d=[];for(f=4;f<b.byteLength;f+=2)d.push(b.getUint16(f,!0));a.he=
d;break;case Sj:case Tj:case Uj:case Vj:case Wj:case Xj:case Yj:a.l=b.getUint16(0,!0);break;case Zj:case ak:a.l=b.getUint16(0,!0);a.b=b.getUint16(2,!0);break;case bk:a.l=b.getUint16(0,!0);b.getUint16(2,!0);b.getUint16(4,!0);break;case ck:a.l=b.getUint16(0,!0);b.getUint16(2,!0);d=[];for(f=4;f<b.byteLength;f+=2)d.push(b.getUint16(f,!0));break;case dk:a.version=b.getUint16(0,!0)}}
function ek(a){var c=new ArrayBuffer(6+a.i.byteLength),b=new DataView(c);b.setUint16(0,a.i.byteLength,!0);b.setUint16(2,a.u,!0);b.setUint16(4,a.id,!0);(new Uint8Array(c)).set(new Uint8Array(a.i),6);return c}Ij.prototype.sb=function(){var a=new Ij(this.id,this.u,this.i);Jj(a);return a};Ij.prototype.toString=function(){var a=fk[this.id]||"0x"+this.id.toString(16);a+=" from "+this.u.toString(10);0<=this.l&&(a+=" to "+this.l.toString());return a};
var Kj=36864,Lj=36865,Mj=36866,Nj=36867,Oj=36869,Pj=36874,Qj=36875,Rj=40961,Tj=40962,Uj=40963,Vj=40964,Wj=40965,Xj=40966,Yj=40967,Zj=40968,ak=40969,Sj=40970,bk=40971,ck=40972,dk=40977,fk={36864:"description",36865:"namedVariableDescription",36866:"localEventDescription",36867:"nativeFunctionDescription",36869:"variables",36874:"executionStateChanged",36876:"nodePresent",40960:"getDescription",40961:"setBytecode",40962:"reset",40963:"run",40964:"pause",40965:"step",40966:"stop",40967:"getExecutionState",
40968:"breakpointSet",40969:"breakpointClear",40970:"breakpointClearAll",40971:"getVariables",40972:"setVariables",40976:"getNodeDescription",40977:"listNodes"};function gk(a){this.xe=a&&a.xe||54321;this.Ma=a&&a.Ma||[];this.Qc=a&&a.Qc||[];this.Ub=a&&a.Ub||[];this.Ne=a&&a.Ne||500;this.$e=a&&a.$e||200;this.Od=a&&a.Od||200;a=[];for(var c=0,b=0;b<this.Ma.length;b++)this.Ma[b].offset=c,a=a.concat(this.Ma[b].Z),c+=this.Ma[b].Z.length;for(;a.length<this.Od;)a.push(0);this.Jc=a;this.P=[];this.b=0;this.i=!1;this.l=!0;this.u=!1;this.stack=[];this.S=[];this.write=this.w=this.H=null}
gk.prototype.sb=function(){var a=new gk({xe:this.xe,Ma:this.Ma,Qc:this.Qc,Ub:this.Ub,Ne:this.Ne,$e:this.$e,Od:this.Od});a.Ne=this.Ne;a.$e=this.$e;a.Od=this.Od;a.P=this.P.slice();a.b=this.b;a.i=this.i;a.l=this.l;a.u=this.u;a.stack=this.stack.slice();a.S=this.S.slice();return a};
function hk(a,c,b){if(a.H)for(var d=0;d<a.Ma.length;d++)if(a.Ma[d].offset+a.Ma[d].Z.length>c&&a.Ma[d].offset<c+b.length)for(var e=0;e<a.Ma[d].Z.length;e++)0<=a.Ma[d].offset+e-c&&a.Ma[d].offset+e-c<b.length&&a.H(a.Ma[d].name,e,b[a.Ma[d].offset+e-c],a.Jc[a.Ma[d].offset+e],a.Jc.slice(a.Ma[d].offset,a.Ma[d].offset+a.Ma[d].Z.length));b.forEach(function(f,g){this.Jc[c+g]=f},a)}
function ik(a,c){a:{if(0<a.P.length)for(var b=1;b<a.P[0];b+=2)if(a.P[b]==c){c=a.P[b+1];break a}c=null}null!==c&&(a.i&&(b=new Ij(36872,a.xe,[a.b]),a.write&&a.write(ek(b))),a.b=c,a.i=!0)}function jk(a){a.i=!1;a.l=!0;a.u=!1;if(0<a.P.length)for(var c=a.P[0];c<a.P.length;){var b=a.P[c];10==b>>>12&&(a.P[c]&=-513);c+=[1,1,2,1,1,2,2,1,1,1,2,3,1,1,1,1][b>>>12]}a.stack=[];for(c=0;c<a.Jc.length;c++)a.Jc[c]=0;a.aa&&a.aa();ik(a,65535)}
function kk(a){function c(u){return 32768<=u?u-65536:u}function b(u){switch(u){case 28672:d.stack.push(-d.stack.pop());break;case 28673:d.stack.push(Math.abs(d.stack.pop()));break;case 28674:d.stack.push(~d.stack.pop());break;case 32768:u=d.stack.pop();d.stack.push(c(d.stack.pop()<<u&65535));break;case 32769:u=d.stack.pop();d.stack.push(d.stack.pop()>>u);break;case 32770:d.stack.push(c(d.stack.pop()+d.stack.pop()&65535));break;case 32771:u=d.stack.pop();d.stack.push(c(d.stack.pop()-u&65535));break;
case 32772:d.stack.push(c(d.stack.pop()*d.stack.pop()&65535));break;case 32773:u=d.stack.pop();d.stack.push(c(Math.trunc(d.stack.pop()/u)&65535));break;case 32774:u=d.stack.pop();d.stack.push(c(d.stack.pop()%u&65535));break;case 32775:d.stack.push(c((d.stack.pop()|d.stack.pop())&65535));break;case 32776:d.stack.push(c((d.stack.pop()^d.stack.pop())&65535));break;case 32777:d.stack.push(c(d.stack.pop()&d.stack.pop()&65535));break;case 32778:d.stack.push(d.stack.pop()===d.stack.pop()?1:0);break;case 32779:d.stack.push(d.stack.pop()!==
d.stack.pop()?1:0);break;case 32780:u=d.stack.pop();d.stack.push(d.stack.pop()>u?1:0);break;case 32781:u=d.stack.pop();d.stack.push(d.stack.pop()>=u?1:0);break;case 32782:u=d.stack.pop();d.stack.push(d.stack.pop()<u?1:0);break;case 32783:u=d.stack.pop();d.stack.push(d.stack.pop()<=u?1:0);break;case 32784:u=d.stack.pop();d.stack.push(d.stack.pop()||u?1:0);break;case 32785:u=d.stack.pop();d.stack.push(d.stack.pop()&&u?1:0);break;default:throw"unknown op 0x"+u.toString(16);}}var d=a,e=a.P[a.b],f=e&4095;
switch(e>>>12){case 0:a.i=!1;break;case 1:a.stack.push(2048<=f?f-4096:f);break;case 2:a.b++;a.stack.push(c(a.P[a.b]));break;case 3:a.stack.push(a.Jc[f]);break;case 4:hk(a,f,[a.stack.pop()]);break;case 5:a.b++;e=a.P[a.b];var g=a.stack.pop();if(g>=e)throw"out of bounds";a.stack.push(a.Jc[f+g]);break;case 6:a.b++;e=a.P[a.b];g=a.stack.pop();if(g>=e)throw"Index out of bounds";hk(a,f+g,[a.stack.pop()]);break;case 9:a.b+=(2048<=f?f-4096:f)-1;break;case 10:var h=e&256;b(32768|e&255);f=0!=a.stack.pop();a.b++;
g=c(a.P[a.b]);if(h){h=a.b-1;if(e&512||!f)a.b+=g-2;a.P[h]=f?a.P[h]|512:a.P[h]&-513}else f||(a.b+=g-2);break;case 11:g=a.P[a.b+1];e=a.P[a.b+2];e=a.Jc.slice(g,g+e);a.b+=2;null(f,e);break;case 12:if(0>f||f>=a.Ub.length)throw"Native call index out of bounds";var l=a.Ub[f].ja.map(function(){return{p:this.stack.pop()}},a),k=[];a.Ub[f].ja.forEach(function(u,y){l[y].Hh=0===u.size?this.stack.pop():u.size},a);a.Ub[f].ja.forEach(function(u){0>u.size&&void 0===k[-u.size]&&(k[-u.size]=0)},a);k=k.map(function(u){return void 0!==
u?this.stack.pop():u},a);a.Ub[f].ja.forEach(function(u,y){0>u.size&&(l[y].Hh=k[-u.size])},a);var r=l.map(function(u){return this.Jc.slice(u.p,u.p+u.Hh)},a);e=!1;a.w&&(e=a.w(a.Ub[f].name,a,r));e||a.Ub[f].Fa(a,r);l.forEach(function(u,y){hk(this,u.p,r[y])},a);break;case 13:a.stack.push(a.b+1);a.b=f-1;break;case 14:a.b=a.stack.pop()-1;break;case 15:throw"op 0x"+e.toString(16)+" (reserved) not implemented";default:b(e)}a.b++}gk.prototype.oc=function(){for(;this.i&&(kk(this),!this.l););};function Ah(a){function c(b){b&=65535;return 32768<=b?b-65536:b}gk.call(this,{xe:a,Ma:[{name:"_id",Z:[0]},{name:"event.source",Z:[0]},{name:"event.args",Z:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"_fwversion",Z:[0,0]},{name:"_productId",Z:[0]},{name:"buttons._raw",Z:[0,0,0,0,0]},{name:"button.backward",Z:[0]},{name:"button.left",Z:[0]},{name:"button.center",Z:[0]},{name:"button.forward",Z:[0]},{name:"button.right",Z:[0]},{name:"buttons._mean",Z:[0,0,0,0,0]},{name:"buttons._noise",
Z:[0,0,0,0,0]},{name:"prox.horizontal",Z:[0,0,0,0,0,0,0]},{name:"prox.comm.rx._payloads",Z:[0,0,0,0,0,0,0]},{name:"prox.comm.rx._intensities",Z:[0,0,0,0,0,0,0]},{name:"prox.comm.rx",Z:[0]},{name:"prox.comm.tx",Z:[0]},{name:"prox.ground.ambiant",Z:[0,0]},{name:"prox.ground.reflected",Z:[0,0]},{name:"prox.ground.delta",Z:[0,0]},{name:"motor.left.target",Z:[0]},{name:"motor.right.target",Z:[0]},{name:"_vbat",Z:[0,0]},{name:"_imot",Z:[0,0]},{name:"motor.left.speed",Z:[0]},{name:"motor.right.speed",Z:[0]},
{name:"motor.left.pwm",Z:[0]},{name:"motor.right.pwm",Z:[0]},{name:"_integrator",Z:[0,0]},{name:"acc",Z:[0,0,0]},{name:"leds.top",Z:[0,0,0]},{name:"leds.bottom.left",Z:[0,0,0]},{name:"leds.bottom.right",Z:[0,0,0]},{name:"leds.circle",Z:[0,0,0,0,0,0,0,0]},{name:"temperature",Z:[0]},{name:"rc5.address",Z:[0]},{name:"rc5.command",Z:[0]},{name:"mic.intensity",Z:[0]},{name:"mic.threshold",Z:[0]},{name:"mic._mean",Z:[0]},{name:"timer.period",Z:[0,0]},{name:"acc._tap",Z:[0]},{name:"sd.present",Z:[0]}],Qc:[{name:"button.backward",
description:"Backward button state changed"},{name:"button.left",description:"Left button state changed"},{name:"button.center",description:"Center button state changed"},{name:"button.forward",description:"Forward button state changed"},{name:"button.right",description:"Right button state changed"},{name:"buttons",description:"Buttons values updated"},{name:"prox",description:"Proximity values updated"},{name:"prox.comm",description:"Data received on the proximity communication"},{name:"tap",description:"Tap detected"},
{name:"acc",description:"Accelerometer values updated"},{name:"mic",description:"Microphone above threshold"},{name:"sound.finished",description:"Sound playback finished"},{name:"temperature",description:"Temperature value updated"},{name:"rc5",description:"RC5 message received"},{name:"motor",description:"Motor timer"},{name:"timer0",description:"Timer 0"},{name:"timer1",description:"Timer 1"}],Ub:[{name:"_system_reboot",ja:[],Fa:function(){}},{name:"_system_settings_read",ja:[],Fa:function(){}},
{name:"_system_settings_write",ja:[],Fa:function(){}},{name:"_system_settings_flash",ja:[],Fa:function(){}},{name:"math.copy",ja:[],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=d[1][b]}},{name:"math.fill",ja:[],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=d[1][0]}},{name:"math.addscalar",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=c(d[1][b]+d[2][0])}},{name:"math.add",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",
size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=c(d[1][b]+d[2][b])}},{name:"math.sub",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=c(d[1][b]-d[2][b])}},{name:"math.mul",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=c(d[1][b]*d[2][b])}},{name:"math.div",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=
c(Math.trunc(d[1][b]/d[2][b]))}},{name:"math.min",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=Math.min(d[1][b],d[2][b])}},{name:"math.max",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=Math.max(d[1][b],d[2][b])}},{name:"math.clamp",ja:[{name:"r",size:-1},{name:"x",size:-1},{name:"low",size:-1},{name:"high",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=
Math.min(Math.max(d[1][b],d[2][b]),d[3][b])}},{name:"math.dot",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1},{name:"shift",size:1}],Fa:function(b,d){for(var e=b=0;e<d[0].length;e++)b+=d[1][e]*d[2][e];d[0][0]=b/Math.pow(2,d[3][0])}},{name:"math.stat",ja:[{name:"x",size:-1},{name:"min",size:1},{name:"max",size:1},{name:"mean",size:1}],Fa:function(b,d){b=0;d[1][0]=32767;d[2][0]=-32768;for(var e=0;e<d[0].length;e++)d[1][0]=Math.min(d[1][0],d[0][e]),d[2][0]=Math.max(d[2][0],d[0][e]),b+=
d[0][e];d[3][0]=b/d[0].length}},{name:"math.argbounds",ja:[{name:"x",size:-1},{name:"argmin",size:1},{name:"argmax",size:1}],Fa:function(b,d){b=-Infinity;for(var e=Infinity,f=0;f<d[0].length;f++)d[0][f]<e&&(e=d[0][f],d[1][0]=f),d[0][f]>b&&(b=d[0][f],d[2][0]=f)}},{name:"math.sort",ja:[{name:"x",size:-1}],Fa:function(b,d){d[0].sort(function(e,f){return e-f})}},{name:"math.muldiv",ja:[{name:"r",size:-1},{name:"a",size:-1},{name:"b",size:-1},{name:"c",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=
c(d[1][b]*d[2][b]/d[3][b])}},{name:"math.atan2",description:"Atan2",ja:[{name:"r",size:-1},{name:"y",size:-1},{name:"x",size:-1}],Fa:function(b,d){d[2].forEach(function(e,f){d[0][f]=Math.round(32767*Math.atan2(d[1][f],e)/Math.PI)})}},{name:"math.sin",description:"Sine",ja:[{name:"r",size:-1},{name:"theta",size:-1}],Fa:function(b,d){d[1].forEach(function(e,f){d[0][f]=Math.round(32767*Math.sin(e*Math.PI/32768))})}},{name:"math.cos",description:"Cosine",ja:[{name:"r",size:-1},{name:"theta",size:-1}],
Fa:function(b,d){d[1].forEach(function(e,f){d[0][f]=Math.round(32767*Math.cos(e*Math.PI/32768))})}},{name:"math.rot2",ja:[{name:"r",size:2},{name:"v",size:2},{name:"theta",size:1}]},{name:"math.sqrt",description:"Square root",ja:[{name:"r",size:-1},{name:"x",size:-1}],Fa:function(b,d){d[1].forEach(function(e,f){d[0][f]=0<e?Math.floor(Math.sqrt(e)):0})}},{name:"math.rand",description:"Pseudo-random number",ja:[{name:"r",size:-1}],Fa:function(b,d){for(b=0;b<d[0].length;b++)d[0][b]=Math.floor(65535.9999*
Math.random())-32768}},{name:"_leds.set",ja:[{name:"led",size:1},{name:"br",size:1}],Fa:function(){}},{name:"sound.record",ja:[{name:"n",size:1}],Fa:function(){}},{name:"sound.play",ja:[{name:"n",size:1}],Fa:function(){}},{name:"sound.replay",ja:[{name:"n",size:1}],Fa:function(){}},{name:"sound.system",description:"Start playing system sound",ja:[{name:"n",size:1}],Fa:function(){}},{name:"leds.circle",description:"Set circular leds",ja:[{name:"l0",size:1},{name:"l1",size:1},{name:"l2",size:1},{name:"l3",
size:1},{name:"l4",size:1},{name:"l5",size:1},{name:"l6",size:1},{name:"l7",size:1}],Fa:function(b,d){b.state["leds.circle"]=d.map(function(e){return e[0]});b.Gd&&b.Gd("leds.circle")}},{name:"leds.top",description:"Set top RGB led",ja:[{name:"r",size:1},{name:"g",size:1},{name:"b",size:1}],Fa:function(b,d){b.state["leds.top"]=d.map(function(e){return e[0]});b.Gd&&b.Gd("leds.top")}},{name:"leds.bottom.left",description:"Set bottom-left RGB led",ja:[{name:"r",size:1},{name:"g",size:1},{name:"b",size:1}],
Fa:function(b,d){b.state["leds.bottom.left"]=d.map(function(e){return e[0]});b.Gd&&b.Gd("leds.bottom.left")}},{name:"leds.bottom.right",description:"Set bottom-right RGB led",ja:[{name:"r",size:1},{name:"g",size:1},{name:"b",size:1}],Fa:function(b,d){b.state["leds.bottom.right"]=d.map(function(e){return e[0]});b.Gd&&b.Gd("leds.bottom.right")}},{name:"sound.freq",description:"Play frequency",ja:[{name:"Hz",size:1},{name:"ds",size:1}],Fa:function(b,d){console.info(d)}},{name:"leds.buttons",description:"Set buttons leds",
ja:[{name:"led 0",size:1},{name:"led 1",size:1},{name:"led 2",size:1},{name:"led 3",size:1}]},{name:"leds.prox.h",description:"Set horizontal proximity leds",ja:[{name:"led 0",size:1},{name:"led 1",size:1},{name:"led 2",size:1},{name:"led 3",size:1},{name:"led 4",size:1},{name:"led 5",size:1},{name:"led 6",size:1},{name:"led 7",size:1}]},{name:"leds.prox.v",description:"Set vertical proximity leds",ja:[{name:"led 0",size:1},{name:"led 1",size:1}]},{name:"leds.rc",description:"Set rc led",ja:[{name:"led",
size:1}]},{name:"leds.sound",description:"Set sound led",ja:[{name:"led",size:1}]},{name:"leds.temperature",description:"Set ntc led",ja:[{name:"red",size:1},{name:"blue",size:1}]},{name:"sound.wave",description:"Set the primary wave of the tone generator",ja:[{name:"wave",size:142}],Fa:function(){}},{name:"prox.comm.enable",description:"Enable or disable the proximity communication",ja:[{name:"state",size:1}]},{name:"sd.open",description:"Open a file on the SD card",ja:[{name:"number",size:1},{name:"status",
size:1}]},{name:"sd.write",description:"Write data to the opened file",ja:[{name:"data",size:-1},{name:"written",size:1}]},{name:"sd.read",description:"Read data from the opened file",ja:[{name:"data",size:-1},{name:"read",size:1}]},{name:"sd.seek",description:"Seek the opened file",ja:[{name:"position",size:1},{name:"status",size:1}]},{name:"_rf.nodeid"},{name:"_poweroff"}],Od:620});this.state={};this.Gd=null}Ah.prototype=Object.create(gk.prototype);Ah.prototype.constructor=Ah;function lk(){Ch.call(this);this.Jb=!0;this.w=new Ah(9999);var a=this;this.w.Gd=function(c){a.S[c]&&a.S[c](c,a.w.state[c])};this.w.H=function(c,b,d,e,f){switch(c){case "leds.circle":e=f.slice();e[b]=d;a.S[c]&&a.S[c](c,e);break;case "timer.period":a.setTimer(b,"timer"+b.toString(10),.001*d,!0)}};this.w.w=function(c,b,d){switch(c){case "sound.play":return a.S.sound("sound",{pcm:d[0][0]}),!0}return!1};this.Aa=new Nb(Ob)}lk.prototype=Object.create(Ch.prototype);lk.prototype.constructor=lk;
lk.prototype.reset=function(a){Ch.prototype.reset.call(this,a);jk(this.w);this.setTimer(20,"prox",.1,!0);this.setTimer(21,"acc",.0625,!0);this.setTimer(22,"buttons",.05,!0);this.setTimer(23,"temperature",1,!0)};function mk(a,c){c=Kh(a.Aa,c);return null==c?null:a.w.Jc.slice(c.offset,c.offset+c.size)}function nk(a,c,b){var d=Kh(a.Aa,c);if(null==d)throw"Unknown VM variable "+c;if(b.length!==d.size)throw"Bad size for variable "+c;Array.prototype.splice.apply(a.w.Jc,[d.offset,d.size].concat(b))}
lk.prototype.set=function(a,c){if(this.Jb){Ch.prototype.set.call(this,a,c);switch(a){case "button.backward":case "button.left":case "button.center":case "button.forward":case "button.right":nk(this,a,[c?1:0]);break;case "prox.ground.delta":nk(this,"prox.ground.delta",c.map(function(b){return 2E3*b}));break;case "prox.horizontal":nk(this,"prox.horizontal",c.map(function(b){return 4E3*b}));break;case "acc":nk(this,"acc",c.map(function(b){return 22*b}));break;default:throw"Unknown variable "+a;}this.S[a]&&
this.S[a](a,c)}else Ch.prototype.set.call(this,a,c)};
lk.prototype.get=function(a){if(this.Jb)switch(a){case "leds.top":return mk(this,"leds.top").map(function(c){return 32<=c?1:0>=c?0:c/32});case "leds.bottom.left":return mk(this,"leds.bottom.left").map(function(c){return 32<=c?1:0>=c?0:c/32});case "leds.bottom.right":return mk(this,"leds.bottom.right").map(function(c){return 32<=c?1:0>=c?0:c/32});case "leds.circle":return mk(this,"leds.circle").map(function(c){return 16<=c?1:0});case "motor.left":return mk(this,"motor.left.target")[0]/200;case "motor.right":return mk(this,
"motor.right.target")[0]/200;default:return Ch.prototype.get.call(this,a)}else return Ch.prototype.get.call(this,a)};lk.prototype.sendEvent=function(a,c){if(this.Jb){if(null!=c)throw"Event arguments not implemented";a=Lh(this.Aa,a);ik(this.w,a);ok(this)}else Ch.prototype.sendEvent.call(this,a,c)};
lk.prototype.loadCode=function(a,c){"js"===a?(Ch.prototype.loadCode.call(this,a,c),this.Jb=!1):("asm"===a?(c=new zh(this.Aa,c),c=yh(c)):(c=(a=Bj(c))?new wh(this.Aa,c):new Pb(this.Aa,c),c.S=a?xh:Qb,c=c.compile()),a=this.w,a.P.splice.apply(a.P,[0,c.length].concat(c)),jk(this.w),ok(this),this.Jb=!0)};function ok(a){for(var c=0;2E3>c&&a.w.i;c++)kk(a.w)};function gh(a,c){a.b=new $b(a.rb,{ia:a.ia});a.b.Za=function(){null!==a.H&&(a.H=null,pk(a))};var b=null;return new Cg({oc:function(d,e){var f=a.M;f.ka.loadCode(d,e);null!==b&&clearInterval(b);f.ka.start(qk());b=setInterval(function(){f.ka.run(qk(),function(g,h){rk(f,g,h)})},10);f.ka.Vc=f.paused;pk(a)},xc:function(){var d=new lk;d=new sk(a.b,d);c&&c.dh&&Te(a.b,c.dh);c&&c.eh&&(a.b.transform=c.eh);a.M=d},ue:function(){return"Simulator"},fd:"js",languages:["js","aseba","l2","asm"]})};function tk(){this.b=[]}tk.prototype.add=function(a){this.b.push(a)};tk.prototype.J=function(a){this.b.forEach(function(c){c.J(a)})};function uk(){}uk.prototype.b=function(){throw"internal";};uk.prototype.J=function(){};function vk(a,c,b){this.x=a;this.y=c;this.i=b}vk.prototype=Object.create(uk.prototype);vk.prototype.constructor=vk;
vk.prototype.b=function(a,c,b){function d(h,l,k,r,u,y,E){k=[Math.cos(k),y-r,Math.sin(k),E-u];h=[y-h,E-l];l=k[0]*k[3]-k[1]*k[2];h=[(k[3]*h[0]-k[1]*h[1])/l,(k[0]*h[1]-k[2]*h[0])/l];return 0<=h[1]&&1>=h[1]&&0<h[0]?h[0]:Infinity}for(var e=Infinity,f=this.x.length,g=0;g<(this.i?this.x.length:this.x.length-1);g++)e=Math.min(e,d(a,c,b,this.x[g],this.y[g],this.x[(g+1)%f],this.y[(g+1)%f]));return e};
vk.prototype.J=function(a){a.save();a.beginPath();a.moveTo(this.x[0],this.y[0]);for(var c=1;c<this.x.length;c++)a.lineTo(this.x[c],this.y[c]);this.i&&a.closePath();a.stroke();a.restore()};function wk(a,c,b){this.x=a;this.y=c;this.r=b}wk.prototype=Object.create(uk.prototype);wk.prototype.constructor=wk;
wk.prototype.b=function(a,c,b){var d=(this.x-a)*Math.cos(b)+(this.y-c)*Math.sin(b);a=(a-this.x)*Math.sin(b)+(this.y-c)*Math.cos(b);a=this.r*this.r-a*a;if(0>a)return Infinity;a=Math.sqrt(a);return 0>d+a?Infinity:0>d-a?d+a:d-a};wk.prototype.J=function(a){a.save();a.beginPath();a.arc(this.x,this.y,this.r,0,2*Math.PI);a.stroke();a.restore()};function xk(a,c){this.width=a;this.height=c}
function sk(a,c){var b=this;this.W=new Ua;this.ka=c;this.S=this.cg=this.paused=this.Ze=!1;this.Nc=yk;this.b=new xk(10*this.ka.rb,7.07*this.ka.rb);c=this.ka.rb;this.ka.setPositionLimits(-this.b.width/2+c,this.b.width/2-c,-this.b.height/2+c,this.b.height/2-c);this.Of=this.vc=null;this.i=document.createElement("canvas");this.u=document.createElement("canvas");this.xg=!1;this.Pf=this.Rb=null;this.l=document.createElement("canvas");this.w=new tk;this.Re=!1;this.Qf=this.aa=null;zk(this);this.ka.Za=function(){Ak(b);
Bk(b);Ck(b)};this.H=a;this.H.state={};this.pa=!1}var yk="ground";sk.prototype.Xe=function(){this.W.b=[]};function Dk(a){var c=a.u.getContext("2d");c.filter="blur("+(a.u.width/300).toFixed(1)+"px)";c.fillStyle="white";c.fillRect(0,0,a.u.width,a.u.height);c.drawImage(a.i,0,0)}
function Ek(a){var c=a.M;if(c.vc){c.i.width=c.vc.width;c.i.height=c.vc.height;var b=c.i.getContext("2d");b.fillStyle="white";b.fillRect(0,0,c.vc.width,c.vc.height);b.drawImage(c.vc,0,0,c.vc.width,c.vc.height)}else c.i.width=c.H?c.H.width:800,c.i.height=c.i.width*c.b.height/c.b.width,b=c.i.getContext("2d"),b.fillStyle="white",b.fillRect(0,0,c.i.width,c.i.height);c.u.width=c.i.width;c.u.height=c.i.height;c.xg=!1;Dk(c);Jc(a)}
function rk(a,c,b){if(a.cg){var d=a.i.getContext("2d");d.save();d.translate(a.i.width/2,a.i.height/2);d.scale(a.i.width/a.b.width,-a.i.height/a.b.height);d.beginPath();switch(c){case "l":d.moveTo(b[0],b[1]);d.lineTo(b[2],b[3]);break;case "a":d.arc(b[0],b[1],Math.abs(b[2]),b[3],b[4],0>b[2])}d.strokeStyle="#060";d.lineCap="round";d.lineWidth=.1*a.ka.rb;d.stroke();d.restore();a.xg=!0;Dk(a)}}
function zk(a){a.w.b=[];a.w.add(new vk([-a.b.width/2,a.b.width/2,a.b.width/2,-a.b.width/2],[-a.b.height/2,-a.b.height/2,a.b.height/2,a.b.height/2],!0))}
function Fk(a,c){var b=a.M;zk(b);if(b.aa=c){var d=new If(c),e=b.b.width/d.D[2],f=-b.b.width*(.5+d.D[0]/d.D[2]),g=-b.b.height/d.D[3],h=b.b.height*(.5+d.D[1]/d.D[3]);d.J(null,{Ea:{line:function(l,k,r){b.w.add(new vk(l.map(function(u){return f+e*u}),k.map(function(u){return h+g*u}),r))},Kf:function(l,k,r){b.w.add(new wk(f+e*l,h+g*k,(e-g)/2*r))}}})}b.Re=null!=c;Bk(b);Jc(a)}
function Gk(a,c,b){c=Math.round(a.u.width*(c+a.b.width/2)/a.b.width);b=Math.round(a.u.height*(a.b.height/2-b)/a.b.height);return a.u.getContext("2d").getImageData(c,b,1,1).data[0]/255}function Hk(a,c,b){if(null==a.Rb)return 0;c=Math.round(a.l.width*(c+a.b.width/2)/a.b.width);b=Math.round(a.l.height*(a.b.height/2-b)/a.b.height);a=a.l.getContext("2d").getImageData(c,b,1,1).data;return-(a[0]+a[1]+a[2])/765}
function Ak(a){for(var c=[],b=0;2>b;b++)c.push(Gk(a,a.ka.b[0]+a.ka.uc*Math.cos(a.ka.i)+(0===b?-1:1)*a.ka.He*Math.sin(a.ka.i),a.ka.b[1]+a.ka.uc*Math.sin(a.ka.i)-(0===b?-1:1)*a.ka.He*Math.cos(a.ka.i))+Dh(a.ka,.05));a.ka.set("prox.ground.delta",c)}
function Bk(a){var c=Math.cos(a.ka.i),b=Math.sin(a.ka.i),d=[{ae:70,$d:60,kb:.7},{ae:85,$d:30,kb:.35},{ae:95,$d:0,kb:0},{ae:85,$d:-30,kb:-.35},{ae:70,$d:-60,kb:-.7},{ae:-25,$d:35,kb:2.8},{ae:-25,$d:-35,kb:-2.8}].map(function(e){var f=this.w,g=this.ka.b[0]+e.ae*c-e.$d*b,h=this.ka.b[1]+e.ae*b+e.$d*c;e=this.ka.i+e.kb;for(var l=Infinity,k=0;k<f.b.length;k++)l=Math.min(l,f.b[k].b(g,h,e));f=l+Dh(this.ka,.01*this.ka.r);return 100>f?1:300<f?0:(f-300)*(f-300)/4E4},a);a.ka.set("prox.horizontal",d)}
function Ck(a){for(var c=[0,0,a.ka.r],b=[-a.ka.r,a.ka.r,0],d=[],e=0;3>e;e++)d.push(Hk(a,a.ka.b[0]+c[e]*Math.cos(a.ka.i)+b[e]*Math.sin(a.ka.i),a.ka.b[1]+c[e]*Math.sin(a.ka.i)-b[e]*Math.cos(a.ka.i)));c=200*(d[1]-d[0])/(2*a.ka.r);d=200*(d[2]-(d[0]+d[1])/2)/a.ka.uc;a.ka.set("acc",[c+Dh(a.ka,.02),d+Dh(a.ka,.02),Math.sqrt(1-c*c-d*d)+Dh(a.ka,.02)])}
function Qg(a,c,b){switch(b||a.M.Nc){case yk:a.M.Of=null==c?a.M.vc:null;a.M.vc=c;Ek(a);Ak(a.M);Jc(a);break;case "height":a.M.Pf=null==c?a.M.Rb:null,b=a.M,b.Rb=c,b.Rb?(b.l.width=b.Rb.width,b.l.height=b.Rb.height,c=b.l.getContext("2d"),c.fillStyle="white",c.fillRect(0,0,b.Rb.width,b.Rb.height),c.drawImage(b.Rb,0,0,b.Rb.width,b.Rb.height)):(b.l.width=1,b.l.height=1),Ck(b),Jc(a)}}function Pg(a,c,b){switch(b||a.M.Nc){case "obstacle":a.M.Qf=null==c?a.M.aa:null,Fk(a,c)}}
Xb.prototype.start=function(a){this.M.paused=a;this.M.Ze=!a;Jc(this)};function Ik(a){a=[a[0],Math.max(.2+.8*a[1],a[2]/2),a[2]];var c=Math.max(a[0],Math.max(a[1],a[2]));return"rgb("+a.map(function(b){return Math.round(225*(1-c)+(30+225*c)*b)}).join(",")+")"}function Jk(a){return function(c){a.H!==c&&(a.H=c,pk(a))}}function og(a,c,b,d,e){var f=new bd(a.b);ud(f,a,c,["sim","top"],a.M.fe||yc,a.M.bf||pd);dd(f,b,e,d);return f}
function Jc(a){function c(z){return function(){d.H!==z&&(d.H=z,pk(d))}}function b(z,D,v,C){var F=(e.bf||pd)(z,g.A);v=Math.min(v.width/(F.na-F.Y),v.height/(F.oa-F.ca));D.save();D.translate(-F.Y,-F.ca);D.scale(v,v);(e.fe||yc)(d,z,D,g.A,g.ia,["sim","event"],null,!0,!1,C);D.restore()}var d=a,e=a.M,f=e.ka,g=a.b;if(g.S){e.pa||(e.pa=!0,e.resize(a),Ek(a));g.ob=[];var h=e.Mg||a.Ha,l=Cc(a,h,["sim","top"]),k=xd(l),r=$d(g);Zd(g);var u=wd(g.ia,{tag:"view",ga:["sim"]}),y=wd(g.ia,{tag:"button",ga:["sim","event"]}),
E=wd(g.ia,{tag:"sim-controller"}),x=wd(g.ia,{tag:"separator",id:"sim-controller-separator"}),n=wd(g.ia,{tag:"separator",ga:["sim","top"]}),w=wd(g.ia,{tag:"toolbar",ga:["sim","top"]}),m=wd(g.ia,{tag:"sim-playground-area"}),p=wd(g.ia,{tag:"sim-playground"});u.Uc(r.width);u.Ec(r.height);u.setPosition(0,0);var q=Math.max(y.width,y.height);E.width=3*ed(y);E.Ec(u.height);E.setPosition(u.x+u.width-ed(E),u.y);w.Uc(u.width-ed(E));w.height=k;w.setPosition(u.x,u.y);m.Uc(u.width-ed(E));m.Ec(u.height-w.ra());
m.setPosition(u.x,u.y+w.ra());gd(g,function(z){u.J(z)});fd(og(a,h,w,n,l),w,l,Jk(a));gd(g,function(z){E.J(z)});h=[];l=E.y+y.offsetTop();h.push(id(g,E.x+ed(y)+y.offsetLeft(),l,y,function(z,D,v){b("sim-event:forward",z,D,v)},{me:function(){f.set("button.forward",!0);f.sendEvent("button.forward",null)},oe:function(){f.set("button.forward",!1);f.sendEvent("button.forward",null)},Ac:c("sim:btn-button.forward")},"button.forward"));l+=y.ra();h.push(id(g,E.x+y.offsetLeft(),l,y,function(z,D,v){b("sim-event:left",
z,D,v)},{me:function(){f.set("button.left",!0);f.sendEvent("button.left",null)},oe:function(){f.set("button.left",!1);f.sendEvent("button.left",null)},Ac:c("sim:btn-button.left")},"button.left"));h.push(id(g,E.x+ed(y)+y.offsetLeft(),l,y,function(z,D,v){b("sim-event:center",z,D,v)},{me:function(){f.set("button.center",!0);f.sendEvent("button.center",null)},oe:function(){f.set("button.center",!1);f.sendEvent("button.center",null)},Ac:c("sim:btn-button.center")},"button.center"));h.push(id(g,E.x+2*ed(y)+
y.offsetLeft(),l,y,function(z,D,v){b("sim-event:right",z,D,v)},{me:function(){f.set("button.center",!0);f.sendEvent("button.center",null)},oe:function(){f.set("button.center",!1);f.sendEvent("button.center",null)},Ac:c("sim:btn-button.right")},"button.right"));l+=y.ra();h.push(id(g,E.x+ed(y)+y.offsetLeft(),l,y,function(z,D,v){b("sim-event:backward",z,D,v)},{me:function(){f.set("button.backward",!0);f.sendEvent("button.backward",null)},oe:function(){f.set("button.backward",!1);f.sendEvent("button.backward",
null)},Ac:c("sim:btn-button.backward")},"button.backward"));l+=y.ra()+x.ra();h.push(id(g,E.x+.5*ed(y)+y.offsetLeft(),l,y,function(z,D,v){b("sim-event:tap",z,D,v)},{action:function(){f.sendEvent("tap",null)},Ac:c("sim:btn-tap")},"tap"));h.push(id(g,E.x+1.5*ed(y)+y.offsetLeft(),l,y,function(z,D,v){b("sim-event:clap",z,D,v)},{action:function(){f.sendEvent("mic",null)},Ac:c("sim:btn-clap")},"clap"));l+=2*q;var A=E.x+1.5*ed(y),t=l+3.5*q;h.push(gd(g,function(z){function D(C,F,S,K,ma,na){function Z(ia,fa){z.beginPath();
z.arc(0,0,ia,0,2*Math.PI);z.fillStyle=fa;z.fill()}z.save();z.translate(C,F);Z(S,na||"#222");Z(.95*S,ma||"#bbb");Z(.95*S*K,na||"#222");z.restore()}z.save();z.beginPath();z.moveTo(A-1.2*q,t);z.lineTo(A-1.2*q,t-1.8*q);z.bezierCurveTo(A-.72*q,t-2.4*q,A-.05*q,t-2.4*q,A,t-2.4*q);z.bezierCurveTo(A+.05*q,t-2.4*q,A+.72*q,t-2.4*q,A+1.2*q,t-1.8*q);z.lineTo(A+1.2*q,t);z.closePath();z.lineWidth=2;z.strokeStyle="black";z.stroke();var v=f.get("prox.ground.delta");D(A-.45*q,t-1.8*q,.4*q,v[0],"#afa","#060");D(A+.45*
q,t-1.8*q,.4*q,v[1],"#9f9","#060");v=f.get("prox.horizontal");D(A-1.45*q,t-2.3*q,.4*q,v[0],"#fcc","#d00");D(A-.8*q,t-2.8*q,.4*q,v[1],"#fcc","#d00");D(A,t-3*q,.4*q,v[2],"#fcc","#d00");D(A+.8*q,t-2.8*q,.4*q,v[3],"#fcc","#d00");D(A+1.45*q,t-2.3*q,.4*q,v[4],"#fcc","#d00");D(A-.8*q,t+.5*q,.4*q,v[5],"#fcc","#d00");D(A+.8*q,t+.5*q,.4*q,v[6],"#fcc","#d00");z.restore()}));var B=l+=5*q;h.push(gd(g,function(z){function D(v,C,F,S){S=Math.max(-1,Math.min(1,S));z.save();z.translate(v,C);z.beginPath();z.arc(0,0,
F,0,2*Math.PI);z.fillStyle="#ccc";z.fill();z.beginPath();z.moveTo(0,0);z.lineTo(F*Math.sin(3*S),-F*Math.cos(3*S));z.lineWidth=Math.max(F/6,1);z.strokeStyle="black";z.stroke();z.restore()}z.save();z.fillStyle="black";z.fillRect(A-1.15*q,B+.5*q,.3*q,.6*q);z.fillRect(A+.85*q,B+.5*q,.3*q,.6*q);z.fillStyle=Ik(f.get("leds.top"));z.fillRect(A-1.2*q,B,2.4*q,.5*q);z.fillStyle=Ik(f.get("leds.bottom.left"));z.fillRect(A-1.2*q,B+.5*q,1.2*q,.5*q);z.fillStyle=Ik(f.get("leds.bottom.right"));z.fillRect(A,B+.5*q,
1.2*q,.5*q);z.lineWidth=1;z.beginPath();z.moveTo(A-1.2*q,B+.5*q);z.lineTo(A+1.2*q,B+.5*q);z.moveTo(A,B+.5*q);z.lineTo(A,B+q);z.strokeStyle="white";z.stroke();z.lineJoin="round";z.strokeStyle="black";z.strokeRect(A-1.2*q,B,2.4*q,q);D(A-1.7*q,B+q,.4*q,f.get("motor.left")/2);D(A+1.7*q,B+q,.4*q,f.get("motor.right")/2);z.restore()}));l+=1.5*q;if(null!=e.Rb){var L=l+1.5*q;h.push(gd(g,function(z){var D=f.get("acc");D=[Math.atan2(D[0],D[1]),Math.atan2(D[1],D[2]),Math.atan2(D[0],D[2])];z.save();z.strokeStyle=
"black";z.lineWidth=.7*g.A.ua;for(var v=0;3>v;v++){z.save();z.translate(A+(v-1)*q,L);z.save();z.strokeStyle="silver";z.beginPath();z.moveTo(-.4*q,0);z.lineTo(.4*q,0);z.moveTo(0,-.4*q);z.lineTo(0,.4*q);z.stroke();z.restore();z.rotate(-D[v]);switch(v){case 0:var C=.25*q;z.translate(0,1.2*C);z.beginPath();z.moveTo(-1.2*C,0);z.lineTo(-1.2*C,-1.8*C);z.bezierCurveTo(-.72*C,-2.4*C,-.05*C,-2.4*C,0,-2.4*C);z.bezierCurveTo(.05*C,-2.4*C,.72*C,-2.4*C,1.2*C,-1.8*C);z.lineTo(1.2*C,0);z.closePath();z.lineWidth=
2;z.strokeStyle="black";z.stroke();break;case 1:z.strokeRect(-.4*q,-.15*q,.8*q,.3*q);z.beginPath();z.arc(-.2*q,.05*q,.15*q,0,2*Math.PI);z.fillStyle="white";z.fill();z.lineWidth=.07*q;z.stroke();break;case 2:z.strokeRect(-.4*q,-.15*q,.8*q,.3*q),z.fillStyle="black",z.fillRect(-.35*q,.15*q,.15*q,.08*q),z.fillRect(.2*q,.15*q,.15*q,.08*q)}z.restore()}z.restore()}));l+=2.5*q}if(f.Wc){var T=l+2*q;h.push(gd(g,function(z){for(var D=f.get("leds.circle"),v=0;8>v;v++)mf(z,A,T,.9*q,1.2*q,Math.PI*(.44-.25*v),Math.PI*
(.56-.25*v),D[v]?"#fa0":"white","black",g.A.ua)}));l+=3.5*q}var la=l+1.5*q,U=f.getTimer(0);0<=U?(h.push(gd(g,function(z){g.state.af?"lin"===g.state.af&&4<U&&(g.state.af="log"):g.state.af=4<U?"log":"lin";jf(z,A,la,q,g.A.ua,function(D){z.textAlign="start";z.textBaseline="top";z.font=(q/2).toFixed(1)+"px sans-serif";z.fillStyle="black";z.fillText(D.toFixed(1),E.x,la-q)},Math.min(U,"log"===g.state.af?9.9:3.95),!1,"log"===g.state.af)})),l+=2.5*q):g.state.af=!1;var H=Math.min((m.y-E.y+E.y+E.height-l)/2,
E.y+E.height-l);0<H&&h.forEach(function(z){z.y+=H});var J=m.x,R=m.y,X=m.width,G=m.height;var O=Math.min(X/e.b.width,G/e.b.height);y=(X-e.b.width*O)/2;x=(G-e.b.height*O)/2;p.width=e.b.width*O;p.height=e.b.height*O;p.x=J+y;p.y=R+x;if(a.W.ic){var Q=wd(g.ia,{tag:"widget",id:"vpl-customize"});gd(g,function(){Rd(g,"vpl:customize",J+X/2,R+G/2,Q)})}else{var P=f.rb,V=!1;y=new Ed(null,e.b.width*O,e.b.height*O,J+y,R+x,function(z,D,v,C){z=z.N;z.save();m.J(z);p.J(z);if(null===d.wd)switch(e.Nc){case yk:z.drawImage(e.i,
D.x+v,D.y+C,D.width,D.height);break;case "height":null!=e.Rb&&z.drawImage(e.l,D.x+v,D.y+C,D.width,D.height);break;case "obstacle":z.save(),z.translate(D.x+v+D.width/2,D.y+C+D.height/2),z.scale(O,-O),e.w.J(z),z.restore()}else z.drawImage(e.i,D.x+v,D.y+C,D.width,D.height),null!=e.Rb&&(z.save(),z.globalAlpha=.5,z.drawImage(e.l,D.x+v,D.y+C,D.width,D.height),z.restore()),e.Re&&(z.save(),z.translate(D.x+v+D.width/2,D.y+C+D.height/2),z.scale(O,-O),e.w.J(z),z.restore());z.translate(D.x+v+D.width/2,D.y+C+
D.height/2);z.scale(O,O);z.translate(f.b[0],-f.b[1]);z.rotate(.5*Math.PI-f.i);z.beginPath();z.moveTo(0,.2*P);z.lineTo(.5*P,.2*P);z.lineTo(.5*P,-.55*P);z.bezierCurveTo(.3*P,-.8*P,.02*P,-.8*P,0,-.8*P);z.bezierCurveTo(-.02*P,-.8*P,-.3*P,-.8*P,-.5*P,-.55*P);z.lineTo(-.5*P,.2*P);z.closePath();z.fillStyle=Ik(f.get("leds.top"));z.strokeStyle="black";z.lineJoin="round";z.lineWidth=2;z.moveTo(.05*P,0);z.arc(0,0,.05*P,0,2*Math.PI);z.fill();z.stroke();if(!e.Ze||e.paused)z.beginPath(),z.arc(0,0,P,0,2*Math.PI),
z.strokeStyle=g.state.rh?"navy":"#3cf",z.lineWidth=.1*P,z.stroke(),z.beginPath(),z.arc(0,-P,.15*P,0,2*Math.PI),z.fillStyle=g.state.Cg?"navy":"white",z.strokeStyle=g.state.Cg?"navy":"#3cf",z.lineWidth=.06*P,z.fill(),z.stroke();z.restore()},{fa:function(z,D,v,C,F,S,K){z=(K.x-F-v/2)/O;C=(C/2-(K.y-S))/O;S=z-f.b[0];K=C-f.b[1];D=P*Math.cos(f.i);v=P*Math.sin(f.i);return(!e.Ze||e.paused)&&(S-D)*(S-D)+(K-v)*(K-v)<.1*P*P?(g.state.x=z,g.state.y=C,g.state.Cg=!0,1):S*S+K*K<P*P?(e.paused?V=!1:(f.suspend(),V=!0),
g.state.x=z,g.state.y=C,g.state.rh=!0,0):null},Pa:function(z,D,v,C,F,S,K,ma){z=(ma.x-S-C/2)/O;F=(F/2-(ma.y-K))/O;switch(v){case 0:v=f.b;f.setPosition([f.b[0]+z-g.state.x,f.b[1]+F-g.state.y],f.i);rk(e,"l",[v[0],v[1],f.b[0],f.b[1]]);break;case 1:f.setPosition(f.b,f.i+(Math.atan2(F-f.b[1],z-f.b[0])-Math.atan2(g.state.y-f.b[1],g.state.x-f.b[0])))}g.state.x=z;g.state.y=F},dd:function(){g.state.rh=!1;g.state.Cg=!1;V&&f.resume(qk())}});y.l=!1;Kd(g,y)}a.H&&gd(g,function(z){var D=wd(g.ia,{tag:"hint"});z.fillStyle=
D.color;z.font=kd(D);z.textAlign="start";z.textBaseline="middle";var v=d.i.translate(d.H);D.width=z.measureText(v).width;D.height=1.2*D.fontSize;hd(D,z,D.marginLeft,r.height-D.ra()+D.marginTop,!0);z.fillText(v,D.offsetLeft(),r.height-D.ra()+D.offsetTop()+D.height/2)});Fc(g);!e.paused&&f.shouldRunContinuously()&&pk(a)}}function pk(a){a.M.S||(a.M.S=!0,window.requestAnimationFrame(function(){a.M.S=!1;Jc(a)}))}function qk(){return.001*(new Date).getTime()}
sk.prototype.resize=function(a){var c=window.innerWidth,b=window.innerHeight;window.vplDisableResize&&(b=this.H.b.getBoundingClientRect(),c=b.width,b=b.height);this.H.A=this.H.A;this.H.resize(c,b);Jc(a)};function uh(a){a.I.add("sim:close",{action:function(c){c.qb(["sim"],{Nf:!0})},object:a,$:function(c){return 1<c.Ka.length&&0<=c.Ka.indexOf("sim")}});a.I.add("sim:restart",{action:function(c){Ek(c);c.M.ka.reset(qk());c.M.ka.start();c.M.Ze=!0;c.M.paused=!1;Jc(c)},object:a});a.I.add("sim:pause",{action:function(c){c.M.Ze&&(c.M.paused=!c.M.paused,c.M.paused?c.M.ka.suspend():(c.M.ka.resume(qk()),Jc(c)))},isEnabled:function(c){return c.M.Ze},Oa:function(c){return c.M.paused},object:a,lb:[{selected:!1},
{selected:!0}]});a.I.add("sim:speedup",{action:function(c){var b=[.5,1,2,5,10];c.M.ka.de=b[(b.indexOf(c.M.ka.de)+1)%b.length]},Oa:function(c){return 1!==c.M.ka.de},getState:function(c){return c.M.ka.de},object:a,lb:[{selected:!1,state:1},{selected:!0,state:.5},{selected:!0,state:2},{selected:!0,state:5},{selected:!0,state:10}]});a.I.add("sim:noise",{action:function(c){c.M.ka.Xf=!c.M.ka.Xf},Oa:function(c){return c.M.ka.Xf},object:a,lb:[{selected:!1},{selected:!0}]});a.I.add("sim:pen",{action:function(c){c.M.cg=
!c.M.cg},Oa:function(c){return c.M.cg},object:a,lb:[{selected:!1},{selected:!0}]});a.I.add("sim:clear",{action:function(c){Ek(c)},isEnabled:function(c){return c.M.xg},object:a});a.I.add("sim:map-kind",{action:function(c){switch(c.M.Nc){case yk:c.M.Nc="height";break;case "height":c.M.Nc="obstacle";break;case "obstacle":c.M.Nc=yk}},getState:function(c){switch(c.M.Nc){case yk:return"ground";case "height":return"height";case "obstacle":return"obstacles";default:return"ground"}},object:a,lb:[{state:"ground"},
{state:"height"},{state:"obstacles"}],$:function(c){return null===c.wd}});a.I.add("sim:map",{action:function(c){switch(c.M.Nc){case yk:Qg(c,null==c.M.vc?c.M.Of:null);break;case "height":Qg(c,null==c.M.Rb?c.M.Pf:null);break;case "obstacle":Pg(c,c.M.Re?null:c.M.Qf)}},Oa:function(c){switch(c.M.Nc){case yk:return null!=c.M.vc;case "height":return null!=c.M.Rb;case "obstacle":return c.M.Re}throw"internal";},getState:function(c){switch(c.M.Nc){case yk:return"ground";case "height":return"height";case "obstacle":return"obstacles";
default:return"ground"}},object:a,lb:[{selected:!1,state:"ground"},{selected:!1,state:"height"},{selected:!1,state:"obstacles"},{selected:!0,state:"ground"},{selected:!0,state:"height"},{selected:!0,state:"obstacles"}],$:function(c){return null===c.wd}});a.I.add("sim:map-ground",{action:function(c,b){b?c.Ue.show("Open ground image file",".gif,.png,.jpg,.svg",function(d){var e=new window.FileReader;e.onload=function(f){f=f.target.result;var g=new Image;g.addEventListener("load",function(){Qg(c,g,yk)});
g.src=f};e.readAsDataURL(d)}):Qg(c,null==c.M.vc?c.M.Of:null,yk)},Oa:function(c){return null!=c.M.vc},object:a,lb:[{selected:!1},{selected:!0}],$:function(c){return c.wd&&0<=c.wd.indexOf("ground")}});a.I.add("sim:map-height",{action:function(c,b){b?c.Ue.show("Open height image file",".gif,.png,.jpg,.svg",function(d){var e=new window.FileReader;e.onload=function(f){f=f.target.result;var g=new Image;g.addEventListener("load",function(){Qg(c,g,"height")});g.src=f};e.readAsDataURL(d)}):Qg(c,null==c.M.Rb?
c.M.Pf:null,"height")},Oa:function(c){return null!=c.M.Rb},object:a,lb:[{selected:!1},{selected:!0}],$:function(c){return c.wd&&0<=c.wd.indexOf("height")}});a.I.add("sim:map-obstacles",{action:function(c,b){b?c.Ue.show("Open obstacle SVG file",".svg",function(d){var e=new window.FileReader;e.onload=function(f){Pg(c,f.target.result,"obstacle")};e.readAsText(d)}):Pg(c,c.M.Re?null:c.M.Qf,"obstacle")},Oa:function(c){return c.M.Re},object:a,lb:[{selected:!1},{selected:!0}],$:function(c){return c.wd&&0<=
c.wd.indexOf("obstacles")}});a.I.add("sim:vpl",{action:function(c){c.we?c.qb(["vpl"],{ye:!0}):c.qb(["vpl"],{te:"sim"})},isEnabled:function(c){return null==c.O||vg(c.O)},object:a,$:function(c){return(null==c.O||!c.O.ta)&&0>c.Ka.indexOf("vpl")}});a.I.add("sim:text",{action:function(c){c.we?c.qb(["src"],{ye:!0,Qg:!c.O.nd}):c.qb(["src"],{te:"sim",Qg:!c.O.nd})},object:a,$:function(c){return 0>c.Ka.indexOf("src")}});a.I.add("sim:teacher-reset",{action:function(c){c.M.Xe();Jc(c)},object:a,pd:!0,$:function(c){return c.M.Zb&&
c.M.W.ic}});a.I.add("sim:teacher",{action:function(c){c.M.W.ic=!c.M.W.ic;Jc(c)},Oa:function(c){return c.M.W.ic},object:a,pd:!0,$:function(c){return c.M.Zb},lb:[{selected:!1},{selected:!0}]})};function eh(a,c){return new Cg({oc:function(b,d){a.Ga[a.ma].Qa.state.b(d)},xc:function(){try{var b=(c?c.Th:rh("asebahttp"))||("http:"!==document.location.origin.slice(0,5)?"http://127.0.0.1:3000":document.location.origin);Aa(b,function(){a.Ga[a.ma].Qa.state=wa[0];Ve(a.ba)})}catch(d){console.info(d),Ve(a.ba)}},isConnected:function(){return null!=a.Ga[a.ma].Qa.state},isEnabled:function(b){return"aseba"===b&&null!=a.Ga[a.ma].Qa.state},ue:function(){return"Thymio (HTTP)"},fd:"aseba",languages:["aseba",
"l2"],state:null})};function fh(a,c){var b=null;void 0==c&&(c={sc:rh("w"),vh:rh("pass")||"",Nh:rh("uuid")||"auto"});return new Cg({oc:function(d,e){b.declareCustomEvents([{name:"user",fixed_size:1}]);b.run(e,null,function(f){console.info("Run error");console.info(f)})},check:function(d,e,f){b.check(e,function(){f(null)},function(g){f(g)});return null},xc:function(){try{b=new window.TDM(c.sc,{password:c.vh||"",uuid:c.Nh||"auto",change:function(d){a.Ga[a.ma].Qa.state=d?{}:null;Ve(a.ba)}})}catch(d){console.info(d),Ve(a.ba)}},
close:function(){b.close()},isConnected:function(){return null!=a.Ga[a.ma].Qa.state&&b.isConnected()},isEnabled:function(d){return"aseba"===d&&null!=a.Ga[a.ma].Qa.state&&b.canRun()},ue:function(){return"Thymio (TDM)"},Tf:function(d,e){b.flash(e)},pf:function(d){return"aseba"===d&&null!=a.Ga[a.ma].Qa.state&&b.canRun()},fd:"aseba",languages:["aseba"],state:null,ja:c})};function Kk(a){this.u=a||"ws://127.0.0.1:8002/";this.l={};this.i=this.b=null}Kk.prototype.connect=function(){this.tc=new WebSocket(this.u);var a=this;this.tc.addEventListener("open",function(){a.tc.send(JSON.stringify({type:"nodes"}))});this.tc.addEventListener("message",function(c){try{var b=JSON.parse(c.data);switch(b.type){case "connect":if(b.id){var d=b.id;a.l[d]=b;a.b&&a.b(d,b.descr)}break;case "disconnect":d=b.id,delete a.l[d],a.i&&a.i(d)}}catch(e){}})};
Kk.prototype.oc=function(a,c){this.tc.send(JSON.stringify({type:"run",id:a,bc:c}))};function th(a){var c=null,b=rh("uuid")||null;b&&(b=b.replace(/^\{(.*)\}$/,"$1"));var d=null;return new Cg({oc:function(e,f){switch(e){case "aseba":e=new Pb(d,f);e.S=Qb;var g=e.compile();break;case "l2":e=new Pb(d,f);e.S=xh;g=e.compile();break;case "asm":e=new zh(d,f),g=yh(e)}c.oc(b,g)},xc:function(){try{var e=rh("w")||("http:"!==document.location.origin.slice(0,5)?"ws://127.0.0.1:8002":document.location.origin.replace(/^http/,"ws"));c=new Kk(e);c.b=function(f,g){if(null==b||f===b)d=new Nb(g),a.Ga[a.ma].Qa.state=
{},Ve(a.ba)};c.i=function(f){if(null==b||f===b)a.Ga[a.ma].Qa.state=null,Ve(a.ba)};c.connect()}catch(f){console.info(f),Ve(a.ba)}},isConnected:function(){return null!=a.Ga[a.ma].Qa.state},isEnabled:function(e){return("aseba"===e||"l2"===e||"asm"===e)&&null!=a.Ga[a.ma].Qa.state},ue:function(){return"Thymio (JWS)"},fd:"aseba",languages:["aseba","l2","asm"],state:null})};
}).call(this);
