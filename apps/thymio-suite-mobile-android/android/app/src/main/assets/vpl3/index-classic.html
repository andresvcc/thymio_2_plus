<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="viewport" content="width=device-width, height=device-height, maximum-scale=1, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />

<!-- definition of the user interface and blocks -->
<script type="application/json" id="ui.json">
{
	"hardcoded-gui": true,
	"blocks": null,
	"buttons": null,
	"widgets": null,

	"css": [
		"classic.css"
	],

	"miscSettings": {
		"advancedModeEnabled": false,
		"basicMultiEvent": true
	},

	"fragments": {
		"about.html": "<iframe src=\"vpl-about.html\" style=\"width:100%;height:100%;border:none;\"></iframe>",
		"help.html": "<div><h1>Help</h1></div>",
		"vpl-export-html.css": "td.events, td.then, td.actions {\n\tborder: solid 2px silver;\n\tborder-style: solid none;\n}\ntd.block {\n\tpadding: 15px;\n}\ntd.events {\n    min-width: 20px;\n    border-left-style: solid;\n    border-top-left-radius: 20px; \n    border-bottom-left-radius: 20px;\n}\ntd.state, td.event-aux {\n    transform: scale(0.8) translate(0,10px);\n}\ntd.actions {\n    min-width: 20px;\n    border-right-style: solid;\n    border-bottom-right-radius: 20px; \n    border-top-right-radius: 20px;\n}\ntd.comment {\n\tfont-family: sans-serif;\n}\ntable.program {\n\tborder-collapse: separate;\n\tborder-spacing: 0 10px;\n\tmargin-left: auto;\n\tmargin-right: auto;\n}\n"
	},

	"doc": {
		"en": {
			"doctemplate.html": "doctemplate-en.html"
		},
		"fr": {
			"doctemplate.html": "doctemplate-fr.html"
		}
	},

	"overlays": [
		"block-list.json",

		"aesl.json",

		"aseba.json",
		"l2.json",
		"js.json",
		"python.json",

		"typical-param-set.json",
		"typical-states.json",

		"block-en.json",
		"cmd-sim-en.json",
		"cmd-vpl-en.json",
		"help-blocks-en.json",
		"help-buttons-en.json",
		"messages-en.json",

		"block-fr.json",
		"cmd-sim-fr.json",
		"cmd-vpl-fr.json",
		"help-buttons-fr.json",
		"help-blocks-fr.json",
		"messages-fr.json"
	]
}

</script>

<script type="text/x-vpl-css" id="classic.css">
/*
	CSS for VPL3 application
    Classic version (blocks, buttons and widgets defined in JavaScript)
	Copyright 2019-2020, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE
*/

view {
	background: white;
}

toolbar {
	padding: 5px;
	margin: 0;
}
toolbar.top {
	border-bottom: 1px silver;
}
toolbar.bottom {
	border-top: 1px silver;
	border-left: 1px silver;
	border-right: 1px silver;
}

button {
	width: 2.5ww;
	height: 2.5ww;
	min-width: 32px;
	min-height: 32px;
	margin: 0.2vw;
}

#vpl-close, #src-close, #sim-close {
	width: 1.5ww;
	min-width: 10px;
}

button.vpl.bottom {
	font: max(1.7vw, 12px) sans-serif;
	min-width: 48px;
	min-height: 48px;
}

button.vpl:possible-drop-target {
	background-color: #ddd;
}

#vpl-message-error {
	color: #e44;
	width: 20vw;
}

#vpl-message-warning {
	color: #f88;
	width: 20vw;
}

#vpl-filename {
	width: 9ww;
	border-width: 1px;
	border-color: transparent;
	font: max(1vw, 12px) sans-serif;
}
#vpl-filename:edited {
	border-color: #333;
	background-color: #eee;
}

separator {
	width: 1ww;
	height: 1ww;
}

vpl {
	padding: 5px;
	margin: 5px;
	background: #eee;
}

block {
	width: 6vw;
	height: 6vw;
	min-width: 32px;
	min-height: 32px;
}

block.library {
	margin: 4px;
}

block.event {
	background: #f70;
	border: none #f70;
	border-top-right-cut: 0.9vw;
	backdrop-color: #830;
}
block.event-aux, block.state {
	width: 5vw;
	height: 5vw;
	min-width: 27px;
	min-height: 27px;
	vertical-align: bottom;
	border-top-right-cut: 0.75vw;
}
block.action {
	background: #38f;
	border: none #38f;
	backdrop-color: #148;
}
block.state {
	background: #0c0;
	border: none #0c0;
	backdrop-color: #060;
}
block.comment {
	background: #aaa;
	border: none #aaa;
}
block.empty {
	border-width: 2px;
	background: transparent;
	width: 1.5vw;
	min-width: 8px;
	backdrop-color: transparent;
}
block.empty.event-aux {
	height: 5vw;
	min-height: 27px;
	vertical-align: bottom;
}
block.empty:only-child {
	width: 6vw;
	min-width: 32px;
}

block-container {
	padding: 0;
	padding-bottom: 0.4vw;
	margin: 0.6vw;
	margin-bottom: 0.2vw;
	border-bottom: transparent 3px;
}

block-container.error {
	border-bottom: #e44 3px;
}
block-container.warning {
	border-bottom: #f88 3px;
}

rule {
	background: #ddd;
	border: solid #666;
	border-radius: 0.6vw;
	padding: 0.3vw;
	margin:0.6vw;
}

rule:small {
	background: white;
}

rule.comment {
	background: transparent;
	border-color: white;
	color: #333;
	font: max(1.3vw, 12px) sans-serif;
}
rule.comment:edited {
	background: white;
	border-color: #333;
	color: #333;
}

overlay-rectangle.disabled {
	background: rgba(255,255,255,0.5);
}

overlay-rectangle.drop-target {
	border: 0.2vw rgba(0,0,0,0.5);
	border-radius: 0.2vw;
}

overlay-rectangle.kbd-selected {
	border: 0.5vw rgba(0,0,0,0.4);
	border-radius: 0.1vw;
	border-corner-length: 1vw;
}
overlay-rectangle.kbd-selected.param {
	border: 0.3vw rgba(0,0,0,0.4);
	border-radius: 0.1vw;
}
overlay-rectangle.rule.kbd-target {
	border: 0.2vw rgba(0,0,0,0.7);
	border-radius: 0.6vw;
}
overlay-rectangle.event.kbd-target {
	border: 0.2vw rgba(200,0,0,0.7);
	border-top-right-cut: 0.9vw;
}
overlay-rectangle.event-aux.kbd-target {
	border: 0.2vw rgba(200,0,0,0.7);
	border-top-right-cut: 0.75vw;
}
overlay-rectangle.action.kbd-target {
	border: 0.2vw rgba(0,0,200,0.7);
}
overlay-rectangle.state.kbd-target {
	border: 0.2vw rgba(0,150,0,0.7);
	border-top-right-cut: 0.75vw;
}
overlay-rectangle.comment.kbd-target {
	border: 0.2vw rgba(100,100,100,0.7);
}
overlay-rectangle.button.kbd-selected {
	border: 0.3vw rgba(0,0,0,0.4);
	border-radius: 0.1vw;
	border-corner-length: 0.8vw;
}

crossout-line {
	line-width: 0.75vw;
 	color: rgba(120,120,120,0.5);
	line-angle: -10deg;
	line-overflow: 0.5vw;
}
crossout-line.library {
	line-overflow: 0.1vw;
}
crossout-line.rule {
	line-angle: -20deg;
}
crossout-line.button {
	line-width: 0.5vw;
	line-overflow: 0.1vw;
}
crossout-line.vpl {
	line-width: 5vw;
}

widget {
	width: 3vw;
	height: 3vw;
}

#widget-error, #widget-warning {
	width: 3vw;
	height: 3vw;
	padding: 0.2vw;
	margin-right: 0.8vw;
}

conflict-line.error {
	line: 3px #e44 dashed;
}
conflict-line.warning {
	line: 3px #f88;
}

#widget-then {
	width: 3vw;
	height: 3vw;
	padding: 1vw;
}

block-library {
	padding: 5px;
	padding-top: 0;
}

block.library {
	width: 4vw;
	height: 4vw;
	min-width: 32px;
	min-height: 32px;
}

block.library.event, block.library.state {
	border-top-right-cut: 0.6vw;
}

hint {
	font: max(1vw, 12px) sans-serif;
	padding: 0.5vw;
	background-color: white;
	color: #222;
}

/* simulator */

sim-controller {
	background: #eee;
	margin: 5px;
	padding: 1vw;
}

button.event {
	width: 2vw;
	height: 2vw;
	margin: 0.2vw;
}

sim-playground-area {
	background: #eee;
	margin: 5px;
	padding: 5px;
}

sim-playground {
	border: 2px silver;
}

</script>

<script type="application/json" id="block-list.json">
{
	"blockList": [
		"init",
		"button 1",
		"button",
		"remote control arrows",
		"roll",
		"yaw",
		"pitch",
		"tap",
		"accelerometer",
		"clap",
		"ground",
		"ground 1",
		"ground adv",
		"horiz prox",
		"horiz prox 1",
		"horiz prox adv",
		"color 8 state",
		"color state",
		"motor state",
		"state 8",
		"state",
		"counter comparison",
		"timer",
		"clock",
		"user event",
		"move",
		"motor",
		"nn obstacles",
		"top color 8",
		"top color",
		"bottom color 8",
		"bottom-left color 8",
		"bottom-right color 8",
		"bottom color",
		"bottom-left color",
		"bottom-right color",
		"set state 8",
		"change state 8",
		"set state",
		"toggle state",
		"set counter",
		"notes",
		"play",
		"play stop",
		"set timer",
		"set timer log",
		"send user event"
	]
}

</script>

<script type="application/json" id="aesl.json">
{
	"aeslImportRules": [
		{
			"aeslName": "acc",
			"condition": "`$[0]===0`",
			"blockName": "tap"
		},
		{
			"aeslName": "acc",
			"condition": "`$[0]===1`",
			"blockName": "roll",
			"parameters": "`[-$[1]]`"
		},
		{
			"aeslName": "acc",
			"condition": "`$[0]===2`",
			"blockName": "pitch",
			"parameters": "`[-$[1]]`"
		},
		{
			"aeslName": "button",
			"condition": "`$[5]===0 && $[0]===0 && $[1]===0 && $[2]===0 && $[3]===0 && $[4]===0`",
			"blockName": "clock",
			"parameters": "`[20]`"
		},
		{
			"aeslName": "button",
			"condition": "`$[5]===0`",
			"blockName": "button",
			"parameters": "`[4, 0, 2, 3, 1].map(function (i) { return $[i] !== 0; })`"
		},
		{
			"aeslName": "button",
			"condition": "`$[5]===1`",
			"blockName": "remote control arrows",
			"parameters": "`[[1, 0, 2, 3, 4][$[6]]]`"
		},
		{
			"aeslName": "button",
			"condition": "`$[5]===2`",
			"blockName": "remote control keypad",
			"parameters": "`[[1, 2, 3, 4, 5, 6, 7, 8, 9, 17, 0, 16][$[6]]]`"
		},
		{
			"aeslName": "clap",
			"blockName": "clap"
		},
		{
			"aeslName": "colorbottom",
			"blockName": "bottom color",
			"parameters": "`$.map(function (v) { return v / 32; })`"
		},
		{
			"aeslName": "colortop",
			"blockName": "top color",
			"parameters": "`$.map(function (v) { return v / 32; })`"
		},
		{
			"aeslName": "prox",
			"condition": "`$[0]===0 && $[1]===0 && $[2]===0 && $[3]===0 && $[4]===0 && $[5]===0 && $[6]===0`",
			"blockName": "clock",
			"parameters": "`[10]`"
		},
		{
			"aeslName": "prox",
			"condition": "`$[0] < 3 && $[1] < 3 && $[2] < 3 && $[3] < 3 && $[4] < 3 && $[5] < 3 && $[6] < 3 && $[7] === 1000 && $[8] === 2000`",
			"blockName": "horiz prox",
			"parameters": "`[2, 1, 3, 0, 4, 5, 6].map(function (v) { return $[v] >= 2 ? -1 : $[v]; })`"
		},
		{
			"aeslName": "prox",
			"condition": "`!($[0] < 3 && $[1] < 3 && $[2] < 3 && $[3] < 3 && $[4] < 3 && $[5] < 3 && $[6] < 3 && $[7] === 1000 && $[8] === 2000)`",
			"blockName": "horiz prox adv",
			"parameters": "`[2, 1, 3, 0, 4, 5, 6].map(function (v) { return $[v]; }).concat($.slice(7).map(function (v) { return Math.max(0, Math.min(1, (v - 700) / 3300)); }))`"
		},
		{
			"aeslName": "proxground",
			"condition": "`$[0]===0 && $[1]===0`",
			"blockName": "clock",
			"parameters": "`[10]`"
		},
		{
			"aeslName": "proxground",
			"condition": "`$[0] < 3 && $[1] < 3 && $[2] === 400 && $[3] === 450`",
			"blockName": "ground",
			"parameters": "`$.slice(0, 2).map(function (v) { return v === 2 ? -1 : v; })`"
		},
		{
			"aeslName": "proxground",
			"condition": "`!($[0] < 3 && $[1] < 3 && $[2] === 400 && $[3] === 450)`",
			"blockName": "ground adv",
			"parameters": "`$.slice(0, 2).map(function (v) { return v; }).concat($.slice(2).map(function (v) { return Math.max(0, Math.min(1, v / 1000)); }))`"
		},
		{
			"aeslName": "move",
			"blockName": "motor",
			"parameters": "`$.map(function (v) { return v / 500; })`"
		},
		{
			"aeslName": "setstate",
			"blockName": "set state",
			"parameters": "`$.map(function (v) { return v == 2 ? -1 : v; })`"
		},
		{
			"aeslName": "sound",
			"blockName": "notes",
			"parameters": "`[$[0]%256,$[0]>=517?0:Math.floor($[0]/256), $[1]%256,$[1]>=517?0:Math.floor($[1]/256), $[2]%256,$[2]>=517?0:Math.floor($[2]/256), $[3]%256,$[3]>=517?0:Math.floor($[3]/256), $[4]%256,$[4]>=517?0:Math.floor($[4]/256), $[5]%256,$[5]>=517?0:Math.floor($[5]/256)]`"
		},
		{
			"aeslName": "statefilter",
			"condition": "`$[0] || $[1] || $[2] || $[3] || $[4] || $[5] || $[6] || $[7]`",
			"blockName": "state",
			"parameters": "`$.map(function (v) { return v == 2 ? -1 : v; })`"
		},
		{
			"aeslName": "statefilter",
			"condition": "`!($[0] || $[1] || $[2] || $[3] || $[4] || $[5] || $[6] || $[7])`"
		},
		{
			"aeslName": "timeout",
			"blockName": "timer"
		},
		{
			"aeslName": "timer",
			"blockName": "set timer",
			"parameters": "`[$[0] / 1000]`"
		}
	]
}

</script>

<script type="application/json" id="aseba.json">
{
	"blocks": [
		{
			"name": "!stop",
			"aseba": {
				"statement": [
					"motor.left.target = 0\n",
					"motor.right.target = 0\n",
					"call sound.system(-1)\n",
					"call leds.circle(32,32,32,32,32,32,32,32)\n",
					"timer.period[0] = 100\n",
					"onevent timer0\n",
					"call leds.circle(0,0,0,0,0,0,0,0)\n"
				]
			}
		},
		{
			"name": "!stop and blink",
			"aseba": {
				"statement": [
					"var i = 16\n",
					"var s = 17\n",
					"motor.left.target = 0\n",
					"motor.right.target = 0\n",
					"call sound.system(-1)\n",
					"timer.period[0] = 125\n",
					"onevent timer0\n",
					"call leds.circle((s&1)<<5,(s&2)<<4,(s&4)<<3,(s&8)<<2,(s&16)<<1,s&32,(s&64)>>1,(s&128)>>2)\n",
					"s = (s << 1) & 0xff | (s >> 7) & 1\n",
					"i -= 1\n",
					"if i < 0 then\n",
					"timer.period[0] = 0\n",
					"end\n"
				]
			}
		},
		{
			"name": "!init",
			"aseba": {
				"initCodeExec": [
					"call sound.system(-1)\n"
				]
			}
		},
		{
			"name": "!volume",
			"aseba": {
				"statement": [
					"# set volume\n",
					"call _system.settings.write(0, `$[0] > 8 ? 0 : 8 - $[0]`)\n"
				]
			}
		},
		{
			"name": "button",
			"aseba": {
				"sectionBegin": "onevent buttons\n",
				"clause": "`['center', 'forward', 'backward', 'right', 'left'].map(function (s, i) { return $[i] ? 'button.' + s : ''; }).filter(function (s) { return s; }).join(' and ') || ['center', 'forward', 'backward', 'right', 'left'].map(function (s) { return 'button.' + s; }).join(' or ')`"
			}
		},
		{
			"name": "button 1",
			"aseba": {
				"sectionBegin": "onevent buttons\n",
				"clause": "button.`['center', 'forward', 'backward', 'right', 'left'][$[0]]` != 0"
			}
		},
		{
			"name": "horiz prox",
			"aseba": {
				"sectionBegin": "onevent prox\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'prox.horizontal[' + ix + '] ' + ($[i] > 0 ? '>= 2000' : '<= 1000') : ''; }).filter(function (s) { return s; }).join(' and ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'prox.horizontal[' + ix + '] >= 2000'; }).join(' or ')`"
			}
		},
		{
			"name": "horiz prox adv",
			"aseba": {
				"sectionBegin": "onevent prox\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { var p = 'prox.horizontal[' + ix + '] ', l = Math.round(17 + 33 * $[7]) + '00', g = Math.round(17 + 33 * $[8]) + '00'; return $[i] === 1 ? p + '>= ' + g : $[i] === 2 ? p + '< ' + l : $[i] === 3 ? p + '>= ' + l + ' and ' + p + '< ' + g : ''; }).filter(function (s) { return s; }).join(' and ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'prox.horizontal[' + ix + '] >= 2000'; }).join(' or ')`"
			}
		},
		{
			"name": "horiz prox 1",
			"aseba": {
				"sectionBegin": "onevent prox\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'prox.horizontal[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + Math.round(7 + 33 * $[7]) + '00' : ''; }).filter(function (s) { return s; }).join(' and ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'prox.horizontal[' + ix + '] >= 2000'; }).join(' or ')`"
			}
		},
		{
			"name": "ground",
			"aseba": {
				"sectionBegin": "onevent prox\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'prox.ground.delta[' + ix + '] ' + ($[i] > 0 ? '>= 450' : '<= 400') : ''; }).filter(function (s) { return s; }).join(' and ') || [0, 1].map(function (ix) { return 'prox.ground.delta[' + ix + '] >= 450'; }).join(' or ')`"
			}

		},
		{
			"name": "ground adv",
			"aseba": {
				"sectionBegin": "onevent prox\n",
				"clause": "`[0, 1].map(function (ix, i) { var p = 'prox.ground.delta[' + ix + '] ', l = Math.round(25 + 40 * $[2]) + '0', g = Math.round(25 + 40 * $[3]) + '0'; return $[i] === 1 ? p + '>= ' + g : $[i] === 2 ? p + '< ' + l : $[i] === 3 ? p + '>= ' + l + ' and ' + p + '< ' + g : ''; }).filter(function (s) { return s; }).join(' and ') || [0, 1].map(function (ix) { return 'prox.ground.delta[' + ix + '] >= 450'; }).join(' or ')`"
			}
		},
		{
			"name": "ground 1",
			"aseba": {
				"sectionBegin": "onevent prox\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'prox.ground.delta[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + Math.round(25 + 40 * $[2]) : ''; }).filter(function (s) { return s; }).join(' and ') || [0, 1].map(function (ix) { return 'prox.ground.delta[' + ix + '] >= 450'; }).join(' or ')`"
			}
		},
		{
			"name": "tap",
			"aseba": {
				"initVarDecl": [
					"var tapped\n"
				],
				"initCodeExec": [
					"tapped = 0\n"
				],
				"sectionBegin": "onevent tap\n",
				"sectionPreamble": "tapped = 1\n",
				"clauseAsCondition": "tapped != 0"
			}
		},
		{
			"name": "accelerometer",
			"aseba": {
				"initVarDecl": [
					"`$[0] == 0 ? 'var tapped\\n' : 'var ' + ($[0] == 1 ? 'rollAngle' : 'pitchAngle') + 'Angle\\n'`"
				],
				"initCodeExec": [
					"`$[0] == 0 ? 'tapped = 0\\n' : ''`"
				],
				"sectionBegin": "onevent `$[0] == 0 ? 'tap' : 'acc'`\n",
				"sectionPreamble": "`$[0] == 0 ? 'tapped = 1\\n' : ''`",
				"clauseInit": "`$[0] == 1 ? 'call math.atan2(rollAngle, acc[0], acc[2])\\n' : $[0] == 2 ? 'call math.atan2(pitchAngle, acc[1], acc[2])\\n' : ''`",
				"clause": "`$[0] == 0 ? 'tapped != 0' : (function (name, a) { return a <= -6 ? name + ' < ' + Math.round(2730.67 * a + 1365.33) : a >= 6 ? name + ' >= ' + Math.round(2730.67 * a - 1365.33) : name + ' >= ' + Math.round(2730.67 * a - 1365.33) + ' and ' + name + ' < ' + Math.round(2730.67 * a + 1365.33); })($[0] === 1 ? 'rollAngle' : 'pitchAngle', $[0] === 2 ? $[1] : -$[1])`"
			}
		},
		{
			"name": "roll",
			"aseba": {
				"sectionBegin": "onevent acc\n",
				"initVarDecl": [
					"var rollAngle\n"
				],
				"clauseInit":
					"call math.atan2(rollAngle, acc[0], acc[2])\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'rollAngle >= ' + Math.round(2730.67 * 12 - 1365.33) + ' or rollAngle < ' + Math.round(2730.67 * $[0] + 1365.33) : 'rollAngle >= ' + Math.round(2730.67 * $[0] - 1365.33) + ' and rollAngle < ' + Math.round(2730.67 * $[0] + 1365.33)`"
			}
		},
		{
			"name": "pitch",
			"aseba": {
				"sectionBegin": "onevent acc\n",
				"initVarDecl": [
					"var pitchAngle\n"
				],
				"clauseInit":
					"call math.atan2(pitchAngle, acc[1], acc[2])\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'pitchAngle >= ' + Math.round(2730.67 * 12 - 1365.33) + ' or pitchAngle < ' + Math.round(2730.67 * $[0] + 1365.33) : 'pitchAngle >= ' + Math.round(2730.67 * $[0] - 1365.33) + ' and pitchAngle < ' + Math.round(2730.67 * $[0] + 1365.33)`"
			}
		},
		{
			"name": "yaw",
			"aseba": {
				"sectionBegin": "onevent acc\n",
				"initVarDecl": [
					"var yawAngle\n"
				],
				"clauseInit":
					"call math.atan2(yawAngle, acc[0], acc[1])\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'yawAngle >= ' + Math.round(2730.67 * 12 - 1365.33) + ' or yawAngle < ' + Math.round(2730.67 * $[0] + 1365.33) : 'yawAngle >= ' + Math.round(2730.67 * $[0] - 1365.33) + ' and yawAngle < ' + Math.round(2730.67 * $[0] + 1365.33)`"
			}
		},
		{
			"name": "clap",
			"aseba": {
				"initCodeExec": [
					[
						"# setup threshold for detecting claps\n",
						"mic.threshold = 250\n"
					]
				],
				"sectionBegin": "onevent buttons\n",
				"clause": "mic.intensity > mic.threshold"
			}
		},
		{
			"name": "init",
			"aseba": {
				"sectionBegin": "# initialization\n"
			}
		},
		{
			"name": "timer",
			"aseba": {
				"initVarDecl": [
					"var timerElapsed\n"
				],
				"initCodeExec": [
					[
						"# stop timer 0\n",
						"timer.period[0] = 0\n"
					],
					"timerElapsed = 0\n"
				],
				"sectionBegin": "onevent timer0\n",
				"sectionPreamble": "timerElapsed = 1\ntimer.period[0] = 0\n",
				"clauseAsCondition": "timerElapsed != 0"
			}
		},
		{
			"name": "clock",
			"aseba": {
				"sectionBegin": "onevent `$[0] === 10 ? 'prox' : 'buttons'`\n"
			}
		},
		{
			"name": "user event",
			"aseba": {
				"sectionBegin": "onevent user\n",
				"clause": "event.args[0] == `$[0]`",
				"clauseAlwaysEval": true
			}
		},
		{
			"name": "remote control arrows",
			"aseba": {
				"sectionBegin": "onevent rc5\n",
				"clause": "`[[85, 17], [80, 32], [81, 33], [86, 16, 78], [87, 13]][$[0]].map(function (c) { return 'rc5.command == ' + c; }).join(' or ')`",
				"clauseAlwaysEval": true
			}
		},
		{
			"name": "state",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"clause":
				"(state & `$.reduce(function (a, b, i) { return b !== 0 ? a | [128,2,32,8][i] : a; }, 0)`) == `$.reduce(function (a, b, i) { return b === 1 ? a | [128,2,32,8][i] : a; }, 0)`"
			}
		},
		{
			"name": "state 8",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"clause": "state == `1 << $[0]`"
			}
		},
		{
			"name": "counter comparison",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"clause": "state `$[0] === 0 ? '==' : $[0] > 0 ? '>=' : '<='` `$[1]`"
			}
		},
		{
			"name": "color state",
			"aseba": {
				"initVarDecl": [
					"var topColor[3]\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0]\n"
				],
				"clause": "`$.map(function (p, i) { return 'topColor[' + i + '] / 11 == ' + Math.floor(p * 2.99); }).join(' and ')`"
			}
		},
		{
			"name": "color 8 state",
			"aseba": {
				"initVarDecl": [
					"var topColor[3]\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0]\n"
				],
				"clause": "topColor[0] `$[0] % 2 ? '>=' : '<'` 16 and topColor[1] `$[0] % 4 >= 2 ? '>=' : '<'` 16 and topColor[2] `$[0] >= 4 ? '>=' : '<'` 16"
			}
		},
		{
			"name": "motor state",
			"aseba": {
				"clause": [
					"`$[0] == 0 ? 'abs(' : ''`motor.left.target`$[0] > 0 ? ' > ' : $[0] < 0 ? ' < -' : ') < '``Math.round(250 * slowdown)` ",
					"and `$[1] == 0 ? 'abs(' : ''`motor.right.target`$[1] > 0 ? ' > ' : $[1] < 0 ? ' < -' : ') < '``Math.round(250 * slowdown)`"
				]
			}
		},
		{
			"name": "motor",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"motor.left.target = `Math.round(500 * slowdown * $[0])`\n",
					"motor.right.target = `Math.round(500 * slowdown * $[1])`\n"
				]
			}
		},
		{
			"name": "move",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"motor.left.target = `Math.round([0, 100, -100, 75, 125, -100, 100][$[0]] * slowdown)`\n",
					"motor.right.target = `Math.round([0, 100, -100, 125, 75, 100, -100][$[0]] * slowdown)`\n"
				]
			}
		},
		{
			"name": "nn obstacles",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"motor.left.target = `Math.round(500 * $[0] * slowdown)`",
					"`Math.round(20 * $[1]) ? ' - prox.horizontal[2] / 10 * ' + Math.round(20 * $[1]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[2]) ? ' + prox.horizontal[0] / 10 * ' + Math.round(20 * $[2]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[3]) ? ' - prox.horizontal[4] / 10 * ' + Math.round(20 * $[3]).toString(10) + ' / 16' : ''`\n",
					"motor.right.target = `Math.round(500 * $[0] * slowdown)`",
					"`Math.round(20 * $[1]) ? ' - prox.horizontal[2] / 10 * ' + Math.round(20 * $[1]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[2]) ? ' + prox.horizontal[4] / 10 * ' + Math.round(20 * $[2]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[3]) ? ' - prox.horizontal[0] / 10 * ' + Math.round(20 * $[3]).toString(10) + ' / 16' : ''`\n"
				]
			}
		},
		{
			"name": "top color",
			"aseba": {
				"initVarDecl": [
					"var topColor[3]\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0]\n",
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.top(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`)\n",
					"topColor = [`$.map(function (x) { return Math.round(32 * x); }).join(', ')`]\n"
				],
				"statementWithoutInit":
					"call leds.top(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`)\n"
			}
		},
		{
			"name": "top color 8",
			"aseba": {
				"initVarDecl": [
					"var topColor[3]\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0]\n",
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.top(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`)\n",
					"topColor = [`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`]\n"
				]
			}
		},
		{
			"name": "bottom color",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.bottom.left(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`)\n",
					"call leds.bottom.right(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`)\n"
				]
			}
		},
		{
			"name": "bottom-left color",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.bottom.left(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`)\n"
				]
			}
		},
		{
			"name": "bottom-right color",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.bottom.right(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`)\n"
				]
			}
		},
		{
			"name": "bottom color 8",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.bottom.left(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`)\n",
					"call leds.bottom.right(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`)\n"
				]
			}
		},
		{
			"name": "bottom-left color 8",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.bottom.left(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`)\n"
				]
			}
		},
		{
			"name": "bottom-right color 8",
			"aseba": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"call leds.top(0, 0, 0)\n",
						"call leds.bottom.left(0, 0, 0)\n",
						"call leds.bottom.right(0, 0, 0)\n",
						"call leds.circle(0, 0, 0, 0, 0, 0, 0, 0)\n"
					]
				],
				"statement": [
					"call leds.bottom.right(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`)\n"
				]
			}
		},
		{
			"name": "notes",
			"aseba": {
				"initVarDecl": [
					[
						"# variables for notes\n",
						"var notes[6]\n",
						"var durations[6]\n",
						"var note_index\n",
						"var note_count\n",
						"var wave[142]\n",
						"var i\n",
						"var wave_phase\n",
						"var wave_intensity\n"
					]
				],
				"initCodeExec": [
					[
						"# init. variables for notes\n",
						"note_index = 6\n",
						"note_count = 6\n"
					],
					[
						"# compute a sinus wave for sound\n",
						"for i in 0 : 141 do\n",
						"wave_phase = (i - 70) * 468\n",
						"call math.cos(wave_intensity, wave_phase)\n",
						"wave[i] = wave_intensity / 256\n",
						"end\ncall sound.wave(wave)\n"
					],
					[
						"call sound.system(-1)\n"
					]
				],
				"initCodeDecl": [
					[
						"# when a note is finished, play the next one\n",
						"onevent sound.finished\n",
						"if note_index != note_count then\n",
						"call sound.freq(notes[note_index], durations[note_index])\n",
						"note_index++\n",
						"end\n"
					]
				],
				"statement": [
					"notes = [`$.filter(function (a, i) { return i % 2 == 0; }).map(function (h, i) { return $[2 * i + 1] ? [370, 415, 466, 494, 554][h] : 0; }).join(', ')`]\n",
					"durations = [`$.filter(function (a, i) { return i % 2 == 1; }).map(function (d) { return d ? 10 * d : 28; }).join(', ')`]\n",
					"note_index = 1\n",
					"note_count = 6\n",
					"call sound.freq(notes[0], durations[0])\n"
				]
			}
		},
		{
			"name": "play",
			"aseba": {
				"initCodeExec": [
					"call sound.system(-1)\n"
				],
				"statement": "call sound.play(`$[0].toString(10)`)\n"
			}
		},
		{
			"name": "play stop",
			"aseba": {
				"initCodeExec": [
					"call sound.system(-1)\n"
				],
				"statement": "call sound.play(-1)\n"
			}
		},
		{
			"name": "set state",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"initCodeDecl": [
					[
						"sub display_state\n",
						"call leds.circle((state&1)<<5,(state&2)<<4,(state&4)<<3,(state&8)<<2,(state&16)<<1,state&32,(state&64)>>1,(state&128)>>2)\n"
					]
				],
				"statement": [
					"state = state & `0xff ^ $.reduce(function (a, b, i) { return b !== 0 ? a | [128,2,32,8][i] : a; }, 0)` | `$.reduce(function (a, b, i) { return b === 1 ? a | [128,2,32,8][i] : a; }, 0)`\n",
					"callsub display_state\n"
				]
			}
		},
		{
			"name": "toggle state",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"initCodeDecl": [
					[
						"sub display_state\n",
						"call leds.circle((state&1)<<5,(state&2)<<4,(state&4)<<3,(state&8)<<2,(state&16)<<1,state&32,(state&64)>>1,(state&128)>>2)\n"
					]
				],
				"statement": [
					"state ^= `$.reduce(function (a, b, i) { return b ? a | [128,2,32,8][i] : a; }, 0)`\n",
					"callsub display_state\n"
				]
			}
		},
		{
			"name": "set state 8",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"initCodeDecl": [
					[
						"sub display_state\n",
						"call leds.circle((state&1)<<5,(state&2)<<4,(state&4)<<3,(state&8)<<2,(state&16)<<1,state&32,(state&64)>>1,(state&128)>>2)\n"
					]
				],
				"statement": [
					"state = `1 << $[0]`\n",
					"callsub display_state\n"
				],
				"statementWithoutInit": [
					"call leds.circle(`$[0] === 0 ? 32 : 0`, `$[0] === 1 ? 32 : 0`, `$[0] === 2 ? 32 : 0`, `$[0] === 3 ? 32 : 0`, ",
						"`$[0] === 4 ? 32 : 0`, `$[0] === 5 ? 32 : 0`, `$[0] === 6 ? 32 : 0`, `$[0] === 7 ? 32 : 0`)\n"
				]
			}
		},
		{
			"name": "change state 8",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"initCodeDecl": [
					[
						"sub display_state\n",
						"call leds.circle((state&1)<<5,(state&2)<<4,(state&4)<<3,(state&8)<<2,(state&16)<<1,state&32,(state&64)>>1,(state&128)>>2)\n"
					]
				],
				"statement": [
					"state = `$[0] > 0 ? '(state << 1) & 0xff | (state >> 7) & 1' : '(state >> 1) & 0x7f | (state << 7) & 0x80'`\n",
					"callsub display_state\n"
				],
				"statementWithoutInit": [
					"call leds.circle(`$[0] === 0 ? 32 : 0`, `$[0] === 1 ? 32 : 0`, `$[0] === 2 ? 32 : 0`, `$[0] === 3 ? 32 : 0`, ",
						"`$[0] === 4 ? 32 : 0`, `$[0] === 5 ? 32 : 0`, `$[0] === 6 ? 32 : 0`, `$[0] === 7 ? 32 : 0`)\n"
				]
			}
		},
		{
			"name": "set counter",
			"aseba": {
				"initVarDecl": [
					"var state\n"
				],
				"initCodeExec": [
					"state = 0\n"
				],
				"initCodeDecl": [
					[
						"sub display_state\n",
						"call leds.circle((state&1)<<5,(state&2)<<4,(state&4)<<3,(state&8)<<2,(state&16)<<1,state&32,(state&64)>>1,(state&128)>>2)\n"
					]
				],
				"statement": [
					"`$[0] === 0 ? 'state = 0' : $[0] > 0 ? 'if state < 255 then\\nstate++\\nend' : 'if state > 0 then\\nstate--\\nend'`\n",
					"callsub display_state\n"
				]
			}
		},
		{
			"name": "set timer",
			"aseba": {
				"initVarDecl": [
					"var timerElapsed\n"
				],
				"initCodeExec": [
					[
						"# stop timer 0\n",
						"timer.period[0] = 0\n"
					],
					"timerElapsed = 0\n"
				],
				"statement": [
					"timer.period[0] = `Math.round(1000 * $[0] / slowdown)`\n",
					"timerElapsed = 0\n"
				]
			}
		},
		{
			"name": "set timer log",
			"aseba": {
				"initVarDecl": [
					"var timerElapsed\n"
				],
				"initCodeExec": [
					[
						"# stop timer 0\n",
						"timer.period[0] = 0\n"
					],
					"timerElapsed = 0\n"
				],
				"statement": [
					"timer.period[0] = `Math.round(1000 * $[0] / slowdown)`\n",
					"timerElapsed = 0\n"
				]
			}
		},
		{
			"name": "send user event",
			"aseba": {
				"statement": "emit user `$[0]`\n"
			}
		},
		{
			"name": "picture comment",
			"aseba": {}
		}
	]
}

</script>

<script type="application/json" id="l2.json">
{
	"blocks": [
		{
			"name": "!stop",
			"l2": {
				"statement": [
					"motor.left.target = 0;\n",
					"motor.right.target = 0;\n",
					"sound.system(-1);\n",
					"leds.circle(32,32,32,32,32,32,32,32);\n",
					"timer.period[0] = 100;\n",
					"onevent timer0 {\n",
					"leds.circle(0,0,0,0,0,0,0,0);\n",
					"}\n"
				]
			}
		},
		{
			"name": "!init",
			"l2": {
				"initCodeExec": [
					"sound.system(-1);\n"
				]
			}
		},
		{
			"name": "!volume",
			"l2": {
				"statement": [
					"// set volume\n",
					"_system.settings.write(0, `$[0] > 8 ? 0 : 8 - $[0]`);\n"
				]
			}
		},
		{
			"name": "button",
			"l2": {
				"sectionBegin": "onevent buttons {\n",
				"sectionEnd": "}\n",
				"clause": "`['center', 'forward', 'backward', 'right', 'left'].map(function (s, i) { return $[i] ? 'button.' + s : ''; }).filter(function (s) { return s; }).join(' && ') || ['center', 'forward', 'backward', 'right', 'left'].map(function (s) { return 'button.' + s; }).join(' || ')`"
			}
		},
		{
			"name": "button 1",
			"l2": {
				"sectionBegin": "onevent buttons {\n",
				"sectionEnd": "}\n",
				"clause": "button.`['center', 'forward', 'backward', 'right', 'left'][$[0]]`"
			}
		},
		{
			"name": "horiz prox",
			"l2": {
				"sectionBegin": "onevent prox {\n",
				"sectionEnd": "}\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'prox.horizontal[' + ix + '] ' + ($[i] > 0 ? '>= 2000' : '<= 1000') : ''; }).filter(function (s) { return s; }).join(' && ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'prox.horizontal[' + ix + '] >= 2000'; }).join(' || ')`"
			}
		},
		{
			"name": "horiz prox adv",
			"l2": {
				"sectionBegin": "onevent prox {\n",
				"sectionEnd": "}\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { var p = 'prox.horizontal[' + ix + '] ', l = Math.round(17 + 33 * $[7]) + '00', g = Math.round(17 + 33 * $[8]) + '00'; return $[i] === 1 ? p + '>= ' + g : $[i] === 2 ? p + '< ' + l : $[i] === 3 ? p + '>= ' + l + ' && ' + p + '< ' + g : ''; }).filter(function (s) { return s; }).join(' && ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'prox.horizontal[' + ix + '] >= 2000'; }).join(' || ')`"
			}
		},
		{
			"name": "horiz prox 1",
			"l2": {
				"sectionBegin": "onevent prox {\n",
				"sectionEnd": "}\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'prox.horizontal[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + Math.round(7 + 33 * $[7]) + '00' : ''; }).filter(function (s) { return s; }).join(' && ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'prox.horizontal[' + ix + '] >= 2000'; }).join(' || ')`"
			}
		},
		{
			"name": "ground",
			"l2": {
				"sectionBegin": "onevent prox {\n",
				"sectionEnd": "}\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'prox.ground.delta[' + ix + '] ' + ($[i] > 0 ? '>= 450' : '<= 400') : ''; }).filter(function (s) { return s; }).join(' && ') || [0, 1].map(function (ix) { return 'prox.ground.delta[' + ix + '] >= 450'; }).join(' || ')`"
			}

		},
		{
			"name": "ground adv",
			"l2": {
				"sectionBegin": "onevent prox {\n",
				"sectionEnd": "}\n",
				"clause": "`[0, 1].map(function (ix, i) { var p = 'prox.ground.delta[' + ix + '] ', l = Math.round(25 + 40 * $[2]) + '0', g = Math.round(25 + 40 * $[3]) + '0'; return $[i] === 1 ? p + '>= ' + g : $[i] === 2 ? p + '< ' + l : $[i] === 3 ? p + '>= ' + l + ' && ' + p + '< ' + g : ''; }).filter(function (s) { return s; }).join(' && ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'prox.ground.delta[' + ix + '] >= 450'; }).join(' || ')`"
			}
		},
		{
			"name": "ground 1",
			"l2": {
				"sectionBegin": "onevent prox {\n",
				"sectionEnd": "}\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'prox.ground.delta[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + Math.round(25 + 40 * $[2]) : ''; }).filter(function (s) { return s; }).join(' && ') || [0, 1].map(function (ix) { return 'prox.ground.delta[' + ix + '] >= 450'; }).join(' || ')`"
			}
		},
		{
			"name": "tap",
			"l2": {
				"initVarDecl": [
					"bool tapped;\n"
				],
				"initCodeExec": [
					"tapped = false;\n"
				],
				"sectionBegin": "onevent tap {\n",
				"sectionEnd": "}\n",
				"sectionPreamble": "tapped = true;\n",
				"clauseAsCondition": "tapped"
			}
		},
		{
			"name": "accelerometer",
			"l2": {
				"initVarDecl": [
					"`$[0] == 0 ? 'bool tapped;\\n' : ''`"
				],
				"initCodeExec": [
					"`$[0] == 0 ? 'tapped = false;\\n' : ''`"
				],
				"sectionBegin": "onevent `$[0] == 0 ? 'tap' : 'acc'` {\n",
				"sectionEnd": "}\n",
				"sectionPreamble": "`$[0] == 0 ? 'tapped = true;\\n' : ''`",
				"clauseInit": "`$[0] == 1 ? 'fixed rollAngle = atan2(acc[0], acc[2]);\\n' : $[0] == 2 ? 'fixed pitchAngle = atan2(acc[1], acc[2]);\\n' : ''`",
				"clause": "`$[0] == 0 ? 'tapped' : (function (name, a) { return a <= -6 ? name + ' < ' + (Math.PI / 12 * (a + 0.5)).toFixed(2) : a >= 6 ? name + ' >= ' + (Math.PI / 12 * (a - 0.5)).toFixed(2) : name + ' >= ' + (Math.PI / 12 * (a - 0.5)).toFixed(2) + ' && ' + name + ' < ' + (Math.PI / 12 * (a + 0.5)).toFixed(2); })($[0] === 1 ? 'rollAngle' : 'pitchAngle', $[0] === 2 ? $[1] : -$[1])`"
			}
		},
		{
			"name": "roll",
			"l2": {
				"sectionBegin": "onevent acc {\n",
				"sectionEnd": "}\n",
				"clauseInit":
					"fixed rollAngle = atan2(-acc[0], acc[2]);\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'rollAngle >= ' + (Math.PI / 12 * (12 - 0.5)).toFixed(2) + ' or rollAngle < ' + (Math.PI / 12 * (-12 + 0.5)).toFixed(2) : 'rollAngle >= ' + (Math.PI / 12 * ($[0] - 0.5)).toFixed(2) + ' and rollAngle < ' + (Math.PI / 12 * ($[0] + 0.5)).toFixed(2)`"
			}
		},
		{
			"name": "pitch",
			"l2": {
				"sectionBegin": "onevent acc {\n",
				"sectionEnd": "}\n",
				"clauseInit":
					"fixed pitchAngle = atan2(-acc[1], acc[2]);\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'pitchAngle >= ' + (Math.PI / 12 * (12 - 0.5)).toFixed(2) + ' or pitchAngle < ' + (Math.PI / 12 * (-12 + 0.5)).toFixed(2) : 'pitchAngle >= ' + (Math.PI / 12 * ($[0] - 0.5)).toFixed(2) + ' and pitchAngle < ' + (Math.PI / 12 * ($[0] + 0.5)).toFixed(2)`"
			}
		},
		{
			"name": "yaw",
			"l2": {
				"sectionBegin": "onevent acc {\n",
				"sectionEnd": "}\n",
				"clauseInit":
					"fixed yawAngle = atan2(-acc[0], acc[1]);\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'yawAngle >= ' + (Math.PI / 12 * (12 - 0.5)).toFixed(2) + ' or yawAngle < ' + (Math.PI / 12 * (-12 + 0.5)).toFixed(2) : 'yawAngle >= ' + (Math.PI / 12 * ($[0] - 0.5)).toFixed(2) + ' and yawAngle < ' + (Math.PI / 12 * ($[0] + 0.5)).toFixed(2)`"
			}
		},
		{
			"name": "clap",
			"l2": {
				"initCodeExec": [
					[
						"// setup threshold for detecting claps\n",
						"mic.threshold = 250;\n"
					]
				],
				"sectionBegin": "onevent buttons {\n",
				"sectionEnd": "}\n",
				"clause": "mic.intensity > mic.threshold"
			}
		},
		{
			"name": "init",
			"l2": {
				"sectionBegin": "// initialization\n"
			}
		},
		{
			"name": "timer",
			"l2": {
				"initVarDecl": [
					"bool timerElapsed;\n"
				],
				"initCodeExec": [
					[
						"// stop timer 0\n",
						"timer.period[0] = 0;\n"
					],
					"timerElapsed = false;\n"
				],
				"sectionBegin": "onevent timer0 {\n",
				"sectionEnd": "}\n",
				"sectionPreamble": "timerElapsed = true;\ntimer.period[0] = 0;\n",
				"clauseAsCondition": "timerElapsed"
			}
		},
		{
			"name": "clock",
			"l2": {
				"sectionBegin": "onevent `$[0] === 10 ? 'prox' : 'buttons'` {\n",
				"sectionEnd": "}\n"
			}
		},
		{
			"name": "user event",
			"l2": {
				"sectionBegin": "onevent user {\n",
				"sectionEnd": "}\n",
				"clause": "event.args[0] == `$[0]`",
				"clauseAlwaysEval": true
			}
		},
		{
			"name": "remote control arrows",
			"l2": {
				"sectionBegin": "onevent rc5 {\n",
				"sectionEnd": "}\n",
				"clause": "`[[85, 17], [80, 32], [81, 33], [86, 16, 78], [87, 13]][$[0]].map(function (c) { return 'rc5.command == ' + c; }).join(' or ')`",
				"clauseAlwaysEval": true
			}
		},
		{
			"name": "state",
			"l2": {
				"initVarDecl": [
					[
						"int state;\n"
					]
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"clause":
				"(state & `$.reduce(function (a, b, i) { return b !== 0 ? a | [128,2,32,8][i] : a; }, 0)`) == `$.reduce(function (a, b, i) { return b === 1 ? a | [128,2,32,8][i] : a; }, 0)`"
			}
		},
		{
			"name": "state 8",
			"l2": {
				"initVarDecl": [
					[
						"int state;\n"
					]
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"clause": "state == `1 << $[0]`"
			}
		},
		{
			"name": "counter comparison",
			"l2": {
				"initVarDecl": [
					"int state;\n"
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"clause": "state `$[0] === 0 ? '==' : $[0] > 0 ? '>=' : '<='` `$[1]`"
			}
		},
		{
			"name": "color state",
			"l2": {
				"initVarDecl": [
					"int topColor[3];\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0];\n"
				],
				"clause": "`$.map(function (p, i) { return 'topColor[' + i + '] / 11 == ' + Math.floor(p * 2.99); }).join(' && ')`"
			}
		},
		{
			"name": "color 8 state",
			"l2": {
				"initVarDecl": [
					"int topColor[3];\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0];\n"
				],
				"clause": "topColor[0] `$[0] % 2 ? '>=' : '<'` 16 && topColor[1] `$[0] % 4 >= 2 ? '>=' : '<'` 16 && topColor[2] `$[0] >= 4 ? '>=' : '<'` 16"
			}
		},
		{
			"name": "motor state",
			"l2": {
				"clause": [
					"`$[0] == 0 ? 'abs(' : ''`motor.left.target`$[0] > 0 ? ' > ' : $[0] < 0 ? ' < -' : ') < '``Math.round(250 * slowdown)` ",
					"&& `$[1] == 0 ? 'abs(' : ''`motor.right.target`$[1] > 0 ? ' > ' : $[1] < 0 ? ' < -' : ') < '``Math.round(250 * slowdown)`"
				]
			}
		},
		{
			"name": "motor",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement":
					[
						"motor.left.target = `Math.round(500 * slowdown * $[0])`;\n",
						"motor.right.target = `Math.round(500 * slowdown * $[1])`;\n"
					]
			}
		},
		{
			"name": "move",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"motor.left.target = `Math.round([0, 100, -100, 75, 125, -100, 100][$[0]] * slowdown)`;\n",
					"motor.right.target = `Math.round([0, 100, -100, 125, 75, 100, -100][$[0]] * slowdown)`;\n"
				]
			}
		},
		{
			"name": "nn obstacles",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"motor.left.target = `Math.round(500 * $[0] * slowdown)`",
					"`Math.round(20 * $[1]) ? ' - prox.horizontal[2] / 10 * ' + Math.round(20 * $[1]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[2]) ? ' + prox.horizontal[0] / 10 * ' + Math.round(20 * $[2]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[3]) ? ' - prox.horizontal[4] / 10 * ' + Math.round(20 * $[3]).toString(10) + ' / 16' : ''`;\n",
					"motor.right.target = `Math.round(500 * $[0] * slowdown)`",
					"`Math.round(20 * $[1]) ? ' - prox.horizontal[2] / 10 * ' + Math.round(20 * $[1]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[2]) ? ' + prox.horizontal[4] / 10 * ' + Math.round(20 * $[2]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[3]) ? ' - prox.horizontal[0] / 10 * ' + Math.round(20 * $[3]).toString(10) + ' / 16' : ''`;\n"
				]
			}
		},
		{
			"name": "top color",
			"l2": {
				"initVarDecl": [
					"int topColor[3];\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0];\n",
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.top(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`);\n",
					"topColor = [`$.map(function (x) { return Math.round(32 * x); }).join(', ')`];\n"
				],
				"statementWithoutInit":
					"leds.top(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`);\n"
			}
		},
		{
			"name": "top color 8",
			"l2": {
				"initVarDecl": [
					"int topColor[3];\n"
				],
				"initCodeExec": [
					"topColor = [0, 0, 0];\n",
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.top(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`);\n",
					"topColor = [`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`];\n"
				]
			}
		},
		{
			"name": "bottom color",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.bottom.left(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`);\n",
					"leds.bottom.right(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`);\n"
				]
			}
		},
		{
			"name": "bottom-left color",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.bottom.left(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`);\n"
				]
			}
		},
		{
			"name": "bottom-right color",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.bottom.right(`$.map(function (x) { return Math.round(32 * x); }).join(', ')`);\n"
				]
			}
		},
		{
			"name": "bottom color 8",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.bottom.left(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`);\n",
					"leds.bottom.right(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`);\n"
				]
			}
		},
		{
			"name": "bottom-left color 8",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.bottom.left(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`);\n"
				]
			}
		},
		{
			"name": "bottom-right color 8",
			"l2": {
				"initCodeExec": [
					[
						"// reset outputs\n",
						"leds.top(0, 0, 0);\n",
						"leds.bottom.left(0, 0, 0);\n",
						"leds.bottom.right(0, 0, 0);\n",
						"leds.circle(0, 0, 0, 0, 0, 0, 0, 0);\n"
					]
				],
				"statement": [
					"leds.bottom.right(`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`);\n"
				]
			}
		},
		{
			"name": "notes",
			"l2": {
				"initVarDecl": [
					"const pi = 3.14;\n",
					[
						"// variables for notes\n",
						"int notes[6];\n",
						"int durations[6];\n",
						"int note_index;\n",
						"int wave[142];\n"
					]
				],
				"initCodeExec": [
					[
						"// init notes\n",
						"for (int i = 0; i < size(wave); i++) {\n",
						"wave[i] = 128 * sin(fixed(i) / size(wave) * 2 * pi);\n",
						"}\n",
						"sound.wave(wave);\n",
						"note_index = 6;\n"
					],
					[
						"sound.system(-1);\n"
					]
				],
				"initCodeDecl": [
					[
						"// when a note is finished, play the next one\n",
						"onevent sound.finished {\n",
						"if (note_index < size(notes)) {\n",
						"sound.freq(notes[note_index], durations[note_index]);\n",
						"note_index++;\n",
						"}\n",
						"}\n"
					]
				],
				"statement": [
					"notes = [`$.filter(function (a, i) { return i % 2 == 0; }).map(function (h, i) { return $[2 * i + 1] ? [262, 311, 370, 440, 524, 370][h] : 0; }).join(', ')`];\n",
					"durations = [`$.filter(function (a, i) { return i % 2 == 1; }).map(function (d) { return d ? 7 * d : 28; }).join(', ')`];\n",
					"note_index = 1;\n",
					"note_count = 6;\n",
					"sound.freq(notes[0], durations[0]);\n"
				]
			}
		},
		{
			"name": "play",
			"l2": {
				"initCodeExec": [
					"sound.system(-1);\n"
				],
				"statement": "sound.play(`$[0].toString(10)`);\n"
			}
		},
		{
			"name": "play stop",
			"l2": {
				"initCodeExec": [
					"sound.system(-1);\n"
				],
				"statement": "sound.play(-1);\n"
			}
		},
		{
			"name": "set state",
			"l2": {
				"initVarDecl": [
					[
						"int state;\n"
					]
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"initCodeDecl": [
					[
						"// display a binary value\n",
						"void display_binary(int n) {\n",
						"leds.circle((n&1)<<5,(n&2)<<4,(n&4)<<3,(n&8)<<2,",
						"(n&16)<<1,n&32,(n&64)>>1,(n&128)>>2);\n",
						"}\n"
					]
				],
				"statement": [
					"state = state & `0xff ^ $.reduce(function (a, b, i) { return b !== 0 ? a | [128,2,32,8][i] : a; }, 0)` | `$.reduce(function (a, b, i) { return b === 1 ? a | [128,2,32,8][i] : a; }, 0)`;\n",
					"display_binary(state);\n"
				]
			}
		},
		{
			"name": "toggle state",
			"l2": {
				"initVarDecl": [
					[
						"int state;\n"
					]
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"initCodeDecl": [
					[
						"// display a binary value\n",
						"void display_binary(int n) {\n",
						"leds.circle((n&1)<<5,(n&2)<<4,(n&4)<<3,(n&8)<<2,",
						"(n&16)<<1,n&32,(n&64)>>1,(n&128)>>2);\n",
						"}\n"
					]
				],
				"statement": [
					"state ^= `$.reduce(function (a, b, i) { return b ? a | [128,2,32,8][i] : a; }, 0)`;\n",
					"display_binary(state);\n"
				]
			}
		},
		{
			"name": "set state 8",
			"l2": {
				"initVarDecl": [
					[
						"int state;\n"
					]
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"initCodeDecl": [
					[
						"// display a binary value\n",
						"void display_binary(int n) {\n",
						"leds.circle((n&1)<<5,(n&2)<<4,(n&4)<<3,(n&8)<<2,",
						"(n&16)<<1,n&32,(n&64)>>1,(n&128)>>2);\n",
						"}\n"
					]
				],
				"statement": [
					"state = `1 << $[0]`;\n",
					"display_binary(state);\n"
				],
				"statementWithoutInit": [
					"leds.circle(`$[0] === 0 ? 32 : 0`, `$[0] === 1 ? 32 : 0`, `$[0] === 2 ? 32 : 0`, `$[0] === 3 ? 32 : 0`, ",
						"`$[0] === 4 ? 32 : 0`, `$[0] === 5 ? 32 : 0`, `$[0] === 6 ? 32 : 0`, `$[0] === 7 ? 32 : 0`);\n"
				]
			}
		},
		{
			"name": "change state 8",
			"l2": {
				"initVarDecl": [
					[
						"// variables for exclusive state\n",
						"int state;\n"
					]
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"initCodeDecl": [
					[
						"// display a binary value\n",
						"void display_binary(int n) {\n",
						"leds.circle((n&1)<<5,(n&2)<<4,(n&4)<<3,(n&8)<<2,",
						"(n&16)<<1,n&32,(n&64)>>1,(n&128)>>2);\n",
						"}\n"
					]
				],
				"statement": [
					"state = `$[0] > 0 ? '(state << 1) & 0xff | (state >> 7) & 1' : '(state >> 1) & 0x7f | (state << 7) & 0x80'`;\n",
					"display_binary(state);\n"
				],
				"statementWithoutInit": [
					"leds.circle(`$[0] === 0 ? 32 : 0`, `$[0] === 1 ? 32 : 0`, `$[0] === 2 ? 32 : 0`, `$[0] === 3 ? 32 : 0`, ",
						"`$[0] === 4 ? 32 : 0`, `$[0] === 5 ? 32 : 0`, `$[0] === 6 ? 32 : 0`, `$[0] === 7 ? 32 : 0`);\n"
				]
			}
		},
		{
			"name": "set counter",
			"l2": {
				"initVarDecl": [
					"int state;\n"
				],
				"initCodeExec": [
					"state = 0;\n"
				],
				"initCodeDecl": [
					[
						"// display a binary value\n",
						"void display_binary(int n) {\n",
						"leds.circle((n&1)<<5,(n&2)<<4,(n&4)<<3,(n&8)<<2,",
						"(n&16)<<1,n&32,(n&64)>>1,(n&128)>>2);\n",
						"}\n"
					]
				],
				"statement": [
					"`$[0] === 0 ? 'state = 0;' : $[0] > 0 ? 'if (state < 255) {\\nstate++;\\n}' : 'if (state > 0) {\\nstate--;\\n}'`\n",
					"display_binary(state);\n"
				]
			}
		},
		{
			"name": "set timer",
			"l2": {
				"initVarDecl": [
					"bool timerElapsed;\n"
				],
				"initCodeExec": [
					[
						"// stop timer 0\n",
						"timer.period[0] = 0;\n"
					],
					"timerElapsed = false;\n"
				],
				"statement": "timer.period[0] = `Math.round(1000 * $[0] / slowdown)`;\n"
			}
		},
		{
			"name": "set timer log",
			"l2": {
				"initVarDecl": [
					"bool timerElapsed;\n"
				],
				"initCodeExec": [
					[
						"// stop timer 0\n",
						"timer.period[0] = 0;\n"
					],
					"timerElapsed = false;\n"
				],
				"statement": "timer.period[0] = `Math.round(1000 * $[0] / slowdown)`;\n"
			}
		},
		{
			"name": "send user event",
			"l2": {
				"statement": "emit(\"user\", `$[0]`);\n"
			}
		},
		{
			"name": "picture comment",
			"l2": {}
		}
	]
}

</script>

<script type="application/json" id="js.json">
{
	"blocks": [
		{
			"name": "!stop",
			"js": {
				"statement": [
					"this.set(\"motor.left\", 0);\n",
					"this.set(\"motor.right\", 0);\n"
				]
			}
		},
		{
			"name": "button",
			"js": {
				"sectionBegin": "this.addEventListener(\"buttons\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "`['center', 'forward', 'backward', 'right', 'left'].map(function (s, i) { return $[i] ? 'this.get(\"button.' + s + '\")' : ''; }).filter(function (s) { return s; }).join(' && ') || ['center', 'forward', 'backward', 'right', 'left'].map(function (s) { return 'this.get(\"button.' + s + '\")'; }).join(' || ')`"
			}
		},
		{
			"name": "button 1",
			"js": {
				"sectionBegin": "this.addEventListener(\"buttons\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "this.get(\"button.`['center', 'forward', 'backward', 'right', 'left'][$[0]]`\")"
			}
		},
		{
			"name": "horiz prox",
			"js": {
				"sectionBegin": "this.addEventListener(\"prox\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'this.get(\"prox.horizontal\")[' + ix + '] ' + ($[i] > 0 ? '>' : '<') + '= 0.5' : ''; }).filter(function (s) { return s; }).join(' || ')`"
			}
		},
		{
			"name": "horiz prox adv",
			"js": {
				"sectionBegin": "this.addEventListener(\"prox\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'this.get(\"prox.horizontal\")[' + ix + '] ' + ($[i] > 0 ? '>= ' + toFixed($[7]) : '<= ' + toFixed($[8])) : ''; }).filter(function (s) { return s; }).join(' && ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'this.get(\"prox.horizontal\")[' + ix + '] ' + ($[i] > 0 ? '>= ' + toFixed($[7]) : '<= ' + toFixed($[8])); }).join(' || ')`"
			}
		},
		{
			"name": "horiz prox 1",
			"js": {
				"sectionBegin": "this.addEventListener(\"prox\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'this.get(\"prox.horizontal\")[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + toFixed($[7]) : ''; }).filter(function (s) { return s; }).join(' && ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'this.get(\"prox.horizontal\")[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + toFixed($[7]); }).join(' || ')`"
			}
		},
		{
			"name": "ground",
			"js": {
				"sectionBegin": "this.addEventListener(\"prox\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'this.get(\"prox.ground.delta\")[' + ix + '] ' + ($[i] > 0 ? '>' : '<') + '= 0.5' : ''; }).filter(function (s) { return s; }).join(' || ')`"
			}
		},
		{
			"name": "ground adv",
			"js": {
				"sectionBegin": "this.addEventListener(\"prox\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'this.get(\"prox.ground.delta\")[' + ix + '] ' + ($[i] > 0 ? '>= ' + toFixed($[2]) : '<= ' + toFixed($[3])) : ''; }).filter(function (s) { return s; }).join(' && ') || [0, 1].map(function (ix) { return 'this.get(\"prox.ground.delta\")[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + toFixed($[2]); }).join(' || ')`"
			}
		},
		{
			"name": "ground 1",
			"js": {
				"sectionBegin": "this.addEventListener(\"prox\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'this.get(\"prox.ground.delta\")[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + toFixed($[2]) : ''; }).filter(function (s) { return s; }).join(' && ') || [0, 1].map(function (ix) { return 'this.get(\"prox.ground.delta\")[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + toFixed($[2]); }).join(' || ')`"
			}
		},
		{
			"name": "tap",
			"js": {
				"initVarDecl": [
					"var tapped;\n"
				],
				"initCodeExec": [
					"tapped = false;\n"
				],
				"sectionBegin": "this.addEventListener(\"tap\", function (name, param) {\n",
				"sectionPreamble": "tapped = true;\n",
				"sectionEnd": "});\n",
				"clauseAsCondition": "tapped"
			}
		},
		{
			"name": "accelerometer",
			"js": {
				"initVarDecl": [
					"`$[0] == 0 ? 'bool tapped;\\n' : ''`"
				],
				"initCodeExec": [
					"`$[0] == 0 ? 'tapped = false;\\n' : ''`"
				],
				"sectionBegin": "this.addEventListener($[0] == 0 ? \"tap\" : \"acc\", function (name, param) {\n",
				"sectionEnd": "}\n",
				"sectionPreamble": "`$[0] == 0 ? 'tapped = true;\\n' : ''`",
				"clauseInit": "`$[0] === 1 ? 'var rollAngle = Math.atan2(acc[0], acc[2]);\\n' : $[0] === 2 ? 'var pitchAngle = Math.atan2(acc[1], acc[2]);\\n' : ''`",
				"clause": "`$[0] == 0 ? 'tapped' : (function (name, a) { return a <= -6 ? name + ' < ' + (Math.PI / 12 * (a + 0.5)).toFixed(2) : a >= 6 ? name + ' >= ' + (Math.PI / 12 * (a - 0.5)).toFixed(2) : name + ' >= ' + (Math.PI / 12 * (a - 0.5)).toFixed(2) + ' && ' + name + ' < ' + (Math.PI / 12 * (a + 0.5)).toFixed(2); })($[0] === 1 ? 'rollAngle' : 'pitchAngle', $[0] === 2 ? $[1] : -$[1])`"
			}
		},
		{
			"name": "roll",
			"js": {
				"sectionBegin": "this.addEventListener(\"acc\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clauseInit":
					"var rollAngle = Math.atan2(acc[0], acc[2]);\n",
				"clause":
					"rollAngle >= `toFixed(Math.PI / 12 * ($[0] - 0.5))` && rollAngle < `toFixed(Math.PI / 12 * ($[0] + 0.5))`"
			}
		},
		{
			"name": "pitch",
			"js": {
				"sectionBegin": "this.addEventListener(\"acc\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clauseInit":
					"var pitchAngle = Math.atan2(acc[1], acc[2]);\n",
				"clause":
					"pitchAngle >= `toFixed(Math.PI / 12 * (a - 0.5))` && pitchAngle < `toFixed(Math.PI / 12 * (a + 0.5))`"
			}
		},
		{
			"name": "yaw",
			"js": {
				"sectionBegin": "this.addEventListener(\"acc\", function (name, param) {\n",
				"sectionEnd": "});\n",
				"clauseInit":
					"var yawAngle = Math.atan2(acc[0], acc[1]);\n",
				"clause":
					"yawAngle >= `toFixed(Math.PI / 12 * (a - 0.5))` && yawAngle < `toFixed(Math.PI / 12 * (a + 0.5))`"
			}
		},
		{
			"name": "clap",
			"js": {
				"sectionBegin": "this.addEventListener(\"mic\", function (name, param) {\n",
				"sectionEnd": "});\n"
			}
		},
		{
			"name": "init",
			"js": {
				"sectionBegin": "// init block\n"
			}
		},
		{
			"name": "timer",
			"js": {
				"initCodeExec": [
					[
						"// stop timer 0\n",
						"this.setTimer(0, 'timer0', -1);\n"
					]
				],
				"sectionBegin": "this.addEventListener('timer0', function (name, param) {\n",
				"sectionEnd": "});\n"
			}
		},
		{
			"name": "clock",
			"js": {
				"initCodeExec": [
					[
						"// start clocks\n",
						"this.setTimer(10, 'clock10', 1 / 10, true);\n",
						"this.setTimer(11, 'clock20', 1 / 20, true);\n"
					]
				],
				"sectionBegin": "this.addEventListener(\"`$[0] === 10 ? 'timer10' : 'timer11'`\", function (name, param) {\n",
				"sectionEnd": "});\n"
			}
		},
		{
			"name": "remote control arrows"
		},
		{
			"name": "state",
			"js": {
				"initVarDecl": [
					[
						"// variables for state\n",
						"this.setClientState(\"state\", []);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"state\", [false, false, false, false]);\n"
				],
				"clauseInit": "var state0 = this.getClientState(\"state\");\n",
				"clause": "`$.map(function (v, i) { return (v >= 0 ? '' : '!') + 'state[' + i + ']'; }).filter(function (v, i) { return $[i]; }).join(' && ')`"
			}
		},
		{
			"name": "state 8",
			"js": {
				"initVarDecl": [
					[
						"// variable for exclusive state\n",
						"this.setClientState(\"state8\", 0);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"state8\", 0);\n"
				],
				"clauseInit": "var state80 = this.getClientState(\"state8\");\n",
				"clause": "state80 == `$[0].toString(10)`"
			}
		},
		{
			"name": "counter comparison",
			"js": {
				"initVarDecl": [
					[
						"// variable for counter\n",
						"this.setClientState(\"counter\", 0);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"counter\", 0);\n"
				],
				"clauseInit": "var counter0 = this.getClientState(\"counter\");\n",
				"clause": "counter0 `$[0] === 0 ? '==' : $[0] > 0 ? '>=' : '<='` `$[1]`"
			}
		},
		{
			"name": "color state",
			"js": {
				"clause": "`$.map(function (p, i) { return 'topColor[' + i + '] / 11 == ' + Math.floor(p * 2.99); }).join(' && ')`"
			}
		},
		{
			"name": "color 8 state",
			"js": {
				"clause": "`$.map(function (p, i) { return 'topColor[' + i + '] / 11 == ' + Math.floor(p * 2.99); }).join(' && ')`"
			}
		},
		{
			"name": "motor state",
			"js": {
				"clause": [
					"`$[0] == 0 ? 'Math.abs(' : ''`this.get(\"motor.left\")`$[0] > 0 ? ' > ' : $[0] < 0 ? ' < -' : ') < '``0.1 * slowdown` ",
					"&& `$[1] == 0 ? 'Math.abs(' : ''`this.get(\"motor.right\")`$[1] > 0 ? ' > ' : $[1] < 0 ? ' < -' : ') < '``0.1 * slowdown`"
				]
			}
		},
		{
			"name": "motor",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement": [
					"this.set(\"motor.left\", `toFixed($[0] * slowdown)`);\n",
					"this.set(\"motor.right\", `toFixed($[1] * slowdown)`);\n"
				]
			}
		},
		{
			"name": "move",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement": [
					"this.set(\"motor.left\", `toFixed([0, 0.2, -0.2, 0.2-0.05, 0.2+0.05, -0.2, 0.2][$[0]] * slowdown)`);\n",
					"this.set(\"motor.right\", `toFixed([0, 0.2, -0.2, 0.2+0.05, 0.2-0.05, 0.2, -0.2][$[0]] * slowdown)`);\n"
				]
			}
		},
		{
			"name": "top color",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement":
					"this.set(\"leds.top\", [`$.map(toFixed).join(', ')`]);\n"
			}
		},
		{
			"name": "top color 8",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement":
					"this.set(\"leds.top\", [`['0,0,0','1,0,0','0,1,0','1,1,0','0,0,1','1,0,1','0,1,1','1,1,1'][$[0]]`]);\n"
			}
		},
		{
			"name": "bottom color",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement": [
					"this.set(\"leds.bottom.left\", [`$.map(toFixed).join(', ')`]);\n",
					"this.set(\"leds.bottom.right\", [`$.map(toFixed).join(', ')`]);\n"
				]
			}
		},
		{
			"name": "bottom-left color",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement":
					"this.set(\"leds.bottom.left\", [`$.map(toFixed).join(', ')`]);\n"
			}
		},
		{
			"name": "bottom-right color",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement":
					"this.set(\"leds.bottom.right\", [`$.map(toFixed).join(', ')`]);\n"
			}
		},
		{
			"name": "bottom color 8",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement": [
					"this.set(\"leds.bottom.left\", [`['0,0,0','1,0,0','0,1,0','1,1,0','0,0,1','1,0,1','0,1,1','1,1,1'][$[0]]`]);\n",
					"this.set(\"leds.bottom.right\", [`['0,0,0','1,0,0','0,1,0','1,1,0','0,0,1','1,0,1','0,1,1','1,1,1'][$[0]]`]);\n"
				]
			}
		},
		{
			"name": "bottom-left color 8",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement":
					"this.set(\"leds.bottom.left\", [`['0,0,0','1,0,0','0,1,0','1,1,0','0,0,1','1,0,1','0,1,1','1,1,1'][$[0]]`]);\n"
			}
		},
		{
			"name": "bottom-right color 8",
			"js": {
				"initCodeExec": [
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement":
					"this.set(\"leds.bottom.right\", [`['0,0,0','1,0,0','0,1,0','1,1,0','0,0,1','1,0,1','0,1,1','1,1,1'][$[0]]`]);\n"
			}
		},
		{
			"name": "notes",
			"js": {
				"initCodeExec": [
					[
						"// init notes\n",
						"this.set(\"sound\", {});\n"
					],
					"this.set(\"leds.top\", [0, 0, 0]);\n"
				],
				"statement":
					"this.set(\"sound\", {\"f\": [`$.filter(function (a, i) { return i % 2 == 0; }).map(function (h, i) { return $[2 * i + 1] ? [262, 311, 370, 440, 524, 370][h] : 0; }).join(', ')`], \"d\": [`$.filter(function (a, i) { return i % 2 == 1; }).map(function (d) { return d ? 7 * d : 28; }).join(', ')`]});\n"
			}
		},
		{
			"name": "play",
			"js": {
				"initCodeExec": [
					"// init notes\nthis.set(\"sound\", {});\n"
				],
				"statement": "this.set(\"sound\", {\"pcm\": `$[0].toString(10)`});\n"
			}
		},
		{
			"name": "play stop",
			"js": {
				"initCodeExec": [
					"// init notes\nthis.set(\"sound\", {});\n"
				],
				"statement": "this.set(\"sound\", {});\n"
			}
		},
		{
			"name": "set state",
			"js": {
				"initVarDecl": [
					[
						"// variables for state\n",
						"this.setClientState(\"state\", []);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"state\", [false, false, false, false]);\n"
				],
				"statement": [
					"var state = this.getClientState(\"state\");\n",
					"`$.map(function (v, i) { return v ? 'state[' + i + '] = ' + (v > 0 ? 'true' : 'false') + ';\\n' : ''; }).join('')`",
					"this.setClientState(\"state\", state);\n",
					"`$[0] || $[1] || $[2] || $[3] ? 'this.set(\"leds.circle\", [0,state[1]?1:0,0,state[3]?1:0,0,state[2]?1:0,0,state[0]?1:0]);\\n' : ''`"
				]
			}
		},
		{
			"name": "toggle state",
			"js": {
				"initVarDecl": [
					[
						"// variables for state\n",
						"this.setClientState(\"state\", []);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"state\", [false, false, false, false]);\n"
				],
				"statement": [
					"var state = this.getClientState(\"state\");\n",
					"`$.map(function (v, i) { return v ? 'state[' + i + '] = !state[' + i + '];\\n' : ''; }).join('')`",
					"this.setClientState(\"state\", state);\n",
					"`$[0] || $[1] || $[2] || $[3] ? 'this.set(\"leds.circle\", [0,state[1]?1:0,0,state[3]?1:0,0,state[2]?1:0,0,state[0]?1:0]);\\n' : ''`"
				]
			}
		},
		{
			"name": "set state 8",
			"js": {
				"initVarDecl": [
					[
						"// variable for exclusive state\n",
						"this.setClientState(\"state8\", 0);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"state8\", 0);\n"
				],
				"statement": [
					"this.setClientState(\"state8\", `$[0].toString(10)`);\n",
					"this.set(\"leds.circle\", [`[0,1,2,3,4,5,6,7].map(function (i) { return $[0] === i; }).join(', ')`]);\n"
				],
				"statementWithoutInit":
					"this.set(\"leds.circle\", [`[0,1,2,3,4,5,6,7].map(function (i) { return $[0] === i; }).join(', ')`]);\n"
			}
		},
		{
			"name": "change state 8",
			"js": {
				"initVarDecl": [
					[
						"// variable for exclusive state\n",
						"this.setClientState(\"state8\", 0);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"state8\", 0);\n"
				],
				"statement": [
					"var state8 = (this.getClientState(\"state8\") + `$[0] > 0 ? 1 : 7`) % 8;",
					"this.setClientState(\"state8\", state8);\n",
					"this.set(\"leds.circle\", [`[0,1,2,3,4,5,6,7].map(function (i) { return 'state8 === ' + i.toString(10); }).join(', ')`]);\n"
				],
				"statementWithoutInit":
					"this.set(\"leds.circle\", [`$[0] === 0 ? 1 : 0`,`$[0] === 1 ? 1 : 0`,`$[0] === 2 ? 1 : 0`,`$[0] === 3 ? 1 : 0`,`$[0] === 4 ? 1 : 0`,`$[0] === 5 ? 1 : 0`,`$[0] === 6 ? 1 : 0`,`$[0] === 7 ? 1 : 0`]);\n"
			}
		},
		{
			"name": "set counter",
			"js": {
				"initVarDecl": [
					[
						"// variable for counter\n",
						"this.setClientState(\"counter\", 0);\n"
					]
				],
				"initCodeExec": [
					"this.setClientState(\"counter\", 0);\n"
				],
				"statement": [
					"var counter = `$[0] === 0 ? 0 : $[0] > 0 ? 'Math.min(this.getClientState(\"counter\") + 1, 255)' : 'Math.max(this.getClientState(\"counter\") - 1, 0)'`;\n",
					"this.setClientState(\"counter\", counter);\n",
					"this.set(\"leds.circle\", [counter&1?1:0,counter&2?1:0,counter&4?1:0,counter&8?1:0,counter&16?1:0,counter&32?1:0,counter&64?1:0,counter&128?1:0]);\n"
				]
			}
		},
		{
			"name": "set timer",
			"js": {
				"initCodeExec": [
					[
						"// stop timer 0\n",
						"this.setTimer(0, 'timer0', -1);\n"
					]
				],
				"statement": "this.setTimer(0, 'timer0', `($[0] / slowdown).toFixed(3)`);\n"
			}
		},
		{
			"name": "set timer log",
			"js": {
				"initCodeExec": [
					[
						"// stop timer 0\n",
						"this.setTimer(0, 'timer0', -1);\n"
					]
				],
				"statement": "this.setTimer(0, 'timer0', `($[0] / slowdown).toFixed(3)`);\n"
			}
		},
		{
			"name": "picture comment",
			"js": {}
		}
	]
}

</script>

<script type="application/json" id="python.json">
{
	"blocks": [
		{
			"name": "!stop",
			"python": {
				"statement": [
					"thymio.motor.left.target = 0\n",
					"thymio.motor.right.target = 0\n",
					"thymio.leds.circle = [32,32,32,32,32,32,32,32]\n",
					"@onevent(thymio.TIMER0)\n",
					"def onevent_timer0():\n",
					"thymio.leds.circle = [0,0,0,0,0,0,0,0]\n",
					"<\n"
				]
			}
		},
		{
			"name": "button",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.BUTTONS)\n",
					"def onevent_buttons():\n"
				],
				"sectionEnd": "<\n",
				"clause": "`['center', 'forward', 'backward', 'right', 'left'].map(function (s, i) { return $[i] ? 'thymio.button.' + s : ''; }).filter(function (s) { return s; }).join(' and ') || ['center', 'forward', 'backward', 'right', 'left'].map(function (s) { return 'button.' + s; }).join(' or ')`"
			}
		},
		{
			"name": "button 1",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.BUTTONS)\n",
					"def onevent_buttons():\n"
				],
				"sectionEnd": "<\n",
				"clause": "thymio.button.`['center', 'forward', 'backward', 'right', 'left'][$[0]]`"
			}
		},
		{
			"name": "horiz prox",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.PROX)\n",
					"def onevent_prox():\n"
				],
				"sectionEnd": "<\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'thymio.prox.horizontal[' + ix + '] ' + ($[i] > 0 ? '>= 2000' : '<= 1000') : ''; }).filter(function (s) { return s; }).join(' or ')`"
			}
		},
		{
			"name": "horiz prox adv",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.PROX)\n",
					"def onevent_prox():\n"
				],
				"sectionEnd": "<\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'thymio.prox.horizontal[' + ix + '] ' + ($[i] > 0 ? '>= ' + Math.round(7 + 33 * $[7]) : '<= ' + Math.round(7 + 33 * $[8])) + '00' : ''; }).filter(function (s) { return s; }).join(' and ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'thymio.prox.horizontal[' + ix + '] >= 2000'; }).join(' or ')`"
			}
		},
		{
			"name": "horiz prox 1",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.PROX)\n",
					"def onevent_prox():\n"
				],
				"sectionEnd": "<\n",
				"clause": "`[2, 1, 3, 0, 4, 5, 6].map(function (ix, i) { return $[i] ? 'thymio.prox.horizontal[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + Math.round(7 + 33 * $[7]) + '00' : ''; }).filter(function (s) { return s; }).join(' and ') || [2, 1, 3, 0, 4, 5, 6].map(function (ix) { return 'thymio.prox.horizontal[' + ix + '] >= 2000'; }).join(' or ')`"
			}
		},
		{
			"name": "ground",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.PROX)\n",
					"def onevent_prox():\n"
				],
				"sectionEnd": "<\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'thymio.prox.ground.delta[' + ix + '] ' + ($[i] > 0 ? '>= 450' : '<= 400') : ''; }).filter(function (s) { return s; }).join(' and ') || [0, 1].map(function (ix) { return 'prox.ground.delta[' + ix + '] >= 450'; }).join(' or ')`"
			}
		},
		{
			"name": "ground adv",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.PROX)\n",
					"def onevent_prox():\n"
				],
				"sectionEnd": "<\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'thymio.prox.ground.delta[' + ix + '] ' + ($[i] > 0 ? '>= ' + Math.round(25 + 40 * $[2]) : '<= ' + Math.round(25 + 40 * $[3])) : ''; }).filter(function (s) { return s; }).join(' and ') || [0, 1].map(function (ix) { return 'thymio.prox.ground.delta[' + ix + '] >= 450'; }).join(' or ')`"
			}
		},
		{
			"name": "ground 1",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.PROX)\n",
					"def onevent_prox():\n"
				],
				"sectionEnd": "<\n",
				"clause": "`[0, 1].map(function (ix, i) { return $[i] ? 'thymio.prox.ground.delta[' + ix + '] ' + ($[i] > 0 ? '>= ' : '<= ') + Math.round(25 + 40 * $[2]) : ''; }).filter(function (s) { return s; }).join(' and ') || [0, 1].map(function (ix) { return 'thymio.prox.ground.delta[' + ix + '] >= 450'; }).join(' or ')`"
			}
		},
		{
			"name": "tap",
			"python": {
				"initCodeExec": [
					"tapped = False\n"
				],
				"sectionBegin": [
					"@thymio.onevent(thymio.TAP)\n",
					"def onevent_tap():\n"
				],
				"sectionPreamble": "tapped = True\n",
				"sectionEnd": "<\n",
				"clauseAsCondition": "tapped"
			}
		},
		{
			"name": "accelerometer",
			"python": {
				"initCodeExec": [
					"`$[0] == 0 ? 'tapped = False\\n' : ''`"
				],
				"sectionBegin": [
					"@thymio.onevent(thymio.`$[0] == 0 ? 'TAP' : 'ACC'`)\n",
					"def onevent_`$[0] == 0 ? 'tap' : 'acc'`():\n"
				],
				"sectionEnd": "<\n",
				"sectionPreamble": "`$[0] == 0 ? 'tapped = True\\n' : ''`",
				"clauseInit": "`$[0] === 1 ? 'rollAngle = thymio.math.atan2(thymio.acc[0], thymio.acc[2])\\n' : $[0] === 2 ? 'pitchAngle = thymio.math.atan2(acc[1], acc[2])\\n' : ''`",
				"clause": "`$[0] == 0 ? 'tapped' : (function (name, a) { return a <= -6 ? name + ' < ' + Math.round(2730.67 * a + 1365.33) : a >= 6 ? name + ' >= ' + Math.round(2730.67 * a - 1365.33) : name + ' >= ' + Math.round(2730.67 * a - 1365.33) + ' and ' + name + ' < ' + Math.round(2730.67 * a + 1365.33); })($[0] === 1 ? 'rollAngle' : 'pitchAngle', $[0] === 2 ? $[1] : -$[1])`"
			}
		},
		{
			"name": "roll",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.ACC)\n",
					"def onevent_acc():\n"
				],
				"sectionEnd": "<\n",
				"clauseInit":
					"rollAngle = thymio.math.atan2(thymio.acc[0], thymio.acc[2])\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'rollAngle >= ' + Math.round(2730.67 * 12 - 1365.33) + ' or rollAngle < ' + Math.round(2730.67 * $[0] + 1365.33) : 'rollAngle >= ' + Math.round(2730.67 * $[0] - 1365.33) + ' and rollAngle < ' + Math.round(2730.67 * $[0] + 1365.33)`"
			}
		},
		{
			"name": "pitch",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.ACC)\n",
					"def onevent_acc():\n"
				],
				"sectionEnd": "<\n",
				"clauseInit":
					"pitchAngle = thymio.math.atan2(thymio.acc[1], thymio.acc[2])\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'pitchAngle >= ' + Math.round(2730.67 * 12 - 1365.33) + ' or pitchAngle < ' + Math.round(2730.67 * $[0] + 1365.33) : 'pitchAngle >= ' + Math.round(2730.67 * $[0] - 1365.33) + ' and pitchAngle < ' + Math.round(2730.67 * $[0] + 1365.33)`"
			}
		},
		{
			"name": "yaw",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.ACC)\n",
					"def onevent_acc():\n"
				],
				"sectionEnd": "<\n",
				"clauseInit":
					"yawAngle = thymio.math.atan2(thymio.acc[0], thymio.acc[1])\n",
				"clause":
					"`Math.abs($[0]) === 12 ? 'yawAngle >= ' + Math.round(2730.67 * 12 - 1365.33) + ' or yawAngle < ' + Math.round(2730.67 * $[0] + 1365.33) : 'yawAngle >= ' + Math.round(2730.67 * $[0] - 1365.33) + ' and yawAngle < ' + Math.round(2730.67 * $[0] + 1365.33)`"
			}
		},
		{
			"name": "clap",
			"python": {
				"sectionBegin": [
					"@thymio.onevent(thymio.MIC)\n",
					"def onevent_mic():\n"
				],
				"sectionEnd": "<\n"
			}
		},
		{
			"name": "init",
			"python": {
					"sectionBegin": "# inititialization\n"
			}
		},
		{
			"name": "timer",
			"python": {
				"initCodeExec": [
					[
						"# stop timer 0\n",
						"thymio.timer.period[0] = 0\n"
					],
					"timerElapsed = False\n"
				],
				"sectionBegin": [
					"@thymio.onevent(thymio.TIMER0)\n",
					"def onevent_timer0():\n"
				],
				"sectionEnd": "<\n",
				"sectionPreamble": "timerElapsed = True\nthymio.timer.period[0] = 0\n",
				"clauseAsCondition": "timerElapsed"
			}
		},
		{
			"name": "remote control arrows"
		},
		{
			"name": "state",
			"python": {
					"initCodeExec": [
						"state = [False, False, False, False]\n"
					],
					"clause": "`$.map(function (v, i) { return (v >= 0 ? '' : 'not ') + 'state0[' + i + ']'; }).filter(function (v, i) { return $[i]; }).join(' and ')`"
			}
		},
		{
			"name": "state 8",
			"python": {
				"initCodeExec": [
					"state8 = 0\n"
				],
				"clause": "state8 == `$[0]`"
			}
		},
		{
			"name": "counter comparison",
			"python": {
					"initCodeExec": [
						"counter = 0\n"
					],
					"clause": "counter `$[0] === 0 ? '==' : $[0] > 0 ? '>=' : '<='` `$[1]`"
			}
		},
		{
			"name": "color state",
			"python": {
				"initCodeExec": [
					"topColor = [0, 0, 0]\n"
				],
				"clause": "`$.map(function (p, i) { return 'topColor[' + i + '] / 11 == ' + Math.floor(p * 2.99); }).join(' and ')`"
			}
		},
		{
			"name": "color 8 state",
			"python": {
				"initCodeExec": [
					"topColor = [0, 0, 0]\n"
				],
				"clause": "`$.map(function (p, i) { return 'topColor[' + i + '] / 11 == ' + Math.floor(p * 2.99); }).join(' and ')`"
			}
		},
		{
			"name": "motor state",
			"python": {
				"clause": [
					"`$[0] == 0 ? 'abs(' : ''`thymio.motor.left.target`$[0] > 0 ? ' > ' : $[0] < 0 ? ' < -' : ') < '``0.1 * slowdown` ",
					"and `$[1] == 0 ? 'abs(' : ''`thymio.motor.right.target`$[1] > 0 ? ' > ' : $[1] < 0 ? ' < -' : ') < '``0.1 * slowdown`"
				]
			}
		},
		{
			"name": "motor",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement": [
					"thymio.motor.left.target = `toFixed($[0] * slowdown)`\n",
					"thymio.motor.right.target = `toFixed($[1] * slowdown)`\n"
				]
			}
		},
		{
			"name": "move",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement": [
					"thymio.motor.left.target = `toFixed([0, 0.2, -0.2, 0.2-0.05, 0.2+0.05, -0.2, 0.2][$[0]] * slowdown)`\n",
					"thymio.motor.right.target = `toFixed([0, 0.2, -0.2, 0.2+0.05, 0.2-0.05, 0.2, -0.2][$[0]] * slowdown)`\n"
				]
			}
		},
		{
			"name": "nn obstacles",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement": [
					"thymio.motor.left.target = `Math.round(500 * $[0] * slowdown)`",
					"`Math.round(20 * $[1]) ? ' - thymio.prox.horizontal[2] / 10 * ' + Math.round(20 * $[1]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[2]) ? ' + thymio.prox.horizontal[0] / 10 * ' + Math.round(20 * $[2]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[3]) ? ' - thymio.thymio.thymio.thymio.prox.horizontal[4] / 10 * ' + Math.round(20 * $[3]).toString(10) + ' / 16' : ''`\n",
					"thymio.motor.right.target = `Math.round(500 * $[0] * slowdown)`",
					"`Math.round(20 * $[1]) ? ' - thymio.thymio.thymio.prox.horizontal[2] / 10 * ' + Math.round(20 * $[1]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[2]) ? ' + thymio.thymio.prox.horizontal[4] / 10 * ' + Math.round(20 * $[2]).toString(10) + ' / 16' : ''`",
					"`Math.round(20 * $[3]) ? ' - thymio.prox.horizontal[0] / 10 * ' + Math.round(20 * $[3]).toString(10) + ' / 16' : ''`\n"
				]
			}
		},
		{
			"name": "top color",
			"python": {
				"initCodeExec": [
					"topColor = [0, 0, 0]\n",
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement": [
					"topColor = [`$.map(function (x) { return Math.round(32 * x); }).join(', ')`]\n",
					"thymio.leds.top = topColor\n"
				]
			}
		},
		{
			"name": "top color 8",
			"python": {
				"initCodeExec": [
					"topColor = [0, 0, 0]\n",
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement": [
					"topColor = [`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`]\n",
					"thymio.leds.top = topColor\n"
				]
			}
		},
		{
			"name": "bottom color",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement": [
					"thymio.leds.bottom.left = [`$.map(function (x) { return Math.round(32 * x); }).join(', ')`]\n",
					"thymio.leds.bottom.right = [`$.map(function (x) { return Math.round(32 * x); }).join(', ')`]\n"
				]
			}
		},
		{
			"name": "bottom-left color",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement":
					"thymio.leds.bottom.left = [`$.map(function (x) { return Math.round(32 * x); }).join(', ')`]\n"
			}
		},
		{
			"name": "bottom-right color",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement":
					"thymio.leds.bottom.right = [`$.map(function (x) { return Math.round(32 * x); }).join(', ')`]\n"
			}
		},
		{
			"name": "bottom color 8",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement": [
					"thymio.leds.bottom.left = [`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`]\n",
					"thymio.leds.bottom.right = [`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`]\n"
				]
			}
		},
		{
			"name": "bottom-left color 8",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement":
					"thymio.leds.bottom.left = [`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`]\n"
			}
		},
		{
			"name": "bottom-right color 8",
			"python": {
				"initCodeExec": [
					[
						"# reset outputs\n",
						"thymio.leds.top = [0, 0, 0]\n",
						"thymio.leds.bottom.left = [0, 0, 0]\n",
						"thymio.leds.bottom.right = [0, 0, 0]\n",
						"thymio.leds.circle = [0, 0, 0, 0, 0, 0, 0, 0]\n"
					]
				],
				"statement":
					"thymio.leds.bottom.right = [`['0,0,0','32,0,0','0,32,0','32,32,0','0,0,32','32,0,32','0,32,32','32,32,32'][$[0]]`]\n"
			}
		},
		{
			"name": "notes",
			"python": {
				"initCodeExec": [
					[
						"# init. variables for notes\n",
						"note_index = 6\n",
						"note_count = 6\n"
					],
					[
						"# compute a sinus wave for sound\n",
						"for i in range(142):\n",
						"wave_phase = (i - 70) * 468\n",
						"wave_intensity = thymio.math.cos(wave_phase)\n",
						"wave[i] = wave_intensity / 256\n",
						"<\n",
						"thymio.nf.sound.wave(wave)\n"
					],
					[
						"thymio.nf.sound.system(-1)\n"
					]
				],
				"initCodeDecl": [
					[
						"# when a note is finished, play the next one\n",
						"@thymio.onevent(thymio.SOUND_FINISHED)\n",
						"def onevent_sound_finished():\n",
						"if note_index != note_count:\n",
						"thymio.nf.sound.freq(notes[note_index], durations[note_index])\n",
						"note_index += 1\n",
						"<\n",
						"<\n"
					]
				],
				"statement": [
					"notes = [`$.filter(function (a, i) { return i % 2 == 0; }).map(function (h, i) { return $[2 * i + 1] ? [370, 415, 466, 494, 554][h] : 0; }).join(', ')`]\n",
					"durations = [`$.filter(function (a, i) { return i % 2 == 1; }).map(function (d) { return d ? 10 * d : 28; }).join(', ')`]\n",
					"note_index = 1\n",
					"note_count = 6\n",
					"thymio.nf.sound.freq(notes[0], durations[0])\n"
				]
			}
		},
		{
			"name": "play",
			"python": {
 				"initCodeExec": [
					"thymio.nf.sound.system(-1)\n"
				],
				"statement": "thymio.nf.sound.play(`$[0].toString(10)`)\n"
			}
		},
		{
			"name": "play stop",
			"python": {
 				"initCodeExec": [
					"thymio.nf.sound.system(-1)\n"
				],
				"statement": "thymio.nf.sound.play(-1)\n"
			}
		},
		{
			"name": "set state",
			"python": {
				"initCodeExec": [
					"state = [False, False, False, False])\n"
				],
				"statement": [
					"`$.map(function (v, i) { return v ? 'state[' + i + '] = ' + (v > 0 ? 'True' : 'False') + '\\n' : ''; }).join('')`",
					"`$[0] || $[1] || $[2] || $[3] ? 'leds.circle = [0,state[1]?1:0,0,state[3]?1:0,0,state[2]?1:0,0,state[0]?1:0]\\n' : ''`"
				]
			}
		},
		{
			"name": "toggle state",
			"python": {
				"initCodeExec": [
					"state = [False, False, False, False])\n"
				],
				"statement": [
					"`$.map(function (v, i) { return v ? 'state[' + i + '] = !state[' + i + ']\\n' : ''; }).join('')`",
					"`$[0] || $[1] || $[2] || $[3] ? 'leds.circle = [0,state[1]?1:0,0,state[3]?1:0,0,state[2]?1:0,0,state[0]?1:0]\\n' : ''`"
				]
			}
		},
		{
			"name": "set state 8",
			"python": {
				"initCodeExec": [
					"state8 = 0\n"
				],
				"statement": [
					"state8 = `$[0].toString(10)`\n",
					"thymio.leds.circle = [`[0,1,2,3,4,5,6,7].map(function (i) { return $[0] === i; }).join(', ')`]\n"
				],
				"statementWithoutInit":
					"thymio.leds.circle = [`[0,1,2,3,4,5,6,7].map(function (i) { return $[0] === i; }).join(', ')`]\n"
			}
		},
		{
			"name": "change state 8",
			"python": {
				"initCodeExec": [
					"state8 = 0\n"
				],
				"statement": [
					"state8 = (state8 + `$[0] > 0 ? 1 : 7`) % 8",
					"thymio.leds.circle = [`[0,1,2,3,4,5,6,7].map(function (i) { return 'state8 === ' + i.toString(10); }).join(', ')`]\n"
				],
				"statementWithoutInit":
					"thymio.leds.circle = [`$[0] === 0 ? 1 : 0`,`$[0] === 1 ? 1 : 0`,`$[0] === 2 ? 1 : 0`,`$[0] === 3 ? 1 : 0`,`$[0] === 4 ? 1 : 0`,`$[0] === 5 ? 1 : 0`,`$[0] === 6 ? 1 : 0`,`$[0] === 7 ? 1 : 0`]\n"
			}
		},
		{
			"name": "set counter",
			"python": {
				"initCodeExec": [
					"counter = 0\n"
				],
				"statement": [
					"counter = `$[0] === 0 ? 0 : $[0] > 0 ? 'Math.min(this.getClientState(\"counter\") + 1, 255)' : 'Math.max(this.getClientState(\"counter\") - 1, 0)'`\n",
					"thymio.leds.circle = [counter&1?1:0,counter&2?1:0,counter&4?1:0,counter&8?1:0,counter&16?1:0,counter&32?1:0,counter&64?1:0,counter&128?1:0]\n"
				]
			}
		},
		{
			"name": "set timer",
			"python": {
				"initCodeExec": [
					[
						"# stop timer 0\n",
						"thymio.timer.period[0] = 0\n"
					],
					"timerElapsed = False\n"
				],
				"statement": [
					"thymio.timer.period[0] = `Math.round(1000 * $[0] / slowdown)`\n",
					"timerElapsed = False\n"
				]
			}
		},
		{
			"name": "set timer log",
			"python": {
				"initCodeExec": [
					[
						"# stop timer 0\n",
						"thymio.timer.period[0] = 0\n"
					],
					"timerElapsed = False\n"
				],
				"statement": [
					"thymio.timer.period[0] = `Math.round(1000 * $[0] / slowdown)`\n",
					"thymio.timerElapsed = False\n"
				]
			}
		},
		{
			"name": "picture comment",
			"python": {}
		}
	]
}

</script>

<script type="application/json" id="typical-param-set.json">
{
	"blocks": [
		{
			"name": "accelerometer",
			"typicalParamSet": [
				[0, 0],
				[1, 2],
				[2, 2]
			]
		},
		{
			"name": "counter comparison",
			"typicalParamSet": [
				[-1, 2],
				[0, 9],
				[1, 3]
			]
		},
		{
			"name": "set counter",
			"typicalParamSet": [
				[-1],
				[0],
				[1]
			]
		}
	]
}

</script>

<script type="application/json" id="typical-states.json">
{
	"buttons": [
		{
			"name": "vpl:text-toggle",
			"typicalStates": [
				{"selected": false},
				{"selected": true}
			]
		}
	]
}

</script>

<!-- english (en) -->

<script type="application/json" id="block-en.json">
{
	"i18n": {
		"en": {
			"button 1": "Single button",
			"button": "Multiple buttons",
			"horiz prox": "Proximity sensors",
			"horiz prox adv": "Proximity sensors with low and high thresholds",
			"horiz prox 1": "Proximity sensors with threshold",
			"ground": "Ground reflection sensors",
			"ground adv": "Ground reflection sensors with low and high thresholds",
			"ground 1": "Ground reflection sensors with threshold",
			"tap": "Impact detection",
			"accelerometer": "Accelerometer",
			"roll": "Roll angle",
			"pitch": "Pitch angle",
			"yaw": "Yaw angle",
			"clap": "Sound detection",
			"init": "Initialization",
			"timer": "Timer elapsed",
			"clock": "Clock at 10 or 20 Hz",
			"user event": "User event",
			"remote control arrows": "Remote control arrow keys",
			"state": "State (4 bits)",
			"state 8": "State (8 values)",
			"counter comparison": "Counter comparison",
			"color state": "Color state",
			"color 8 state": "Color state",
			"motor state": "Motor state",
			"motor": "Set motor speeds",
			"move": "Set motion",
			"nn obstacles": "Neural net for obstacle avoidance",
			"top color": "Set top color (RGB components)",
			"top color 8": "Set top color",
			"bottom color": "Set bottom color (RGB components)",
			"bottom-left color": "Set bottom-left color (RGB components)",
			"bottom-right color": "Set bottom-right color (RGB components)",
			"bottom color 8": "Set bottom color",
			"bottom-left color 8": "Set bottom-left color",
			"bottom-right color 8": "Set bottom-right color",
			"notes": "Play melody",
			"play": "Play a .wav file",
			"play stop": "Stop playing a .wav file",
			"set state": "Set state (4 bits)",
			"toggle state": "Toggle state (4 bits)",
			"set state 8": "Set state (8 values)",
			"change state 8": "Set to next or previous state (8 values)",
			"set counter": "Set counter",
			"set timer": "Start timer (0-4 sec)",
			"set timer log": "Set timer (0.1-10 sec)",
			"send user event": "Sent user event",
			"picture comment": "Picture comment"
		}
	}
}

</script>

<script type="application/json" id="cmd-sim-en.json">
{
	"i18n": {
		"en": {
			"sim:close": "Close panel",
			"sim:restart": "Restart simulation",
			"sim:pause": "Pause simulation",
			"sim:speedup": "Set simulation speedup factor",
			"sim:noise": "Switch noise on sensors on or off",
			"sim:pen": "Switch pen on or off",
			"sim:clear": "Erase traces made by pen",
			"sim:map-kind": "Select which map is displayed (ground, height, obstacles)",
			"sim:map": "Switch map on or off",
			"sim:map-ground": "Switch ground map on or off",
			"sim:map-height": "Switch height map on or off",
			"sim:map-obstacles": "Switch obstacles map on or off",
			"sim:vpl": "VPL panel",
			"sim:text": "Text source code panel",
			"sim:teacher": "Switch customization mode on or off",
			"sim:teacher-reset": "Reset customization",
			"sim:btn-button.forward": "Simulate a touch on the forward button",
			"sim:btn-button.left": "Simulate a touch on the left button",
			"sim:btn-button.center": "Simulate a touch on the center button",
			"sim:btn-button.right": "Simulate a touch on the right button",
			"sim:btn-button.backward": "Simulate a touch on the backward button",
			"sim:btn-tap": "Simulate an impact detection",
			"sim:btn-clap": "Simulate a sound detection"
		}
	}
}

</script>

<script type="application/json" id="cmd-vpl-en.json">
{
	"i18n": {
		"en": {
			"vpl:close": "Close panel",
			"vpl:about": "Show application information",
			"vpl:help": "Show documentation",
			"vpl:statement": "Show exercise statement",
			"vpl:readonly": "Read-only program",
			"vpl:new": "New program",
			"vpl:save": "Save program",
			"vpl:load": "Load program",
			"vpl:upload": "Upload program",
			"vpl:nextProgram": "Next program",
			"vpl:exportToHTML": "Export program view to HTML",
			"vpl:text": "Text source code panel",
			"vpl:text-toggle": "Show or hide text source code panel",
			"vpl:advanced": "Switch advanced mode on or off",
			"vpl:undo": "Undo last program change",
			"vpl:redo": "Redo last undone program change",
			"vpl:run": "Run program",
			"vpl:stop": "Stop program",
			"vpl:flash": "Write program to robot's flash memory",
			"vpl:connected": "Connection status",
			"vpl:robot": "Change robot",
			"vpl:sim": "Simulator panel",
			"vpl:duplicate": "Duplicate rule (rule drop target)",
			"vpl:disable": "Disable block or rule (drop target)",
			"vpl:lock": "Lock block or rule (drop target)",
			"vpl:trashcan": "Remove block or rule (drop target)",
			"vpl:duplicate;nodrag": "Duplicate rule",
			"vpl:disable;nodrag": "Disable block or rule",
			"vpl:lock;nodrag": "Lock block or rule",
			"vpl:trashcan;nodrag": "Remove block or rule",
			"vpl:message-error": "Error message",
			"vpl:message-warning": "Warning message",
			"vpl:message-empty": " ",
			"vpl:filename": "Filename",
			"vpl:teacher": "Switch customization mode on or off",
			"vpl:teacher-reset": "Reset customization",
			"vpl:teacher-save": "Save customization",
			"vpl:teacher-setasnew": "Install customization for new programs"
		}
	}
}

</script>

<script type="text/html" id="doctemplate-en.html">
<html>
	<head>
		<style>
			body {
				font-family: sans-serif;
			}
			img {
				float: left;
				margin-right: 10px;
				margin-bottom: 20px;
			}
			h1, h2, hr {
				clear: left;
			}
			p {
				margin-left: 120px;
			}
			p.parimg {
				margin-left: 0;
			}
		</style>
	</head>

	<body>
		<div style='padding: 2em; max-width: 60em; margin-left: auto; margin-right: auto;'>
			<h1>Toolbars</h1>
			BUTTONS
			<h1>Blocks</h1>
			BLOCKS
		</div>
	</body>
</html>

</script>

<script type="application/json" id="help-blocks-en.json">
{
	"help": {
		"en": {
			"blocks": {
				"button 1": [
					"# Single button",
					"![single button](vpl:block:button-1)",
					"Type: event or condition block",
					"As an event block, the _Single button_ block triggers a rule when the specified button on the Thymio is touched.",
					"As a condition block, the _Single button_ block allows the rule to be triggered only if the specified button is being touched at the moment the event in the leftmost block occurs."
				],
				"button": [
					"# Multiple buttons",
					"![button](vpl:block:button)",
					"Type: event or condition block",
					"As an event block, the _Multiple buttons_ block triggers a rule when all the specified buttons on the Thymio are touched simultaneously.",
					"As a condition block, the _Multiple buttons_ block allows the rule to be triggered only if all the specified buttons are being touched at the moment the event in the leftmost block occurs."
				],
				"horiz prox": [
					"# Proximity sensors",
					"![Proximity sensors](vpl:block:horiz-prox)",
					"Type: event or condition block",
					"As an event block, the _Proximity sensors_ block triggers a rule when the specified proximity sensors on the Thymio detect an obstacle, or the absence of obstacle, by reflecting more, or less, than a fixed amount of infrared emission. All the conditions must be satisfied simulaneously; the event occurs at the time the last specified sensor detects, or stops detecting, an obstacle.",
					"As a condition block, the _Proximity sensors_ block allows the rule to be triggered only if the specified proximity sensors fullfil the presence of absence of an obstacle."
				],
				"horiz prox adv": [
					"# Proximity sensors with low and high thresholds",
					"![horiz prox adv](vpl:block:horiz-prox-adv)",
					"Type: event or condition block",
					"As an event block, the _Proximity sensors with low and high thresholds_ block triggers a rule when the specified proximity sensors on the Thymio detect an obstacle by reflecting more infrared emission than the amount specified by the high threshold; or the absence of obstacle by reflecting less emission than the amount specified by the low threshold. All the conditions must be satisfied simulaneously; the event occurs at the time the last specified sensor detects, or stops detecting, an obstacle.",
					"As a condition block, the _Proximity sensors with low and high thresholds_ block allows the rule to be triggered only if the specified proximity sensors fullfil the presence of absence of an obstacle."
				],
				"horiz prox 1": [
					"# Proximity sensors with threshold",
					"![horiz prox 1](vpl:block:horiz-prox-1)",
					"Type: event or condition block",
					"As an event block, the _Proximity sensors with threshold_ block triggers a rule when the specified proximity sensors on the Thymio detect an obstacle, or the absence of obstacle, by reflecting more, or less, infrared emission than the amount specified by the threshold. All the conditions must be satisfied simulaneously; the event occurs at the time the last specified sensor detects, or stops detecting, an obstacle.",
					"As a condition block, the _Proximity sensors with threshold_ block allows the rule to be triggered only if the specified proximity sensors fullfil the presence of absence of an obstacle."
				],
				"ground": [
					"# Ground reflection sensors",
					"![ground](vpl:block:ground)",
					"Type: event or condition block",
					"Type: event or condition block",
					"As an event block, the _Ground reflection sensors_ block triggers a rule when the specified ground sensors on the Thymio detect a white or light ground, or its absence (dark or lack of ground), by reflecting more, or less, than a fixed amount of infrared emission. All the conditions must be satisfied simulaneously; when the two sensors are active, the event occurs at the time the second sensor detects, or stops detecting, the ground reflection.",
					"As a condition block, the _Ground reflection sensors_ block allows the rule to be triggered only if the specified ground sensors fullfil the presence of absence of a reflective ground."
				],
				"ground adv": [
					"# Ground reflection sensors with low and high thresholds",
					"![ground adv](vpl:block:ground-adv)",
					"Type: event or condition block",
					"As an event block, the _Ground reflection sensors with low and high thresholds_ block triggers a rule when the specified ground sensors on the Thymio detect a white or light ground, or its absence (dark or lack of ground), by reflecting more, or less, infrared emission than the amounts specified by the high and low thresholds, respectively. All the conditions must be satisfied simulaneously; when the two sensors are active, the event occurs at the time the second sensor detects, or stops detecting, the ground reflection.",
					"As a condition block, the _Ground reflection sensors with low and high thresholds_ block allows the rule to be triggered only if the specified ground sensors fullfil the presence of absence of a reflective ground."
				],
				"ground 1": [
					"# Ground reflection sensors with threshold",
					"![ground 1](vpl:block:ground-1)",
					"Type: event or condition block",
					"As an event block, the _Ground reflection sensors with threshold_ block triggers a rule when the specified ground sensors on the Thymio detect a white or light ground, or its absence (dark or lack of ground), by reflecting more, or less, infrared emission than the amounts specified by the threshold. All the conditions must be satisfied simulaneously; when the two sensors are active, the event occurs at the time the second sensor detects, or stops detecting, the ground reflection.",
					"As a condition block, the _Ground reflection sensors with threshold_ block allows the rule to be triggered only if the specified ground sensors fullfil the presence of absence of a reflective ground."
				],
				"tap": [
					"# Impact detection",
					"![tap](vpl:block:tap)",
					"Type: event or condition block",
					"As an event block, the _Impact detection_ block triggers a rule when the accelerometer sensor detects an impact, typically a gentle tap of the hand on the robot.",
					"As a condition block, the _Impact detection_ block allows the rule to be triggered only after an impact has been detected by the accelerometer sensor."
				],
				"accelerometer": [
					"# Accelerometer",
					"![accelerometer](vpl:block:accelerometer)",
					"Type: event or condition block",
					"As an event block, the _Accelerometer_ block triggers a rule when the specified event is detected: an impact (typically a gentle tap of the hand on the robot), the specified pitch angle (gravity orientation in the plane perpendicular to the left-right axis of the robot), or the specified roll roll angle (gravity orientation in the plane perpendicular to the back-front axis of the robot).",
					"As a condition block, the _Accelerometer_ block allows the rule to be triggered only after an impactt has been detected, or when the gravity is in the specified direction, depending on the mode."
				],
				"roll": [
					"# Roll angle",
					"![roll](vpl:block:roll)",
					"Type: event or condition block",
					"As an event block, the _Roll angle_ block triggers a rule when the accelerometer sensor detects that the robot roll angle (the angle of the vertical direction projected in a plane perpendicular to the back-front axis of the robot) reaches the specified value.",
					"As a condition block, the _Roll angle_ block allows the rule to be triggered only when the specified roll angle is reached."
				],
				"pitch": [
					"# Pitch angle",
					"![pitch](vpl:block:pitch)",
					"Type: event or condition block",
					"As an event block, the _Pitch angle_ block triggers a rule when the accelerometer sensor detects that the robot pitch angle (the angle of the vertical direction projected in a plane perpendicular to the left-right axis of the robot) reaches the specified value.",
					"As a condition block, the _Pitch angle_ block allows the rule to be triggered only when the specified pitch angle is reached."
				],
				"yaw": [
					"# Yaw angle",
					"![yaw](vpl:block:yaw)",
					"Type: event or condition block",
					"As an event block, the _Yaw angle_ block triggers a rule when the accelerometer sensor detects that the robot yaw angle (the angle of the vertical direction projected in a plane perpendicular to the pen hole of the robot) reaches the specified value.",
					"As a condition block, the _Yaw angle_ block allows the rule to be triggered only when the specified yaw angle is reached."
				],
				"clap": [
					"# Sound detection",
					"![clap](vpl:block:clap)",
					"Type: event or condition block",
					"As an event block, the _Sound detection_ block triggers a rule when the microphone detects sound or noise, typically a clap of the hands.",
					"As a condition block, the _Sound detection_ block allows the rule to be triggered only if the sound level detected by the microphone is higher than some threshold."
				],
				"init": [
					"# Initialization",
					"![init](vpl:block:init)",
					"Type: event or condition block",
					"As an event block, the _Initialization_ block triggers a rule when the program starts.",
					"As a condition block, the _Initialization_ block is always satisfied."
				],
				"timer": [
					"# Timer elapsed",
					"![timer](vpl:block:timer)",
					"Type: event or condition block",
					"As an event block, the _Timer elapsed_ block triggers a rule when the timer, started with the _Timer_ action block, reaches 0.",
					"As a condition block, the _Timer elapsed_ block allows the rule to be triggered only after the timer has reached 0, and before the _Timer_ action block has restarted the timer to a new value."
				],
				"remote control arrows": [
					"# remote control arrows",
					"![remote control arrows](vpl:block:remote-control-arrows)",
					"Type: event or condition block",
					"As an event block, the _Remote control arrow keys_ block triggers a rule when the specified key of the remote control is pressed.",
					"As a condition block, the _Remote control arrow keys_ block allows the rule to be triggered only after the specified button has been pressed at the moment the event in the leftmost block occurs."
				],
				"state": [
					"# State (4 bits)",
					"![state](vpl:block:state)",
					"Type: condition block",
					"As a condition block, the _State (4 bits)_ block allows the rule to be triggered only if the specified bits of the state, displayed on the yellow LEDs, are ON or OFF."
				],
				"state 8": [
					"# State (8 values)",
					"![state 8](vpl:block:state-8)",
					"Type: condition block",
					"As a condition block, the _State (8 values)_ block allows the rule to be triggered only if the 8-value state, displayed on the yellow LEDs, has the specified value."
				],
				"counter comparison": [
					"# Counter comparison",
					"![counter comparison](vpl:block:counter-comparison)",
					"Type: condition block",
					"As a condition block, the _Counter comparison_ block allows the rule to be triggered only if the state, displayed in binary on the yellow LEDs, fulfils the specified test."
				],
				"color state": [
					"# Color state",
					"![color state](vpl:block:color-state)",
					"Type: condition block",
					"As a condition block, the _Color state_ block allows the rule to be triggered only if the top RGB LED has approximately the specified color."
				],
				"color 8 state": [
					"# Color state",
					"![color 8 state](vpl:block:color-8-state)",
					"Type: condition block",
					"As a condition block, the _Color state_ block allows the rule to be triggered only if the top RGB LED has the specified color."
				],
				"motor state": [
					"# Motor state",
					"![motor state](vpl:block:motor-state)",
					"Type: condition block",
					"As a condition block, the _Motor state_ block allows the rule to be triggered only if the motor speeds have approximately the specified values."
				],
				"motor": [
					"# Set motor speeds",
					"![Set motor speeds](vpl:block:motor)",
					"Type: action block",
					"The _Set motor speeds_ block sets the target speed for the left and right motors. The combination of speeds makes the robot move forward or backward, possibly, turning at the same time, or to stop."
				],
				"move": [
					"# Set motion",
					"![move](vpl:block:move)",
					"Type: action block",
					"The _Set motor speeds_ block sets the speed for the left and right motors to move in the specified direction or to stop."
				],
				"nn obstacles": [
					"# Neural net for obstacle avoidance",
					"![nn obstacles](vpl:block:nn-obstacles)",
					"Type: action block",
					"..."
				],
				"top color": [
					"# Set top color (RGB components)",
					"![top color](vpl:block:top-color)",
					"Type: action block",
					"The _Set top color (RGB components)_ block sets the color of the top RGB LED to the color specified by the addition of red, green, and blue components."
				],
				"top color 8": [
					"# Set top color",
					"![top color 8](vpl:block:top-color-8)",
					"Type: action block",
					"The _Set top color_ block sets the color of the top RGB LED to the specified color."
				],
				"bottom color": [
					"# Set bottom color (RGB components)",
					"![bottom color](vpl:block:bottom-color)",
					"Type: action block",
					"The _Set bottom color (RGB components)_ block sets the color of the two bottom RGB LEDs to the color specified by the addition of red, green, and blue components."
				],
				"bottom-left color": [
					"# Set bottom-left color (RGB components)",
					"![bottom-left color](vpl:block:bottom-left-color)",
					"Type: action block",
					"The _Set bottom-left color (RGB components)_ block sets the color of the bottom-left RGB LED to the color specified by the addition of red, green, and blue components."
				],
				"bottom-right color": [
					"# Set bottom-right color (RGB components)",
					"![bottom-right color](vpl:block:bottom-right-color)",
					"Type: action block",
					"The _Set bottom-right color (RGB components)_ block sets the color of the bottom-right RGB LED to the color specified by the addition of red, green, and blue components."
				],
				"bottom color 8": [
					"# Set bottom color",
					"![bottom color 8](vpl:block:bottom-color-8)",
					"Type: action block",
					"The _Set bottom color_ block sets the color of the two bottom RGB LEDs to the specified color."
				],
				"bottom-left color 8": [
					"# Set bottom-left color",
					"![bottom-left color 8](vpl:block:bottom-left-color-8)",
					"Type: action block",
					"The _Set bottom-left color_ block sets the color of the bottom-left RGB LED to the specified color."
				],
				"bottom-right color 8": [
					"# Set bottom-right color",
					"![bottom-right color 8](vpl:block:bottom-right-color-8)",
					"Type: action block",
					"The _Set bottom-right color_ block sets the color of the bottom-right RGB LED to the specified color."
				],
				"notes": [
					"# Play melody",
					"![notes](vpl:block:notes)",
					"Type: action block",
					"The _Play melody_ block plays the specified melody. A melody is made of up to 6 notes. Hollow notes have twice the duration of solid notes, and lack of note twice the duration of hollow notes."
				],
				"play": [
					"# Play a .wav file",
					"![play](vpl:block:play)",
					"Type: action block",
					"The _Play a .wav file_ block plays the specified .wav file stored on the micro-SD card."
				],
				"play stop": [
					"# Stop playing a .wav file",
					"![play stop](vpl:block:play-stop)",
					"Type: action block",
					"The _Stop playing a .wav file_ block does what its name suggests."
				],
				"set state": [
					"# Set state (4 bits)",
					"![set state](vpl:block:set-state)",
					"Type: action block",
					"The _Set state (4 bits)_ block sets or clears the specified bits of the state."
				],
				"toggle state": [
					"# Toggle state (4 bits)",
					"![toggle state](vpl:block:toggle-state)",
					"Type: action block",
					"The _Toggle state (4 bits)_ block toggles (changes) the specified bits of the state."
				],
				"set state 8": [
					"# Set state (8 values)",
					"![set state 8](vpl:block:set-state-8)",
					"Type: action block",
					"The _Set state (8 values)_ block sets the 8-value state, displayed on the yellow LEDs, to the specified value."
				],
				"change state 8": [
					"# Set to next or previous state (8 values)",
					"![change state 8](vpl:block:change-state-8)",
					"Type: action block",
					"The _Set to next or previous state (8 values)_ block changes the 8-value state, displayed on the yellow LEDs, with a clockwise or anticlockwise rotation of one step."
				],
				"set counter": [
					"# Set counter",
					"![set counter](vpl:block:set-counter)",
					"Type: action block",
					"The _Set counter_ block sets or changes the state, displayed in binary on the yellow LEDs."
                ],
				"set timer": [
					"# Start timer (0-4 sec)",
					"![set timer](vpl:block:set-timer)",
					"Type: action block",
					"The _Start timer (0-4 sec)_ block sets the timer to a value between 0 and 4 seconds and starts a count down. When the time is elapsed, a timer event is triggered."
				],
				"set timer log": [
					"# Set timer (0.1-10 sec)",
					"![set timer log](vpl:block:set-timer-log)",
					"Type: action block",
					"The _Set timer (0.1-10 sec)_ block sets the timer to a value between 0.1 and 10 seconds and starts a count down. When the time is elapsed, a timer event is triggered."
				],
				"picture comment": [
					"# Picture comment",
					"![picture comment](vpl:block:picture-comment)",
					"Type: comment block",
					"The _Picture comment_ can contain a webcam snapshot. Its only role is to document the VPL program; it has no other effect."
				]
			}
		}
	}
}

</script>

<script type="application/json" id="help-buttons-en.json">
{
	"help": {
		"en": {
			"buttons": {
				"vpl:close": [
					"# Close panel",
					"![vpl:close](vpl:cmd:vpl-close)",
					"Close the VPL programming environment panel."
				],
				"vpl:about": [
					"# Show application information",
					"![show application information](vpl:cmd:vpl-about)",
					"Show information about the VPL application and its copyright."
				],
				"vpl:help": [
					"# Show documentation",
					"![show documentation](vpl:cmd:vpl-help)",
					"Show VPL documentation."
				],
				"vpl:statement": [
					"# Show exercise statement",
					"![show statement](vpl:cmd:vpl-statement)",
					"Show the statement of the problem you're asked to solve."
				],
				"vpl:new": [
					"# New program",
					"![new program](vpl:cmd:vpl-new)",
					"Create a new program without any rule. Like any action which modifies the program, this can be undone with the Undo button."
				],
				"vpl:save": [
					"# Save program",
					"![vpl:save](vpl:cmd:vpl-save)",
					"Save the VPL program to the local computer."
				],
				"vpl:load": [
					"# Load program",
					"![vpl:load](vpl:cmd:vpl-load)",
					"Load an existing VPL program from the local computer."
				],
				"vpl:upload": [
					"# Upload program",
					"![vpl:upload](vpl:cmd:vpl-upload)",
					"Submit the VPL program."
				],
				"vpl:filename": [
					"# Filename",
					"![vpl:filename](vpl:cmd:vpl-filename)",
					"Filename of the current VPL program."
				],
				"vpl:nextProgram": [
					"# Next program",
					"![vpl:nextProgram](vpl:cmd:vpl-nextProgram)",
					"Switch to next program."
				],
				"vpl:exportToHTML": [
					"# Export program view to HTML",
					"![vpl:exportToHTML](vpl:cmd:vpl-exportToHTML)",
					"Export the VPL program to an HTML file saved on the local computer."
				],
				"vpl:advanced": [
					"# Switch advanced mode on or off",
					"![vpl:advanced](vpl:cmd:vpl-advanced)",
					"Toggles the advanced mode on or off. The advanced mode has more advanced blocks."
				],
				"vpl:readonly": [
					"# Read-only program",
					"![read-only program](vpl:cmd:vpl-readonly)",
					"Indicator displayed if the VPL program cannot be modified."
				],
				"vpl:undo": [
					"# Undo last program change",
					"![vpl:undo](vpl:cmd:vpl-undo)",
					"Undo the last action which modified the VPL program."
				],
				"vpl:redo": [
					"# Redo last undone program change",
					"![vpl:redo](vpl:cmd:vpl-redo)",
					"Redo the last undone action. Multiple undone actions can be redone, step by step."
				],
				"vpl:connected": [
					"# Connection status",
					"![vpl:connected](vpl:cmd:vpl-connected)",
					"Indicator showing if VPL can communicate with the robot. The rectangle at the bottom represents VPL on your computer. A cross on the link indicates a broken connection, such as a disconnected cable or a robot switched off."
				],
				"vpl:run": [
					"# Run program",
					"![vpl:run](vpl:cmd:vpl-run)",
					"Run the VPL program on the robot. The confirmation bar is displayed when the program running on the robot matches the one on the screen, i.e. after you have clicked the button and before you have made changes or stopped the program."
				],
				"vpl:stop": [
					"# Stop program",
					"![vpl:stop](vpl:cmd:vpl-stop)",
					"Stop the robot."
				],
				"vpl:debug": [
					"# vpl:debug",
					"![vpl:debug](vpl:cmd:vpl-debug)",
					"Toggle the debugging mode on or off."
				],
				"vpl:robot": [
					"# Change robot",
					"![vpl:robot](vpl:cmd:vpl-robot)",
					"Change the robot."
				],
				"vpl:flash": [
					"# Write program to robot's flash memory",
					"![vpl:flash](vpl:cmd:vpl-flash)",
					"Store the VPL program in the flash memory of the robot (permanent memory). Then you can disconnect the robot and switch it off. The program starts automatically when the robot is switched on.",
					"The number of times a program can be written to the flash memory is limited to a few hundreds."
				],
				"vpl:sim": [
					"# Simulator panel",
					"![vpl:sim](vpl:cmd:vpl-sim)",
					"Display the simulator panel. The simulator is a program which lets you run a VPL program without a real robot and to simulate the motion, state, leds, and some of the events."
				],
				"vpl:text": [
					"# Text source code panel",
					"![vpl:text](vpl:cmd:vpl-text)",
					"Display the text source code panel.",
					"Upon every change, the VPL program is translated to another programming language such as Aseba which is displayed in this panel. You can also modify it directly, but then you loose the relationship with the original VPL program."
				],
				"vpl:teacher-reset": [
					"# Reset customization",
					"![vpl:teacher-reset](vpl:cmd:vpl-teacher-reset)",
					"Reset the customization to the standard user interface and selection of blocks."
				],
				"vpl:teacher-save": [
					"# Save customization",
					"![vpl:teacher-save](vpl:cmd:vpl-teacher-save)",
					"Save the customization of the user interface and selection of blocks to a .vpl3ui file."
				],
				"vpl:teacher-setasnew": [
					"# Install customization for new programs",
					"![vpl:teacher-setasnew](vpl:cmd:vpl-teacher-setasnew)",
					"Use the current customization of the user interface and selection of blocks as the application state after a \"New program\" command."
				],
				"vpl:teacher": [
					"# Switch customization mode on or off",
					"![vpl:teacher](vpl:cmd:vpl-teacher)",
					"Toggle the customization mode of the user interface and the selectino of blocks."
				],
				"vpl:message-error": [
					"# Error message",
					"![vpl:message-error](vpl:cmd:vpl-message-error)",
					"Description of the first error in the VPL program. An error symbol is also displayed next to the problematic rule.",
					"A program with error(s) cannot be run."
				],
				"vpl:message-warning": [
					"# Warning message",
					"![vpl:message-warning](vpl:cmd:vpl-message-warning)",
					"Description of the first warning of the VPL program, provided there are no errors. A warning symbol is also displayed next to the problematic rule.",
					"A program with warning(s) can be run, but its behavior can be unexpected."
				],
				"vpl:duplicate": [
					"# Duplicate rule (rule drop target)",
					"![vpl:duplicate](vpl:cmd:vpl-duplicate)",
					"By dragging a rule and dropping it on this button, the rule is duplicated. Then the blocks in the duplicate can (and should to avoid errors) be changed."
				],
				"vpl:disable": [
					"# Disable block or rule (drop target)",
					"![vpl:disable](vpl:cmd:vpl-disable)",
					"By dragging a block or a whole rule and dropping it on this button, the block or rule is disabled or reenabled.",
					"A disabled block or rule has no effect; it is ignored when checking for errors or changing the behavior of the robot. But it can be convenient to test different versions of the program."
				],
				"vpl:lock": [
					"# Lock block or rule (drop target)",
					"![vpl:lock](vpl:cmd:vpl-lock)",
					"By dragging a block or a whole rule on this button, the block or rule is locked.",
					"The parameters of a locked block canot be changed. The blocks in a locked rule cannot be changed."
				],
				"vpl:trashcan": [
					"# Remove block or rule (drop target)",
					"![vpl:trashcan](vpl:cmd:vpl-trashcan)",
					"By dragging a block or a whole rule on this button, the block or rule is deleted. Like any action which modifies the program, this can be undone with the Undo button."
				]
			}
		}
	}
}

</script>

<!-- french (fr) -->

<script type="application/json" id="block-fr.json">
{
	"i18n": {
		"fr": {
			"button 1": "Bouton simple",
			"button": "Boutons multiples",
			"horiz prox": "Capteurs de proximité",
			"horiz prox adv": "Capteurs de proximité avec seuils bas et haut",
			"horiz prox 1": "Capteurs de proximité avec seuil",
			"ground": "Capteurs de réflexion sur le sol",
			"ground adv": "Capteurs de réflexion sur le sol avec seuils bas et haut",
			"ground 1": "Capteurs de réflexion sur le sol avec seuil",
			"tap": "Détection de choc",
			"accelerometer": "Accéléromètre",
			"roll": "Angle de roulis",
			"pitch": "Angle de tangage",
			"yaw": "Angle de lacet",
			"clap": "Détection de son",
			"init": "Initialisation",
			"timer": "Minuterie",
			"clock": "Horloge à 10 ou 20 Hz",
			"user event": "Événement utilisateur",
			"remote control arrows": "Touches de direction de la télécommande",
			"state": "État (4 bits)",
			"state 8": "État (8 valeurs)",
			"counter comparison": "Comparaison du compteur",
			"color state": "État (couleur)",
			"color 8 state": "État (couleur)",
			"motor state": "Vitesses des moteurs",
			"motor": "Change les vitesses des moteurs",
			"move": "Change le type de déplacement",
			"nn obstacles": "Réseau de neurones pour l'évitement d'obstacles",
			"top color": "Change la couleur du dessus (composantes RVB)",
			"top color 8": "Change la couleur du dessus",
			"bottom color": "Change la couleur du dessous (composantes RVB)",
			"bottom-left color": "Change la couleur du dessous à gauche (composantes RVB)",
			"bottom-right color": "Change la couleur du dessous à droite (composantes RVB)",
			"bottom color 8": "Change la couleur du dessous",
			"bottom-left color 8": "Change la couleur du dessous à gauche",
			"bottom-right color 8": "Change la couleur du dessous à droite",
			"notes": "Joue une mélodie",
			"play": "Joue un fichier .wav",
			"play stop": "Arrête de jouer un fichier .wav",
			"set state": "Change l'état (4 bits)",
			"toggle state": "Inverse l'état (4 bits)",
			"set state 8": "Change l'état (8 valeurs)",
			"change state 8": "Passe à l'état suivant ou précédant (8 valeurs)",
			"set counter": "Change le compteur",
			"set timer": "Démarre la minuterie (0-4 s)",
			"set timer log": "Démarre la minuterie (0.1-10 s)",
			"send user event": "Envoyer un événement utilisateur",
			"picture comment": "Commentaire (image)"
		}
	}
}

</script>

<script type="application/json" id="cmd-sim-fr.json">
{
	"i18n": {
		"fr": {
			"sim:close": "Ferme la vue",
			"sim:restart": "Redémarre la simulation depuis le début",
			"sim:pause": "Met la simulation en pause",
			"sim:speedup": "Change le facteur d'accélération de la simulation",
			"sim:noise": "Enclenche l'ajout de bruit sur les capteurs",
			"sim:pen": "Commute entre le crayon en position baissée ou levée",
			"sim:clear": "Efface les traces faites par le crayon",
			"sim:map-kind": "Change la carte affichée (sol, hauteur ou obstacles)",
			"sim:map": "Active ou désactive la carte",
			"sim:map-ground": "Active ou désactive la carte du sol",
			"sim:map-height": "Active ou désactive la carte de la hauteur",
			"sim:map-obstacles": "Active ou désactive la carte des obstacles",
			"sim:vpl": "Affiche le programme VPL",
			"sim:text": "Affiche le code source",
			"sim:teacher": "Commute entre les modes de programmation et de configuration",
			"sim:teacher-reset": "Remet la configuration à l'état d'origine",
			"sim:btn-button.forward": "Simule une pression sur le bouton avant",
			"sim:btn-button.left": "Simule une pression sur le bouton gauche",
			"sim:btn-button.center": "Simule une pression sur le bouton central",
			"sim:btn-button.right": "Simule une pression sur le bouton droit",
			"sim:btn-button.backward": "Simule une pression sur le bouton arrière",
			"sim:btn-tap": "Simule une détection de choc",
			"sim:btn-clap": "Simule une détection de bruit"
		}
	}
}

</script>

<script type="application/json" id="cmd-vpl-fr.json">
{
	"i18n": {
		"fr": {
			"vpl:close": "Fermer la vue",
			"vpl:about": "Afficher des informations sur l'application",
			"vpl:help": "Afficher la documentation",
			"vpl:statement": "Afficher la donnée de l'exercice",
			"vpl:readonly": "Programmer en mode lecture seule",
			"vpl:new": "Nouveau programme",
			"vpl:save": "Enregistrer le programme",
			"vpl:load": "Charger le programme",
			"vpl:upload": "Téléverser le programme",
			"vpl:nextProgram": "Programme suivant",
			"vpl:exportToHTML": "Exporter le programme en HTML",
			"vpl:text": "Afficher le code source",
			"vpl:text-toggle": "Afficher ou cacher la vue code source",
			"vpl:advanced": "Commuter entre les modes de base et avancés",
			"vpl:undo": "Annuler le dernier changement",
			"vpl:redo": "Rétablire le dernier changement annulé",
			"vpl:run": "Exécuter le programme",
			"vpl:stop": "Arrêter le programme",
			"vpl:flash": "Écrire le programme dans la mémoire du robot",
			"vpl:connected": "Témoin de connexion",
			"vpl:robot": "Changer de robot",
			"vpl:sim": "Afficher le simulateur",
			"vpl:duplicate": "Dupliquer une règle (cible de glisser/déposer)",
			"vpl:disable": "Désactiver un bloc ou une règle (cible de glisser/déposer)",
			"vpl:lock": "Verrouiller un bloc ou une règle (cible de glisser/déposer)",
			"vpl:trashcan": "Supprimer un bloc ou une règle (cible de glisser/déposer)",
			"vpl:duplicate;nodrag": "Dupliquer une règle",
			"vpl:disable;nodrag": "Désactiver un bloc ou une règle",
			"vpl:lock;nodrag": "Verrouiller un bloc ou une règle",
			"vpl:trashcan;nodrag": "Supprimer un bloc ou une règle",
			"vpl:message-error": "Message d'erreur",
			"vpl:message-warning": "Message d'avertissement",
			"vpl:message-empty": " ",
			"vpl:filename": "Nom de fichier",
			"vpl:teacher": "Commuter entre les modes de programmation et de configuration",
			"vpl:teacher-reset": "Remettre la configuration à l'état d'origine",
			"vpl:teacher-save": "Enregistrer la configuration",
			"vpl:teacher-setasnew": "Installer la configuration pour les nouveaux programmes"
		}
	}
}

</script>

<script type="text/html" id="doctemplate-fr.html">
<html>
	<head>
		<style>
			body {
				font-family: sans-serif;
			}
			img {
				float: left;
				margin-right: 10px;
				margin-bottom: 20px;
			}
			h1, h2, hr {
				clear: left;
			}
			p {
				margin-left: 120px;
			}
			p.parimg {
				margin-left: 0;
			}
		</style>
	</head>

	<body>
		<div style='padding: 2em; max-width: 60em; margin-left: auto; margin-right: auto;'>
			<h1>Barres d'outils</h1>
			BUTTONS
			<h1>Blocs</h1>
			BLOCKS
		</div>
	</body>
</html>

</script>

<script type="application/json" id="help-blocks-fr.json">
{
	"help": {
		"fr": {
			"blocks": {
				"button 1": [
					"# Bouton simple",
					"![single button](vpl:block:button-1)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _bouton simple_ active la règle lorsqu'on touche le bouton spécifié sur le Thymio.",
					"Comme bloc de condition, le bloc _bouton simple_ n'autorise l'activation de la règle que si l'on touche le bouton spécifié au moment où l'événement correspondant au 1er bloc à gauche survient."
				],
				"button": [
					"# Boutons multiples",
					"![button](vpl:block:button)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _boutons multiples_ active la règle lorsqu'on touche simultanément tous les boutons spécifiés sur le Thymio.",
					"Comme bloc de condition, le bloc _boutons multiples_ n'autorise l'activation de la règle que si l'on touche tous les boutons spécifiés au moment où l'événement correspondant au 1er bloc à gauche survient."
				],
				"horiz prox": [
					"# Capteurs de proximité",
					"![Proximity sensors](vpl:block:horiz-prox)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _capteurs de proximité_ active la règle lorsque les capteurs de proximité spécifiés détectent un obstacle, ou l'absence d'obstacle, en réfléchissant plus qu'une certaine fraction de l'émission infrarouge. Toutes les conditions doivent être remplies simultanément; l'événement ne se produit qu'au moment où le dernier capteur spécifié détecte (ou ne détecte plus) un obstacle.",
					"Comme bloc de condition, le bloc _capteurs de proximité_ n'autorise l'activation de la règle que si les capteurs de proximité spécifiés détectent (ou pas) la présence d'un obstacle."
				],
				"horiz prox adv": [
					"# Capteurs de proximité avec seuils bas et haut",
					"![horiz prox adv](vpl:block:horiz-prox-adv)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _capteurs de proximité avec seuils bas et haut_ active la règle lorsque les capteurs de proximité spécifiés détectent un obstacle, ou l'absence d'obstacle, en réfléchissant plus que la fraction de l'émission infrarouge spécifiée par les seuils haut et bas, respectivement. Toutes les conditions doivent être remplies simultanément; l'événement ne se produit qu'au moment où le dernier capteur spécifié détecte (ou ne détecte plus) un obstacle.",
					"Comme bloc de condition, le bloc _capteurs de proximité avec seuils bas et haut_ n'autorise l'activation de la règle que si les capteurs de proximité spécifiés détectent (ou pas) la présence d'un obstacle."
				],
				"horiz prox 1": [
					"# Capteurs de proximité avec seuil",
					"![horiz prox 1](vpl:block:horiz-prox-1)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _capteurs de proximité avec seuil_ active la règle lorsque les capteurs de proximité spécifiés détectent un obstacle, ou l'absence d'obstacle, en réfléchissant plus que la fraction de l'émission infrarouge spécifiée par le seuil. Toutes les conditions doivent être remplies simultanément; l'événement ne se produit qu'au moment où le dernier capteur spécifié détecte (ou ne détecte plus) un obstacle.",
					"Comme bloc de condition, le bloc _capteurs de proximité avec seuils bas et haut_ n'autorise l'activation de la règle que si les capteurs de proximité spécifiés détectent (ou pas) la présence d'un obstacle."
				],
				"ground": [
					"# Capteurs de réflexion sur le sol",
					"![ground](vpl:block:ground)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _capteurs de réflexion sur le sol_ active la règle lorsque les capteurs de sol spécifiés détectent un sol blanc ou clair (ou son absence), en réfléchissant plus (ou moins) qu'une certaine fraction de l'émission infrarouge. Toutes les conditions doivent être remplies simultanément; quand les deux capteurs sont actifs, l'événement ne se produit qu'au moment où le second capteur détecte (ou ne détecte plus) la réflexion sur le sol.",
					"Comme bloc de condition, le bloc _capteurs de réflexion sur le sol_ n'autorise l'activation de la règle que si les capteurs de sol spécifiés détectent (ou pas) la réflection sur le sol."
				],
				"ground adv": [
					"# Capteurs de réflexion sur le sol avec seuils bas et haut",
					"![ground adv](vpl:block:ground-adv)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _capteurs de réflexion sur le sol avec seuils bas et haut_ active la règle lorsque les capteurs de sol spécifiés détectent un sol blanc ou clair (ou son absence), en réfléchissant plus (ou moins) que la fraction de l'émission infrarouge spécifiée par les seuils haut et bas, respectivement. Toutes les conditions doivent être remplies simultanément; quand les deux capteurs sont actifs, l'événement ne se produit qu'au moment où le second capteur détecte (ou ne détecte plus) la réflexion sur le sol.",
					"Comme bloc de condition, le bloc _capteurs de réflexion sur le sol avec seuils bas et haut_ n'autorise l'activation de la règle que si les capteurs de sol spécifiés détectent (ou pas) la réflection sur le sol."
				],
				"ground 1": [
					"# Capteurs de réflexion sur le sol avec seuil",
					"![ground 1](vpl:block:ground-1)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _capteurs de réflexion sur le sol avec seuil_ active la règle lorsque les capteurs de sol spécifiés détectent un sol blanc ou clair (ou son absence), en réfléchissant plus (ou moins) que la fraction de l'émission infrarouge spécifiée par le seuil. Toutes les conditions doivent être remplies simultanément; quand les deux capteurs sont actifs, l'événement ne se produit qu'au moment où le second capteur détecte (ou ne détecte plus) la réflexion sur le sol.",
					"Comme bloc de condition, le bloc _capteurs de réflexion sur le sol avec seuil_ n'autorise l'activation de la règle que si les capteurs de sol spécifiés détectent (ou pas) la réflection sur le sol."
				],
				"tap": [
					"# Détection de choc",
					"![tap](vpl:block:tap)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _détection de choc_ active la règle lorsque l'accéléromètre détecte un impact tel qu'une légère tape de la main sur le robot.",
					"Comme bloc de condition, le bloc _détection de choc_ n'autorise l'activation de la règle que si un impact a été détecté auparavant."
				],
				"accelerometer": [
					"# Accéléromètre",
					"![accelerometer](vpl:block:accelerometer)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _accéléromètre_ active la règle lorsque l'événement spécifié est détecté: un impact (typiquement une légère tape de la main sur le robot), l'angle de tangage spécifié (le tangage est la rotation autour d'un axe gauche-droite) ou l'angle de roulis spécifié (le roulis est la rotation autour d'un axe avant-arrière).",
					"Comme bloc de condition, le bloc _accéléromètre_ n'autorise l'activation de la règle qu'après qu'un impact a été détecté, ou lorsque l'angle de tangage ou de roulis est dans l'intervalle spécifié."
				],
				"roll": [
					"# Angle de roulis",
					"![roll](vpl:block:roll)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _angle de roulis_ active la règle lorsque l'angle de roulis (la rotation autour d'un axe avant-arrière) spécifié est atteint.",
					"Comme bloc de condition, le bloc _angle de roulis_ n'autorise l'activation de la règle que lorsque l'angle de roulis est dans l'intervalle spécifié."
				],
				"pitch": [
					"# Angle de tangage",
					"![pitch](vpl:block:pitch)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _angle de tangage_ active la règle lorsque l'angle de tangage (la rotation autour d'un axe gauche-droite) spécifié est atteint.",
					"Comme bloc de condition, le bloc _angle de tangage_ n'autorise l'activation de la règle que lorsque l'angle de tangage est dans l'intervalle spécifié."
				],
				"yaw": [
					"# Angle de lacet",
					"![yaw](vpl:block:yaw)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _angle de lacet_ active la règle lorsque l'angle de lacet spécifié est atteint. Le lacet est la rotation autour du crayon telle qu'elle est perçue par la direction de la gravité dans le plan perpendiculaire au crayon.",
					"Comme bloc de condition, le bloc _angle de lacet_ n'autorise l'activation de la règle que lorsque l'angle de tangage est dans l'intervalle spécifié."
				],
				"clap": [
					"# Détection de son",
					"![clap](vpl:block:clap)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _détection de son_ active la règle lorsque le micro détecte un son ou un bruit tel qu'une frappe des mains.",
					"Comme bloc de condition, le bloc _détection de son_ n'autorise l'activation de la règle que si le volume sonore capté par le micro dépasse un certain niveau."
				],
				"init": [
					"# Initialisation",
					"![init](vpl:block:init)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _initialisation_ active la règle au lancement du programme.",
					"Comme bloc de condition, le bloc _initialisation_ est toujours satisfait."
				],
				"timer": [
					"# Minuterie",
					"![timer](vpl:block:timer)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _minuterie_ active la règle lorsque le temps spécifié par le bloc d'action de démarrage de la minuterie est écoulé.",
					"Comme bloc de condition, le bloc _minuterie_ n'autorise l'activation de la règle que si le temps de la minuterie est écoulé, jusqu'au prochain lancement."
				],
				"remote control arrows": [
					"# Touches de direction de la télécommande",
					"![remote control arrows](vpl:block:remote-control-arrows)",
					"Type: bloc d'événement ou de condition",
					"Comme bloc d'événement, le bloc _touches de direction de la télécommande_ active la règle lorsqu'on appuie sur le bouton spécifié de la télécommande.",
					"Comme bloc de condition, le bloc _touches de direction de la télécommande_ n'autorise l'activation de la règle que si l'on a appuyé sur le bouton spécifié de la télécommande au moment où l'événement correspondant au 1er bloc à gauche survient."
				],
				"state": [
					"# État (4 bits)",
					"![state](vpl:block:state)",
					"Type: bloc de condition",
					"Comme bloc de condition, le bloc _état (4 bits)_ n'autorise l'activation de la règle que si les bits spécifiés de l'état, indiqués par les LEDs jaunes, valent 1 ou 0."
				],
				"state 8": [
					"# État (8 valeurs)",
					"![state 8](vpl:block:state-8)",
					"Type: bloc de condition",
					"Comme bloc de condition, le bloc _état (8 valeurs)_ n'autorise l'activation de la règle que si l'état de 8 valeurs, indiqués par les LEDs jaunes, a la valeur spécifiée."
				],
				"counter comparison": [
					"# Comparaison du compteur",
					"![counter comparison](vpl:block:counter-comparison)",
					"Type: bloc de condition",
					"Comme bloc de condition, le bloc _comparaison du compteur_ n'autorise l'activation de la règle que si l'état 8 bits, indiqués par les LEDs jaunes, remplit la condition spécifiée."
				],
				"color state": [
					"# État (couleur)",
					"![color state](vpl:block:color-state)",
					"Type: bloc de condition",
					"Comme bloc de condition, le bloc _état (couleur)_ n'autorise l'activation de la règle que si la couleur de la LED RVB du dessus du robot a approximativement la couleur spécifiée."
				],
				"color 8 state": [
					"# État (couleur)",
					"![color 8 state](vpl:block:color-8-state)",
					"Type: bloc de condition",
					"Comme bloc de condition, le bloc _état (couleur)_ n'autorise l'activation de la règle que si la couleur de la LED RVB du dessus du robot a approximativement la couleur spécifiée."
				],
				"motor state": [
					"# Vitesses des moteurs",
					"![motor state](vpl:block:motor-state)",
					"Type: bloc de condition",
					"Comme bloc de condition, le bloc _vitesse des moteurs_ n'autorise l'activation de la règle que si la vitesse des moteurs a approximativement les valeurs spécifiées."
				],
				"motor": [
					"# Change les vitesses des moteurs",
					"![Set motor speeds](vpl:block:motor)",
					"Type: bloc d'action",
					"Le bloc _change les vitesses des moteurs_ fixe la vitesse à atteindre pour les moteurs gauche et droit. La combinaison de vitesses permet d'avancer ou de reculer, de tourner et de s'arrêter."
				],
				"move": [
					"# Change le type de déplacement",
					"![move](vpl:block:move)",
					"Type: bloc d'action",
					"Le bloc _change le type de déplacement_ fixe la vitesse des moteurs gauche et droit pour obtenir un déplacement dans la direction indiquée. La combinaison de vitesses permet d'avancer ou de reculer, de tourner et de s'arrêter."
				],
				"nn obstacles": [
					"# Réseau de neurones pour l'évitement d'obstacles",
					"![nn obstacles](vpl:block:nn-obstacles)",
					"Type: bloc d'action",
					"..."
				],
				"top color": [
					"# Change la couleur du dessus (composantes RVB)",
					"![top color](vpl:block:top-color)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessus (composantes RVB)_ change les composantes rouge, verte et bleue de la LED RVB du dessus du robot."
				],
				"top color 8": [
					"# Change la couleur du dessus",
					"![top color 8](vpl:block:top-color-8)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessus_ change la couleur de la LED RVB du dessus du robot."
				],
				"bottom color": [
					"# Change la couleur du dessous (composantes RVB)",
					"![bottom color](vpl:block:bottom-color)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessous (composantes RVB)_ change les composantes rouge, verte et bleue des LEDs RVB gauche et droite du dessous du robot."
				],
				"bottom-left color": [
					"# Change la couleur du dessous à gauche (composantes RVB)",
					"![bottom-left color](vpl:block:bottom-left-color)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessous (composantes RVB)_ change les composantes rouge, verte et bleue de la LED RVB gauche du dessous du robot."
				],
				"bottom-right color": [
					"# Change la couleur du dessous à droite (composantes RVB)",
					"![bottom-right color](vpl:block:bottom-right-color)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessous (composantes RVB)_ change les composantes rouge, verte et bleue de la LED RVB droite du dessous du robot."
				],
				"bottom color 8": [
					"# Change la couleur du dessous",
					"![bottom color 8](vpl:block:bottom-color-8)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessous_ change la couleur des LEDs RVB gauche et droite du dessous du robot."
				],
				"bottom-left color 8": [
					"# Change la couleur du dessous à gauche",
					"![bottom-left color 8](vpl:block:bottom-left-color-8)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessous_ change la couleur de la LED RVB gauche du dessous du robot."
				],
				"bottom-right color 8": [
					"# Change la couleur du dessous à droite",
					"![bottom-right color 8](vpl:block:bottom-right-color-8)",
					"Type: bloc d'action",
					"Le bloc _change la couleur du dessous_ change la couleur de la LED RVB droite du dessous du robot."
				],
				"notes": [
					"# Joue une mélodie",
					"![notes](vpl:block:notes)",
					"Type: bloc d'action",
					"Le bloc _joue une mélodie_ joue la mélodie spécifiée. Une mélodie est faite d'un maximum de 6 notes. Les blanches ont une durée 2x plus longue que les noires, et les pauses (absence de note) une durée 2x plus longue que les blanches."
				],
				"play": [
					"# Joue un fichier .wav",
					"![play](vpl:block:play)",
					"Type: bloc d'action",
					"Le bloc _jour un fichier .wav_ joue le fichier .wav spécifié sur la carte micro-SD du robot."
				],
				"play stop": [
					"# Arrête de jouer un fichier .wav",
					"![play stop](vpl:block:play-stop)",
					"Type: bloc d'action",
					"Le bloc _arrête de jouer un fichier .wav_ fait ce que son nom indique."
				],
				"set state": [
					"# Change l'état (4 bits)",
					"![set state](vpl:block:set-state)",
					"Type: bloc d'action",
					"Le bloc _change l'état (4 bits)_ fait passer les bits spécifiés de l'état à 1 ou 0. L'état est affiché sur les LEDs jaunes."
				],
				"toggle state": [
					"# Inverse l'état (4 bits)",
					"![toggle state](vpl:block:toggle-state)",
					"Type: bloc d'action",
					"Le bloc _inverse l'état (4 bits)_ change les bits spécifiés de l'état de 0 à 1 ou inversément."
				],
				"set state 8": [
					"# Change l'état (8 valeurs)",
					"![set state 8](vpl:block:set-state-8)",
					"Type: bloc d'action",
					"Le bloc _change l'état (8 valeurs)_ fait passer l'état de 8 valeurs, qui est affiché sur les LEDs jaunes, à la valeur spécifiée."
				],
				"change state 8": [
					"# Passe à l'état suivant ou précédant (8 valeurs)",
					"![change state 8](vpl:block:change-state-8)",
					"Type: bloc d'action",
					"Le bloc _passe à l'état suivant ou précédant (8 valeurs)_ fait passer l'état de 8 valeurs, qui est affiché sur les LEDs jaunes, à la valeur suivante ou précédante en tournant dans le sens spécifié."
				],
				"set counter": [
					"# Change le compteur",
					"![set counter](vpl:block:set-counter)",
					"Type: bloc d'action",
					"Le bloc _change le compteur_ change l'état représenté sur les LEDs jaunes."
				],
				"set timer": [
					"# Démarre la minuterie (0-4 s)",
					"![set timer](vpl:block:set-timer)",
					"Type: bloc d'action",
					"Le bloc _démarre la minuterie (0-4 s)_ fait démarer la minuterie pour qu'elle se déclenche jusqu'à 4 s plus tard."
				],
				"set timer log": [
					"# Démarre la minuterie (0.1-10 s)",
					"![set timer log](vpl:block:set-timer-log)",
					"Type: bloc d'action",
					"Le bloc _démarre la minuterie (0.1-10 s)_ fait démarer la minuterie pour qu'elle se déclenche jusqu'à 10 s plus tard."
				],
				"picture comment": [
					"# Commentaire (image)",
					"![picture comment](vpl:block:picture-comment)",
					"Type: block de commentaire",
					"Le bloc _commentaire (image)_ peut contenir une photo prise par la caméra de l'ordinateur. Il permet de documenter le programme sans en changer le comportement."
				]
			}
		}
	}
}

</script>

<script type="application/json" id="help-buttons-fr.json">
{
	"help": {
		"fr": {
			"buttons": {
				"vpl:close": [
					"# Ferme la vue",
					"![vpl:close](vpl:cmd:vpl-close)",
					"Ferme le panneau de l'environnement de programmation VPL."
				],
				"vpl:about": [
					"# Affiche des informations sur l'application",
					"![vpl:about](vpl:cmd:vpl-about)",
					"Affiche l'information sur l'application VPL et les mentions légales."
				],
				"vpl:help": [
					"# Affiche la documentation",
					"![vpl:help](vpl:cmd:vpl-help)",
					"Affiche la documentation de VPL."
				],
				"vpl:statement": [
					"# Affiche la donnée de l'exercice",
					"![vpl:statement](vpl:cmd:vpl-statement)",
					"Affiche la donnée du problème qu'on vous propose de résoudre."
				],
				"vpl:new": [
					"# Nouveau programme",
					"![vpl:new](vpl:cmd:vpl-new)",
					"Crée un nouveau programme vide. Tout comme pour les autres actions qui modifient le programme, ceci peut être annulé avec le bouton Annuler."
				],
				"vpl:save": [
					"# Enregistre le programme",
					"![vpl:save](vpl:cmd:vpl-save)",
					"Enregistre le programme sur l'ordinateur local."
				],
				"vpl:load": [
					"# Charge le programme",
					"![vpl:load](vpl:cmd:vpl-load)",
					"Charge un programme VPL existant depuis l'ordinateur local."
				],
				"vpl:upload": [
					"# Téléverse le programme",
					"![vpl:upload](vpl:cmd:vpl-upload)",
					"Soumet le programme VPL."
				],
				"vpl:filename": [
					"# Nom de fichier",
					"![vpl:filename](vpl:cmd:vpl-filename)",
					"Nom de fichier du programme VPL."
				],
				"vpl:nextProgram": [
					"# Programme suivant",
					"![vpl:nextProgram](vpl:cmd:vpl-nextProgram)",
					"Passe au programme suivant."
				],
				"vpl:exportToHTML": [
					"# Exporte le programme en HTML",
					"![vpl:exportToHTML](vpl:cmd:vpl-exportToHTML)",
					"Exporte le programme VPL au format HTML sur l'ordinateur local."
				],
				"vpl:advanced": [
					"# Commute entre les modes de base et avancés",
					"![vpl:advanced](vpl:cmd:vpl-advanced)",
					"Commute le mode de programmation avancé."
				],
				"vpl:readonly": [
					"# Programme en mode lecture seule",
					"![vpl:readonly](vpl:cmd:vpl-readonly)",
					"Indicateur affiché si le programme ne peut pas être modifié."
				],
				"vpl:undo": [
					"# Annule le dernier changement",
					"![vpl:undo](vpl:cmd:vpl-undo)",
					"Annule l'effet de la dernière action qui a changé le programme VPL."
				],
				"vpl:redo": [
					"# Rétablit le dernier changement annulé",
					"![vpl:redo](vpl:cmd:vpl-redo)",
					"Rétablit l'effet de la dernière action annulée. Plusieurs annulations peuvent être rétablies une par une."
				],
				"vpl:connected": [
					"# Témoin de connexion",
					"![vpl:connected](vpl:cmd:vpl-connected)",
					"Indicateur qui montre si VPL peut communiquer avec le robot. Le rectangle du bas correspond à VPL sur votre ordinateur. Une croix sur le lien indique une déconnexion telle qu'un câble débranché ou un robot éteint."
				],
				"vpl:run": [
					"# Exécute le programme",
					"![vpl:run](vpl:cmd:vpl-run)",
					"Lance le programme sur le robot. La barre de confirmation est affichée lorsque le programme qui tourne sur le robot correspond à celui à l'écran, entre le clic sur le bouton et la prochain changement ou l'arrêt du programme."
				],
				"vpl:stop": [
					"# Arrête le programme",
					"![vpl:stop](vpl:cmd:vpl-stop)",
					"Arrête le robot."
				],
				"vpl:debug": [
					"# vpl:debug",
					"![vpl:debug](vpl:cmd:vpl-debug)",
					"Commute le mode de débogage."
				],
				"vpl:robot": [
					"# Change de robot",
					"![vpl:robot](vpl:cmd:vpl-robot)",
					"Change de robot."
				],
				"vpl:flash": [
					"# Écrit le programme dans la mémoire du robot",
					"![vpl:flash](vpl:cmd:vpl-flash)",
					"Écrit le programme dans la mémoire flash du robot (mémoire permanente). Le robot peut ensuite être éteint et déconnecté. Le programme est relancé lorsque le robot est rallumé."
				],
				"vpl:sim": [
					"# Affiche le simulateur",
					"![vpl:sim](vpl:cmd:vpl-sim)",
					"Affiche le panneau du simulateur. Le simulateur est un programme qui vous permet de tester un programme sans robot réel et de simuler les déplacements, les états, les leds, ainsi que la plupart des événements."
				],
				"vpl:text": [
					"# Affiche le code source",
					"![vpl:text](vpl:cmd:vpl-text)",
					"Affiche le panneau de l'éditeur de code source.",
					"À chaque changement, le programme VPL est traduit dans un langage de programmation tel qu'Aseba qui est affiché dans cet éditeur. Vous pouvez aussi le modifier directement, perdant ainsi la correspondance avec le programme VPL."
				],
				"vpl:teacher-reset": [
					"# Remet la configuration à l'état d'origine",
					"![vpl:teacher-reset](vpl:cmd:vpl-teacher-reset)",
					"Réinitialise la configuration pour retrouver l'état standard de l'interface utilisateur et de l'assortiment de blocs."
				],
				"vpl:teacher-save": [
					"# Enregistre la configuration",
					"![vpl:teacher-save](vpl:cmd:vpl-teacher-save)",
					"Enregistre la configuration de l'interface utilisateur et de l'assortiment de blocs dans un fichier .vpl3ui."
				],
				"vpl:teacher-setasnew": [
					"# Installe la configuration pour les nouveaux programmes",
					"![vpl:teacher-setasnew](vpl:cmd:vpl-teacher-setasnew)",
					"Utilise la configuration actuelle de l'interface utilisateur et de l'assortiment de blocs lorsque la commande \"Nouveau programme\" est exécutée."
				],
				"vpl:teacher": [
					"# Commute entre les modes de programmation et de configuration",
					"![vpl:teacher](vpl:cmd:vpl-teacher)",
					"Commute le mode de configuration de l'interface utilisateur et de l'assortiment de blocs."
				],
				"vpl:message-error": [
					"# Message d'erreur",
					"![vpl:message-error](vpl:cmd:vpl-message-error)",
					"Description de la première erreur rencontrée dans le programme VPL. Une marque indique précisément où se trouve l'erreur.",
					"Un programme ne doit pas avoir d'erreurs pour pouvoir être exécuté."
				],
				"vpl:message-warning": [
					"# Message d'avertissement",
					"![vpl:message-warning](vpl:cmd:vpl-message-warning)",
					"Description du premier avertissement dans le programme VPL s'il n'y a aucune erreur. Une marque indique précisément où se trouve le problème.",
					"Un programme qui provoque des avertissements peut être lancé, mais son comportement peut être inattendu."
				],
				"vpl:duplicate": [
					"# Duplique une règle (cible de glisser/déposer)",
					"![vpl:duplicate](vpl:cmd:vpl-duplicate)",
					"En glissant et déposant une règle sur ce bouton, on duplique la règle. Les blocs peuvent ensuite être modifiés."
				],
				"vpl:disable": [
					"# Désactive un bloc ou une règle (cible de glisser/déposer)",
					"![vpl:disable](vpl:cmd:vpl-disable)",
					"En glissant et déposant un bloc ou une règle sur ce bouton, on le désactive ou réactive.",
					"Un bloc ou une règle désactivé n'a aucun effet sur l'exécution du programme. Cela peut être pratique pour faire des tests en cours de développement."
				],
				"vpl:lock": [
					"# Verrouille un bloc ou une règle (cible de glisser/déposer)",
					"![vpl:lock](vpl:cmd:vpl-lock)",
					"En glissant et déponsant un bloc ou une règle sur ce bouton, on le verrouille ou le déverrouille.",
					"Les paramètres d'un bloc verrouillé, ou les blocs d'une règle verrouillée, ne peuvent pas être changées."
				],
				"vpl:trashcan": [
					"# Supprime un bloc ou une règle (cible de glisser/déposer)",
					"![vpl:trashcan](vpl:cmd:vpl-trashcan)",
					"En glissant et déponsant un bloc ou une règle sur ce bouton, on le supprime. Tout comme pour les autres actions qui modifient le programme, ceci peut être annulé avec le bouton Annuler."
				]
			}
		}
	}
}

</script>

<script type="application/json" id="messages-en.json">
{
	"i18n": {
		"en": {
			"Same block used multiple times": "Same block used multiple times",
			"Rules with same events": "Rules with same events",
			"Missing action block": "Missing action block",
			"Missing event block": "Missing event block",
			"No button specified": "No button specified",
			"No ground sensor specified": "No ground sensor specified",
			"No proximity sensor specified": "No proximity sensor specified",
			"No sensor specified": "No sensor specified",
			"Open program file": "Open program file",
			"OK": "OK",
			"Cancel": "Cancel",
			"Open ground image file": "Open ground image file",
			"Open height image file": "Open height image file",
			"Open obstacle SVG file": "Open obstacle SVG file",

			"Script too big for target bytecode size": "Program too large for Thymio"
		}
	}
}

</script>

<script type="application/json" id="messages-fr.json">
{
	"i18n": {
		"fr": {
			"Same block used multiple times": "Même bloc utilisé plusieurs fois",
			"Rules with same events": "Règles avec les mêmes événements",
			"Missing action block": "Il manque un bloc d'action",
			"Missing event block": "Il manque un bloc d'événement",
			"No button specified": "Aucun bouton n'est spécifié",
			"No ground sensor specified": "Aucun capteur de sol n'est spécifié",
			"No proximity sensor specified": "Aucun capteur de proximité n'est spécifié",
			"No sensor specified": "Aucun capteur n'est spécifié",
			"Open program file": "Ouvrir un programme",
			"OK": "OK",
			"Cancel": "Annuler",
			"Open ground image file": "Ouvrir une image pour le sol",
			"Open height image file": "Ouvrir une image pour la hauteur",
			"Open obstacle SVG file": "Ouvrir un fichier SVG pour les obstacles",

			"Script too big for target bytecode size": "Programme trop grand pour le Thymio"
		}
	}
}

</script>

<title>VPL</title>

<style>
html {
	height: 100%;
}
body {
	height: 100%;
	margin: 0;
}
#programCanvas {
	width: 100%;
	height: 100%;
	display: block;
	z-index: 10;
}
#src-editor {
	width: 100%;
	position: fixed;
	z-index: 20;
}
#editor {
	height: 100%;
	display: block;
	padding-top: 0;
	padding-bottom: 0;
	padding-left: 5pt;
	padding-right: 5pt;
	margin: 0;
	border: 0;
	box-sizing: border-box;
	tab-size: 4;
	font-family: monospace;
	font-size: 11pt;
}
pre#editor-lines {
	background-color: silver;
    width: 70px;
    float: left;
    margin: 0;
    padding-top: 0;
    padding-bottom: 0;
    padding-left: 0;
    padding-right: 5pt;
    text-align: right;
    overflow: hidden;
	user-select: none;
}

#input {
	position: absolute;
	z-index: 1000;
	font-family: sans-serif;
	font-size: 15pt;
	top: 10px;
	left: 10px;
	display: none;
}

@media only screen and (max-device-width: 1024px) {
	#editor {
		tab-size: 2;
		font-size: 10pt;
	}
}
</style>

<script src="libs/jszip/jszip.min.js"></script>

<script src="src/a3a-ns.js"></script>
<script src="src/svg.js"></script>
<script src="src/svg-preparsed.js"></script>
<script src="src/svg-transform.js"></script>
<script src="src/vpl-ns.js"></script>
<script src="src/vpl-blocktemplate.js"></script>
<script src="src/vpl-blockparam-acc.js"></script>
<script src="src/vpl-block.js"></script>
<script src="src/vpl-emptyblock.js"></script>
<script src="src/css.js"></script>
<script src="src/vpl-css.js"></script>
<script src="src/vpl-css-draw.js"></script>
<script src="src/vpl-canvas.js"></script>
<script src="src/vpl-canvas-scroll.js"></script>
<script src="src/vpl-blocklibutil.js"></script>
<script src="src/vpl-blocklib.js"></script>
<script src="src/vpl-blocklib-svg.js"></script>
<script src="src/vpl-jsoncode.js"></script>
<script src="src/vpl-rule.js"></script>
<script src="src/vpl-rule-comment.js"></script>
<script src="src/vpl-uiconfig.js"></script>
<script src="src/vpl-program.js"></script>
<script src="src/vpl-code.js"></script>
<script src="src/vpl-code-aseba.js"></script>
<script src="src/vpl-code-l2.js"></script>
<script src="src/vpl-code-asm.js"></script>
<script src="src/vpl-code-js.js"></script>
<script src="src/vpl-code-python.js"></script>
<script src="src/vpl-cmd.js"></script>
<script src="src/vpl-app.js"></script>
<script src="src/vpl-ui-validator.js"></script>
<script src="src/vpl-cmd-vpl.js"></script>
<script src="src/vpl-controlbar.js"></script>
<script src="src/vpl-buttons-js.js"></script>
<script src="src/vpl-controlbar-btn.js"></script>
<script src="src/vpl-widgets-js.js"></script>
<script src="src/vpl-program-canvas.js"></script>
<script src="src/vpl-error.js"></script>
<script src="src/vpl-draw.js"></script>
<script src="src/vpl-undo.js"></script>
<script src="src/vpl-html.js"></script>
<script src="src/vpl-aeslfile.js"></script>
<script src="src/vpl-texteditor.js"></script>
<script src="src/vpl-sourceedit.js"></script>
<script src="src/vpl-cmd-src.js"></script>
<script src="src/vpl-ui-svg.js"></script>
<script src="src/vpl-runglue.js"></script>
<script src="src/vpl-htmlpanel.js"></script>
<script src="src/vpl-conv-html.js"></script>
<script src="src/vpl-files.js"></script>
<script src="src/zipbundle.js"></script>
<script src="src/vpl-load.js"></script>
<script src="src/vpl-com.js"></script>
<script src="src/vpl-i18n.js"></script>
<script src="src/vpl-dynamic-help.js"></script>
<script src="src/vpl-keyboard.js"></script>
<script src="src/vpl-textfield.js"></script>
<script src="src/vpl-textfield-input.js"></script>
<script src="src/vpl-kbd-control.js"></script>
<script src="src/vpl-main.js"></script>

<script src="src/a3a-nodebase.js"></script>
<script src="src/a3a-nodeproxy.js"></script>

<script src="src/vpl-thymio.js"></script>
<script src="src/vpl-thymio-tdm.js"></script>
<script src="src/vpl-robot.js"></script>
<script src="src/vpl-virtualthymio.js"></script>
<script src="src/compiler-ns.js"></script>
<script src="src/compiler-vm.js"></script>
<script src="src/compiler-dis.js"></script>
<script src="src/compiler-dis-mixed.js"></script>
<script src="src/compiler.js"></script>
<script src="src/compiler-macros.js"></script>
<script src="src/compiler-l2.js"></script>
<script src="src/compiler-macros-l2.js"></script>
<script src="src/compiler-thymio.js"></script>
<script src="src/compiler-asm.js"></script>
<script src="src/inputbuffer.js"></script>
<script src="src/a3a-idmapping.js"></script>
<script src="src/a3a-com.js"></script>
<script src="src/a3a-device.js"></script>
<script src="src/a3a-virtual-thymio.js"></script>
<script src="src/vpl-virtualthymio-a3a.js"></script>
<script src="src/vpl-obstacles.js"></script>
<script src="src/vpl-sim.js"></script>
<script src="src/vpl-sim2d.js"></script>
<script src="src/vpl-cmd-sim.js"></script>

<script src="thymio/thymio.js"></script>

</head>

<body>

<div id="vpl-editor">

<canvas id="programCanvas" width="900" height="700"></canvas>

<input id="input">

</div>

<div id="src-editor">
<pre id="editor-lines"></pre>
<textarea id="editor" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
</textarea>
</div>

</body>

</html>

